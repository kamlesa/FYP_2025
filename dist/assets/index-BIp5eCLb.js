(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();/**
* @vue/shared v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function e2(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const ct={},bl=[],Gr=()=>{},wO=()=>!1,s0=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),t2=e=>e.startsWith("onUpdate:"),wn=Object.assign,n2=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},F7=Object.prototype.hasOwnProperty,Ke=(e,t)=>F7.call(e,t),Oe=Array.isArray,Kf=e=>o0(e)==="[object Map]",T7=e=>o0(e)==="[object Set]",Re=e=>typeof e=="function",Gt=e=>typeof e=="string",vc=e=>typeof e=="symbol",At=e=>e!==null&&typeof e=="object",_O=e=>(At(e)||Re(e))&&Re(e.then)&&Re(e.catch),R7=Object.prototype.toString,o0=e=>R7.call(e),O7=e=>o0(e).slice(8,-1),D7=e=>o0(e)==="[object Object]",i2=e=>Gt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Qf=e2(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),a0=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},N7=/-\w/g,Pi=a0(e=>e.replace(N7,t=>t.slice(1).toUpperCase())),P7=/\B([A-Z])/g,Mu=a0(e=>e.replace(P7,"-$1").toLowerCase()),u0=a0(e=>e.charAt(0).toUpperCase()+e.slice(1)),_y=a0(e=>e?`on${u0(e)}`:""),Bo=(e,t)=>!Object.is(e,t),Ey=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},EO=(e,t,n,i=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:i,value:n})},I7=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let XA;const l0=()=>XA||(XA=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function r2(e){if(Oe(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Gt(i)?U7(i):r2(i);if(r)for(const s in r)t[s]=r[s]}return t}else if(Gt(e)||At(e))return e}const L7=/;(?![^(]*\))/g,z7=/:([^]+)/,B7=/\/\*[^]*?\*\//g;function U7(e){const t={};return e.replace(B7,"").split(L7).forEach(n=>{if(n){const i=n.split(z7);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function s2(e){let t="";if(Gt(e))t=e;else if(Oe(e))for(let n=0;n<e.length;n++){const i=s2(e[n]);i&&(t+=i+" ")}else if(At(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const j7="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",q7=e2(j7);function SO(e){return!!e||e===""}/**
* @vue/reactivity v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vn;class W7{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Vn,!t&&Vn&&(this.index=(Vn.scopes||(Vn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Vn;try{return Vn=this,t()}finally{Vn=n}}}on(){++this._on===1&&(this.prevScope=Vn,Vn=this)}off(){this._on>0&&--this._on===0&&(Vn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function H7(){return Vn}let lt;const Sy=new WeakSet;class $O{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Vn&&Vn.active&&Vn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Sy.has(this)&&(Sy.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||CO(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,KA(this),kO(this);const t=lt,n=ur;lt=this,ur=!0;try{return this.fn()}finally{MO(this),lt=t,ur=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)u2(t);this.deps=this.depsTail=void 0,KA(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Sy.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){$b(this)&&this.run()}get dirty(){return $b(this)}}let AO=0,Jf,Zf;function CO(e,t=!1){if(e.flags|=8,t){e.next=Zf,Zf=e;return}e.next=Jf,Jf=e}function o2(){AO++}function a2(){if(--AO>0)return;if(Zf){let t=Zf;for(Zf=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Jf;){let t=Jf;for(Jf=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(i){e||(e=i)}t=n}}if(e)throw e}function kO(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function MO(e){let t,n=e.depsTail,i=n;for(;i;){const r=i.prevDep;i.version===-1?(i===n&&(n=r),u2(i),G7(i)):t=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=r}e.deps=t,e.depsTail=n}function $b(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(FO(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function FO(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===wd)||(e.globalVersion=wd,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!$b(e))))return;e.flags|=2;const t=e.dep,n=lt,i=ur;lt=e,ur=!0;try{kO(e);const r=e.fn(e._value);(t.version===0||Bo(r,e._value))&&(e.flags|=128,e._value=r,t.version++)}catch(r){throw t.version++,r}finally{lt=n,ur=i,MO(e),e.flags&=-3}}function u2(e,t=!1){const{dep:n,prevSub:i,nextSub:r}=e;if(i&&(i.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=i,e.nextSub=void 0),n.subs===e&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let s=n.computed.deps;s;s=s.nextDep)u2(s,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function G7(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ur=!0;const TO=[];function Qs(){TO.push(ur),ur=!1}function Js(){const e=TO.pop();ur=e===void 0?!0:e}function KA(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=lt;lt=void 0;try{t()}finally{lt=n}}}let wd=0;class V7{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class l2{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!lt||!ur||lt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==lt)n=this.activeLink=new V7(lt,this),lt.deps?(n.prevDep=lt.depsTail,lt.depsTail.nextDep=n,lt.depsTail=n):lt.deps=lt.depsTail=n,RO(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=lt.depsTail,n.nextDep=void 0,lt.depsTail.nextDep=n,lt.depsTail=n,lt.deps===n&&(lt.deps=i)}return n}trigger(t){this.version++,wd++,this.notify(t)}notify(t){o2();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{a2()}}}function RO(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let i=t.deps;i;i=i.nextDep)RO(i)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Ab=new WeakMap,Xa=Symbol(""),Cb=Symbol(""),_d=Symbol("");function fn(e,t,n){if(ur&&lt){let i=Ab.get(e);i||Ab.set(e,i=new Map);let r=i.get(n);r||(i.set(n,r=new l2),r.map=i,r.key=n),r.track()}}function Os(e,t,n,i,r,s){const o=Ab.get(e);if(!o){wd++;return}const a=u=>{u&&u.trigger()};if(o2(),t==="clear")o.forEach(a);else{const u=Oe(e),l=u&&i2(n);if(u&&n==="length"){const c=Number(i);o.forEach((f,d)=>{(d==="length"||d===_d||!vc(d)&&d>=c)&&a(f)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),l&&a(o.get(_d)),t){case"add":u?l&&a(o.get("length")):(a(o.get(Xa)),Kf(e)&&a(o.get(Cb)));break;case"delete":u||(a(o.get(Xa)),Kf(e)&&a(o.get(Cb)));break;case"set":Kf(e)&&a(o.get(Xa));break}}a2()}function Yu(e){const t=Xe(e);return t===e?t:(fn(t,"iterate",_d),lr(e)?t:t.map(Mn))}function c2(e){return fn(e=Xe(e),"iterate",_d),e}const Y7={__proto__:null,[Symbol.iterator](){return $y(this,Symbol.iterator,Mn)},concat(...e){return Yu(this).concat(...e.map(t=>Oe(t)?Yu(t):t))},entries(){return $y(this,"entries",e=>(e[1]=Mn(e[1]),e))},every(e,t){return _s(this,"every",e,t,void 0,arguments)},filter(e,t){return _s(this,"filter",e,t,n=>n.map(Mn),arguments)},find(e,t){return _s(this,"find",e,t,Mn,arguments)},findIndex(e,t){return _s(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return _s(this,"findLast",e,t,Mn,arguments)},findLastIndex(e,t){return _s(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return _s(this,"forEach",e,t,void 0,arguments)},includes(...e){return Ay(this,"includes",e)},indexOf(...e){return Ay(this,"indexOf",e)},join(e){return Yu(this).join(e)},lastIndexOf(...e){return Ay(this,"lastIndexOf",e)},map(e,t){return _s(this,"map",e,t,void 0,arguments)},pop(){return Xc(this,"pop")},push(...e){return Xc(this,"push",e)},reduce(e,...t){return QA(this,"reduce",e,t)},reduceRight(e,...t){return QA(this,"reduceRight",e,t)},shift(){return Xc(this,"shift")},some(e,t){return _s(this,"some",e,t,void 0,arguments)},splice(...e){return Xc(this,"splice",e)},toReversed(){return Yu(this).toReversed()},toSorted(e){return Yu(this).toSorted(e)},toSpliced(...e){return Yu(this).toSpliced(...e)},unshift(...e){return Xc(this,"unshift",e)},values(){return $y(this,"values",Mn)}};function $y(e,t,n){const i=c2(e),r=i[t]();return i!==e&&!lr(e)&&(r._next=r.next,r.next=()=>{const s=r._next();return s.value&&(s.value=n(s.value)),s}),r}const X7=Array.prototype;function _s(e,t,n,i,r,s){const o=c2(e),a=o!==e&&!lr(e),u=o[t];if(u!==X7[t]){const f=u.apply(e,s);return a?Mn(f):f}let l=n;o!==e&&(a?l=function(f,d){return n.call(this,Mn(f),d,e)}:n.length>2&&(l=function(f,d){return n.call(this,f,d,e)}));const c=u.call(o,l,i);return a&&r?r(c):c}function QA(e,t,n,i){const r=c2(e);let s=n;return r!==e&&(lr(e)?n.length>3&&(s=function(o,a,u){return n.call(this,o,a,u,e)}):s=function(o,a,u){return n.call(this,o,Mn(a),u,e)}),r[t](s,...i)}function Ay(e,t,n){const i=Xe(e);fn(i,"iterate",_d);const r=i[t](...n);return(r===-1||r===!1)&&h2(n[0])?(n[0]=Xe(n[0]),i[t](...n)):r}function Xc(e,t,n=[]){Qs(),o2();const i=Xe(e)[t].apply(e,n);return a2(),Js(),i}const K7=e2("__proto__,__v_isRef,__isVue"),OO=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vc));function Q7(e){vc(e)||(e=String(e));const t=Xe(this);return fn(t,"has",e),t.hasOwnProperty(e)}class DO{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,i){if(n==="__v_skip")return t.__v_skip;const r=this._isReadonly,s=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return s;if(n==="__v_raw")return i===(r?s?aB:LO:s?IO:PO).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const o=Oe(t);if(!r){let u;if(o&&(u=Y7[n]))return u;if(n==="hasOwnProperty")return Q7}const a=Reflect.get(t,n,mn(t)?t:i);return(vc(n)?OO.has(n):K7(n))||(r||fn(t,"get",n),s)?a:mn(a)?o&&i2(n)?a:a.value:At(a)?r?BO(a):c0(a):a}}class NO extends DO{constructor(t=!1){super(!1,t)}set(t,n,i,r){let s=t[n];if(!this._isShallow){const u=ou(s);if(!lr(i)&&!ou(i)&&(s=Xe(s),i=Xe(i)),!Oe(t)&&mn(s)&&!mn(i))return u||(s.value=i),!0}const o=Oe(t)&&i2(n)?Number(n)<t.length:Ke(t,n),a=Reflect.set(t,n,i,mn(t)?t:r);return t===Xe(r)&&(o?Bo(i,s)&&Os(t,"set",n,i):Os(t,"add",n,i)),a}deleteProperty(t,n){const i=Ke(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&i&&Os(t,"delete",n,void 0),r}has(t,n){const i=Reflect.has(t,n);return(!vc(n)||!OO.has(n))&&fn(t,"has",n),i}ownKeys(t){return fn(t,"iterate",Oe(t)?"length":Xa),Reflect.ownKeys(t)}}class J7 extends DO{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const Z7=new NO,eB=new J7,tB=new NO(!0);const kb=e=>e,Zh=e=>Reflect.getPrototypeOf(e);function nB(e,t,n){return function(...i){const r=this.__v_raw,s=Xe(r),o=Kf(s),a=e==="entries"||e===Symbol.iterator&&o,u=e==="keys"&&o,l=r[e](...i),c=n?kb:t?Mb:Mn;return!t&&fn(s,"iterate",u?Cb:Xa),{next(){const{value:f,done:d}=l.next();return d?{value:f,done:d}:{value:a?[c(f[0]),c(f[1])]:c(f),done:d}},[Symbol.iterator](){return this}}}}function ep(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function iB(e,t){const n={get(r){const s=this.__v_raw,o=Xe(s),a=Xe(r);e||(Bo(r,a)&&fn(o,"get",r),fn(o,"get",a));const{has:u}=Zh(o),l=t?kb:e?Mb:Mn;if(u.call(o,r))return l(s.get(r));if(u.call(o,a))return l(s.get(a));s!==o&&s.get(r)},get size(){const r=this.__v_raw;return!e&&fn(Xe(r),"iterate",Xa),r.size},has(r){const s=this.__v_raw,o=Xe(s),a=Xe(r);return e||(Bo(r,a)&&fn(o,"has",r),fn(o,"has",a)),r===a?s.has(r):s.has(r)||s.has(a)},forEach(r,s){const o=this,a=o.__v_raw,u=Xe(a),l=t?kb:e?Mb:Mn;return!e&&fn(u,"iterate",Xa),a.forEach((c,f)=>r.call(s,l(c),l(f),o))}};return wn(n,e?{add:ep("add"),set:ep("set"),delete:ep("delete"),clear:ep("clear")}:{add(r){!t&&!lr(r)&&!ou(r)&&(r=Xe(r));const s=Xe(this);return Zh(s).has.call(s,r)||(s.add(r),Os(s,"add",r,r)),this},set(r,s){!t&&!lr(s)&&!ou(s)&&(s=Xe(s));const o=Xe(this),{has:a,get:u}=Zh(o);let l=a.call(o,r);l||(r=Xe(r),l=a.call(o,r));const c=u.call(o,r);return o.set(r,s),l?Bo(s,c)&&Os(o,"set",r,s):Os(o,"add",r,s),this},delete(r){const s=Xe(this),{has:o,get:a}=Zh(s);let u=o.call(s,r);u||(r=Xe(r),u=o.call(s,r)),a&&a.call(s,r);const l=s.delete(r);return u&&Os(s,"delete",r,void 0),l},clear(){const r=Xe(this),s=r.size!==0,o=r.clear();return s&&Os(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=nB(r,e,t)}),n}function f2(e,t){const n=iB(e,t);return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Ke(n,r)&&r in i?n:i,r,s)}const rB={get:f2(!1,!1)},sB={get:f2(!1,!0)},oB={get:f2(!0,!1)};const PO=new WeakMap,IO=new WeakMap,LO=new WeakMap,aB=new WeakMap;function uB(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function lB(e){return e.__v_skip||!Object.isExtensible(e)?0:uB(O7(e))}function c0(e){return ou(e)?e:d2(e,!1,Z7,rB,PO)}function zO(e){return d2(e,!1,tB,sB,IO)}function BO(e){return d2(e,!0,eB,oB,LO)}function d2(e,t,n,i,r){if(!At(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=lB(e);if(s===0)return e;const o=r.get(e);if(o)return o;const a=new Proxy(e,s===2?i:n);return r.set(e,a),a}function ed(e){return ou(e)?ed(e.__v_raw):!!(e&&e.__v_isReactive)}function ou(e){return!!(e&&e.__v_isReadonly)}function lr(e){return!!(e&&e.__v_isShallow)}function h2(e){return e?!!e.__v_raw:!1}function Xe(e){const t=e&&e.__v_raw;return t?Xe(t):e}function cB(e){return!Ke(e,"__v_skip")&&Object.isExtensible(e)&&EO(e,"__v_skip",!0),e}const Mn=e=>At(e)?c0(e):e,Mb=e=>At(e)?BO(e):e;function mn(e){return e?e.__v_isRef===!0:!1}function fB(e){return UO(e,!1)}function dB(e){return UO(e,!0)}function UO(e,t){return mn(e)?e:new hB(e,t)}class hB{constructor(t,n){this.dep=new l2,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:Xe(t),this._value=n?t:Mn(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,i=this.__v_isShallow||lr(t)||ou(t);t=i?t:Xe(t),Bo(t,n)&&(this._rawValue=t,this._value=i?t:Mn(t),this.dep.trigger())}}function xl(e){return mn(e)?e.value:e}const pB={get:(e,t,n)=>t==="__v_raw"?e:xl(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return mn(r)&&!mn(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function jO(e){return ed(e)?e:new Proxy(e,pB)}class gB{constructor(t,n,i){this.fn=t,this.setter=n,this._value=void 0,this.dep=new l2(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=wd-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&lt!==this)return CO(this,!0),!0}get value(){const t=this.dep.track();return FO(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function mB(e,t,n=!1){let i,r;return Re(e)?i=e:(i=e.get,r=e.set),new gB(i,r,n)}const tp={},vg=new WeakMap;let Pa;function yB(e,t=!1,n=Pa){if(n){let i=vg.get(n);i||vg.set(n,i=[]),i.push(e)}}function vB(e,t,n=ct){const{immediate:i,deep:r,once:s,scheduler:o,augmentJob:a,call:u}=n,l=x=>r?x:lr(x)||r===!1||r===0?Mo(x,1):Mo(x);let c,f,d,h,p=!1,g=!1;if(mn(e)?(f=()=>e.value,p=lr(e)):ed(e)?(f=()=>l(e),p=!0):Oe(e)?(g=!0,p=e.some(x=>ed(x)||lr(x)),f=()=>e.map(x=>{if(mn(x))return x.value;if(ed(x))return l(x);if(Re(x))return u?u(x,2):x()})):Re(e)?t?f=u?()=>u(e,2):e:f=()=>{if(d){Qs();try{d()}finally{Js()}}const x=Pa;Pa=c;try{return u?u(e,3,[h]):e(h)}finally{Pa=x}}:f=Gr,t&&r){const x=f,w=r===!0?1/0:r;f=()=>Mo(x(),w)}const m=H7(),y=()=>{c.stop(),m&&m.active&&n2(m.effects,c)};if(s&&t){const x=t;t=(...w)=>{x(...w),y()}}let v=g?new Array(e.length).fill(tp):tp;const b=x=>{if(!(!(c.flags&1)||!c.dirty&&!x))if(t){const w=c.run();if(r||p||(g?w.some((E,_)=>Bo(E,v[_])):Bo(w,v))){d&&d();const E=Pa;Pa=c;try{const _=[w,v===tp?void 0:g&&v[0]===tp?[]:v,h];v=w,u?u(t,3,_):t(..._)}finally{Pa=E}}}else c.run()};return a&&a(b),c=new $O(f),c.scheduler=o?()=>o(b,!1):b,h=x=>yB(x,!1,c),d=c.onStop=()=>{const x=vg.get(c);if(x){if(u)u(x,4);else for(const w of x)w();vg.delete(c)}},t?i?b(!0):v=c.run():o?o(b.bind(null,!0),!0):c.run(),y.pause=c.pause.bind(c),y.resume=c.resume.bind(c),y.stop=y,y}function Mo(e,t=1/0,n){if(t<=0||!At(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,mn(e))Mo(e.value,t,n);else if(Oe(e))for(let i=0;i<e.length;i++)Mo(e[i],t,n);else if(T7(e)||Kf(e))e.forEach(i=>{Mo(i,t,n)});else if(D7(e)){for(const i in e)Mo(e[i],t,n);for(const i of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,i)&&Mo(e[i],t,n)}return e}/**
* @vue/runtime-core v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function sh(e,t,n,i){try{return i?e(...i):e()}catch(r){f0(r,t,n)}}function Zr(e,t,n,i){if(Re(e)){const r=sh(e,t,n,i);return r&&_O(r)&&r.catch(s=>{f0(s,t,n)}),r}if(Oe(e)){const r=[];for(let s=0;s<e.length;s++)r.push(Zr(e[s],t,n,i));return r}}function f0(e,t,n,i=!0){const r=t?t.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||ct;if(t){let a=t.parent;const u=t.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const c=a.ec;if(c){for(let f=0;f<c.length;f++)if(c[f](e,u,l)===!1)return}a=a.parent}if(s){Qs(),sh(s,null,10,[e,u,l]),Js();return}}bB(e,n,r,i,o)}function bB(e,t,n,i=!0,r=!1){if(r)throw e;console.error(e)}const Fn=[];let Nr=-1;const wl=[];let wo=null,al=0;const qO=Promise.resolve();let bg=null;function WO(e){const t=bg||qO;return e?t.then(this?e.bind(this):e):t}function xB(e){let t=Nr+1,n=Fn.length;for(;t<n;){const i=t+n>>>1,r=Fn[i],s=Ed(r);s<e||s===e&&r.flags&2?t=i+1:n=i}return t}function p2(e){if(!(e.flags&1)){const t=Ed(e),n=Fn[Fn.length-1];!n||!(e.flags&2)&&t>=Ed(n)?Fn.push(e):Fn.splice(xB(t),0,e),e.flags|=1,HO()}}function HO(){bg||(bg=qO.then(VO))}function wB(e){Oe(e)?wl.push(...e):wo&&e.id===-1?wo.splice(al+1,0,e):e.flags&1||(wl.push(e),e.flags|=1),HO()}function JA(e,t,n=Nr+1){for(;n<Fn.length;n++){const i=Fn[n];if(i&&i.flags&2){if(e&&i.id!==e.uid)continue;Fn.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function GO(e){if(wl.length){const t=[...new Set(wl)].sort((n,i)=>Ed(n)-Ed(i));if(wl.length=0,wo){wo.push(...t);return}for(wo=t,al=0;al<wo.length;al++){const n=wo[al];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}wo=null,al=0}}const Ed=e=>e.id==null?e.flags&2?-1:1/0:e.id;function VO(e){try{for(Nr=0;Nr<Fn.length;Nr++){const t=Fn[Nr];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),sh(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Nr<Fn.length;Nr++){const t=Fn[Nr];t&&(t.flags&=-2)}Nr=-1,Fn.length=0,GO(),bg=null,(Fn.length||wl.length)&&VO()}}let ir=null,YO=null;function xg(e){const t=ir;return ir=e,YO=e&&e.type.__scopeId||null,t}function Sf(e,t=ir,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&Eg(-1);const s=xg(t);let o;try{o=e(...r)}finally{xg(s),i._d&&Eg(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Ea(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let u=a.dir[i];u&&(Qs(),Zr(u,n,8,[e.el,a,e,t]),Js())}}const _B=Symbol("_vte"),EB=e=>e.__isTeleport,SB=Symbol("_leaveCb");function g2(e,t){e.shapeFlag&6&&e.component?(e.transition=t,g2(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function XO(e,t){return Re(e)?wn({name:e.name},t,{setup:e}):e}function KO(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const wg=new WeakMap;function td(e,t,n,i,r=!1){if(Oe(e)){e.forEach((p,g)=>td(p,t&&(Oe(t)?t[g]:t),n,i,r));return}if(nd(i)&&!r){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&td(e,t,n,i.component.subTree);return}const s=i.shapeFlag&4?b2(i.component):i.el,o=r?null:s,{i:a,r:u}=e,l=t&&t.r,c=a.refs===ct?a.refs={}:a.refs,f=a.setupState,d=Xe(f),h=f===ct?wO:p=>Ke(d,p);if(l!=null&&l!==u){if(ZA(t),Gt(l))c[l]=null,h(l)&&(f[l]=null);else if(mn(l)){l.value=null;const p=t;p.k&&(c[p.k]=null)}}if(Re(u))sh(u,a,12,[o,c]);else{const p=Gt(u),g=mn(u);if(p||g){const m=()=>{if(e.f){const y=p?h(u)?f[u]:c[u]:u.value;if(r)Oe(y)&&n2(y,s);else if(Oe(y))y.includes(s)||y.push(s);else if(p)c[u]=[s],h(u)&&(f[u]=c[u]);else{const v=[s];u.value=v,e.k&&(c[e.k]=v)}}else p?(c[u]=o,h(u)&&(f[u]=o)):g&&(u.value=o,e.k&&(c[e.k]=o))};if(o){const y=()=>{m(),wg.delete(e)};y.id=-1,wg.set(e,y),li(y,n)}else ZA(e),m()}}}function ZA(e){const t=wg.get(e);t&&(t.flags|=8,wg.delete(e))}l0().requestIdleCallback;l0().cancelIdleCallback;const nd=e=>!!e.type.__asyncLoader,QO=e=>e.type.__isKeepAlive;function $B(e,t){JO(e,"a",t)}function AB(e,t){JO(e,"da",t)}function JO(e,t,n=dn){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(d0(t,i,n),n){let r=n.parent;for(;r&&r.parent;)QO(r.parent.vnode)&&CB(i,t,n,r),r=r.parent}}function CB(e,t,n,i){const r=d0(t,e,i,!0);eD(()=>{n2(i[t],r)},n)}function d0(e,t,n=dn,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{Qs();const a=oh(n),u=Zr(t,n,e,o);return a(),Js(),u});return i?r.unshift(s):r.push(s),s}}const so=e=>(t,n=dn)=>{(!$d||e==="sp")&&d0(e,(...i)=>t(...i),n)},kB=so("bm"),ZO=so("m"),MB=so("bu"),FB=so("u"),TB=so("bum"),eD=so("um"),RB=so("sp"),OB=so("rtg"),DB=so("rtc");function NB(e,t=dn){d0("ec",e,t)}const PB="components";function tD(e,t){return LB(PB,e,!0,t)||e}const IB=Symbol.for("v-ndc");function LB(e,t,n=!0,i=!1){const r=ir||dn;if(r){const s=r.type;{const a=CU(s,!1);if(a&&(a===t||a===Pi(t)||a===u0(Pi(t))))return s}const o=eC(r[e]||s[e],t)||eC(r.appContext[e],t);return!o&&i?s:o}}function eC(e,t){return e&&(e[t]||e[Pi(t)]||e[u0(Pi(t))])}const Fb=e=>e?xD(e)?b2(e):Fb(e.parent):null,id=wn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Fb(e.parent),$root:e=>Fb(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>iD(e),$forceUpdate:e=>e.f||(e.f=()=>{p2(e.update)}),$nextTick:e=>e.n||(e.n=WO.bind(e.proxy)),$watch:e=>sU.bind(e)}),Cy=(e,t)=>e!==ct&&!e.__isScriptSetup&&Ke(e,t),zB={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:u}=e;let l;if(t[0]!=="$"){const h=o[t];if(h!==void 0)switch(h){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(Cy(i,t))return o[t]=1,i[t];if(r!==ct&&Ke(r,t))return o[t]=2,r[t];if((l=e.propsOptions[0])&&Ke(l,t))return o[t]=3,s[t];if(n!==ct&&Ke(n,t))return o[t]=4,n[t];Tb&&(o[t]=0)}}const c=id[t];let f,d;if(c)return t==="$attrs"&&fn(e.attrs,"get",""),c(e);if((f=a.__cssModules)&&(f=f[t]))return f;if(n!==ct&&Ke(n,t))return o[t]=4,n[t];if(d=u.config.globalProperties,Ke(d,t))return d[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return Cy(r,t)?(r[t]=n,!0):i!==ct&&Ke(i,t)?(i[t]=n,!0):Ke(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s,type:o}},a){let u,l;return!!(n[a]||e!==ct&&a[0]!=="$"&&Ke(e,a)||Cy(t,a)||(u=s[0])&&Ke(u,a)||Ke(i,a)||Ke(id,a)||Ke(r.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Ke(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function tC(e){return Oe(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Tb=!0;function BB(e){const t=iD(e),n=e.proxy,i=e.ctx;Tb=!1,t.beforeCreate&&nC(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:o,watch:a,provide:u,inject:l,created:c,beforeMount:f,mounted:d,beforeUpdate:h,updated:p,activated:g,deactivated:m,beforeDestroy:y,beforeUnmount:v,destroyed:b,unmounted:x,render:w,renderTracked:E,renderTriggered:_,errorCaptured:$,serverPrefetch:A,expose:F,inheritAttrs:M,components:P,directives:D,filters:O}=t;if(l&&UB(l,i,null),o)for(const N in o){const I=o[N];Re(I)&&(i[N]=I.bind(n))}if(r){const N=r.call(n,n);At(N)&&(e.data=c0(N))}if(Tb=!0,s)for(const N in s){const I=s[N],U=Re(I)?I.bind(n,n):Re(I.get)?I.get.bind(n,n):Gr,re=!Re(I)&&Re(I.set)?I.set.bind(n):Gr,me=er({get:U,set:re});Object.defineProperty(i,N,{enumerable:!0,configurable:!0,get:()=>me.value,set:de=>me.value=de})}if(a)for(const N in a)nD(a[N],i,n,N);if(u){const N=Re(u)?u.call(n):u;Reflect.ownKeys(N).forEach(I=>{jp(I,N[I])})}c&&nC(c,e,"c");function R(N,I){Oe(I)?I.forEach(U=>N(U.bind(n))):I&&N(I.bind(n))}if(R(kB,f),R(ZO,d),R(MB,h),R(FB,p),R($B,g),R(AB,m),R(NB,$),R(DB,E),R(OB,_),R(TB,v),R(eD,x),R(RB,A),Oe(F))if(F.length){const N=e.exposed||(e.exposed={});F.forEach(I=>{Object.defineProperty(N,I,{get:()=>n[I],set:U=>n[I]=U,enumerable:!0})})}else e.exposed||(e.exposed={});w&&e.render===Gr&&(e.render=w),M!=null&&(e.inheritAttrs=M),P&&(e.components=P),D&&(e.directives=D),A&&KO(e)}function UB(e,t,n=Gr){Oe(e)&&(e=Rb(e));for(const i in e){const r=e[i];let s;At(r)?"default"in r?s=js(r.from||i,r.default,!0):s=js(r.from||i):s=js(r),mn(s)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):t[i]=s}}function nC(e,t,n){Zr(Oe(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function nD(e,t,n,i){let r=i.includes(".")?mD(n,i):()=>n[i];if(Gt(e)){const s=t[e];Re(s)&&qp(r,s)}else if(Re(e))qp(r,e.bind(n));else if(At(e))if(Oe(e))e.forEach(s=>nD(s,t,n,i));else{const s=Re(e.handler)?e.handler.bind(n):t[e.handler];Re(s)&&qp(r,s,e)}}function iD(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=e.appContext,a=s.get(t);let u;return a?u=a:!r.length&&!n&&!i?u=t:(u={},r.length&&r.forEach(l=>_g(u,l,o,!0)),_g(u,t,o)),At(t)&&s.set(t,u),u}function _g(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&_g(e,s,n,!0),r&&r.forEach(o=>_g(e,o,n,!0));for(const o in t)if(!(i&&o==="expose")){const a=jB[o]||n&&n[o];e[o]=a?a(e[o],t[o]):t[o]}return e}const jB={data:iC,props:rC,emits:rC,methods:$f,computed:$f,beforeCreate:An,created:An,beforeMount:An,mounted:An,beforeUpdate:An,updated:An,beforeDestroy:An,beforeUnmount:An,destroyed:An,unmounted:An,activated:An,deactivated:An,errorCaptured:An,serverPrefetch:An,components:$f,directives:$f,watch:WB,provide:iC,inject:qB};function iC(e,t){return t?e?function(){return wn(Re(e)?e.call(this,this):e,Re(t)?t.call(this,this):t)}:t:e}function qB(e,t){return $f(Rb(e),Rb(t))}function Rb(e){if(Oe(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function An(e,t){return e?[...new Set([].concat(e,t))]:t}function $f(e,t){return e?wn(Object.create(null),e,t):t}function rC(e,t){return e?Oe(e)&&Oe(t)?[...new Set([...e,...t])]:wn(Object.create(null),tC(e),tC(t??{})):t}function WB(e,t){if(!e)return t;if(!t)return e;const n=wn(Object.create(null),e);for(const i in t)n[i]=An(e[i],t[i]);return n}function rD(){return{app:null,config:{isNativeTag:wO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let HB=0;function GB(e,t){return function(i,r=null){Re(i)||(i=wn({},i)),r!=null&&!At(r)&&(r=null);const s=rD(),o=new WeakSet,a=[];let u=!1;const l=s.app={_uid:HB++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:MU,get config(){return s.config},set config(c){},use(c,...f){return o.has(c)||(c&&Re(c.install)?(o.add(c),c.install(l,...f)):Re(c)&&(o.add(c),c(l,...f))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,f){return f?(s.components[c]=f,l):s.components[c]},directive(c,f){return f?(s.directives[c]=f,l):s.directives[c]},mount(c,f,d){if(!u){const h=l._ceVNode||Qn(i,r);return h.appContext=s,d===!0?d="svg":d===!1&&(d=void 0),e(h,c,d),u=!0,l._container=c,c.__vue_app__=l,b2(h.component)}},onUnmount(c){a.push(c)},unmount(){u&&(Zr(a,l._instance,16),e(null,l._container),delete l._container.__vue_app__)},provide(c,f){return s.provides[c]=f,l},runWithContext(c){const f=_l;_l=l;try{return c()}finally{_l=f}}};return l}}let _l=null;function jp(e,t){if(dn){let n=dn.provides;const i=dn.parent&&dn.parent.provides;i===n&&(n=dn.provides=Object.create(i)),n[e]=t}}function js(e,t,n=!1){const i=_U();if(i||_l){let r=_l?_l._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&Re(t)?t.call(i&&i.proxy):t}}const sD={},oD=()=>Object.create(sD),aD=e=>Object.getPrototypeOf(e)===sD;function VB(e,t,n,i=!1){const r={},s=oD();e.propsDefaults=Object.create(null),uD(e,t,r,s);for(const o in e.propsOptions[0])o in r||(r[o]=void 0);n?e.props=i?r:zO(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function YB(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=e,a=Xe(r),[u]=e.propsOptions;let l=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=e.vnode.dynamicProps;for(let f=0;f<c.length;f++){let d=c[f];if(h0(e.emitsOptions,d))continue;const h=t[d];if(u)if(Ke(s,d))h!==s[d]&&(s[d]=h,l=!0);else{const p=Pi(d);r[p]=Ob(u,a,p,h,e,!1)}else h!==s[d]&&(s[d]=h,l=!0)}}}else{uD(e,t,r,s)&&(l=!0);let c;for(const f in a)(!t||!Ke(t,f)&&((c=Mu(f))===f||!Ke(t,c)))&&(u?n&&(n[f]!==void 0||n[c]!==void 0)&&(r[f]=Ob(u,a,f,void 0,e,!0)):delete r[f]);if(s!==a)for(const f in s)(!t||!Ke(t,f))&&(delete s[f],l=!0)}l&&Os(e.attrs,"set","")}function uD(e,t,n,i){const[r,s]=e.propsOptions;let o=!1,a;if(t)for(let u in t){if(Qf(u))continue;const l=t[u];let c;r&&Ke(r,c=Pi(u))?!s||!s.includes(c)?n[c]=l:(a||(a={}))[c]=l:h0(e.emitsOptions,u)||(!(u in i)||l!==i[u])&&(i[u]=l,o=!0)}if(s){const u=Xe(n),l=a||ct;for(let c=0;c<s.length;c++){const f=s[c];n[f]=Ob(r,u,f,l[f],e,!Ke(l,f))}}return o}function Ob(e,t,n,i,r,s){const o=e[n];if(o!=null){const a=Ke(o,"default");if(a&&i===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&Re(u)){const{propsDefaults:l}=r;if(n in l)i=l[n];else{const c=oh(r);i=l[n]=u.call(null,t),c()}}else i=u;r.ce&&r.ce._setProp(n,i)}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===Mu(n))&&(i=!0))}return i}const XB=new WeakMap;function lD(e,t,n=!1){const i=n?XB:t.propsCache,r=i.get(e);if(r)return r;const s=e.props,o={},a=[];let u=!1;if(!Re(e)){const c=f=>{u=!0;const[d,h]=lD(f,t,!0);wn(o,d),h&&a.push(...h)};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!s&&!u)return At(e)&&i.set(e,bl),bl;if(Oe(s))for(let c=0;c<s.length;c++){const f=Pi(s[c]);sC(f)&&(o[f]=ct)}else if(s)for(const c in s){const f=Pi(c);if(sC(f)){const d=s[c],h=o[f]=Oe(d)||Re(d)?{type:d}:wn({},d),p=h.type;let g=!1,m=!0;if(Oe(p))for(let y=0;y<p.length;++y){const v=p[y],b=Re(v)&&v.name;if(b==="Boolean"){g=!0;break}else b==="String"&&(m=!1)}else g=Re(p)&&p.name==="Boolean";h[0]=g,h[1]=m,(g||Ke(h,"default"))&&a.push(f)}}const l=[o,a];return At(e)&&i.set(e,l),l}function sC(e){return e[0]!=="$"&&!Qf(e)}const m2=e=>e==="_"||e==="_ctx"||e==="$stable",y2=e=>Oe(e)?e.map(zr):[zr(e)],KB=(e,t,n)=>{if(t._n)return t;const i=Sf((...r)=>y2(t(...r)),n);return i._c=!1,i},cD=(e,t,n)=>{const i=e._ctx;for(const r in e){if(m2(r))continue;const s=e[r];if(Re(s))t[r]=KB(r,s,i);else if(s!=null){const o=y2(s);t[r]=()=>o}}},fD=(e,t)=>{const n=y2(t);e.slots.default=()=>n},dD=(e,t,n)=>{for(const i in t)(n||!m2(i))&&(e[i]=t[i])},QB=(e,t,n)=>{const i=e.slots=oD();if(e.vnode.shapeFlag&32){const r=t._;r?(dD(i,t,n),n&&EO(i,"_",r,!0)):cD(t,i)}else t&&fD(e,t)},JB=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,o=ct;if(i.shapeFlag&32){const a=t._;a?n&&a===1?s=!1:dD(r,t,n):(s=!t.$stable,cD(t,r)),o=t}else t&&(fD(e,t),o={default:1});if(s)for(const a in r)!m2(a)&&o[a]==null&&delete r[a]},li=hU;function ZB(e){return eU(e)}function eU(e,t){const n=l0();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:u,setText:l,setElementText:c,parentNode:f,nextSibling:d,setScopeId:h=Gr,insertStaticContent:p}=e,g=(S,k,T,B=null,H=null,W=null,ue=void 0,se=null,ie=!!k.dynamicChildren)=>{if(S===k)return;S&&!Kc(S,k)&&(B=V(S),de(S,H,W,!0),S=null),k.patchFlag===-2&&(ie=!1,k.dynamicChildren=null);const{type:Z,ref:Se,shapeFlag:he}=k;switch(Z){case p0:m(S,k,T,B);break;case Ol:y(S,k,T,B);break;case My:S==null&&v(k,T,B,ue);break;case Fs:P(S,k,T,B,H,W,ue,se,ie);break;default:he&1?w(S,k,T,B,H,W,ue,se,ie):he&6?D(S,k,T,B,H,W,ue,se,ie):(he&64||he&128)&&Z.process(S,k,T,B,H,W,ue,se,ie,X)}Se!=null&&H?td(Se,S&&S.ref,W,k||S,!k):Se==null&&S&&S.ref!=null&&td(S.ref,null,W,S,!0)},m=(S,k,T,B)=>{if(S==null)i(k.el=a(k.children),T,B);else{const H=k.el=S.el;k.children!==S.children&&l(H,k.children)}},y=(S,k,T,B)=>{S==null?i(k.el=u(k.children||""),T,B):k.el=S.el},v=(S,k,T,B)=>{[S.el,S.anchor]=p(S.children,k,T,B,S.el,S.anchor)},b=({el:S,anchor:k},T,B)=>{let H;for(;S&&S!==k;)H=d(S),i(S,T,B),S=H;i(k,T,B)},x=({el:S,anchor:k})=>{let T;for(;S&&S!==k;)T=d(S),r(S),S=T;r(k)},w=(S,k,T,B,H,W,ue,se,ie)=>{k.type==="svg"?ue="svg":k.type==="math"&&(ue="mathml"),S==null?E(k,T,B,H,W,ue,se,ie):A(S,k,H,W,ue,se,ie)},E=(S,k,T,B,H,W,ue,se)=>{let ie,Z;const{props:Se,shapeFlag:he,transition:Ee,dirs:ke}=S;if(ie=S.el=o(S.type,W,Se&&Se.is,Se),he&8?c(ie,S.children):he&16&&$(S.children,ie,null,B,H,ky(S,W),ue,se),ke&&Ea(S,null,B,"created"),_(ie,S,S.scopeId,ue,B),Se){for(const ut in Se)ut!=="value"&&!Qf(ut)&&s(ie,ut,null,Se[ut],W,B);"value"in Se&&s(ie,"value",null,Se.value,W),(Z=Se.onVnodeBeforeMount)&&Tr(Z,B,S)}ke&&Ea(S,null,B,"beforeMount");const Ue=tU(H,Ee);Ue&&Ee.beforeEnter(ie),i(ie,k,T),((Z=Se&&Se.onVnodeMounted)||Ue||ke)&&li(()=>{Z&&Tr(Z,B,S),Ue&&Ee.enter(ie),ke&&Ea(S,null,B,"mounted")},H)},_=(S,k,T,B,H)=>{if(T&&h(S,T),B)for(let W=0;W<B.length;W++)h(S,B[W]);if(H){let W=H.subTree;if(k===W||vD(W.type)&&(W.ssContent===k||W.ssFallback===k)){const ue=H.vnode;_(S,ue,ue.scopeId,ue.slotScopeIds,H.parent)}}},$=(S,k,T,B,H,W,ue,se,ie=0)=>{for(let Z=ie;Z<S.length;Z++){const Se=S[Z]=se?_o(S[Z]):zr(S[Z]);g(null,Se,k,T,B,H,W,ue,se)}},A=(S,k,T,B,H,W,ue)=>{const se=k.el=S.el;let{patchFlag:ie,dynamicChildren:Z,dirs:Se}=k;ie|=S.patchFlag&16;const he=S.props||ct,Ee=k.props||ct;let ke;if(T&&Sa(T,!1),(ke=Ee.onVnodeBeforeUpdate)&&Tr(ke,T,k,S),Se&&Ea(k,S,T,"beforeUpdate"),T&&Sa(T,!0),(he.innerHTML&&Ee.innerHTML==null||he.textContent&&Ee.textContent==null)&&c(se,""),Z?F(S.dynamicChildren,Z,se,T,B,ky(k,H),W):ue||I(S,k,se,null,T,B,ky(k,H),W,!1),ie>0){if(ie&16)M(se,he,Ee,T,H);else if(ie&2&&he.class!==Ee.class&&s(se,"class",null,Ee.class,H),ie&4&&s(se,"style",he.style,Ee.style,H),ie&8){const Ue=k.dynamicProps;for(let ut=0;ut<Ue.length;ut++){const tt=Ue[ut],Wn=he[tt],Hn=Ee[tt];(Hn!==Wn||tt==="value")&&s(se,tt,Wn,Hn,H,T)}}ie&1&&S.children!==k.children&&c(se,k.children)}else!ue&&Z==null&&M(se,he,Ee,T,H);((ke=Ee.onVnodeUpdated)||Se)&&li(()=>{ke&&Tr(ke,T,k,S),Se&&Ea(k,S,T,"updated")},B)},F=(S,k,T,B,H,W,ue)=>{for(let se=0;se<k.length;se++){const ie=S[se],Z=k[se],Se=ie.el&&(ie.type===Fs||!Kc(ie,Z)||ie.shapeFlag&198)?f(ie.el):T;g(ie,Z,Se,null,B,H,W,ue,!0)}},M=(S,k,T,B,H)=>{if(k!==T){if(k!==ct)for(const W in k)!Qf(W)&&!(W in T)&&s(S,W,k[W],null,H,B);for(const W in T){if(Qf(W))continue;const ue=T[W],se=k[W];ue!==se&&W!=="value"&&s(S,W,se,ue,H,B)}"value"in T&&s(S,"value",k.value,T.value,H)}},P=(S,k,T,B,H,W,ue,se,ie)=>{const Z=k.el=S?S.el:a(""),Se=k.anchor=S?S.anchor:a("");let{patchFlag:he,dynamicChildren:Ee,slotScopeIds:ke}=k;ke&&(se=se?se.concat(ke):ke),S==null?(i(Z,T,B),i(Se,T,B),$(k.children||[],T,Se,H,W,ue,se,ie)):he>0&&he&64&&Ee&&S.dynamicChildren?(F(S.dynamicChildren,Ee,T,H,W,ue,se),(k.key!=null||H&&k===H.subTree)&&hD(S,k,!0)):I(S,k,T,Se,H,W,ue,se,ie)},D=(S,k,T,B,H,W,ue,se,ie)=>{k.slotScopeIds=se,S==null?k.shapeFlag&512?H.ctx.activate(k,T,B,ue,ie):O(k,T,B,H,W,ue,ie):C(S,k,ie)},O=(S,k,T,B,H,W,ue)=>{const se=S.component=wU(S,B,H);if(QO(S)&&(se.ctx.renderer=X),EU(se,!1,ue),se.asyncDep){if(H&&H.registerDep(se,R,ue),!S.el){const ie=se.subTree=Qn(Ol);y(null,ie,k,T),S.placeholder=ie.el}}else R(se,S,k,T,H,W,ue)},C=(S,k,T)=>{const B=k.component=S.component;if(fU(S,k,T))if(B.asyncDep&&!B.asyncResolved){N(B,k,T);return}else B.next=k,B.update();else k.el=S.el,B.vnode=k},R=(S,k,T,B,H,W,ue)=>{const se=()=>{if(S.isMounted){let{next:he,bu:Ee,u:ke,parent:Ue,vnode:ut}=S;{const Mr=pD(S);if(Mr){he&&(he.el=ut.el,N(S,he,ue)),Mr.asyncDep.then(()=>{S.isUnmounted||se()});return}}let tt=he,Wn;Sa(S,!1),he?(he.el=ut.el,N(S,he,ue)):he=ut,Ee&&Ey(Ee),(Wn=he.props&&he.props.onVnodeBeforeUpdate)&&Tr(Wn,Ue,he,ut),Sa(S,!0);const Hn=aC(S),kr=S.subTree;S.subTree=Hn,g(kr,Hn,f(kr.el),V(kr),S,H,W),he.el=Hn.el,tt===null&&dU(S,Hn.el),ke&&li(ke,H),(Wn=he.props&&he.props.onVnodeUpdated)&&li(()=>Tr(Wn,Ue,he,ut),H)}else{let he;const{el:Ee,props:ke}=k,{bm:Ue,m:ut,parent:tt,root:Wn,type:Hn}=S,kr=nd(k);Sa(S,!1),Ue&&Ey(Ue),!kr&&(he=ke&&ke.onVnodeBeforeMount)&&Tr(he,tt,k),Sa(S,!0);{Wn.ce&&Wn.ce._def.shadowRoot!==!1&&Wn.ce._injectChildStyle(Hn);const Mr=S.subTree=aC(S);g(null,Mr,T,B,S,H,W),k.el=Mr.el}if(ut&&li(ut,H),!kr&&(he=ke&&ke.onVnodeMounted)){const Mr=k;li(()=>Tr(he,tt,Mr),H)}(k.shapeFlag&256||tt&&nd(tt.vnode)&&tt.vnode.shapeFlag&256)&&S.a&&li(S.a,H),S.isMounted=!0,k=T=B=null}};S.scope.on();const ie=S.effect=new $O(se);S.scope.off();const Z=S.update=ie.run.bind(ie),Se=S.job=ie.runIfDirty.bind(ie);Se.i=S,Se.id=S.uid,ie.scheduler=()=>p2(Se),Sa(S,!0),Z()},N=(S,k,T)=>{k.component=S;const B=S.vnode.props;S.vnode=k,S.next=null,YB(S,k.props,B,T),JB(S,k.children,T),Qs(),JA(S),Js()},I=(S,k,T,B,H,W,ue,se,ie=!1)=>{const Z=S&&S.children,Se=S?S.shapeFlag:0,he=k.children,{patchFlag:Ee,shapeFlag:ke}=k;if(Ee>0){if(Ee&128){re(Z,he,T,B,H,W,ue,se,ie);return}else if(Ee&256){U(Z,he,T,B,H,W,ue,se,ie);return}}ke&8?(Se&16&&et(Z,H,W),he!==Z&&c(T,he)):Se&16?ke&16?re(Z,he,T,B,H,W,ue,se,ie):et(Z,H,W,!0):(Se&8&&c(T,""),ke&16&&$(he,T,B,H,W,ue,se,ie))},U=(S,k,T,B,H,W,ue,se,ie)=>{S=S||bl,k=k||bl;const Z=S.length,Se=k.length,he=Math.min(Z,Se);let Ee;for(Ee=0;Ee<he;Ee++){const ke=k[Ee]=ie?_o(k[Ee]):zr(k[Ee]);g(S[Ee],ke,T,null,H,W,ue,se,ie)}Z>Se?et(S,H,W,!0,!1,he):$(k,T,B,H,W,ue,se,ie,he)},re=(S,k,T,B,H,W,ue,se,ie)=>{let Z=0;const Se=k.length;let he=S.length-1,Ee=Se-1;for(;Z<=he&&Z<=Ee;){const ke=S[Z],Ue=k[Z]=ie?_o(k[Z]):zr(k[Z]);if(Kc(ke,Ue))g(ke,Ue,T,null,H,W,ue,se,ie);else break;Z++}for(;Z<=he&&Z<=Ee;){const ke=S[he],Ue=k[Ee]=ie?_o(k[Ee]):zr(k[Ee]);if(Kc(ke,Ue))g(ke,Ue,T,null,H,W,ue,se,ie);else break;he--,Ee--}if(Z>he){if(Z<=Ee){const ke=Ee+1,Ue=ke<Se?k[ke].el:B;for(;Z<=Ee;)g(null,k[Z]=ie?_o(k[Z]):zr(k[Z]),T,Ue,H,W,ue,se,ie),Z++}}else if(Z>Ee)for(;Z<=he;)de(S[Z],H,W,!0),Z++;else{const ke=Z,Ue=Z,ut=new Map;for(Z=Ue;Z<=Ee;Z++){const ui=k[Z]=ie?_o(k[Z]):zr(k[Z]);ui.key!=null&&ut.set(ui.key,Z)}let tt,Wn=0;const Hn=Ee-Ue+1;let kr=!1,Mr=0;const Yc=new Array(Hn);for(Z=0;Z<Hn;Z++)Yc[Z]=0;for(Z=ke;Z<=he;Z++){const ui=S[Z];if(Wn>=Hn){de(ui,H,W,!0);continue}let Fr;if(ui.key!=null)Fr=ut.get(ui.key);else for(tt=Ue;tt<=Ee;tt++)if(Yc[tt-Ue]===0&&Kc(ui,k[tt])){Fr=tt;break}Fr===void 0?de(ui,H,W,!0):(Yc[Fr-Ue]=Z+1,Fr>=Mr?Mr=Fr:kr=!0,g(ui,k[Fr],T,null,H,W,ue,se,ie),Wn++)}const GA=kr?nU(Yc):bl;for(tt=GA.length-1,Z=Hn-1;Z>=0;Z--){const ui=Ue+Z,Fr=k[ui],VA=k[ui+1],YA=ui+1<Se?VA.el||VA.placeholder:B;Yc[Z]===0?g(null,Fr,T,YA,H,W,ue,se,ie):kr&&(tt<0||Z!==GA[tt]?me(Fr,T,YA,2):tt--)}}},me=(S,k,T,B,H=null)=>{const{el:W,type:ue,transition:se,children:ie,shapeFlag:Z}=S;if(Z&6){me(S.component.subTree,k,T,B);return}if(Z&128){S.suspense.move(k,T,B);return}if(Z&64){ue.move(S,k,T,X);return}if(ue===Fs){i(W,k,T);for(let he=0;he<ie.length;he++)me(ie[he],k,T,B);i(S.anchor,k,T);return}if(ue===My){b(S,k,T);return}if(B!==2&&Z&1&&se)if(B===0)se.beforeEnter(W),i(W,k,T),li(()=>se.enter(W),H);else{const{leave:he,delayLeave:Ee,afterLeave:ke}=se,Ue=()=>{S.ctx.isUnmounted?r(W):i(W,k,T)},ut=()=>{W._isLeaving&&W[SB](!0),he(W,()=>{Ue(),ke&&ke()})};Ee?Ee(W,Ue,ut):ut()}else i(W,k,T)},de=(S,k,T,B=!1,H=!1)=>{const{type:W,props:ue,ref:se,children:ie,dynamicChildren:Z,shapeFlag:Se,patchFlag:he,dirs:Ee,cacheIndex:ke}=S;if(he===-2&&(H=!1),se!=null&&(Qs(),td(se,null,T,S,!0),Js()),ke!=null&&(k.renderCache[ke]=void 0),Se&256){k.ctx.deactivate(S);return}const Ue=Se&1&&Ee,ut=!nd(S);let tt;if(ut&&(tt=ue&&ue.onVnodeBeforeUnmount)&&Tr(tt,k,S),Se&6)Ae(S.component,T,B);else{if(Se&128){S.suspense.unmount(T,B);return}Ue&&Ea(S,null,k,"beforeUnmount"),Se&64?S.type.remove(S,k,T,X,B):Z&&!Z.hasOnce&&(W!==Fs||he>0&&he&64)?et(Z,k,T,!1,!0):(W===Fs&&he&384||!H&&Se&16)&&et(ie,k,T),B&&$e(S)}(ut&&(tt=ue&&ue.onVnodeUnmounted)||Ue)&&li(()=>{tt&&Tr(tt,k,S),Ue&&Ea(S,null,k,"unmounted")},T)},$e=S=>{const{type:k,el:T,anchor:B,transition:H}=S;if(k===Fs){Be(T,B);return}if(k===My){x(S);return}const W=()=>{r(T),H&&!H.persisted&&H.afterLeave&&H.afterLeave()};if(S.shapeFlag&1&&H&&!H.persisted){const{leave:ue,delayLeave:se}=H,ie=()=>ue(T,W);se?se(S.el,W,ie):ie()}else W()},Be=(S,k)=>{let T;for(;S!==k;)T=d(S),r(S),S=T;r(k)},Ae=(S,k,T)=>{const{bum:B,scope:H,job:W,subTree:ue,um:se,m:ie,a:Z}=S;oC(ie),oC(Z),B&&Ey(B),H.stop(),W&&(W.flags|=8,de(ue,S,k,T)),se&&li(se,k),li(()=>{S.isUnmounted=!0},k)},et=(S,k,T,B=!1,H=!1,W=0)=>{for(let ue=W;ue<S.length;ue++)de(S[ue],k,T,B,H)},V=S=>{if(S.shapeFlag&6)return V(S.component.subTree);if(S.shapeFlag&128)return S.suspense.next();const k=d(S.anchor||S.el),T=k&&k[_B];return T?d(T):k};let ce=!1;const L=(S,k,T)=>{S==null?k._vnode&&de(k._vnode,null,null,!0):g(k._vnode||null,S,k,null,null,null,T),k._vnode=S,ce||(ce=!0,JA(),GO(),ce=!1)},X={p:g,um:de,m:me,r:$e,mt:O,mc:$,pc:I,pbc:F,n:V,o:e};return{render:L,hydrate:void 0,createApp:GB(L)}}function ky({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Sa({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function tU(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function hD(e,t,n=!1){const i=e.children,r=t.children;if(Oe(i)&&Oe(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=_o(r[s]),a.el=o.el),!n&&a.patchFlag!==-2&&hD(o,a)),a.type===p0&&a.patchFlag!==-1&&(a.el=o.el),a.type===Ol&&!a.el&&(a.el=o.el)}}function nU(e){const t=e.slice(),n=[0];let i,r,s,o,a;const u=e.length;for(i=0;i<u;i++){const l=e[i];if(l!==0){if(r=n[n.length-1],e[r]<l){t[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,e[n[a]]<l?s=a+1:o=a;l<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=t[o];return n}function pD(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:pD(t)}function oC(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const iU=Symbol.for("v-scx"),rU=()=>js(iU);function qp(e,t,n){return gD(e,t,n)}function gD(e,t,n=ct){const{immediate:i,deep:r,flush:s,once:o}=n,a=wn({},n),u=t&&i||!t&&s!=="post";let l;if($d){if(s==="sync"){const h=rU();l=h.__watcherHandles||(h.__watcherHandles=[])}else if(!u){const h=()=>{};return h.stop=Gr,h.resume=Gr,h.pause=Gr,h}}const c=dn;a.call=(h,p,g)=>Zr(h,c,p,g);let f=!1;s==="post"?a.scheduler=h=>{li(h,c&&c.suspense)}:s!=="sync"&&(f=!0,a.scheduler=(h,p)=>{p?h():p2(h)}),a.augmentJob=h=>{t&&(h.flags|=4),f&&(h.flags|=2,c&&(h.id=c.uid,h.i=c))};const d=vB(e,t,a);return $d&&(l?l.push(d):u&&d()),d}function sU(e,t,n){const i=this.proxy,r=Gt(e)?e.includes(".")?mD(i,e):()=>i[e]:e.bind(i,i);let s;Re(t)?s=t:(s=t.handler,n=t);const o=oh(this),a=gD(r,s.bind(i),n);return o(),a}function mD(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}const oU=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Pi(t)}Modifiers`]||e[`${Mu(t)}Modifiers`];function aU(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||ct;let r=n;const s=t.startsWith("update:"),o=s&&oU(i,t.slice(7));o&&(o.trim&&(r=n.map(c=>Gt(c)?c.trim():c)),o.number&&(r=n.map(I7)));let a,u=i[a=_y(t)]||i[a=_y(Pi(t))];!u&&s&&(u=i[a=_y(Mu(t))]),u&&Zr(u,e,6,r);const l=i[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Zr(l,e,6,r)}}const uU=new WeakMap;function yD(e,t,n=!1){const i=n?uU:t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let o={},a=!1;if(!Re(e)){const u=l=>{const c=yD(l,t,!0);c&&(a=!0,wn(o,c))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!s&&!a?(At(e)&&i.set(e,null),null):(Oe(s)?s.forEach(u=>o[u]=null):wn(o,s),At(e)&&i.set(e,o),o)}function h0(e,t){return!e||!s0(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ke(e,t[0].toLowerCase()+t.slice(1))||Ke(e,Mu(t))||Ke(e,t))}function aC(e){const{type:t,vnode:n,proxy:i,withProxy:r,propsOptions:[s],slots:o,attrs:a,emit:u,render:l,renderCache:c,props:f,data:d,setupState:h,ctx:p,inheritAttrs:g}=e,m=xg(e);let y,v;try{if(n.shapeFlag&4){const x=r||i,w=x;y=zr(l.call(w,x,c,f,h,d,p)),v=a}else{const x=t;y=zr(x.length>1?x(f,{attrs:a,slots:o,emit:u}):x(f,null)),v=t.props?a:lU(a)}}catch(x){rd.length=0,f0(x,e,1),y=Qn(Ol)}let b=y;if(v&&g!==!1){const x=Object.keys(v),{shapeFlag:w}=b;x.length&&w&7&&(s&&x.some(t2)&&(v=cU(v,s)),b=Dl(b,v,!1,!0))}return n.dirs&&(b=Dl(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&g2(b,n.transition),y=b,xg(m),y}const lU=e=>{let t;for(const n in e)(n==="class"||n==="style"||s0(n))&&((t||(t={}))[n]=e[n]);return t},cU=(e,t)=>{const n={};for(const i in e)(!t2(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function fU(e,t,n){const{props:i,children:r,component:s}=e,{props:o,children:a,patchFlag:u}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return i?uC(i,o,l):!!o;if(u&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const d=c[f];if(o[d]!==i[d]&&!h0(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?uC(i,o,l):!0:!!o;return!1}function uC(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!h0(n,s))return!0}return!1}function dU({vnode:e,parent:t},n){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===e&&(i.el=e.el),i===e)(e=t.vnode).el=n,t=t.parent;else break}}const vD=e=>e.__isSuspense;function hU(e,t){t&&t.pendingBranch?Oe(e)?t.effects.push(...e):t.effects.push(e):wB(e)}const Fs=Symbol.for("v-fgt"),p0=Symbol.for("v-txt"),Ol=Symbol.for("v-cmt"),My=Symbol.for("v-stc"),rd=[];let pi=null;function bc(e=!1){rd.push(pi=e?null:[])}function pU(){rd.pop(),pi=rd[rd.length-1]||null}let Sd=1;function Eg(e,t=!1){Sd+=e,e<0&&pi&&t&&(pi.hasOnce=!0)}function gU(e){return e.dynamicChildren=Sd>0?pi||bl:null,pU(),Sd>0&&pi&&pi.push(e),e}function xc(e,t,n,i,r,s){return gU(bt(e,t,n,i,r,s,!0))}function Sg(e){return e?e.__v_isVNode===!0:!1}function Kc(e,t){return e.type===t.type&&e.key===t.key}const bD=({key:e})=>e??null,Wp=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Gt(e)||mn(e)||Re(e)?{i:ir,r:e,k:t,f:!!n}:e:null);function bt(e,t=null,n=null,i=0,r=null,s=e===Fs?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&bD(t),ref:t&&Wp(t),scopeId:YO,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:ir};return a?(v2(u,n),s&128&&e.normalize(u)):n&&(u.shapeFlag|=Gt(n)?8:16),Sd>0&&!o&&pi&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&pi.push(u),u}const Qn=mU;function mU(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===IB)&&(e=Ol),Sg(e)){const a=Dl(e,t,!0);return n&&v2(a,n),Sd>0&&!s&&pi&&(a.shapeFlag&6?pi[pi.indexOf(e)]=a:pi.push(a)),a.patchFlag=-2,a}if(kU(e)&&(e=e.__vccOpts),t){t=yU(t);let{class:a,style:u}=t;a&&!Gt(a)&&(t.class=s2(a)),At(u)&&(h2(u)&&!Oe(u)&&(u=wn({},u)),t.style=r2(u))}const o=Gt(e)?1:vD(e)?128:EB(e)?64:At(e)?4:Re(e)?2:0;return bt(e,t,n,i,r,o,s,!0)}function yU(e){return e?h2(e)||aD(e)?wn({},e):e:null}function Dl(e,t,n=!1,i=!1){const{props:r,ref:s,patchFlag:o,children:a,transition:u}=e,l=t?vU(r||{},t):r,c={__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&bD(l),ref:t&&t.ref?n&&s?Oe(s)?s.concat(Wp(t)):[s,Wp(t)]:Wp(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Fs?o===-1?16:o|16:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Dl(e.ssContent),ssFallback:e.ssFallback&&Dl(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&i&&g2(c,u.clone(c)),c}function Af(e=" ",t=0){return Qn(p0,null,e,t)}function zr(e){return e==null||typeof e=="boolean"?Qn(Ol):Oe(e)?Qn(Fs,null,e.slice()):Sg(e)?_o(e):Qn(p0,null,String(e))}function _o(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Dl(e)}function v2(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(Oe(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),v2(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!aD(t)?t._ctx=ir:r===3&&ir&&(ir.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Re(t)?(t={default:t,_ctx:ir},n=32):(t=String(t),i&64?(n=16,t=[Af(t)]):n=8);e.children=t,e.shapeFlag|=n}function vU(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=s2([t.class,i.class]));else if(r==="style")t.style=r2([t.style,i.style]);else if(s0(r)){const s=t[r],o=i[r];o&&s!==o&&!(Oe(s)&&s.includes(o))&&(t[r]=s?[].concat(s,o):o)}else r!==""&&(t[r]=i[r])}return t}function Tr(e,t,n,i=null){Zr(e,t,7,[n,i])}const bU=rD();let xU=0;function wU(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||bU,s={uid:xU++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new W7(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:lD(i,r),emitsOptions:yD(i,r),emit:null,emitted:null,propsDefaults:ct,inheritAttrs:i.inheritAttrs,ctx:ct,data:ct,props:ct,attrs:ct,slots:ct,refs:ct,setupState:ct,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=aU.bind(null,s),e.ce&&e.ce(s),s}let dn=null;const _U=()=>dn||ir;let $g,Db;{const e=l0(),t=(n,i)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(i),s=>{r.length>1?r.forEach(o=>o(s)):r[0](s)}};$g=t("__VUE_INSTANCE_SETTERS__",n=>dn=n),Db=t("__VUE_SSR_SETTERS__",n=>$d=n)}const oh=e=>{const t=dn;return $g(e),e.scope.on(),()=>{e.scope.off(),$g(t)}},lC=()=>{dn&&dn.scope.off(),$g(null)};function xD(e){return e.vnode.shapeFlag&4}let $d=!1;function EU(e,t=!1,n=!1){t&&Db(t);const{props:i,children:r}=e.vnode,s=xD(e);VB(e,i,s,t),QB(e,r,n||t);const o=s?SU(e,t):void 0;return t&&Db(!1),o}function SU(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,zB);const{setup:i}=n;if(i){Qs();const r=e.setupContext=i.length>1?AU(e):null,s=oh(e),o=sh(i,e,0,[e.props,r]),a=_O(o);if(Js(),s(),(a||e.sp)&&!nd(e)&&KO(e),a){if(o.then(lC,lC),t)return o.then(u=>{cC(e,u)}).catch(u=>{f0(u,e,0)});e.asyncDep=o}else cC(e,o)}else wD(e)}function cC(e,t,n){Re(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:At(t)&&(e.setupState=jO(t)),wD(e)}function wD(e,t,n){const i=e.type;e.render||(e.render=i.render||Gr);{const r=oh(e);Qs();try{BB(e)}finally{Js(),r()}}}const $U={get(e,t){return fn(e,"get",""),e[t]}};function AU(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,$U),slots:e.slots,emit:e.emit,expose:t}}function b2(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(jO(cB(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in id)return id[n](e)},has(t,n){return n in t||n in id}})):e.proxy}function CU(e,t=!0){return Re(e)?e.displayName||e.name:e.name||t&&e.__name}function kU(e){return Re(e)&&"__vccOpts"in e}const er=(e,t)=>mB(e,t,$d);function _D(e,t,n){const i=(s,o,a)=>{Eg(-1);try{return Qn(s,o,a)}finally{Eg(1)}},r=arguments.length;return r===2?At(t)&&!Oe(t)?Sg(t)?i(e,null,[t]):i(e,t):i(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Sg(n)&&(n=[n]),i(e,t,n))}const MU="3.5.21";/**
* @vue/runtime-dom v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Nb;const fC=typeof window<"u"&&window.trustedTypes;if(fC)try{Nb=fC.createPolicy("vue",{createHTML:e=>e})}catch{}const ED=Nb?e=>Nb.createHTML(e):e=>e,FU="http://www.w3.org/2000/svg",TU="http://www.w3.org/1998/Math/MathML",ks=typeof document<"u"?document:null,dC=ks&&ks.createElement("template"),RU={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t==="svg"?ks.createElementNS(FU,e):t==="mathml"?ks.createElementNS(TU,e):n?ks.createElement(e,{is:n}):ks.createElement(e);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>ks.createTextNode(e),createComment:e=>ks.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ks.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,i,r,s){const o=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{dC.innerHTML=ED(i==="svg"?`<svg>${e}</svg>`:i==="mathml"?`<math>${e}</math>`:e);const a=dC.content;if(i==="svg"||i==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}t.insertBefore(a,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},OU=Symbol("_vtc");function DU(e,t,n){const i=e[OU];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const hC=Symbol("_vod"),NU=Symbol("_vsh"),PU=Symbol(""),IU=/(?:^|;)\s*display\s*:/;function LU(e,t,n){const i=e.style,r=Gt(n);let s=!1;if(n&&!r){if(t)if(Gt(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Hp(i,a,"")}else for(const o in t)n[o]==null&&Hp(i,o,"");for(const o in n)o==="display"&&(s=!0),Hp(i,o,n[o])}else if(r){if(t!==n){const o=i[PU];o&&(n+=";"+o),i.cssText=n,s=IU.test(n)}}else t&&e.removeAttribute("style");hC in e&&(e[hC]=s?i.display:"",e[NU]&&(i.display="none"))}const pC=/\s*!important$/;function Hp(e,t,n){if(Oe(n))n.forEach(i=>Hp(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=zU(e,t);pC.test(n)?e.setProperty(Mu(i),n.replace(pC,""),"important"):e[i]=n}}const gC=["Webkit","Moz","ms"],Fy={};function zU(e,t){const n=Fy[t];if(n)return n;let i=Pi(t);if(i!=="filter"&&i in e)return Fy[t]=i;i=u0(i);for(let r=0;r<gC.length;r++){const s=gC[r]+i;if(s in e)return Fy[t]=s}return t}const mC="http://www.w3.org/1999/xlink";function yC(e,t,n,i,r,s=q7(t)){i&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(mC,t.slice(6,t.length)):e.setAttributeNS(mC,t,n):n==null||s&&!SO(n)?e.removeAttribute(t):e.setAttribute(t,s?"":vc(n)?String(n):n)}function vC(e,t,n,i,r){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?ED(n):n);return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(a!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let o=!1;if(n===""||n==null){const a=typeof e[t];a==="boolean"?n=SO(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(r||t)}function BU(e,t,n,i){e.addEventListener(t,n,i)}function UU(e,t,n,i){e.removeEventListener(t,n,i)}const bC=Symbol("_vei");function jU(e,t,n,i,r=null){const s=e[bC]||(e[bC]={}),o=s[t];if(i&&o)o.value=i;else{const[a,u]=qU(t);if(i){const l=s[t]=GU(i,r);BU(e,a,l,u)}else o&&(UU(e,a,o,u),s[t]=void 0)}}const xC=/(?:Once|Passive|Capture)$/;function qU(e){let t;if(xC.test(e)){t={};let i;for(;i=e.match(xC);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Mu(e.slice(2)),t]}let Ty=0;const WU=Promise.resolve(),HU=()=>Ty||(WU.then(()=>Ty=0),Ty=Date.now());function GU(e,t){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Zr(VU(i,n.value),t,5,[i])};return n.value=e,n.attached=HU(),n}function VU(e,t){if(Oe(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const wC=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,YU=(e,t,n,i,r,s)=>{const o=r==="svg";t==="class"?DU(e,i,o):t==="style"?LU(e,n,i):s0(t)?t2(t)||jU(e,t,n,i,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):XU(e,t,i,o))?(vC(e,t,i),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&yC(e,t,i,o,s,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Gt(i))?vC(e,Pi(t),i,s,t):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),yC(e,t,i,o))};function XU(e,t,n,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in e&&wC(t)&&Re(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return wC(t)&&Gt(n)?!1:t in e}const KU=wn({patchProp:YU},RU);let _C;function QU(){return _C||(_C=ZB(KU))}const JU=((...e)=>{const t=QU().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=ej(i);if(!r)return;const s=t._component;!Re(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,ZU(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t});function ZU(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function ej(e){return Gt(e)?document.querySelector(e):e}const tj={class:"max-w-7xl mx-auto flex items-center justify-between p-4"},nj={class:"space-x-6 hidden sm:block"},ij={__name:"Header",setup(e){return(t,n)=>{const i=tD("router-link");return bc(),xc("div",tj,[n[4]||(n[4]=bt("div",{class:"flex items-center space-x-3"},[bt("h1",{class:"text-xl font-bold"},"FIT4701/4702 FYP Project Monash")],-1)),bt("nav",nj,[Qn(i,{to:"/",class:"font-semibold px-4 py-2 rounded-lg hover:text-cadetblue hover:bg-calmblue"},{default:Sf(()=>[...n[0]||(n[0]=[Af("Dashboard",-1)])]),_:1}),Qn(i,{to:"/fit4701",class:"font-semibold px-4 py-2 rounded-lg hover:text-cadetblue hover:bg-calmblue"},{default:Sf(()=>[...n[1]||(n[1]=[Af("FIT4701",-1)])]),_:1}),Qn(i,{to:"/about",class:"font-semibold px-4 py-2 rounded-lg hover:text-cadetblue hover:bg-calmblue"},{default:Sf(()=>[...n[2]||(n[2]=[Af("About",-1)])]),_:1}),Qn(i,{to:"/contact",class:"font-semibold px-4 py-2 rounded-lg hover:text-cadetblue hover:bg-calmblue"},{default:Sf(()=>[...n[3]||(n[3]=[Af("Contact",-1)])]),_:1})])])}}},rj={class:"flex flex-col h-screen justify-between bg-backblue"},sj={class:""},oj={class:"mb-auto p-[1rem] bg-happygreen"},aj={__name:"App",setup(e){return(t,n)=>{const i=tD("router-view");return bc(),xc("div",rj,[n[0]||(n[0]=bt("link",{href:"/dist/output.css",rel:"stylesheet"},null,-1)),bt("header",sj,[Qn(ij)]),bt("main",oj,[Qn(i)]),n[1]||(n[1]=bt("footer",{class:""},[bt("p",null,"Footer")],-1))])}}};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const ul=typeof document<"u";function SD(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uj(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&SD(e.default)}const Ye=Object.assign;function Ry(e,t){const n={};for(const i in t){const r=t[i];n[i]=dr(r)?r.map(e):e(r)}return n}const sd=()=>{},dr=Array.isArray,$D=/#/g,lj=/&/g,cj=/\//g,fj=/=/g,dj=/\?/g,AD=/\+/g,hj=/%5B/g,pj=/%5D/g,CD=/%5E/g,gj=/%60/g,kD=/%7B/g,mj=/%7C/g,MD=/%7D/g,yj=/%20/g;function x2(e){return encodeURI(""+e).replace(mj,"|").replace(hj,"[").replace(pj,"]")}function vj(e){return x2(e).replace(kD,"{").replace(MD,"}").replace(CD,"^")}function Pb(e){return x2(e).replace(AD,"%2B").replace(yj,"+").replace($D,"%23").replace(lj,"%26").replace(gj,"`").replace(kD,"{").replace(MD,"}").replace(CD,"^")}function bj(e){return Pb(e).replace(fj,"%3D")}function xj(e){return x2(e).replace($D,"%23").replace(dj,"%3F")}function wj(e){return e==null?"":xj(e).replace(cj,"%2F")}function Ad(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const _j=/\/$/,Ej=e=>e.replace(_j,"");function Oy(e,t,n="/"){let i,r={},s="",o="";const a=t.indexOf("#");let u=t.indexOf("?");return a<u&&a>=0&&(u=-1),u>-1&&(i=t.slice(0,u),s=t.slice(u+1,a>-1?a:t.length),r=e(s)),a>-1&&(i=i||t.slice(0,a),o=t.slice(a,t.length)),i=Cj(i??t,n),{fullPath:i+(s&&"?")+s+o,path:i,query:r,hash:Ad(o)}}function Sj(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function EC(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function $j(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&Nl(t.matched[i],n.matched[r])&&FD(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function Nl(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function FD(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!Aj(e[n],t[n]))return!1;return!0}function Aj(e,t){return dr(e)?SC(e,t):dr(t)?SC(t,e):e===t}function SC(e,t){return dr(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function Cj(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let s=n.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")s>1&&s--;else break;return n.slice(0,s).join("/")+"/"+i.slice(o).join("/")}const mo={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Cd;(function(e){e.pop="pop",e.push="push"})(Cd||(Cd={}));var od;(function(e){e.back="back",e.forward="forward",e.unknown=""})(od||(od={}));function kj(e){if(!e)if(ul){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Ej(e)}const Mj=/^[^#]+#/;function Fj(e,t){return e.replace(Mj,"#")+t}function Tj(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const g0=()=>({left:window.scrollX,top:window.scrollY});function Rj(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=Tj(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function $C(e,t){return(history.state?history.state.position-t:-1)+e}const Ib=new Map;function Oj(e,t){Ib.set(e,t)}function Dj(e){const t=Ib.get(e);return Ib.delete(e),t}let Nj=()=>location.protocol+"//"+location.host;function TD(e,t){const{pathname:n,search:i,hash:r}=t,s=e.indexOf("#");if(s>-1){let a=r.includes(e.slice(s))?e.slice(s).length:1,u=r.slice(a);return u[0]!=="/"&&(u="/"+u),EC(u,"")}return EC(n,e)+i+r}function Pj(e,t,n,i){let r=[],s=[],o=null;const a=({state:d})=>{const h=TD(e,location),p=n.value,g=t.value;let m=0;if(d){if(n.value=h,t.value=d,o&&o===p){o=null;return}m=g?d.position-g.position:0}else i(h);r.forEach(y=>{y(n.value,p,{delta:m,type:Cd.pop,direction:m?m>0?od.forward:od.back:od.unknown})})};function u(){o=n.value}function l(d){r.push(d);const h=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return s.push(h),h}function c(){const{history:d}=window;d.state&&d.replaceState(Ye({},d.state,{scroll:g0()}),"")}function f(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:u,listen:l,destroy:f}}function AC(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?g0():null}}function Ij(e){const{history:t,location:n}=window,i={value:TD(e,n)},r={value:t.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(u,l,c){const f=e.indexOf("#"),d=f>-1?(n.host&&document.querySelector("base")?e:e.slice(f))+u:Nj()+e+u;try{t[c?"replaceState":"pushState"](l,"",d),r.value=l}catch(h){console.error(h),n[c?"replace":"assign"](d)}}function o(u,l){const c=Ye({},t.state,AC(r.value.back,u,r.value.forward,!0),l,{position:r.value.position});s(u,c,!0),i.value=u}function a(u,l){const c=Ye({},r.value,t.state,{forward:u,scroll:g0()});s(c.current,c,!0);const f=Ye({},AC(i.value,u,null),{position:c.position+1},l);s(u,f,!1),i.value=u}return{location:i,state:r,push:a,replace:o}}function Lj(e){e=kj(e);const t=Ij(e),n=Pj(e,t.state,t.location,t.replace);function i(s,o=!0){o||n.pauseListeners(),history.go(s)}const r=Ye({location:"",base:e,go:i,createHref:Fj.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function zj(e){return typeof e=="string"||e&&typeof e=="object"}function RD(e){return typeof e=="string"||typeof e=="symbol"}const OD=Symbol("");var CC;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(CC||(CC={}));function Pl(e,t){return Ye(new Error,{type:e,[OD]:!0},t)}function Es(e,t){return e instanceof Error&&OD in e&&(t==null||!!(e.type&t))}const kC="[^/]+?",Bj={sensitive:!1,strict:!1,start:!0,end:!0},Uj=/[.+*?^${}()[\]/\\]/g;function jj(e,t){const n=Ye({},Bj,t),i=[];let r=n.start?"^":"";const s=[];for(const l of e){const c=l.length?[]:[90];n.strict&&!l.length&&(r+="/");for(let f=0;f<l.length;f++){const d=l[f];let h=40+(n.sensitive?.25:0);if(d.type===0)f||(r+="/"),r+=d.value.replace(Uj,"\\$&"),h+=40;else if(d.type===1){const{value:p,repeatable:g,optional:m,regexp:y}=d;s.push({name:p,repeatable:g,optional:m});const v=y||kC;if(v!==kC){h+=10;try{new RegExp(`(${v})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${p}" (${v}): `+x.message)}}let b=g?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;f||(b=m&&l.length<2?`(?:/${b})`:"/"+b),m&&(b+="?"),r+=b,h+=20,m&&(h+=-8),g&&(h+=-20),v===".*"&&(h+=-50)}c.push(h)}i.push(c)}if(n.strict&&n.end){const l=i.length-1;i[l][i[l].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(l){const c=l.match(o),f={};if(!c)return null;for(let d=1;d<c.length;d++){const h=c[d]||"",p=s[d-1];f[p.name]=h&&p.repeatable?h.split("/"):h}return f}function u(l){let c="",f=!1;for(const d of e){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const h of d)if(h.type===0)c+=h.value;else if(h.type===1){const{value:p,repeatable:g,optional:m}=h,y=p in l?l[p]:"";if(dr(y)&&!g)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const v=dr(y)?y.join("/"):y;if(!v)if(m)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${p}"`);c+=v}}return c||"/"}return{re:o,score:i,keys:s,parse:a,stringify:u}}function qj(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function DD(e,t){let n=0;const i=e.score,r=t.score;for(;n<i.length&&n<r.length;){const s=qj(i[n],r[n]);if(s)return s;n++}if(Math.abs(r.length-i.length)===1){if(MC(i))return 1;if(MC(r))return-1}return r.length-i.length}function MC(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Wj={type:0,value:""},Hj=/[a-zA-Z0-9_]/;function Gj(e){if(!e)return[[]];if(e==="/")return[[Wj]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(h){throw new Error(`ERR (${n})/"${l}": ${h}`)}let n=0,i=n;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,u,l="",c="";function f(){l&&(n===0?s.push({type:0,value:l}):n===1||n===2||n===3?(s.length>1&&(u==="*"||u==="+")&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):t("Invalid state to consume buffer"),l="")}function d(){l+=u}for(;a<e.length;){if(u=e[a++],u==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:u==="/"?(l&&f(),o()):u===":"?(f(),n=1):d();break;case 4:d(),n=i;break;case 1:u==="("?n=2:Hj.test(u)?d():(f(),n=0,u!=="*"&&u!=="?"&&u!=="+"&&a--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:n=3:c+=u;break;case 3:f(),n=0,u!=="*"&&u!=="?"&&u!=="+"&&a--,c="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${l}"`),f(),o(),r}function Vj(e,t,n){const i=jj(Gj(e.path),n),r=Ye(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf==!t.record.aliasOf&&t.children.push(r),r}function Yj(e,t){const n=[],i=new Map;t=OC({strict:!1,end:!0,sensitive:!1},t);function r(f){return i.get(f)}function s(f,d,h){const p=!h,g=TC(f);g.aliasOf=h&&h.record;const m=OC(t,f),y=[g];if("alias"in f){const x=typeof f.alias=="string"?[f.alias]:f.alias;for(const w of x)y.push(TC(Ye({},g,{components:h?h.record.components:g.components,path:w,aliasOf:h?h.record:g})))}let v,b;for(const x of y){const{path:w}=x;if(d&&w[0]!=="/"){const E=d.record.path,_=E[E.length-1]==="/"?"":"/";x.path=d.record.path+(w&&_+w)}if(v=Vj(x,d,m),h?h.alias.push(v):(b=b||v,b!==v&&b.alias.push(v),p&&f.name&&!RC(v)&&o(f.name)),ND(v)&&u(v),g.children){const E=g.children;for(let _=0;_<E.length;_++)s(E[_],v,h&&h.children[_])}h=h||v}return b?()=>{o(b)}:sd}function o(f){if(RD(f)){const d=i.get(f);d&&(i.delete(f),n.splice(n.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=n.indexOf(f);d>-1&&(n.splice(d,1),f.record.name&&i.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return n}function u(f){const d=Qj(f,n);n.splice(d,0,f),f.record.name&&!RC(f)&&i.set(f.record.name,f)}function l(f,d){let h,p={},g,m;if("name"in f&&f.name){if(h=i.get(f.name),!h)throw Pl(1,{location:f});m=h.record.name,p=Ye(FC(d.params,h.keys.filter(b=>!b.optional).concat(h.parent?h.parent.keys.filter(b=>b.optional):[]).map(b=>b.name)),f.params&&FC(f.params,h.keys.map(b=>b.name))),g=h.stringify(p)}else if(f.path!=null)g=f.path,h=n.find(b=>b.re.test(g)),h&&(p=h.parse(g),m=h.record.name);else{if(h=d.name?i.get(d.name):n.find(b=>b.re.test(d.path)),!h)throw Pl(1,{location:f,currentLocation:d});m=h.record.name,p=Ye({},d.params,f.params),g=h.stringify(p)}const y=[];let v=h;for(;v;)y.unshift(v.record),v=v.parent;return{name:m,path:g,params:p,matched:y,meta:Kj(y)}}e.forEach(f=>s(f));function c(){n.length=0,i.clear()}return{addRoute:s,resolve:l,removeRoute:o,clearRoutes:c,getRoutes:a,getRecordMatcher:r}}function FC(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function TC(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Xj(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function Xj(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="object"?n[i]:n;return t}function RC(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Kj(e){return e.reduce((t,n)=>Ye(t,n.meta),{})}function OC(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function Qj(e,t){let n=0,i=t.length;for(;n!==i;){const s=n+i>>1;DD(e,t[s])<0?i=s:n=s+1}const r=Jj(e);return r&&(i=t.lastIndexOf(r,i-1)),i}function Jj(e){let t=e;for(;t=t.parent;)if(ND(t)&&DD(e,t)===0)return t}function ND({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Zj(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(AD," "),o=s.indexOf("="),a=Ad(o<0?s:s.slice(0,o)),u=o<0?null:Ad(s.slice(o+1));if(a in t){let l=t[a];dr(l)||(l=t[a]=[l]),l.push(u)}else t[a]=u}return t}function DC(e){let t="";for(let n in e){const i=e[n];if(n=bj(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(dr(i)?i.map(s=>s&&Pb(s)):[i&&Pb(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+n,s!=null&&(t+="="+s))})}return t}function eq(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=dr(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return t}const tq=Symbol(""),NC=Symbol(""),w2=Symbol(""),PD=Symbol(""),Lb=Symbol("");function Qc(){let e=[];function t(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function n(){e=[]}return{add:t,list:()=>e.slice(),reset:n}}function Eo(e,t,n,i,r,s=o=>o()){const o=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((a,u)=>{const l=d=>{d===!1?u(Pl(4,{from:n,to:t})):d instanceof Error?u(d):zj(d)?u(Pl(2,{from:t,to:d})):(o&&i.enterCallbacks[r]===o&&typeof d=="function"&&o.push(d),a())},c=s(()=>e.call(i&&i.instances[r],t,n,l));let f=Promise.resolve(c);e.length<3&&(f=f.then(l)),f.catch(d=>u(d))})}function Dy(e,t,n,i,r=s=>s()){const s=[];for(const o of e)for(const a in o.components){let u=o.components[a];if(!(t!=="beforeRouteEnter"&&!o.instances[a]))if(SD(u)){const c=(u.__vccOpts||u)[t];c&&s.push(Eo(c,n,i,o,a,r))}else{let l=u();s.push(()=>l.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=uj(c)?c.default:c;o.mods[a]=c,o.components[a]=f;const h=(f.__vccOpts||f)[t];return h&&Eo(h,n,i,o,a,r)()}))}}return s}function PC(e){const t=js(w2),n=js(PD),i=er(()=>{const u=xl(e.to);return t.resolve(u)}),r=er(()=>{const{matched:u}=i.value,{length:l}=u,c=u[l-1],f=n.matched;if(!c||!f.length)return-1;const d=f.findIndex(Nl.bind(null,c));if(d>-1)return d;const h=IC(u[l-2]);return l>1&&IC(c)===h&&f[f.length-1].path!==h?f.findIndex(Nl.bind(null,u[l-2])):d}),s=er(()=>r.value>-1&&oq(n.params,i.value.params)),o=er(()=>r.value>-1&&r.value===n.matched.length-1&&FD(n.params,i.value.params));function a(u={}){if(sq(u)){const l=t[xl(e.replace)?"replace":"push"](xl(e.to)).catch(sd);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>l),l}return Promise.resolve()}return{route:i,href:er(()=>i.value.href),isActive:s,isExactActive:o,navigate:a}}function nq(e){return e.length===1?e[0]:e}const iq=XO({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:PC,setup(e,{slots:t}){const n=c0(PC(e)),{options:i}=js(w2),r=er(()=>({[LC(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[LC(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=t.default&&nq(t.default(n));return e.custom?s:_D("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},s)}}}),rq=iq;function sq(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function oq(e,t){for(const n in t){const i=t[n],r=e[n];if(typeof i=="string"){if(i!==r)return!1}else if(!dr(r)||r.length!==i.length||i.some((s,o)=>s!==r[o]))return!1}return!0}function IC(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const LC=(e,t,n)=>e??t??n,aq=XO({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=js(Lb),r=er(()=>e.route||i.value),s=js(NC,0),o=er(()=>{let l=xl(s);const{matched:c}=r.value;let f;for(;(f=c[l])&&!f.components;)l++;return l}),a=er(()=>r.value.matched[o.value]);jp(NC,er(()=>o.value+1)),jp(tq,a),jp(Lb,r);const u=fB();return qp(()=>[u.value,a.value,e.name],([l,c,f],[d,h,p])=>{c&&(c.instances[f]=l,h&&h!==c&&l&&l===d&&(c.leaveGuards.size||(c.leaveGuards=h.leaveGuards),c.updateGuards.size||(c.updateGuards=h.updateGuards))),l&&c&&(!h||!Nl(c,h)||!d)&&(c.enterCallbacks[f]||[]).forEach(g=>g(l))},{flush:"post"}),()=>{const l=r.value,c=e.name,f=a.value,d=f&&f.components[c];if(!d)return zC(n.default,{Component:d,route:l});const h=f.props[c],p=h?h===!0?l.params:typeof h=="function"?h(l):h:null,m=_D(d,Ye({},p,t,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(f.instances[c]=null)},ref:u}));return zC(n.default,{Component:m,route:l})||m}}});function zC(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const uq=aq;function lq(e){const t=Yj(e.routes,e),n=e.parseQuery||Zj,i=e.stringifyQuery||DC,r=e.history,s=Qc(),o=Qc(),a=Qc(),u=dB(mo);let l=mo;ul&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Ry.bind(null,V=>""+V),f=Ry.bind(null,wj),d=Ry.bind(null,Ad);function h(V,ce){let L,X;return RD(V)?(L=t.getRecordMatcher(V),X=ce):X=V,t.addRoute(X,L)}function p(V){const ce=t.getRecordMatcher(V);ce&&t.removeRoute(ce)}function g(){return t.getRoutes().map(V=>V.record)}function m(V){return!!t.getRecordMatcher(V)}function y(V,ce){if(ce=Ye({},ce||u.value),typeof V=="string"){const T=Oy(n,V,ce.path),B=t.resolve({path:T.path},ce),H=r.createHref(T.fullPath);return Ye(T,B,{params:d(B.params),hash:Ad(T.hash),redirectedFrom:void 0,href:H})}let L;if(V.path!=null)L=Ye({},V,{path:Oy(n,V.path,ce.path).path});else{const T=Ye({},V.params);for(const B in T)T[B]==null&&delete T[B];L=Ye({},V,{params:f(T)}),ce.params=f(ce.params)}const X=t.resolve(L,ce),pe=V.hash||"";X.params=c(d(X.params));const S=Sj(i,Ye({},V,{hash:vj(pe),path:X.path})),k=r.createHref(S);return Ye({fullPath:S,hash:pe,query:i===DC?eq(V.query):V.query||{}},X,{redirectedFrom:void 0,href:k})}function v(V){return typeof V=="string"?Oy(n,V,u.value.path):Ye({},V)}function b(V,ce){if(l!==V)return Pl(8,{from:ce,to:V})}function x(V){return _(V)}function w(V){return x(Ye(v(V),{replace:!0}))}function E(V){const ce=V.matched[V.matched.length-1];if(ce&&ce.redirect){const{redirect:L}=ce;let X=typeof L=="function"?L(V):L;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=v(X):{path:X},X.params={}),Ye({query:V.query,hash:V.hash,params:X.path!=null?{}:V.params},X)}}function _(V,ce){const L=l=y(V),X=u.value,pe=V.state,S=V.force,k=V.replace===!0,T=E(L);if(T)return _(Ye(v(T),{state:typeof T=="object"?Ye({},pe,T.state):pe,force:S,replace:k}),ce||L);const B=L;B.redirectedFrom=ce;let H;return!S&&$j(i,X,L)&&(H=Pl(16,{to:B,from:X}),me(X,X,!0,!1)),(H?Promise.resolve(H):F(B,X)).catch(W=>Es(W)?Es(W,2)?W:re(W):I(W,B,X)).then(W=>{if(W){if(Es(W,2))return _(Ye({replace:k},v(W.to),{state:typeof W.to=="object"?Ye({},pe,W.to.state):pe,force:S}),ce||B)}else W=P(B,X,!0,k,pe);return M(B,X,W),W})}function $(V,ce){const L=b(V,ce);return L?Promise.reject(L):Promise.resolve()}function A(V){const ce=Be.values().next().value;return ce&&typeof ce.runWithContext=="function"?ce.runWithContext(V):V()}function F(V,ce){let L;const[X,pe,S]=cq(V,ce);L=Dy(X.reverse(),"beforeRouteLeave",V,ce);for(const T of X)T.leaveGuards.forEach(B=>{L.push(Eo(B,V,ce))});const k=$.bind(null,V,ce);return L.push(k),et(L).then(()=>{L=[];for(const T of s.list())L.push(Eo(T,V,ce));return L.push(k),et(L)}).then(()=>{L=Dy(pe,"beforeRouteUpdate",V,ce);for(const T of pe)T.updateGuards.forEach(B=>{L.push(Eo(B,V,ce))});return L.push(k),et(L)}).then(()=>{L=[];for(const T of S)if(T.beforeEnter)if(dr(T.beforeEnter))for(const B of T.beforeEnter)L.push(Eo(B,V,ce));else L.push(Eo(T.beforeEnter,V,ce));return L.push(k),et(L)}).then(()=>(V.matched.forEach(T=>T.enterCallbacks={}),L=Dy(S,"beforeRouteEnter",V,ce,A),L.push(k),et(L))).then(()=>{L=[];for(const T of o.list())L.push(Eo(T,V,ce));return L.push(k),et(L)}).catch(T=>Es(T,8)?T:Promise.reject(T))}function M(V,ce,L){a.list().forEach(X=>A(()=>X(V,ce,L)))}function P(V,ce,L,X,pe){const S=b(V,ce);if(S)return S;const k=ce===mo,T=ul?history.state:{};L&&(X||k?r.replace(V.fullPath,Ye({scroll:k&&T&&T.scroll},pe)):r.push(V.fullPath,pe)),u.value=V,me(V,ce,L,k),re()}let D;function O(){D||(D=r.listen((V,ce,L)=>{if(!Ae.listening)return;const X=y(V),pe=E(X);if(pe){_(Ye(pe,{replace:!0,force:!0}),X).catch(sd);return}l=X;const S=u.value;ul&&Oj($C(S.fullPath,L.delta),g0()),F(X,S).catch(k=>Es(k,12)?k:Es(k,2)?(_(Ye(v(k.to),{force:!0}),X).then(T=>{Es(T,20)&&!L.delta&&L.type===Cd.pop&&r.go(-1,!1)}).catch(sd),Promise.reject()):(L.delta&&r.go(-L.delta,!1),I(k,X,S))).then(k=>{k=k||P(X,S,!1),k&&(L.delta&&!Es(k,8)?r.go(-L.delta,!1):L.type===Cd.pop&&Es(k,20)&&r.go(-1,!1)),M(X,S,k)}).catch(sd)}))}let C=Qc(),R=Qc(),N;function I(V,ce,L){re(V);const X=R.list();return X.length?X.forEach(pe=>pe(V,ce,L)):console.error(V),Promise.reject(V)}function U(){return N&&u.value!==mo?Promise.resolve():new Promise((V,ce)=>{C.add([V,ce])})}function re(V){return N||(N=!V,O(),C.list().forEach(([ce,L])=>V?L(V):ce()),C.reset()),V}function me(V,ce,L,X){const{scrollBehavior:pe}=e;if(!ul||!pe)return Promise.resolve();const S=!L&&Dj($C(V.fullPath,0))||(X||!L)&&history.state&&history.state.scroll||null;return WO().then(()=>pe(V,ce,S)).then(k=>k&&Rj(k)).catch(k=>I(k,V,ce))}const de=V=>r.go(V);let $e;const Be=new Set,Ae={currentRoute:u,listening:!0,addRoute:h,removeRoute:p,clearRoutes:t.clearRoutes,hasRoute:m,getRoutes:g,resolve:y,options:e,push:x,replace:w,go:de,back:()=>de(-1),forward:()=>de(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:R.add,isReady:U,install(V){const ce=this;V.component("RouterLink",rq),V.component("RouterView",uq),V.config.globalProperties.$router=ce,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>xl(u)}),ul&&!$e&&u.value===mo&&($e=!0,x(r.location).catch(pe=>{}));const L={};for(const pe in mo)Object.defineProperty(L,pe,{get:()=>u.value[pe],enumerable:!0});V.provide(w2,ce),V.provide(PD,zO(L)),V.provide(Lb,u);const X=V.unmount;Be.add(V),V.unmount=function(){Be.delete(V),Be.size<1&&(l=mo,D&&D(),D=null,u.value=mo,$e=!1,N=!1),X()}}};function et(V){return V.reduce((ce,L)=>ce.then(()=>A(L)),Promise.resolve())}return Ae}function cq(e,t){const n=[],i=[],r=[],s=Math.max(t.matched.length,e.matched.length);for(let o=0;o<s;o++){const a=t.matched[o];a&&(e.matched.find(l=>Nl(l,a))?i.push(a):n.push(a));const u=e.matched[o];u&&(t.matched.find(l=>Nl(l,u))||r.push(u))}return[n,i,r]}const _2=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},fq={},dq={class:"p-10 flex-row"};function hq(e,t){return bc(),xc("div",dq,[...t[0]||(t[0]=[bt("h2",{class:"text-4xl font-bold"},"About Page",-1),bt("p",null," This project is in progress, currently the Ethics Application is not approved within our university, so we do not have real data, as our survey has not been distributed yet, you are witnessing results on fake data as we prepare for real entries! ",-1),bt("p",null," This Project is an extension of a separate project: AI-Driven Sentiment Analysis for Public Perception of Emerging Technologies. The previous project was discontinued, resulting in an altered scope. We are conducting research to better understand how Australians feel about the use of Artificial Intelligence (AI) in law enforcement and national security. We have conducted an online survey, and this repository is used to showcase the results, presenting both scaled-response data and an analysis of open-ended responses. ",-1),bt("h2",{class:"text-2xl font-bold"},"Our Recommendations",-1),bt("p",null,"TBD",-1)])])}const pq=_2(fq,[["render",hq]]),gq={},mq={class:"p-10 flex-row"};function yq(e,t){return bc(),xc("div",mq,[...t[0]||(t[0]=[bt("h2",{class:"text-4xl font-bold"},"Contact Page",-1),bt("p",null," Anika Kamleshwaran and Marcus Wei are both Software Engineering students at Monash University. This study is part of their final year project. ",-1),bt("p",null,"akam0020@student.monash.edu mwei0018@student.monash.edu",-1)])])}const vq=_2(gq,[["render",yq]]),bq=/("(?:[^\\"]|\\.)*")|[:,]/g;function Ny(e,t={}){const n=JSON.stringify([1],void 0,t.indent===void 0?2:t.indent).slice(2,-3),i=n===""?1/0:t.maxLength===void 0?80:t.maxLength;let{replacer:r}=t;return(function s(o,a,u){o&&typeof o.toJSON=="function"&&(o=o.toJSON());const l=JSON.stringify(o,r);if(l===void 0)return l;const c=i-a.length-u;if(l.length<=c){const f=l.replace(bq,(d,h)=>h||`${d} `);if(f.length<=c)return f}if(r!=null&&(o=JSON.parse(l),r=void 0),typeof o=="object"&&o!==null){const f=a+n,d=[];let h=0,p,g;if(Array.isArray(o)){p="[",g="]";const{length:m}=o;for(;h<m;h++)d.push(s(o[h],f,h===m-1?0:1)||"null")}else{p="{",g="}";const m=Object.keys(o),{length:y}=m;for(;h<y;h++){const v=m[h],b=`${JSON.stringify(v)}: `,x=s(o[v],f,b.length+(h===y-1?0:1));x!==void 0&&d.push(b+x)}}if(d.length>0)return[p,n+d.join(`,
${f}`),g].join(`
${a}`)}return l})(e,"",0)}function oi(e,t,n){return e.fields=t||[],e.fname=n,e}function St(e){return e==null?null:e.fname}function yn(e){return e==null?null:e.fields}function ID(e){return e.length===1?xq(e[0]):wq(e)}const xq=e=>function(t){return t[e]},wq=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function q(e){throw Error(e)}function ls(e){const t=[],n=e.length;let i=null,r=0,s="",o,a,u;e=e+"";function l(){t.push(s+e.substring(o,a)),s="",o=a+1}for(o=a=0;a<n;++a)if(u=e[a],u==="\\")s+=e.substring(o,a++),o=a;else if(u===i)l(),i=null,r=-1;else{if(i)continue;o===r&&u==='"'||o===r&&u==="'"?(o=a+1,i=u):u==="."&&!r?a>o?l():o=a+1:u==="["?(a>o&&l(),r=o=a+1):u==="]"&&(r||q("Access path missing open bracket: "+e),r>0&&l(),r=0,o=a+1)}return r&&q("Access path missing closing bracket: "+e),i&&q("Access path missing closing quote: "+e),a>o&&(a++,l()),t}function Ii(e,t,n){const i=ls(e);return e=i.length===1?i[0]:e,oi((n&&n.get||ID)(i),[e],t||e)}const ah=Ii("id"),_n=oi(e=>e,[],"identity"),Fo=oi(()=>0,[],"zero"),wc=oi(()=>1,[],"one"),Li=oi(()=>!0,[],"true"),vo=oi(()=>!1,[],"false");function _q(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const LD=0,E2=1,S2=2,zD=3,BD=4;function $2(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_q,i=e||LD;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=E2&&n(t||"error","ERROR",arguments),this},warn(){return i>=S2&&n(t||"warn","WARN",arguments),this},info(){return i>=zD&&n(t||"log","INFO",arguments),this},debug(){return i>=BD&&n(t||"log","DEBUG",arguments),this}}}var G=Array.isArray;function ae(e){return e===Object(e)}const BC=e=>e!=="__proto__";function _c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((i,r)=>{for(const s in r)if(s==="signals")i.signals=Eq(i.signals,r.signals);else{const o=s==="legend"?{layout:1}:s==="style"?!0:null;Ec(i,s,r[s],o)}return i},{})}function Ec(e,t,n,i){if(!BC(t))return;let r,s;if(ae(n)&&!G(n)){s=ae(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?Ec(s,r,n[r]):BC(r)&&(s[r]=n[r])}else e[t]=n}function Eq(e,t){if(e==null)return t;const n={},i=[];function r(s){n[s.name]||(n[s.name]=1,i.push(s))}return t.forEach(r),e.forEach(r),i}function ze(e){return e[e.length-1]}function pn(e){return e==null||e===""?null:+e}const UD=e=>t=>e*Math.exp(t),jD=e=>t=>Math.log(e*t),qD=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),WD=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Ag=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function m0(e,t,n,i){const r=n(e[0]),s=n(ze(e)),o=(s-r)*t;return[i(r-o),i(s-o)]}function HD(e,t){return m0(e,t,pn,_n)}function GD(e,t){var n=Math.sign(e[0]);return m0(e,t,jD(n),UD(n))}function VD(e,t,n){return m0(e,t,Ag(n),Ag(1/n))}function YD(e,t,n){return m0(e,t,qD(n),WD(n))}function y0(e,t,n,i,r){const s=i(e[0]),o=i(ze(e)),a=t!=null?i(t):(s+o)/2;return[r(a+(s-a)*n),r(a+(o-a)*n)]}function A2(e,t,n){return y0(e,t,n,pn,_n)}function C2(e,t,n){const i=Math.sign(e[0]);return y0(e,t,n,jD(i),UD(i))}function Cg(e,t,n,i){return y0(e,t,n,Ag(i),Ag(1/i))}function k2(e,t,n,i){return y0(e,t,n,qD(i),WD(i))}function XD(e){return 1+~~(new Date(e).getMonth()/3)}function KD(e){return 1+~~(new Date(e).getUTCMonth()/3)}function le(e){return e!=null?G(e)?e:[e]:[]}function QD(e,t,n){let i=e[0],r=e[1],s;return r<i&&(s=r,r=i,i=s),s=r-i,s>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-s),i+s]}function Te(e){return typeof e=="function"}const Sq="descending";function M2(e,t,n){n=n||{},t=le(t)||[];const i=[],r=[],s={},o=n.comparator||$q;return le(e).forEach((a,u)=>{a!=null&&(i.push(t[u]===Sq?-1:1),r.push(a=Te(a)?a:Ii(a,null,n)),(yn(a)||[]).forEach(l=>s[l]=1))}),r.length===0?null:oi(o(r,i),Object.keys(s))}const Sc=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),$q=(e,t)=>e.length===1?Aq(e[0],t[0]):Cq(e,t,e.length),Aq=(e,t)=>function(n,i){return Sc(e(n),e(i))*t},Cq=(e,t,n)=>(t.push(0),function(i,r){let s,o=0,a=-1;for(;o===0&&++a<n;)s=e[a],o=Sc(s(i),s(r));return o*t[a]});function En(e){return Te(e)?e:()=>e}function F2(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Fe(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function es(e,t){let n=0,i,r,s,o;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(s=o=r;n<i;++n)r=e[n],r!=null&&(r<s&&(s=r),r>o&&(o=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(s=o=r;n<i;++n)r=t(e[n]),r!=null&&(r<s&&(s=r),r>o&&(o=r))}return[s,o]}function JD(e,t){const n=e.length;let i=-1,r,s,o,a,u;if(t==null){for(;++i<n;)if(s=e[i],s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=e[i],s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}else{for(;++i<n;)if(s=t(e[i],i,e),s!=null&&s>=s){r=o=s;break}if(i===n)return[-1,-1];for(a=u=i;++i<n;)s=t(e[i],i,e),s!=null&&(r>s&&(r=s,a=i),o<s&&(o=s,u=i))}return[a,u]}function fe(e,t){return Object.hasOwn(e,t)}const np={};function $c(e){let t={},n;function i(s){return fe(t,s)&&t[s]!==np}const r={size:0,empty:0,object:t,has:i,get(s){return i(s)?t[s]:void 0},set(s,o){return i(s)||(++r.size,t[s]===np&&--r.empty),t[s]=o,this},delete(s){return i(s)&&(--r.size,++r.empty,t[s]=np),this},clear(){r.size=r.empty=0,r.object=t={}},test(s){return arguments.length?(n=s,r):n},clean(){const s={};let o=0;for(const a in t){const u=t[a];u!==np&&(!n||!n(u))&&(s[a]=u,++o)}r.size=o,r.empty=0,r.object=t=s}};return e&&Object.keys(e).forEach(s=>{r.set(s,e[s])}),r}function ZD(e,t,n,i,r,s){if(!n&&n!==0)return s;const o=+n;let a=e[0],u=ze(e),l;u<a&&(l=a,a=u,u=l),l=Math.abs(t-a);const c=Math.abs(u-t);return l<c&&l<=o?i:c<=o?r:s}function te(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Fe(i,n)}function dl(e,t,n,i){let r=t[0],s=t[t.length-1],o;return r>s&&(o=r,r=s,s=o),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=s:e<s)}function ua(e){return typeof e=="boolean"}function Uo(e){return Object.prototype.toString.call(e)==="[object Date]"}function eN(e){return e&&Te(e[Symbol.iterator])}function We(e){return typeof e=="number"}function T2(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function oe(e){return typeof e=="string"}function R2(e,t,n){e&&(e=t?le(e).map(a=>a.replace(/\\(.)/g,"$1")):le(e));const i=e&&e.length,r=n&&n.get||ID,s=a=>r(t?[a]:ls(a));let o;if(!i)o=function(){return""};else if(i===1){const a=s(e[0]);o=function(u){return""+a(u)}}else{const a=e.map(s);o=function(u){let l=""+a[0](u),c=0;for(;++c<i;)l+="|"+a[c](u);return l}}return oi(o,e,"key")}function tN(e,t){const n=e[0],i=ze(e),r=+t;return r?r===1?i:n+r*(i-n):n}const kq=1e4;function nN(e){e=+e||kq;let t,n,i;const r=()=>{t={},n={},i=0},s=(o,a)=>(++i>e&&(n=t,t={},i=1),t[o]=a);return r(),{clear:r,has:o=>fe(t,o)||fe(n,o),get:o=>fe(t,o)?t[o]:fe(n,o)?s(o,n[o]):void 0,set:(o,a)=>fe(t,o)?t[o]=a:s(o,a)}}function iN(e,t,n,i){const r=t.length,s=n.length;if(!s)return t;if(!r)return n;const o=i||new t.constructor(r+s);let a=0,u=0,l=0;for(;a<r&&u<s;++l)o[l]=e(t[a],n[u])>0?n[u++]:t[a++];for(;a<r;++a,++l)o[l]=t[a];for(;u<s;++u,++l)o[l]=n[u];return o}function Cf(e,t){let n="";for(;--t>=0;)n+=e;return n}function rN(e,t,n,i){const r=n||" ",s=e+"",o=t-s.length;return o<=0?s:i==="left"?Cf(r,o)+s:i==="center"?Cf(r,~~(o/2))+s+Cf(r,Math.ceil(o/2)):s+Cf(r,o)}function uh(e){return e&&ze(e)-e[0]||0}function ee(e){return G(e)?"["+e.map(ee)+"]":ae(e)||oe(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function O2(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Mq=e=>We(e)||Uo(e)?e:Date.parse(e);function D2(e,t){return t=t||Mq,e==null||e===""?null:t(e)}function N2(e){return e==null||e===""?null:e+""}function hr(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function sN(e,t,n,i){const r=i??"",s=e+"",o=s.length,a=Math.max(0,t-r.length);return o<=t?s:n==="left"?r+s.slice(o-a):n==="center"?s.slice(0,Math.ceil(a/2))+r+s.slice(o-~~(a/2)):s.slice(0,a)+r}function So(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const s=t(e[r]);s&&n(s,r,e)}}else e.forEach(n)}var UC={},Py={},Iy=34,Jc=10,Ly=13;function oN(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Fq(e,t){var n=oN(e);return function(i,r){return t(n(i),r,e)}}function jC(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Gn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function Tq(e){return e<0?"-"+Gn(-e,6):e>9999?"+"+Gn(e,6):Gn(e,4)}function Rq(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Tq(e.getUTCFullYear())+"-"+Gn(e.getUTCMonth()+1,2)+"-"+Gn(e.getUTCDate(),2)+(r?"T"+Gn(t,2)+":"+Gn(n,2)+":"+Gn(i,2)+"."+Gn(r,3)+"Z":i?"T"+Gn(t,2)+":"+Gn(n,2)+":"+Gn(i,2)+"Z":n||t?"T"+Gn(t,2)+":"+Gn(n,2)+"Z":"")}function Oq(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,p,g=r(f,function(m,y){if(h)return h(m,y-1);p=m,h=d?Fq(m,d):oN(m)});return g.columns=p||[],g}function r(f,d){var h=[],p=f.length,g=0,m=0,y,v=p<=0,b=!1;f.charCodeAt(p-1)===Jc&&--p,f.charCodeAt(p-1)===Ly&&--p;function x(){if(v)return Py;if(b)return b=!1,UC;var E,_=g,$;if(f.charCodeAt(_)===Iy){for(;g++<p&&f.charCodeAt(g)!==Iy||f.charCodeAt(++g)===Iy;);return(E=g)>=p?v=!0:($=f.charCodeAt(g++))===Jc?b=!0:$===Ly&&(b=!0,f.charCodeAt(g)===Jc&&++g),f.slice(_+1,E-1).replace(/""/g,'"')}for(;g<p;){if(($=f.charCodeAt(E=g++))===Jc)b=!0;else if($===Ly)b=!0,f.charCodeAt(g)===Jc&&++g;else if($!==n)continue;return f.slice(_,E)}return v=!0,f.slice(_,p)}for(;(y=x())!==Py;){for(var w=[];y!==UC&&y!==Py;)w.push(y),y=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function s(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=jC(f)),[d.map(c).join(e)].concat(s(f,d)).join(`
`)}function a(f,d){return d==null&&(d=jC(f)),s(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?Rq(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:o,formatBody:a,formatRows:u,formatRow:l,formatValue:c}}function Dq(e){return e}function Nq(e){if(e==null)return Dq;var t,n,i=e.scale[0],r=e.scale[1],s=e.translate[0],o=e.translate[1];return function(a,u){u||(t=n=0);var l=2,c=a.length,f=new Array(c);for(f[0]=(t+=a[0])*i+s,f[1]=(n+=a[1])*r+o;l<c;)f[l]=a[l],++l;return f}}function Pq(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function Iq(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return qC(e,n)})}:qC(e,t)}function qC(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,s=aN(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function aN(e,t){var n=Nq(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&Pq(f,p)}function s(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function a(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(a)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=s(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(s);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function Lq(e,t){var n={},i={},r={},s=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=a(l),f=c[0],d=c[1],h,p;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,p=i[d]){delete i[p.start];var g=p===h?h:h.concat(p);i[g.start=h.start]=r[g.end=p.end]=g}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,p=r[f]){delete r[p.end];var m=p===h?h:p.concat(h);i[m.start=p.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function a(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),s.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||s.push([l])}),s}function zq(e){return aN(e,Bq.apply(this,arguments))}function Bq(e,t,n){var i,r,s;if(arguments.length>1)i=Uq(e,t,n);else for(r=0,i=new Array(s=e.arcs.length);r<s;++r)i[r]=r;return{type:"MultiLineString",arcs:Lq(e,i)}}function Uq(e,t,n){var i=[],r=[],s;function o(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:s})}function a(f){f.forEach(o)}function u(f){f.forEach(a)}function l(f){f.forEach(u)}function c(f){switch(s=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":a(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function qs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jq(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ac(e){let t,n,i;e.length!==2?(t=qs,n=(a,u)=>qs(e(a),u),i=(a,u)=>e(a)-u):(t=e===qs||e===jq?e:qq,n=e,i=e);function r(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<0?l=f+1:c=f}while(l<c)}return l}function s(a,u,l=0,c=a.length){if(l<c){if(t(u,u)!==0)return c;do{const f=l+c>>>1;n(a[f],u)<=0?l=f+1:c=f}while(l<c)}return l}function o(a,u,l=0,c=a.length){const f=r(a,u,l,c-1);return f>l&&i(a[f-1],u)>-i(a[f],u)?f-1:f}return{left:r,center:o,right:s}}function qq(){return 0}function uN(e){return e===null?NaN:+e}function*Wq(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const lN=Ac(qs),Vo=lN.right,Hq=lN.left;Ac(uN).center;function Gq(e,t){let n=0,i,r=0,s=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,s+=i*(o-r));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,s+=i*(a-r))}if(n>1)return s/(n-1)}function Vq(e,t){const n=Gq(e,t);return n&&Math.sqrt(n)}class In{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=n[r],o=t+s,a=Math.abs(t)<Math.abs(s)?t-(o-s):s-(o-t);a&&(n[i++]=a),t=o}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,s,o=0;if(n>0){for(o=t[--n];n>0&&(i=o,r=t[--n],o=i+r,s=r-(o-i),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}class WC extends Map{constructor(t,n=dN){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,r]of t)this.set(i,r)}get(t){return super.get(zb(this,t))}has(t){return super.has(zb(this,t))}set(t,n){return super.set(cN(this,t),n)}delete(t){return super.delete(fN(this,t))}}class kg extends Set{constructor(t,n=dN){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const i of t)this.add(i)}has(t){return super.has(zb(this,t))}add(t){return super.add(cN(this,t))}delete(t){return super.delete(fN(this,t))}}function zb({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function cN({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function fN({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function dN(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Yq(e,t){return Array.from(t,n=>e[n])}function Xq(e=qs){if(e===qs)return hN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function hN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Kq=Math.sqrt(50),Qq=Math.sqrt(10),Jq=Math.sqrt(2);function Mg(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=Kq?10:s>=Qq?5:s>=Jq?2:1;let a,u,l;return r<0?(l=Math.pow(10,-r)/o,a=Math.round(e*l),u=Math.round(t*l),a/l<e&&++a,u/l>t&&--u,l=-l):(l=Math.pow(10,r)*o,a=Math.round(e/l),u=Math.round(t/l),a*l<e&&++a,u*l>t&&--u),u<a&&.5<=n&&n<2?Mg(e,t,n*2):[a,u,l]}function Bb(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[r,s,o]=i?Mg(t,e,n):Mg(e,t,n);if(!(s>=r))return[];const a=s-r+1,u=new Array(a);if(i)if(o<0)for(let l=0;l<a;++l)u[l]=(s-l)/-o;else for(let l=0;l<a;++l)u[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)u[l]=(r+l)/-o;else for(let l=0;l<a;++l)u[l]=(r+l)*o;return u}function Ub(e,t,n){return t=+t,e=+e,n=+n,Mg(e,t,n)[2]}function Yo(e,t,n){t=+t,e=+e,n=+n;const i=t<e,r=i?Ub(t,e,n):Ub(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function Ka(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function jb(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function pN(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=r===void 0?hN:Xq(r);i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(i,Math.floor(t+(u-l)*f/u+d));pN(e,t,h,p,r)}const s=e[t];let o=n,a=i;for(Zc(e,n,t),r(e[i],s)>0&&Zc(e,n,i);o<a;){for(Zc(e,o,a),++o,--a;r(e[o],s)<0;)++o;for(;r(e[a],s)>0;)--a}r(e[n],s)===0?Zc(e,n,a):(++a,Zc(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function Zc(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function qb(e,t,n){if(e=Float64Array.from(Wq(e,n)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return jb(e);if(t>=1)return Ka(e);var i,r=(i-1)*t,s=Math.floor(r),o=Ka(pN(e,s).subarray(0,s+1)),a=jb(e.subarray(s+1));return o+(a-o)*(r-s)}}function gN(e,t,n=uN){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,s=Math.floor(r),o=+n(e[s],s,e),a=+n(e[s+1],s+1,e);return o+(a-o)*(r-s)}}function Zq(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&(++n,i+=s)}if(n)return i/n}function mN(e,t){return qb(e,.5,t)}function*eW(e){for(const t of e)yield*t}function yN(e){return Array.from(eW(e))}function gi(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(r);++i<r;)s[i]=e+i*n;return s}function vN(e,t){let n=0;for(let i of e)(i=+i)&&(n+=i);return n}function tW(e,...t){e=new kg(e),t=t.map(nW);e:for(const n of e)for(const i of t)if(!i.has(n)){e.delete(n);continue e}return e}function nW(e){return e instanceof kg?e:new kg(e)}function iW(...e){const t=new kg;for(const n of e)for(const i of n)t.add(i);return t}function rW(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Fg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Il(e){return e=Fg(Math.abs(e)),e?e[1]:NaN}function sW(e,t){return function(n,i){for(var r=n.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(t)}}function oW(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var aW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function au(e){if(!(t=aW.exec(e)))throw new Error("invalid format: "+e);var t;return new P2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}au.prototype=P2.prototype;function P2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}P2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uW(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var bN;function lW(e,t){var n=Fg(e,t);if(!n)return e+"";var i=n[0],r=n[1],s=r-(bN=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Fg(e,Math.max(0,t+s-1))[0]}function HC(e,t){var n=Fg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const GC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rW,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>HC(e*100,t),r:HC,s:lW,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function VC(e){return e}var YC=Array.prototype.map,XC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function xN(e){var t=e.grouping===void 0||e.thousands===void 0?VC:sW(YC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?VC:oW(YC.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=au(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,y=f.width,v=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(v=!0,w="g"):GC[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=g==="$"?i:/[%p]/.test(w)?o:"",$=GC[w],A=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function F(M){var P=E,D=_,O,C,R;if(w==="c")D=$(M)+D,M="";else{M=+M;var N=M<0||1/M<0;if(M=isNaN(M)?u:$(Math.abs(M),b),x&&(M=uW(M)),N&&+M==0&&p!=="+"&&(N=!1),P=(N?p==="("?p:a:p==="-"||p==="("?"":p)+P,D=(w==="s"?XC[8+bN/3]:"")+D+(N&&p==="("?")":""),A){for(O=-1,C=M.length;++O<C;)if(R=M.charCodeAt(O),48>R||R>57){D=(R===46?r+M.slice(O+1):M.slice(O))+D,M=M.slice(0,O);break}}}v&&!m&&(M=t(M,1/0));var I=P.length+M.length+D.length,U=I<y?new Array(y-I+1).join(d):"";switch(v&&m&&(M=t(U+M,U.length?y-D.length:1/0),U=""),h){case"<":M=P+M+D+U;break;case"=":M=P+U+M+D;break;case"^":M=U.slice(0,I=U.length>>1)+P+M+D+U.slice(I);break;default:M=U+P+M+D;break}return s(M)}return F.toString=function(){return f+""},F}function c(f,d){var h=l((f=au(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Il(d)/3)))*3,g=Math.pow(10,-p),m=XC[8+p/3];return function(y){return h(g*y)+m}}return{format:l,formatPrefix:c}}var ip,v0,I2;cW({thousands:",",grouping:[3],currency:["$",""]});function cW(e){return ip=xN(e),v0=ip.format,I2=ip.formatPrefix,ip}function wN(e){return Math.max(0,-Il(Math.abs(e)))}function _N(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Il(t)/3)))*3-Il(Math.abs(e)))}function EN(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Il(t)-Il(e))+1}const zy=new Date,By=new Date;function It(e,t,n,i){function r(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(e(s=new Date(+s)),s),r.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),r.round=s=>{const o=r(s),a=r.ceil(s);return s-o<a-s?o:a},r.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),r.range=(s,o,a)=>{const u=[];if(s=r.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return u;let l;do u.push(l=new Date(+s)),t(s,a),e(s);while(l<s&&s<o);return u},r.filter=s=>It(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),n&&(r.count=(s,o)=>(zy.setTime(+s),By.setTime(+o),e(zy),e(By),Math.floor(n(zy,By))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(i?o=>i(o)%s===0:o=>r.count(0,o)%s===0):r)),r}const Ll=It(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ll.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?It(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Ll);Ll.range;const Ps=1e3,Fi=Ps*60,Is=Fi*60,Zs=Is*24,L2=Zs*7,KC=Zs*30,Uy=Zs*365,Ls=It(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getUTCSeconds());Ls.range;const b0=It(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ps)},(e,t)=>{e.setTime(+e+t*Fi)},(e,t)=>(t-e)/Fi,e=>e.getMinutes());b0.range;const x0=It(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Fi)},(e,t)=>(t-e)/Fi,e=>e.getUTCMinutes());x0.range;const w0=It(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ps-e.getMinutes()*Fi)},(e,t)=>{e.setTime(+e+t*Is)},(e,t)=>(t-e)/Is,e=>e.getHours());w0.range;const _0=It(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Is)},(e,t)=>(t-e)/Is,e=>e.getUTCHours());_0.range;const Ws=It(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fi)/Zs,e=>e.getDate()-1);Ws.range;const jo=It(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Zs,e=>e.getUTCDate()-1);jo.range;const SN=It(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Zs,e=>Math.floor(e/Zs));SN.range;function Fu(e){return It(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fi)/L2)}const Cc=Fu(0),Tg=Fu(1),fW=Fu(2),dW=Fu(3),zl=Fu(4),hW=Fu(5),pW=Fu(6);Cc.range;Tg.range;fW.range;dW.range;zl.range;hW.range;pW.range;function Tu(e){return It(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/L2)}const kc=Tu(0),Rg=Tu(1),gW=Tu(2),mW=Tu(3),Bl=Tu(4),yW=Tu(5),vW=Tu(6);kc.range;Rg.range;gW.range;mW.range;Bl.range;yW.range;vW.range;const kd=It(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kd.range;const Md=It(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Md.range;const ts=It(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:It(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});ts.range;const ns=It(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ns.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:It(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});ns.range;function $N(e,t,n,i,r,s){const o=[[Ls,1,Ps],[Ls,5,5*Ps],[Ls,15,15*Ps],[Ls,30,30*Ps],[s,1,Fi],[s,5,5*Fi],[s,15,15*Fi],[s,30,30*Fi],[r,1,Is],[r,3,3*Is],[r,6,6*Is],[r,12,12*Is],[i,1,Zs],[i,2,2*Zs],[n,1,L2],[t,1,KC],[t,3,3*KC],[e,1,Uy]];function a(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=Ac(([,,m])=>m).right(o,d);if(h===o.length)return e.every(Yo(l/Uy,c/Uy,f));if(h===0)return Ll.every(Math.max(Yo(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[a,u]}const[bW,xW]=$N(ns,Md,kc,SN,_0,x0),[wW,_W]=$N(ts,kd,Cc,Ws,w0,b0),nn="year",ei="quarter",vn="month",Dt="week",ti="date",hn="day",is="dayofyear",_i="hours",Ei="minutes",zi="seconds",pr="milliseconds",z2=[nn,ei,vn,Dt,ti,hn,is,_i,Ei,zi,pr],jy=z2.reduce((e,t,n)=>(e[t]=1+n,e),{});function B2(e){const t=le(e).slice(),n={};return t.length||q("Missing time unit."),t.forEach(r=>{fe(jy,r)?n[r]=1:q(`Invalid time unit: ${r}.`)}),(n[Dt]||n[hn]?1:0)+(n[ei]||n[vn]||n[ti]?1:0)+(n[is]?1:0)>1&&q(`Incompatible time units: ${e}`),t.sort((r,s)=>jy[r]-jy[s]),t}const EW={[nn]:"%Y ",[ei]:"Q%q ",[vn]:"%b ",[ti]:"%d ",[Dt]:"W%U ",[hn]:"%a ",[is]:"%j ",[_i]:"%H:00",[Ei]:"00:%M",[zi]:":%S",[pr]:".%L",[`${nn}-${vn}`]:"%Y-%m ",[`${nn}-${vn}-${ti}`]:"%Y-%m-%d ",[`${_i}-${Ei}`]:"%H:%M"};function AN(e,t){const n=Fe({},EW,t),i=B2(e),r=i.length;let s="",o=0,a,u;for(o=0;o<r;)for(a=i.length;a>o;--a)if(u=i.slice(o,a).join("-"),n[u]!=null){s+=n[u],o=a;break}return s.trim()}const Ba=new Date;function U2(e){return Ba.setFullYear(e),Ba.setMonth(0),Ba.setDate(1),Ba.setHours(0,0,0,0),Ba}function CN(e){return MN(new Date(e))}function kN(e){return Wb(new Date(e))}function MN(e){return Ws.count(U2(e.getFullYear())-1,e)}function Wb(e){return Cc.count(U2(e.getFullYear())-1,e)}function Hb(e){return U2(e).getDay()}function SW(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(-1,t,n,i,r,s,o);return a.setFullYear(e),a}return new Date(e,t,n,i,r,s,o)}function FN(e){return RN(new Date(e))}function TN(e){return Gb(new Date(e))}function RN(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return jo.count(t-1,e)}function Gb(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return kc.count(t-1,e)}function Vb(e){return Ba.setTime(Date.UTC(e,0,1)),Ba.getUTCDay()}function $W(e,t,n,i,r,s,o){if(0<=e&&e<100){const a=new Date(Date.UTC(-1,t,n,i,r,s,o));return a.setUTCFullYear(n.y),a}return new Date(Date.UTC(e,t,n,i,r,s,o))}function ON(e,t,n,i,r){const s=t||1,o=ze(e),a=(y,v,b)=>(b=b||y,AW(n[b],i[b],y===o&&s,v)),u=new Date,l=hr(e),c=l[nn]?a(nn):En(2012),f=l[vn]?a(vn):l[ei]?a(ei):Fo,d=l[Dt]&&l[hn]?a(hn,1,Dt+hn):l[Dt]?a(Dt,1):l[hn]?a(hn,1):l[ti]?a(ti,1):l[is]?a(is,1):wc,h=l[_i]?a(_i):Fo,p=l[Ei]?a(Ei):Fo,g=l[zi]?a(zi):Fo,m=l[pr]?a(pr):Fo;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),p(u),g(u),m(u))}}function AW(e,t,n,i){const r=n<=1?e:i?(s,o)=>i+n*Math.floor((e(s,o)-i)/n):(s,o)=>n*Math.floor(e(s,o)/n);return t?(s,o)=>t(r(s,o),o):r}function Ul(e,t,n){return t+e*7-(n+6)%7}const CW={[nn]:e=>e.getFullYear(),[ei]:e=>Math.floor(e.getMonth()/3),[vn]:e=>e.getMonth(),[ti]:e=>e.getDate(),[_i]:e=>e.getHours(),[Ei]:e=>e.getMinutes(),[zi]:e=>e.getSeconds(),[pr]:e=>e.getMilliseconds(),[is]:e=>MN(e),[Dt]:e=>Wb(e),[Dt+hn]:(e,t)=>Ul(Wb(e),e.getDay(),Hb(t)),[hn]:(e,t)=>Ul(1,e.getDay(),Hb(t))},kW={[ei]:e=>3*e,[Dt]:(e,t)=>Ul(e,0,Hb(t))};function DN(e,t){return ON(e,t||1,CW,kW,SW)}const MW={[nn]:e=>e.getUTCFullYear(),[ei]:e=>Math.floor(e.getUTCMonth()/3),[vn]:e=>e.getUTCMonth(),[ti]:e=>e.getUTCDate(),[_i]:e=>e.getUTCHours(),[Ei]:e=>e.getUTCMinutes(),[zi]:e=>e.getUTCSeconds(),[pr]:e=>e.getUTCMilliseconds(),[is]:e=>RN(e),[Dt]:e=>Gb(e),[hn]:(e,t)=>Ul(1,e.getUTCDay(),Vb(t)),[Dt+hn]:(e,t)=>Ul(Gb(e),e.getUTCDay(),Vb(t))},FW={[ei]:e=>3*e,[Dt]:(e,t)=>Ul(e,0,Vb(t))};function NN(e,t){return ON(e,t||1,MW,FW,$W)}const TW={[nn]:ts,[ei]:kd.every(3),[vn]:kd,[Dt]:Cc,[ti]:Ws,[hn]:Ws,[is]:Ws,[_i]:w0,[Ei]:b0,[zi]:Ls,[pr]:Ll},RW={[nn]:ns,[ei]:Md.every(3),[vn]:Md,[Dt]:kc,[ti]:jo,[hn]:jo,[is]:jo,[_i]:_0,[Ei]:x0,[zi]:Ls,[pr]:Ll};function Mc(e){return TW[e]}function Fc(e){return RW[e]}function PN(e,t,n){return e?e.offset(t,n):void 0}function IN(e,t,n){return PN(Mc(e),t,n)}function LN(e,t,n){return PN(Fc(e),t,n)}function zN(e,t,n,i){return e?e.range(t,n,i):void 0}function BN(e,t,n,i){return zN(Mc(e),t,n,i)}function UN(e,t,n,i){return zN(Fc(e),t,n,i)}const kf=1e3,Mf=kf*60,Ff=Mf*60,E0=Ff*24,OW=E0*7,QC=E0*30,Yb=E0*365,jN=[nn,vn,ti,_i,Ei,zi,pr],Tf=jN.slice(0,-1),Rf=Tf.slice(0,-1),Of=Rf.slice(0,-1),DW=Of.slice(0,-1),NW=[nn,Dt],JC=[nn,vn],qN=[nn],ef=[[Tf,1,kf],[Tf,5,5*kf],[Tf,15,15*kf],[Tf,30,30*kf],[Rf,1,Mf],[Rf,5,5*Mf],[Rf,15,15*Mf],[Rf,30,30*Mf],[Of,1,Ff],[Of,3,3*Ff],[Of,6,6*Ff],[Of,12,12*Ff],[DW,1,E0],[NW,1,OW],[JC,1,QC],[JC,3,3*QC],[qN,1,Yb]];function WN(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(uh(t))/n;let r=Ac(a=>a[2]).right(ef,i),s,o;return r===ef.length?(s=qN,o=Yo(t[0]/Yb,t[1]/Yb,n)):r?(r=ef[i/ef[r-1][2]<ef[r][2]/i?r-1:r],s=r[0],o=r[1]):(s=jN,o=Math.max(Yo(t[0],t[1],n),1)),{units:s,step:o}}function qy(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Wy(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function tf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function HN(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,s=e.days,o=e.shortDays,a=e.months,u=e.shortMonths,l=nf(r),c=rf(r),f=nf(s),d=rf(s),h=nf(o),p=rf(o),g=nf(a),m=rf(a),y=nf(u),v=rf(u),b={a:N,A:I,b:U,B:re,c:null,d:rk,e:rk,f:rH,g:pH,G:mH,H:tH,I:nH,j:iH,L:GN,m:sH,M:oH,p:me,q:de,Q:ak,s:uk,S:aH,u:uH,U:lH,V:cH,w:fH,W:dH,x:null,X:null,y:hH,Y:gH,Z:yH,"%":ok},x={a:$e,A:Be,b:Ae,B:et,c:null,d:sk,e:sk,f:wH,g:TH,G:OH,H:vH,I:bH,j:xH,L:YN,m:_H,M:EH,p:V,q:ce,Q:ak,s:uk,S:SH,u:$H,U:AH,V:CH,w:kH,W:MH,x:null,X:null,y:FH,Y:RH,Z:DH,"%":ok},w={a:F,A:M,b:P,B:D,c:O,d:nk,e:nk,f:QW,g:tk,G:ek,H:ik,I:ik,j:VW,L:KW,m:GW,M:YW,p:A,q:HW,Q:ZW,s:eH,S:XW,u:BW,U:UW,V:jW,w:zW,W:qW,x:C,X:R,y:tk,Y:ek,Z:WW,"%":JW};b.x=E(n,b),b.X=E(i,b),b.c=E(t,b),x.x=E(n,x),x.X=E(i,x),x.c=E(t,x);function E(L,X){return function(pe){var S=[],k=-1,T=0,B=L.length,H,W,ue;for(pe instanceof Date||(pe=new Date(+pe));++k<B;)L.charCodeAt(k)===37&&(S.push(L.slice(T,k)),(W=ZC[H=L.charAt(++k)])!=null?H=L.charAt(++k):W=H==="e"?" ":"0",(ue=X[H])&&(H=ue(pe,W)),S.push(H),T=k+1);return S.push(L.slice(T,k)),S.join("")}}function _(L,X){return function(pe){var S=tf(1900,void 0,1),k=$(S,L,pe+="",0),T,B;if(k!=pe.length)return null;if("Q"in S)return new Date(S.Q);if("s"in S)return new Date(S.s*1e3+("L"in S?S.L:0));if(X&&!("Z"in S)&&(S.Z=0),"p"in S&&(S.H=S.H%12+S.p*12),S.m===void 0&&(S.m="q"in S?S.q:0),"V"in S){if(S.V<1||S.V>53)return null;"w"in S||(S.w=1),"Z"in S?(T=Wy(tf(S.y,0,1)),B=T.getUTCDay(),T=B>4||B===0?Rg.ceil(T):Rg(T),T=jo.offset(T,(S.V-1)*7),S.y=T.getUTCFullYear(),S.m=T.getUTCMonth(),S.d=T.getUTCDate()+(S.w+6)%7):(T=qy(tf(S.y,0,1)),B=T.getDay(),T=B>4||B===0?Tg.ceil(T):Tg(T),T=Ws.offset(T,(S.V-1)*7),S.y=T.getFullYear(),S.m=T.getMonth(),S.d=T.getDate()+(S.w+6)%7)}else("W"in S||"U"in S)&&("w"in S||(S.w="u"in S?S.u%7:"W"in S?1:0),B="Z"in S?Wy(tf(S.y,0,1)).getUTCDay():qy(tf(S.y,0,1)).getDay(),S.m=0,S.d="W"in S?(S.w+6)%7+S.W*7-(B+5)%7:S.w+S.U*7-(B+6)%7);return"Z"in S?(S.H+=S.Z/100|0,S.M+=S.Z%100,Wy(S)):qy(S)}}function $(L,X,pe,S){for(var k=0,T=X.length,B=pe.length,H,W;k<T;){if(S>=B)return-1;if(H=X.charCodeAt(k++),H===37){if(H=X.charAt(k++),W=w[H in ZC?X.charAt(k++):H],!W||(S=W(L,pe,S))<0)return-1}else if(H!=pe.charCodeAt(S++))return-1}return S}function A(L,X,pe){var S=l.exec(X.slice(pe));return S?(L.p=c.get(S[0].toLowerCase()),pe+S[0].length):-1}function F(L,X,pe){var S=h.exec(X.slice(pe));return S?(L.w=p.get(S[0].toLowerCase()),pe+S[0].length):-1}function M(L,X,pe){var S=f.exec(X.slice(pe));return S?(L.w=d.get(S[0].toLowerCase()),pe+S[0].length):-1}function P(L,X,pe){var S=y.exec(X.slice(pe));return S?(L.m=v.get(S[0].toLowerCase()),pe+S[0].length):-1}function D(L,X,pe){var S=g.exec(X.slice(pe));return S?(L.m=m.get(S[0].toLowerCase()),pe+S[0].length):-1}function O(L,X,pe){return $(L,t,X,pe)}function C(L,X,pe){return $(L,n,X,pe)}function R(L,X,pe){return $(L,i,X,pe)}function N(L){return o[L.getDay()]}function I(L){return s[L.getDay()]}function U(L){return u[L.getMonth()]}function re(L){return a[L.getMonth()]}function me(L){return r[+(L.getHours()>=12)]}function de(L){return 1+~~(L.getMonth()/3)}function $e(L){return o[L.getUTCDay()]}function Be(L){return s[L.getUTCDay()]}function Ae(L){return u[L.getUTCMonth()]}function et(L){return a[L.getUTCMonth()]}function V(L){return r[+(L.getUTCHours()>=12)]}function ce(L){return 1+~~(L.getUTCMonth()/3)}return{format:function(L){var X=E(L+="",b);return X.toString=function(){return L},X},parse:function(L){var X=_(L+="",!1);return X.toString=function(){return L},X},utcFormat:function(L){var X=E(L+="",x);return X.toString=function(){return L},X},utcParse:function(L){var X=_(L+="",!0);return X.toString=function(){return L},X}}}var ZC={"-":"",_:" ",0:"0"},Yt=/^\s*\d+/,PW=/^%/,IW=/[\\^$*+?|[\]().{}]/g;function He(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",s=r.length;return i+(s<n?new Array(n-s+1).join(t)+r:r)}function LW(e){return e.replace(IW,"\\$&")}function nf(e){return new RegExp("^(?:"+e.map(LW).join("|")+")","i")}function rf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function zW(e,t,n){var i=Yt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function BW(e,t,n){var i=Yt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function UW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function jW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function qW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function ek(e,t,n){var i=Yt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function tk(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function WW(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function HW(e,t,n){var i=Yt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function GW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function nk(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function VW(e,t,n){var i=Yt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function ik(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function YW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function XW(e,t,n){var i=Yt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function KW(e,t,n){var i=Yt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function QW(e,t,n){var i=Yt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function JW(e,t,n){var i=PW.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function ZW(e,t,n){var i=Yt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function eH(e,t,n){var i=Yt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function rk(e,t){return He(e.getDate(),t,2)}function tH(e,t){return He(e.getHours(),t,2)}function nH(e,t){return He(e.getHours()%12||12,t,2)}function iH(e,t){return He(1+Ws.count(ts(e),e),t,3)}function GN(e,t){return He(e.getMilliseconds(),t,3)}function rH(e,t){return GN(e,t)+"000"}function sH(e,t){return He(e.getMonth()+1,t,2)}function oH(e,t){return He(e.getMinutes(),t,2)}function aH(e,t){return He(e.getSeconds(),t,2)}function uH(e){var t=e.getDay();return t===0?7:t}function lH(e,t){return He(Cc.count(ts(e)-1,e),t,2)}function VN(e){var t=e.getDay();return t>=4||t===0?zl(e):zl.ceil(e)}function cH(e,t){return e=VN(e),He(zl.count(ts(e),e)+(ts(e).getDay()===4),t,2)}function fH(e){return e.getDay()}function dH(e,t){return He(Tg.count(ts(e)-1,e),t,2)}function hH(e,t){return He(e.getFullYear()%100,t,2)}function pH(e,t){return e=VN(e),He(e.getFullYear()%100,t,2)}function gH(e,t){return He(e.getFullYear()%1e4,t,4)}function mH(e,t){var n=e.getDay();return e=n>=4||n===0?zl(e):zl.ceil(e),He(e.getFullYear()%1e4,t,4)}function yH(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+He(t/60|0,"0",2)+He(t%60,"0",2)}function sk(e,t){return He(e.getUTCDate(),t,2)}function vH(e,t){return He(e.getUTCHours(),t,2)}function bH(e,t){return He(e.getUTCHours()%12||12,t,2)}function xH(e,t){return He(1+jo.count(ns(e),e),t,3)}function YN(e,t){return He(e.getUTCMilliseconds(),t,3)}function wH(e,t){return YN(e,t)+"000"}function _H(e,t){return He(e.getUTCMonth()+1,t,2)}function EH(e,t){return He(e.getUTCMinutes(),t,2)}function SH(e,t){return He(e.getUTCSeconds(),t,2)}function $H(e){var t=e.getUTCDay();return t===0?7:t}function AH(e,t){return He(kc.count(ns(e)-1,e),t,2)}function XN(e){var t=e.getUTCDay();return t>=4||t===0?Bl(e):Bl.ceil(e)}function CH(e,t){return e=XN(e),He(Bl.count(ns(e),e)+(ns(e).getUTCDay()===4),t,2)}function kH(e){return e.getUTCDay()}function MH(e,t){return He(Rg.count(ns(e)-1,e),t,2)}function FH(e,t){return He(e.getUTCFullYear()%100,t,2)}function TH(e,t){return e=XN(e),He(e.getUTCFullYear()%100,t,2)}function RH(e,t){return He(e.getUTCFullYear()%1e4,t,4)}function OH(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Bl(e):Bl.ceil(e),He(e.getUTCFullYear()%1e4,t,4)}function DH(){return"+0000"}function ok(){return"%"}function ak(e){return+e}function uk(e){return Math.floor(+e/1e3)}var Xu,j2,KN,q2,QN;NH({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function NH(e){return Xu=HN(e),j2=Xu.format,KN=Xu.parse,q2=Xu.utcFormat,QN=Xu.utcParse,Xu}function Df(e){const t={};return n=>t[n]||(t[n]=e(n))}function PH(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let s=IH(i,r);const o=s<i.length?i.slice(s):"";for(;--s>r;)if(i[s]!=="0"){++s;break}return i.slice(0,s)+o}}function IH(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function JN(e){const t=Df(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=au(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return PH(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,s,o){o=au(o??",f");const a=Yo(i,r,s),u=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=_N(a,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=EN(a,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=wN(a))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let Xb;ZN();function ZN(){return Xb=JN({format:v0,formatPrefix:I2})}function e3(e){return JN(xN(e))}function Og(e){return arguments.length?Xb=e3(e):Xb}function lk(e,t,n){n=n||{},ae(n)||q(`Invalid time multi-format specifier: ${n}`);const i=t(zi),r=t(Ei),s=t(_i),o=t(ti),a=t(Dt),u=t(vn),l=t(ei),c=t(nn),f=e(n[pr]||".%L"),d=e(n[zi]||":%S"),h=e(n[Ei]||"%I:%M"),p=e(n[_i]||"%I %p"),g=e(n[ti]||n[hn]||"%a %d"),m=e(n[Dt]||"%b %d"),y=e(n[vn]||"%B"),v=e(n[ei]||"%B"),b=e(n[nn]||"%Y");return x=>(i(x)<x?f:r(x)<x?d:s(x)<x?h:o(x)<x?p:u(x)<x?a(x)<x?g:m:c(x)<x?l(x)<x?y:v:b)(x)}function t3(e){const t=Df(e.format),n=Df(e.utcFormat);return{timeFormat:i=>oe(i)?t(i):lk(t,Mc,i),utcFormat:i=>oe(i)?n(i):lk(n,Fc,i),timeParse:Df(e.parse),utcParse:Df(e.utcParse)}}let Kb;n3();function n3(){return Kb=t3({format:j2,parse:KN,utcFormat:q2,utcParse:QN})}function i3(e){return t3(HN(e))}function Fd(e){return arguments.length?Kb=i3(e):Kb}const Qb=(e,t)=>Fe({},e,t);function r3(e,t){const n=e?e3(e):Og(),i=t?i3(t):Fd();return Qb(n,i)}function W2(e,t){const n=arguments.length;return n&&n!==2&&q("defaultLocale expects either zero or two arguments."),n?Qb(Og(e),Fd(t)):Qb(Og(),Fd())}function LH(){return ZN(),n3(),W2()}const zH=/^(data:|([A-Za-z]+:)?\/\/)/,BH=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,UH=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ck="file://";function jH(e,t){return n=>({options:n||{},sanitize:WH,load:qH,fileAccess:!1,file:HH(),http:VH(e)})}async function qH(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function WH(e,t){t=Fe({},this.options,t);const n=this.fileAccess,i={href:null};let r,s,o;const a=BH.test(e.replace(UH,""));(e==null||typeof e!="string"||!a)&&q("Sanitize failure, invalid URI: "+ee(e));const u=zH.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&!o.endsWith("/")&&(e="/"+e),e=o+e),s=(r=e.startsWith(ck))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(ck.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),s=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!s}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function HH(e){return GH}async function GH(){q("No file system access.")}function VH(e){return e?async function(t,n){const i=Fe({},this.options.http,n),r=n&&n.response,s=await e(t,i);return s.ok?Te(s[r])?s[r]():s.text():q(s.status+""+s.statusText)}:YH}async function YH(){q("No HTTP fetch method available.")}const XH=e=>e!=null&&e===e,KH=e=>e==="true"||e==="false"||e===!0||e===!1,QH=e=>!Number.isNaN(Date.parse(e)),s3=e=>!Number.isNaN(+e)&&!(e instanceof Date),JH=e=>s3(e)&&Number.isInteger(+e),Jb={boolean:O2,integer:pn,number:pn,date:D2,string:N2,unknown:_n},rp=[KH,JH,s3,QH],ZH=["boolean","integer","number","date"];function o3(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=rp.length,r=rp.map((s,o)=>o+1);for(let s=0,o=0,a,u;s<n;++s)for(u=t?e[s][t]:e[s],a=0;a<i;++a)if(r[a]&&XH(u)&&!rp[a](u)&&(r[a]=0,++o,o===rp.length))return"string";return ZH[r.reduce((s,o)=>s===0?o:s,0)-1]}function a3(e,t){return t.reduce((n,i)=>(n[i]=o3(e,i),n),{})}function fk(e){const t=function(n,i){const r={delimiter:e};return H2(n,i?Fe(i,r):r)};return t.responseType="text",t}function H2(e,t){return t.header&&(e=t.header.map(ee).join(t.delimiter)+`
`+e),Oq(t.delimiter).parse(e+"")}H2.responseType="text";function eG(e){return typeof Buffer=="function"&&Te(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function G2(e,t){const n=t&&t.property?Ii(t.property):_n;return ae(e)&&!eG(e)?tG(n(e),t):n(JSON.parse(e))}G2.responseType="json";function tG(e,t){return!G(e)&&eN(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const nG={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function u3(e,t){let n,i,r,s;return e=G2(e,t),t&&t.feature?(n=Iq,r=t.feature):t&&t.mesh?(n=zq,r=t.mesh,s=nG[t.filter]):q("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,s):q("Invalid TopoJSON object: "+r),i&&i.features||[i]}u3.responseType="json";const Gp={dsv:H2,csv:fk(","),tsv:fk("	"),json:G2,topojson:u3};function V2(e,t){return arguments.length>1?(Gp[e]=t,this):fe(Gp,e)?Gp[e]:null}function l3(e){const t=V2(e);return t&&t.responseType||"text"}function c3(e,t,n,i){t=t||{};const r=V2(t.type||"json");return r||q("Unknown data format type: "+t.type),e=r(e,t),t.parse&&iG(e,t.parse,n,i),fe(e,"columns")&&delete e.columns,e}function iG(e,t,n,i){if(!e.length)return;const r=Fd();n=n||r.timeParse,i=i||r.utcParse;let s=e.columns||Object.keys(e[0]),o,a,u,l,c,f;t==="auto"&&(t=a3(e,s)),s=Object.keys(t);const d=s.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?i:n)(m);if(!Jb[p])throw Error("Illegal format pattern: "+h+":"+p);return Jb[p]});for(u=0,c=e.length,f=s.length;u<c;++u)for(o=e[u],l=0;l<f;++l)a=s[l],o[a]=d[l](o[a])}const S0=jH(typeof fetch<"u"&&fetch);function $0(e){const t=e||_n,n=[],i={};return n.add=r=>{const s=t(r);return i[s]||(i[s]=1,n.push(r)),n},n.remove=r=>{const s=t(r);if(i[s]){i[s]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function Vp(e,t){try{await t(e)}catch(n){e.error(n)}}const f3=Symbol("vega_id");let rG=1;function A0(e){return!!(e&&be(e))}function be(e){return e[f3]}function d3(e,t){return e[f3]=t,e}function Ve(e){const t=e===Object(e)?e:{data:e};return be(t)?t:d3(t,rG++)}function Y2(e){return C0(e,Ve({}))}function C0(e,t){for(const n in e)t[n]=e[n];return t}function h3(e,t){return d3(t,be(e))}function Ru(e,t){return e?t?(n,i)=>e(n,i)||be(t(n))-be(t(i)):(n,i)=>e(n,i)||be(n)-be(i):null}function p3(e){return e&&e.constructor===Ou}function Ou(){const e=[],t=[],n=[],i=[],r=[];let s=null,o=!1;return{constructor:Ou,insert(a){const u=le(a),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(a){const u=Te(a)?i:t,l=le(a),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(a,u,l){const c={field:u,value:En(l)};return Te(a)?(c.filter=a,r.push(c)):(c.tuple=a,n.push(c)),this},encode(a,u){return Te(a)?r.push({filter:a,field:u}):n.push({tuple:a,field:u}),this},clean(a){return s=a,this},reflow(){return o=!0,this},pulse(a,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[be(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[be(g)]=-1;for(f=0,d=i.length;f<d;++f)p=i[f],u.forEach(v=>{p(v)&&(l[be(v)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=be(g),l[m]?l[m]=1:a.add.push(Ve(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[be(g)]<0&&a.rem.push(g);function y(v,b,x){x?v[b]=x(v):a.encode=b,o||(c[be(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[be(g)],m>0&&(y(g,p,h.value),a.modifies(p));for(f=0,d=r.length;f<d;++f)h=r[f],p=h.filter,u.forEach(v=>{p(v)&&l[be(v)]>0&&y(v,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=t.length||i.length?u.filter(v=>l[be(v)]>0):u.slice();else for(m in c)a.mod.push(c[m]);return(s||s==null&&(t.length||i.length))&&a.clean(!0),a}}}const Yp="_:mod:_";function k0(){Object.defineProperty(this,Yp,{writable:!0,value:{}})}k0.prototype={set(e,t,n,i){const r=this,s=r[e],o=r[Yp];return t!=null&&t>=0?(s[t]!==n||i)&&(s[t]=n,o[t+":"+e]=-1,o[e]=-1):(s!==n||i)&&(r[e]=n,o[e]=G(n)?1+n.length:-1),r},modified(e,t){const n=this[Yp];if(arguments.length){if(G(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Yp]={},this}};let sG=0;const oG="pulse",aG=new k0,uG=1,lG=2;function ot(e,t,n,i){this.id=++sG,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function dk(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}ot.prototype={targets(){return this._targets||(this._targets=$0(ah))},set(e){return this.value!==e?(this.value=e,1):0},skip:dk(uG),modified:dk(lG),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new k0,r=this._argops=this._argops||[],s=[];let o,a,u,l;const c=(f,d,h)=>{h instanceof ot?(h!==this&&(t&&h.targets().add(this),s.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(o in e)if(a=e[o],o===oG)le(a).forEach(f=>{f instanceof ot?f!==this&&(f.targets().add(this),s.push(f)):q("Pulse parameters must be operator instances.")}),this.source=a;else if(G(a))for(i.set(o,-1,Array(u=a.length)),l=0;l<u;++l)c(o,l,a[l]);else c(o,-1,a);return this.marshall().clear(),n&&(r.initonly=!0),s},marshall(e){const t=this._argval||aG,n=this._argops;let i,r,s,o;if(n){const a=n.length;for(r=0;r<a;++r)i=n[r],s=i.op,o=s.modified()&&s.stamp===e,t.set(i.name,i.index,s.value,o);if(n.initonly){for(r=0;r<a;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function cG(e,t,n,i){let r=1,s;return e instanceof ot?s=e:e&&e.prototype instanceof ot?s=new e:Te(e)?s=new ot(null,e):(r=0,s=new ot(e,t)),this.rank(s),r&&(i=n,n=t),n&&this.connect(s,s.parameters(n,i)),this.touch(s),s}function fG(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let dG=0;function M0(e,t,n){this.id=++dG,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function bo(e,t,n){return new M0(e,t,n)}M0.prototype={_filter:Li,_apply:_n,targets(){return this._targets||(this._targets=$0(ah))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=bo(e);return this.targets().add(t),t},apply(e){const t=bo(null,e);return this.targets().add(t),t},merge(){const e=bo();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=bo();return this.targets().add(bo(null,null,F2(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(bo(null,null,()=>n=!0)),t.targets().add(bo(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Li,this._targets=null}};function hG(e,t,n,i){const r=this,s=bo(n,i),o=function(l){l.dataflow=r;try{s.receive(l)}catch(c){r.error(c)}finally{r.run()}};let a;typeof e=="string"&&typeof document<"u"?a=document.querySelectorAll(e):a=le(e);const u=a.length;for(let l=0;l<u;++l)a[l].addEventListener(t,o);return s}function pG(e,t){const n=this.locale();return c3(e,t,n.timeParse,n.utcParse)}function gG(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function mG(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:l3(t&&t.type)});try{r=n.parse(r,t)}catch(s){i=-2,n.warn("Data ingestion failed",e,s)}}catch(s){i=-1,n.warn("Loading failed",e,s)}return{data:r,status:i}}async function yG(e,t,n){const i=this,r=i._pending||vG(i);r.requests+=1;const s=await i.request(t,n);return i.pulse(e,i.changeset().remove(Li).insert(s.data||[])),r.done(),s}function vG(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests===0&&(e._pending=null,t(e))},e._pending=n}const bG={skip:!0};function xG(e,t,n,i,r){return(e instanceof ot?_G:wG)(this,e,t,n,i,r),this}function wG(e,t,n,i,r,s){const o=Fe({},s,bG);let a,u;Te(n)||(n=En(n)),i===void 0?a=l=>e.touch(n(l)):Te(i)?(u=new ot(null,i,r,!1),a=l=>{u.evaluate(l);const c=n(l),f=u.value;p3(f)?e.pulse(c,f,s):e.update(c,f,o)}):a=l=>e.update(n(l),i,o),t.apply(a)}function _G(e,t,n,i,r,s){if(i===void 0)t.targets().add(n);else{const o=s||{},a=new ot(null,EG(n,i),r,!1);a.modified(o.force),a.rank=t.rank,t.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),e.connect(n,[a]))}}function EG(e,t){return t=Te(t)?t:En(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function SG(e){e.rank=++this._rank}function $G(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&q("Cycle detected in dataflow graph.")}const Dg={},Ir=1,$o=2,Ms=4,AG=Ir|$o,hk=Ir|Ms,Ku=Ir|$o|Ms,pk=8,sf=16,gk=32,mk=64;function qo(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Hy(e,t){const n=[];return So(e,t,i=>n.push(i)),n}function yk(e,t){const n={};return e.visit(t,i=>{n[be(i)]=1}),i=>n[be(i)]?null:i}function sp(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}qo.prototype={StopPropagation:Dg,ADD:Ir,REM:$o,MOD:Ms,ADD_REM:AG,ADD_MOD:hk,ALL:Ku,REFLOW:pk,SOURCE:sf,NO_SOURCE:gk,NO_FIELDS:mk,fork(e){return new qo(this.dataflow).init(this,e)},clone(){const e=this.fork(Ku);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(Ku|sf)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new qo(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&mk)&&(n.fields=e.fields),t&Ir?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&$o?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ms?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&gk?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||Ku;return t&Ir&&this.add.length||t&$o&&this.rem.length||t&Ms&&this.mod.length},reflow(e){if(e)return this.fork(Ku).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ms,yk(this,Ir))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return G(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?G(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Ir&&(n.addF=sp(n.addF,t)),e&$o&&(n.remF=sp(n.remF,t)),e&Ms&&(n.modF=sp(n.modF,t)),e&sf&&(n.srcF=sp(n.srcF,t)),n},materialize(e){e=e||Ku;const t=this;return e&Ir&&t.addF&&(t.add=Hy(t.add,t.addF),t.addF=null),e&$o&&t.remF&&(t.rem=Hy(t.rem,t.remF),t.remF=null),e&Ms&&t.modF&&(t.mod=Hy(t.mod,t.modF),t.modF=null),e&sf&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&sf)return So(n.source,n.srcF,i),n;e&Ir&&So(n.add,n.addF,i),e&$o&&So(n.rem,n.remF,i),e&Ms&&So(n.mod,n.modF,i);const r=n.source;if(e&pk&&r){const s=n.add.length+n.mod.length;s===r.length||(s?So(r,yk(n,hk),i):So(r,n.srcF,i))}return n}};function X2(e,t,n,i){const r=this;let s=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(const o of n)if(o.stamp===t){if(o.fields){const a=r.fields||(r.fields={});for(const u in o.fields)a[u]=1}o.changed(r.ADD)&&(s|=r.ADD),o.changed(r.REM)&&(s|=r.REM),o.changed(r.MOD)&&(s|=r.MOD)}this.changes=s}te(X2,qo,{fork(e){const t=new qo(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?G(e)?e.some(i=>n[i]):n[e]:0},filter(){q("MultiPulse does not support filtering.")},materialize(){q("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let s=0;if(e&n.SOURCE)for(;s<r;++s)i[s].visit(e,t);else for(;s<r;++s)i[s].stamp===n.stamp&&i[s].visit(e,t);return n}});async function CG(e,t,n){const i=this,r=[];if(i._pulse)return g3(i);if(i._pending&&await i._pending,t&&await Vp(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const s=++i._clock;i._pulse=new qo(i,s,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=$0(ah);let o=0,a,u,l;try{for(;i._heap.size()>0;){if(a=i._heap.pop(),a.rank!==a.qrank){i._enqueue(a,!0);continue}u=a.run(i._getPulse(a,e)),u.then?u=await u:u.async&&(r.push(u.async),u=Dg),u!==Dg&&a._targets&&a._targets.forEach(c=>i._enqueue(c)),++o}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${s}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Vp(i,c[f].callback)}return n&&await Vp(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function kG(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function MG(e,t,n){return this._pulse?g3(this):(this.evaluate(e,t,n),this)}function FG(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function g3(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function TG(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function RG(e,t){const n=e.source,i=this._clock;return n&&G(n)?new X2(this,i,n.map(r=>r.pulse),t):this._input[e.id]||OG(this._pulse,n&&n.pulse)}function OG(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Dg&&(e.source=t.source),e)}const K2={skip:!1,force:!1};function DG(e,t){const n=t||K2;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function NG(e,t,n){const i=n||K2;return(e.set(t)||i.force)&&this.touch(e,i),this}function PG(e,t,n){this.touch(e,n||K2);const i=new qo(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function IG(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),m3(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,LG(t,0,e)):i=n,i}}}function m3(e,t,n,i){let r,s;const o=e[n];for(;n>t;){if(s=n-1>>1,r=e[s],i(o,r)<0){e[n]=r,n=s;continue}break}return e[n]=o}function LG(e,t,n){const i=t,r=e.length,s=e[t];let o=(t<<1)+1,a;for(;o<r;)a=o+1,a<r&&n(e[o],e[a])>=0&&(o=a),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=s,m3(e,i,t,n)}function El(){this.logger($2()),this.logLevel(E2),this._clock=0,this._rank=0,this._locale=W2();try{this._loader=S0()}catch{}this._touched=$0(ah),this._input={},this._pulse=null,this._heap=IG((e,t)=>e.qrank-t.qrank),this._postrun=[]}function of(e){return function(){return this._log[e].apply(this,arguments)}}El.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:of("error"),warn:of("warn"),info:of("info"),debug:of("debug"),logLevel:of("level"),cleanThreshold:1e4,add:cG,connect:fG,rank:SG,rerank:$G,pulse:PG,touch:DG,update:NG,changeset:Ou,ingest:gG,parse:pG,preload:yG,request:mG,events:hG,on:xG,evaluate:CG,run:MG,runAsync:kG,runAfter:FG,_enqueue:TG,_getPulse:RG};function z(e,t){ot.call(this,e,null,t)}te(z,ot,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const jl={};function y3(e){const t=v3(e);return t&&t.Definition||null}function v3(e){return e=e&&e.toLowerCase(),fe(jl,e)?jl[e]:null}function*b3(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Q2(e,t,n){const i=Float64Array.from(b3(e,n));return i.sort(qs),t.map(r=>gN(i,r))}function J2(e,t){return Q2(e,[.25,.5,.75],t)}function Z2(e,t){const n=e.length,i=Vq(e,t),r=J2(e,t),s=(r[2]-r[0])/1.34;return 1.06*(Math.min(i,s)||i||Math.abs(r[0])||1)*Math.pow(n,-.2)}function x3(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let s=e.extent[0],o=e.extent[1],a,u,l,c,f,d;const h=e.span||o-s||Math.abs(s)||1;if(e.step)a=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);a=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,a=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/a)>t;)a*=n;for(f=0,d=r.length;f<d;++f)c=a/r[f],c>=l&&h/c<=t&&(a=c)}c=Math.log(a);const p=c>=0?0:~~(-c/i)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(s/a+g)*a,s=s<c?c-a:c,o=Math.ceil(o/a)*a),{start:s,stop:o===s?s+a:o,step:a}}var Bi=Math.random;function zG(e){Bi=e}function w3(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(b3(e,i)),s=r.length,o=t;let a,u,l,c;for(l=0,c=Array(o);l<o;++l){for(a=0,u=0;u<s;++u)a+=r[~~(Bi()*s)];c[l]=a/s}return c.sort(qs),[qb(c,n/2),qb(c,1-n/2)]}function _3(e,t,n,i){i=i||(d=>d);const r=e.length,s=new Float64Array(r);let o=0,a=1,u=i(e[0]),l=u,c=u+t,f;for(;a<r;++a){if(f=i(e[a]),f>=c){for(l=(u+l)/2;o<a;++o)s[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<a;++o)s[o]=l;return n?BG(s,t+t/4):s}function BG(e,t){const n=e.length;let i=0,r=1,s,o;for(;e[i]===e[r];)++r;for(;r<n;){for(s=r+1;e[r]===e[s];)++s;if(e[r]-e[r-1]<t){for(o=r+(i+s-r-r>>1);o<r;)e[o++]=e[r];for(;o>r;)e[o--]=e[i]}i=r,r=s}return e}function UG(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function jG(e,t){t==null&&(t=e,e=0);let n,i,r;const s={min(o){return arguments.length?(n=o||0,r=i-n,s):n},max(o){return arguments.length?(i=o||0,r=i-n,s):i},sample(){return n+Math.floor(r*Bi())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const a=Math.floor(o);return a<n?0:a>=i?1:(a-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return s.min(e).max(t)}const E3=Math.sqrt(2*Math.PI),qG=Math.SQRT2;let af=NaN;function F0(e,t){e=e||0,t=t??1;let n=0,i=0,r,s;if(af===af)n=af,af=NaN;else{do n=Bi()*2-1,i=Bi()*2-1,r=n*n+i*i;while(r===0||r>1);s=Math.sqrt(-2*Math.log(r)/r),n*=s,af=i*s}return e+n*t}function e_(e,t,n){n=n??1;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*E3)}function T0(e,t,n){t=t||0,n=n??1;const i=(e-t)/n,r=Math.abs(i);let s;if(r>37)s=0;else{const o=Math.exp(-r*r/2);let a;r<7.07106781186547?(a=.0352624965998911*r+.700383064443688,a=a*r+6.37396220353165,a=a*r+33.912866078383,a=a*r+112.079291497871,a=a*r+221.213596169931,a=a*r+220.206867912376,s=o*a,a=.0883883476483184*r+1.75566716318264,a=a*r+16.064177579207,a=a*r+86.7807322029461,a=a*r+296.564248779674,a=a*r+637.333633378831,a=a*r+793.826512519948,a=a*r+440.413735824752,s=s/a):(a=r+.65,a=r+4/a,a=r+3/a,a=r+2/a,a=r+1/a,s=o/a/2.506628274631)}return i>0?1-s:s}function R0(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*qG*WG(2*e-1)}function WG(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function t_(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>F0(n,i),pdf:s=>e_(s,n,i),cdf:s=>T0(s,n,i),icdf:s=>R0(s,n,i)};return r.mean(e).stdev(t)}function n_(e,t){const n=t_();let i=0;const r={data(s){return arguments.length?(e=s,i=s?s.length:0,r.bandwidth(t)):e},bandwidth(s){return arguments.length?(t=s,!t&&e&&(t=Z2(e)),r):t},sample(){return e[~~(Bi()*i)]+t*n.sample()},pdf(s){let o=0,a=0;for(;a<i;++a)o+=n.pdf((s-e[a])/t);return o/t/i},cdf(s){let o=0,a=0;for(;a<i;++a)o+=n.cdf((s-e[a])/t);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function i_(e,t){return e=e||0,t=t??1,Math.exp(e+F0()*t)}function r_(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*E3*e)}function s_(e,t,n){return T0(Math.log(e),t,n)}function o_(e,t,n){return Math.exp(R0(e,t,n))}function S3(e,t){let n,i;const r={mean(s){return arguments.length?(n=s||0,r):n},stdev(s){return arguments.length?(i=s??1,r):i},sample:()=>i_(n,i),pdf:s=>r_(s,n,i),cdf:s=>s_(s,n,i),icdf:s=>o_(s,n,i)};return r.mean(e).stdev(t)}function $3(e,t){let n=0,i;function r(o){const a=[];let u=0,l;for(l=0;l<n;++l)u+=a[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)a[l]/=u;return a}const s={weights(o){return arguments.length?(i=r(t=o||[]),s):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),s.weights(t)):e},sample(){const o=Bi();let a=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(o<u){a=e[l];break}return a.sample()},pdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].pdf(o);return a},cdf(o){let a=0,u=0;for(;u<n;++u)a+=i[u]*e[u].cdf(o);return a},icdf(){throw Error("Mixture icdf not supported.")}};return s.distributions(e).weights(t)}function a_(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*Bi()}function u_(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function l_(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function c_(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function A3(e,t){let n,i;const r={min(s){return arguments.length?(n=s||0,r):n},max(s){return arguments.length?(i=s??1,r):i},sample:()=>a_(n,i),pdf:s=>u_(s,n,i),cdf:s=>l_(s,n,i),icdf:s=>c_(s,n,i)};return t==null&&(t=e??1,e=0),r.min(e).max(t)}function f_(e,t,n){let i=0,r=0;for(const s of e){const o=n(s);t(s)==null||o==null||isNaN(o)||(i+=(o-i)/++r)}return{coef:[i],predict:()=>i,rSquared:0}}function lh(e,t,n,i){const r=i-e*e,s=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-s*e,s]}function O0(e,t,n,i){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),i&&e.sort((h,p)=>t(h)-t(p));const r=e.length,s=new Float64Array(r),o=new Float64Array(r);let a=0,u=0,l=0,c,f,d;for(d of e)s[a]=c=+t(d),o[a]=f=+n(d),++a,u+=(c-u)/a,l+=(f-l)/a;for(a=0;a<r;++a)s[a]-=u,o[a]-=l;return[s,o,u,l]}function ch(e,t,n,i){let r=-1,s,o;for(const a of e)s=t(a),o=n(a),s!=null&&(s=+s)>=s&&o!=null&&(o=+o)>=o&&i(s,o,++r)}function Tc(e,t,n,i,r){let s=0,o=0;return ch(e,t,n,(a,u)=>{const l=u-r(a),c=u-i;s+=l*l,o+=c*c}),1-s/o}function d_(e,t,n){let i=0,r=0,s=0,o=0,a=0;ch(e,t,n,(c,f)=>{++a,i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=lh(i,r,s,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Tc(e,t,n,r,l)}}function C3(e,t,n){let i=0,r=0,s=0,o=0,a=0;ch(e,t,n,(c,f)=>{++a,c=Math.log(c),i+=(c-i)/a,r+=(f-r)/a,s+=(c*f-s)/a,o+=(c*c-o)/a});const u=lh(i,r,s,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Tc(e,t,n,r,l)}}function k3(e,t,n){const[i,r,s,o]=O0(e,t,n);let a=0,u=0,l=0,c=0,f=0,d,h,p;ch(e,t,n,(v,b)=>{d=i[f++],h=Math.log(b),p=d*b,a+=(b*h-a)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=lh(u/o,a/o,l/o,c/o),y=v=>Math.exp(g+m*(v-s));return{coef:[Math.exp(g-m*s),m],predict:y,rSquared:Tc(e,t,n,o,y)}}function M3(e,t,n){let i=0,r=0,s=0,o=0,a=0,u=0;ch(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,i+=(h-i)/u,r+=(p-r)/u,s+=(h*p-s)/u,o+=(h*h-o)/u,a+=(d-a)/u});const l=lh(i,r,s,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Tc(e,t,n,a,c)}}function h_(e,t,n){const[i,r,s,o]=O0(e,t,n),a=i.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<a;)p=i[h],g=r[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const y=c-u*u,v=u*y-l*l,b=(d*u-f*l)/v,x=(f*y-d*l)/v,w=-b*u,E=_=>(_=_-s,b*_*_+x*_+w+o);return{coef:[w-x*s+b*s*s+o,x-2*b*s,b],predict:E,rSquared:Tc(e,t,n,o,E)}}function F3(e,t,n,i){if(i===0)return f_(e,t,n);if(i===1)return d_(e,t,n);if(i===2)return h_(e,t,n);const[r,s,o,a]=O0(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d)*s[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(r[p],d+h);m[h]=g}c.push(m)}c.push(l);const y=GG(c),v=b=>{b-=o;let x=a+y[0]+y[1]*b+y[2]*b*b;for(d=3;d<f;++d)x+=y[d]*Math.pow(b,d);return x};return{coef:HG(f,y,-o,a),predict:v,rSquared:Tc(e,t,n,a,v)}}function HG(e,t,n,i){const r=Array(e);let s,o,a,u;for(s=0;s<e;++s)r[s]=0;for(s=e-1;s>=0;--s)for(a=t[s],u=1,r[s]+=a,o=1;o<=s;++o)u*=(s+1-o)/o,r[s-o]+=a*Math.pow(n,o)*u;return r[0]+=i,r}function GG(e){const t=e.length-1,n=[];let i,r,s,o,a;for(i=0;i<t;++i){for(o=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][o])&&(o=r);for(s=i;s<t+1;++s)a=e[s][i],e[s][i]=e[s][o],e[s][o]=a;for(r=i+1;r<t;++r)for(s=t;s>=i;s--)e[s][r]-=e[s][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(a=0,s=r+1;s<t;++s)a+=e[s][r]*n[s];n[r]=(e[t][r]-a)/e[r][r]}return n}const vk=2,bk=1e-12;function T3(e,t,n,i){const[r,s,o,a]=O0(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=vk;){const p=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=p[0],b=p[1],x=y-r[v]>r[b]-y?v:b;let w=0,E=0,_=0,$=0,A=0;const F=1/Math.abs(r[x]-y||1);for(let D=v;D<=b;++D){const O=r[D],C=s[D],R=VG(Math.abs(y-O)*F)*d[D],N=O*R;w+=R,E+=N,_+=C*R,$+=C*N,A+=O*N}const[M,P]=lh(E/w,_/w,$/w,A/w);c[m]=M+P*y,f[m]=Math.abs(s[m]-c[m]),YG(r,m+1,p)}if(h===vk)break;const g=mN(f);if(Math.abs(g)<bk)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*g),d[m]=y>=1?bk:(v=1-y*y)*v}return XG(r,c,o,a)}function VG(e){return(e=1-e*e*e)*e*e}function YG(e,t,n){const i=e[t];let r=n[0],s=n[1]+1;if(!(s>=e.length))for(;t>r&&e[s]-i<=i-e[r];)n[0]=++r,n[1]=s,++s}function XG(e,t,n,i){const r=e.length,s=[];let o=0,a=0,u=[],l;for(;o<r;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++a:(a=0,u[1]+=i,u=[l,t[o]],s.push(u));return u[1]+=i,s}const KG=.5*Math.PI/180;function D0(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=g=>[g,e(g)],s=t[0],o=t[1],a=o-s,u=a/i,l=[r(s)],c=[];if(n===i){for(let g=1;g<i;++g)l.push(r(s+g/n*a));return l.push(r(o)),l}else{c.push(r(o));for(let g=n;--g>0;)c.push(r(s+g/n*a))}let f=l[0],d=c[c.length-1];const h=1/a,p=QG(f[1],c);for(;d;){const g=r((f[0]+d[0])/2);g[0]-f[0]>=u&&JG(f,g,d,h,p)>KG?c.push(g):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function QG(e,t){let n=e,i=e;const r=t.length;for(let s=0;s<r;++s){const o=t[s][1];o<n&&(n=o),o>i&&(i=o)}return 1/(i-n)}function JG(e,t,n,i,r){const s=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),o=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(s-o)}function ZG(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function Zb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:ZG(e)}function R3(e,t,n){return n||e+(t?"_"+t:"")}const Gy=()=>{},eV={init:Gy,add:Gy,rem:Gy,idx:0},Td={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},fh=Object.keys(Td).filter(e=>e!=="__count__");function tV(e,t){return(n,i)=>Fe({name:e,aggregate_param:i,out:n||e},eV,t)}[...fh,"__count__"].forEach(e=>{Td[e]=tV(e,Td[e])});function O3(e,t,n){return Td[e](n,t)}function D3(e,t){return e.idx-t.idx}function nV(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{i.req&&i.req.forEach(r=>{t[r]||n(t[r]=Td[r]())})};return e.forEach(n),Object.values(t).sort(D3)}function iV(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.aggregate_param==null?e.init(this):e.init(this,e.aggregate_param))}function rV(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function sV(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function oV(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function N3(e,t){const n=t||_n,i=nV(e),r=e.slice().sort(D3);function s(o){this._ops=i,this._out=r,this.cell=o,this.init()}return s.prototype.init=iV,s.prototype.add=rV,s.prototype.rem=sV,s.prototype.set=oV,s.prototype.get=n,s.fields=e.map(o=>o.out),s}function p_(e){this._key=e?Ii(e):be,this.reset()}const sn=p_.prototype;sn.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};sn.add=function(e){this._add.push(e)};sn.rem=function(e){this._rem.push(e)};sn.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,s=Array(i-r),o={};let a,u,l;for(a=0;a<r;++a)o[n(t[a])]=1;for(a=0,u=0;a<i;++a)o[n(l=e[a])]?o[n(l)]=0:s[u++]=l;return this._rem=[],this._add=s};sn.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,s;for(;--i>=0;)s=e(t[i])+"",fe(n,s)||(n[s]=1,++r);return r};sn.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=JD(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};sn.argmin=function(e){return this.extent(e)[0]||{}};sn.argmax=function(e){return this.extent(e)[1]||{}};sn.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};sn.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};sn.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=J2(this.values(),e),this._get=e),this._q};sn.q1=function(e){return this.quartile(e)[0]};sn.q2=function(e){return this.quartile(e)[1]};sn.q3=function(e){return this.quartile(e)[2]};sn.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=w3(this.values(),1e3,.05,e),this._get=e),this._ci};sn.ci0=function(e){return this.ci(e)[0]};sn.ci1=function(e){return this.ci(e)[1]};function Xo(e){z.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Xo.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:fh},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};te(Xo,z,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):Object.create(null),t.visit(t.SOURCE,s=>n.add(s))):(n.value=n.value||n.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function s(a){let u,l,c,f;for(u in a)for(c=a[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}s(e._prev),s(t);function o(a,u,l){const c=n[l],f=i[l++];for(const d in f){const h=a?a+"|"+d:d;u[c]=f[d],l<r?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(v){const b=le(yn(v)),x=b.length;let w=0,E;for(;w<x;++w)i[E=b[w]]||(i[E]=1,t.push(E))}this._dims=le(e.groupby),this._dnames=this._dims.map(v=>{const b=St(v);return r(v),n.push(b),b}),this.cellkey=e.key?e.key:Zb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const s=e.fields||[null],o=e.ops||["count"],a=e.aggregate_params||[null],u=e.as||[],l=s.length,c={};let f,d,h,p,g,m,y;for(l!==o.length&&q("Unmatched number of fields and aggregate ops."),y=0;y<l;++y){if(f=s[y],d=o[y],h=a[y]||null,f==null&&d!=="count"&&q("Null aggregate field specified."),g=St(f),m=R3(d,g,u[y]),n.push(m),d==="count"){this._counts.push(m);continue}p=c[g],p||(r(f),p=c[g]=[],p.field=f,this._measures.push(p)),d!=="count"&&(this._countOnly=!1),p.push(O3(d,h,m))}return this._measures=this._measures.map(v=>N3(v,v.field)),Object.create(null)},cellkey:Zb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let s=0;s<r;++s)n.agg[s]=new i[s](n)}return n.store&&(n.data=new p_),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,s={};for(let o=0;o<r;++o)s[n[o]]=i[o](e);return t?h3(t.tuple,s):Ve(s)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,s=i.length;r<s;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,s=i.length;r<s;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,s=e.add,o=e.rem,a=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)s.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?o:a).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const aV=1e-14;function g_(e){z.call(this,null,e)}g_.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};te(g_,z,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,s=i.step,o=e.as||["bin0","bin1"],a=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(yn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[a]=f,c[u]=f==null?null:r+s*(1+(f-r)/s)}:c=>c[a]=i(c)),t.modifies(n?o:a)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=x3(e),i=n.step;let r=n.start,s=r+Math.ceil((n.stop-r)/i)*i,o,a;(o=e.anchor)!=null&&(a=o-(r+i*Math.floor((o-r)/i)),r+=a,s+=a);const u=function(l){let c=pn(t(l));return c==null?null:c<r?-1/0:c>s?1/0:(c=Math.max(r,Math.min(c,s-i)),r+i*Math.floor(aV+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=oi(u,yn(t),e.name||"bin_"+St(t))}});function P3(e,t,n){const i=e;let r=t||[],s=n||[],o={},a=0;return{add:u=>s.push(u),remove:u=>o[i(u)]=++a,size:()=>r.length,data:(u,l)=>(a&&(r=r.filter(c=>!o[i(c)]),o={},a=0),l&&u&&r.sort(u),s.length&&(r=u?iN(u,r,s.sort(u)):r.concat(s),s=[]),r)}}function m_(e){z.call(this,[],e)}m_.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};te(m_,z,{transform(e,t){const n=t.fork(t.ALL),i=P3(be,this.value,n.materialize(n.ADD).add),r=e.sort,s=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(Ru(r),s),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function I3(e){ot.call(this,null,uV,e)}te(I3,ot);function uV(e){return this.value&&!e.modified()?this.value:M2(e.fields,e.orders)}function y_(e){z.call(this,null,e)}y_.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function lV(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}te(y_,z,{transform(e,t){const n=f=>d=>{for(var h=lV(a(d),e.case,s)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},i=this._parameterCheck(e,t),r=this._counts,s=this._match,o=this._stop,a=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],s=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let a,u,l;for(a in n)u=i[a],l=n[a]||0,!u&&l?(i[a]=u=Ve({}),u[r]=a,u[s]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[a]=null,i[a]=null):u[s]!==l&&(u[s]=l,o.mod.push(u));return o.modifies(t)}});function v_(e){z.call(this,null,e)}v_.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};te(v_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],s=i[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let a=this.value;return o?(a&&(n.rem=a),a=t.materialize(t.SOURCE).source,n.add=this.value=cV(a,r,s,e.filter||Li)):n.mod=a,n.source=this.value,n.modifies(i)}});function cV(e,t,n,i){for(var r=[],s={},o=e.length,a=0,u,l;a<o;++a)for(s[t]=l=e[a],u=0;u<o;++u)s[n]=e[u],i(s)&&(r.push(Ve(s)),s={},s[t]=l);return r}const xk={kde:n_,mixture:$3,normal:t_,lognormal:S3,uniform:A3},fV="distributions",wk="function",dV="field";function L3(e,t){const n=e[wk];fe(xk,n)||q("Unknown distribution function: "+n);const i=xk[n]();for(const r in e)r===dV?i.data((e.from||t()).map(e[r])):r===fV?i[r](e[r].map(s=>L3(s,t))):typeof i[r]===wk&&i[r](e[r]);return i}function b_(e){z.call(this,null,e)}const z3=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],hV={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:z3},{name:"weights",type:"number",array:!0}]};b_.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:z3.concat(hV)},{name:"as",type:"string",array:!0,default:["value","density"]}]};te(b_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=L3(e.distribution,pV(t)),r=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&q("Invalid density method: "+o),!e.extent&&!i.data&&q("Missing density extent parameter."),o=i[o];const a=e.as||["value","density"],u=e.extent||es(i.data()),l=D0(o,u,r,s).map(c=>{const f={};return f[a[0]]=c[0],f[a[1]]=c[1],Ve(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function pV(e){return()=>e.materialize(e.SOURCE).source}function B3(e,t){return e?e.map((n,i)=>t[i]||St(n)):null}function x_(e,t,n){const i=[],r=f=>f(u);let s,o,a,u,l,c;if(t==null)i.push(e.map(n));else for(s={},o=0,a=e.length;o<a;++o)u=e[o],l=t.map(r),c=s[l],c||(s[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const U3="bin";function w_(e){z.call(this,null,e)}w_.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:U3}]};const gV=(e,t)=>uh(es(e,t))/30;te(w_,z,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=x_(t.source,e.groupby,_n),r=e.smooth||!1,s=e.field,o=e.step||gV(n,s),a=Ru((p,g)=>s(p)-s(g)),u=e.as||U3,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=i[d].sort(a);h=-1;for(const g of _3(p,o,r,s))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function j3(e){ot.call(this,null,mV,e),this.modified(!0)}te(j3,ot);function mV(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:oi(n=>t(n,e),yn(t),St(t))}function __(e){z.call(this,[void 0,void 0],e)}__.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};te(__,z,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let s=n[0],o=n[1];if((r||s==null)&&(s=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,a=>{const u=pn(i(a));u!=null&&(u<s&&(s=u),u>o&&(o=u))}),!Number.isFinite(s)||!Number.isFinite(o)){let a=St(i);a&&(a=` for field "${a}"`),t.dataflow.warn(`Infinite extent${a}: [${s}, ${o}]`),s=o=void 0}this.value=[s,o]}});function E_(e,t){ot.call(this,e),this.parent=t,this.count=0}te(E_,ot,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function N0(e){z.call(this,{},e),this._keys=$c();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}te(N0,z,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let s=fe(r,e)&&r[e],o,a;return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(a=i||(a=this._group[e])&&a.tuple,o=n.dataflow,s=new E_(n.fork(n.NO_SOURCE),this),o.add(s).connect(t(o,e,a)),r[e]=s,this.activate(s)),s},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,s=this._keys,o=e.modified("key"),a=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=be(u),c=s.get(l);c!==void 0&&(s.delete(l),a(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);s.set(be(u),l),a(l).add(u)}),o||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=be(u),c=s.get(l),f=i(u);c===f?a(f).mod(u):(s.set(l,f),a(c).rem(u),a(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{a(s.get(be(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=be(u),c=s.get(l),f=i(u);c!==f&&(s.set(l,f),a(c).rem(u),a(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),s.clean()}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t}});function q3(e){ot.call(this,null,yV,e)}te(q3,ot);function yV(e){return this.value&&!e.modified()?this.value:G(e.name)?le(e.name).map(t=>Ii(t)):Ii(e.name,e.as)}function S_(e){z.call(this,$c(),e)}S_.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};te(S_,z,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),s=r.add,o=r.rem,a=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=be(f);i.has(d)?i.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?s.push(f):i.set(be(f),1)});function c(f){const d=be(f),h=u(f,e),p=i.get(d);h&&p?(i.delete(d),s.push(f)):!h&&!p?(i.set(d,1),o.push(f)):l&&h&&!p&&a.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function $_(e){z.call(this,[],e)}$_.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};te($_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=B3(i,e.as||[]),s=e.index||null,o=r.length;return n.rem=this.value,t.visit(t.SOURCE,a=>{const u=i.map(p=>p(a)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Y2(a),f=0;f<o;++f)d[r[f]]=(h=u[f][c])==null?null:h;s&&(d[s]=c),n.add.push(d)}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(r)}});function A_(e){z.call(this,[],e)}A_.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};te(A_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(St),s=e.as||["key","value"],o=s[0],a=s[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Y2(l),f[o]=r[c],f[a]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(s)}});function C_(e){z.call(this,null,e)}C_.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};te(C_,z,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),s=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,o=>o[i]=n(o,e))}});function W3(e){z.call(this,[],e)}te(W3,z,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,s=e.size-r.length,o,a,u;if(s>0){for(o=[];--s>=0;)o.push(u=Ve(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else a=r.slice(0,-s),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a,r=r.slice(-s);return n.source=this.value=r,n}});const op={value:"value",median:mN,mean:Zq,min:jb,max:Ka},vV=[];function k_(e){z.call(this,[],e)}k_.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function bV(e){var t=e.method||op.value,n;if(op[t]==null)q("Unrecognized imputation method: "+t);else return t===op.value?(n=e.value!==void 0?e.value:0,()=>n):op[t]}function xV(e){const t=e.field;return n=>n?t(n):NaN}te(k_,z,{transform(e,t){var n=t.fork(t.ALL),i=bV(e),r=xV(e),s=St(e.field),o=St(e.key),a=(e.groupby||[]).map(St),u=wV(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,y,v,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(g=u.domain[v],w={_impute:!0},y=0,x=p.length;y<x;++y)w[a[y]]=p[y];w[o]=g,w[s]=Number.isNaN(h)?h=i(d,r):h,l.push(Ve(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function wV(e,t,n,i){var r=y=>y(m),s=[],o=i?i.slice():[],a={},u={},l,c,f,d,h,p,g,m;for(o.forEach((y,v)=>a[y]=v+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=a[p]||(a[p]=o.push(p)),c=(l=t?t.map(r):vV)+"",(f=u[c])||(f=u[c]=[],s.push(f),f.values=l),f[h-1]=m;return s.domain=o,s}function M_(e){Xo.call(this,e)}M_.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:fh},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};te(M_,Xo,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,s=>n.add(s))):(r=n.value=n.value||this.init(e),t.visit(t.REM,s=>n.rem(s)),t.visit(t.ADD,s=>n.add(s))),n.changes(),t.visit(t.SOURCE,s=>{Fe(s,r[n.cellkey(s)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function F_(e){z.call(this,null,e)}F_.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};te(F_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=x_(i,e.groupby,e.field),s=(e.groupby||[]).map(St),o=e.bandwidth,a=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;a!=="pdf"&&a!=="cdf"&&q("Invalid density method: "+a),e.resolve==="shared"&&(c||(c=es(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const p=n_(h,o)[a],g=e.counts?h.length:1,m=c||es(h);D0(p,m,f,d).forEach(y=>{const v={};for(let b=0;b<s.length;++b)v[s[b]]=h.dims[b];v[u[0]]=y[0],v[u[1]]=y[1]*g,l.push(Ve(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function H3(e){ot.call(this,null,_V,e)}te(H3,ot);function _V(e){return this.value&&!e.modified()?this.value:R2(e.fields,e.flat)}function G3(e){z.call(this,[],e),this._pending=null}te(G3,z,{transform(e,t){const n=t.dataflow;return this._pending?Vy(this,t,this._pending):EV(e)?t.StopPropagation:e.values?Vy(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=le(r.data),s=>s.touch(this)))}:n.request(e.url,e.format).then(i=>Vy(this,t,le(i.data)))}});function EV(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Vy(e,t,n){n.forEach(Ve);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function T_(e){z.call(this,{},e)}T_.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};te(T_,z,{transform(e,t){const n=e.fields,i=e.index,r=e.values,s=e.default==null?null:e.default,o=e.modified(),a=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,a>1&&!c&&q('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==a*d&&q('The "as" parameter has too few output field names.'),c=c||r.map(St),f=function(p){for(var g=0,m=0,y,v;g<a;++g)if(v=i.get(n[g](p)),v==null)for(y=0;y<d;++y,++m)p[c[m]]=s;else for(y=0;y<d;++y,++m)p[c[m]]=r[y](v)}):(c||q("Missing output field names."),f=function(p){for(var g=0,m;g<a;++g)m=i.get(n[g](p)),p[c[g]]=m??s}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function V3(e){ot.call(this,null,SV,e)}te(V3,ot);function SV(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,s,o;for(s=0;s<n;++s)o=t[s],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function Y3(e){ot.call(this,null,$V,e)}te(Y3,ot);function $V(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function X3(e){z.call(this,null,e)}te(X3,z,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function R_(e){Xo.call(this,e)}R_.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:fh,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};te(R_,Xo,{_transform:Xo.prototype.transform,transform(e,t){return this._transform(AV(e,t),t)}});function AV(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",s=yn(n).concat(yn(i)),o=kV(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>r),fields:o.map(a=>CV(a,n,i,s)),as:o.map(a=>a+""),modified:e.modified.bind(e)}}function CV(e,t,n,i){return oi(r=>t(r)===e?n(r):NaN,i,e+"")}function kV(e,t,n){const i={},r=[];return n.visit(n.SOURCE,s=>{const o=e(s);i[o]||(i[o]=1,r.push(o))}),r.sort(Sc),t?r.slice(0,t):r}function K3(e){N0.call(this,e)}te(K3,N0,{transform(e,t){const n=e.subflow,i=e.field,r=s=>this.subflow(be(s),n,t,s);return(e.modified("field")||i&&t.modified(yn(i)))&&q("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,s=>{const o=r(s);i(s).forEach(a=>o.mod(a))}),t.visit(t.ADD,s=>{const o=r(s);i(s).forEach(a=>o.add(Ve(a)))}),t.visit(t.REM,s=>{const o=r(s);i(s).forEach(a=>o.rem(a))})):(t.visit(t.MOD,s=>r(s).mod(s)),t.visit(t.ADD,s=>r(s).add(s)),t.visit(t.REM,s=>r(s).rem(s))),t.clean()&&t.runAfter(()=>this.clean()),t}});function O_(e){z.call(this,null,e)}O_.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};te(O_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=B3(e.fields,e.as||[]),s=i?(a,u)=>MV(a,u,i,r):C0;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,a=>{const u=be(a);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,a=>{const u=s(a,Ve({}));o[be(a)]=u,n.add.push(u)}),t.visit(t.MOD,a=>{n.mod.push(s(a,o[be(a)]))}),n}});function MV(e,t,n,i){for(let r=0,s=n.length;r<s;++r)t[i[r]]=n[r](e);return t}function Q3(e){z.call(this,null,e)}te(Q3,z,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function D_(e){z.call(this,null,e)}D_.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const FV=1e-14;te(D_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,s=x_(r,e.groupby,e.field),o=(e.groupby||[]).map(St),a=[],u=e.step||.01,l=e.probs||gi(u/2,1-FV,u),c=l.length;return s.forEach(f=>{const d=Q2(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[i[0]]=l[h],p[i[1]]=d[h],a.push(Ve(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}});function J3(e){z.call(this,null,e)}te(J3,z,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const s=be(r);n.rem.push(i[s]),i[s]=null}),t.visit(t.ADD,r=>{const s=Y2(r);i[be(r)]=s,n.add.push(s)}),t.visit(t.MOD,r=>{const s=i[be(r)];for(const o in r)s[o]=r[o],n.modifies(o);n.mod.push(s)})),n}});function N_(e){z.call(this,[],e),this.count=0}N_.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};te(N_,z,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,s=this.value.reduce((c,f)=>(c[be(f)]=1,c),{});let o=this.value,a=this.count,u=0;function l(c){let f,d;o.length<r?o.push(c):(d=~~((a+1)*Bi()),d<o.length&&d>=u&&(f=o[d],s[be(f)]&&n.rem.push(f),o[d]=c)),++a}if(t.rem.length&&(t.visit(t.REM,c=>{const f=be(c);s[f]&&(s[f]=-1,n.rem.push(c)),--a}),o=o.filter(c=>s[be(c)]!==-1)),(t.rem.length||i)&&o.length<r&&t.source&&(u=a=o.length,t.visit(t.SOURCE,c=>{s[be(c)]||l(c)}),u=-1),i&&o.length>r){const c=o.length-r;for(let f=0;f<c;++f)s[be(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{s[be(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!s[be(c)])),this.count=a,this.value=n.source=o,n}});function P_(e){z.call(this,null,e)}P_.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};te(P_,z,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=gi(e.start,e.stop,e.step||1).map(r=>{const s={};return s[i]=r,Ve(s)}),n.add=t.add.concat(this.value),n}});function Z3(e){z.call(this,null,e),this.modified(!0)}te(Z3,z,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function I_(e){z.call(this,null,e)}const eP=["unit0","unit1"];I_.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:z2,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:eP}]};te(I_,z,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",s=this._floor(e,t),o=(r?Fc:Mc)(s.unit).offset,a=e.as||eP,u=a[0],l=a[1],c=s.step;let f=s.start||1/0,d=s.stop||-1/0,h=t.ADD;return(e.modified()||t.changed(t.REM)||t.modified(yn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,y;g==null?(p[u]=null,i&&(p[l]=null)):(p[u]=m=y=s(g),i&&(p[l]=y=o(m,c)),m<f&&(f=m),y>d&&(d=y))}),s.start=f,s.stop=d,t.modifies(i?a:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:WN({extent:e.extent||es(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=B2(i),o=this.value||{},a=(n?NN:DN)(s,r);return a.unit=ze(s),a.units=s,a.step=r,a.start=o.start,a.stop=o.stop,this.value=a}});function tP(e){z.call(this,$c(),e)}te(tP,z,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,s=a=>r.set(i(a),a);let o=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,a=>r.delete(i(a))),t.visit(t.ADD,s)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function nP(e){z.call(this,null,e)}te(nP,z,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Ru(e.sort)):t.source).map(e.field))}});function TV(e,t,n,i){const r=Rd[e](t,n);return{init:r.init||Fo,update:function(s,o){o[i]=r.next(s)}}}const Rd={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Rd.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||q("ntile num must be greater than zero.");const n=Rd.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||q("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=RV(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function RV(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const OV=Object.keys(Rd);function iP(e){const t=le(e.ops),n=le(e.fields),i=le(e.params),r=le(e.aggregate_params),s=le(e.as),o=this.outputs=[],a=this.windows=[],u={},l={},c=[],f=[];let d=!0;function h(p){le(yn(p)).forEach(g=>u[g]=1)}h(e.sort),t.forEach((p,g)=>{const m=n[g],y=i[g],v=r[g]||null,b=St(m),x=R3(p,b,s[g]);if(h(m),o.push(x),fe(Rd,p))a.push(TV(p,m,y,x));else{if(m==null&&p!=="count"&&q("Null aggregate field specified."),p==="count"){c.push(x);return}d=!1;let w=l[b];w||(w=l[b]=[],w.field=m,f.push(w)),w.push(O3(p,v,x))}}),(c.length||f.length)&&(this.cell=DV(f,c,d)),this.inputs=Object.keys(u)}const rP=iP.prototype;rP.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};rP.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,s=i&&i.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(r[o]);for(o=e.p1;o<e.i1;++o)n.add(r[o]);n.set(t)}for(o=0;o<s;++o)i[o].update(e,t)};function DV(e,t,n){e=e.map(u=>N3(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,s=i.agg=Array(r),o=0;o<r;++o)s[o]=new e[o](i);if(i.store)var a=i.data=new p_;return i.add=function(u){if(i.num+=1,!n){a&&a.add(u);for(let l=0;l<r;++l)s[l].add(s[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){a&&a.rem(u);for(let l=0;l<r;++l)s[l].rem(s[l].get(u),u)}},i.set=function(u){let l,c;for(a&&a.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=s.length;l<c;++l)s[l].set(u)},i.init=function(){i.num=0,a&&a.reset();for(let u=0;u<r;++u)s[u].init()},i}function L_(e){z.call(this,{},e),this._mlen=0,this._mods=[]}L_.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:OV.concat(fh)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};te(L_,z,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Ru(e.sort),r=Zb(e.groupby),s=a=>this.group(r(a));let o=this.state;(!o||n)&&(o=this.state=new iP(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,a=>s(a).add(a))):(t.visit(t.REM,a=>s(a).remove(a)),t.visit(t.ADD,a=>s(a).add(a)));for(let a=0,u=this._mlen;a<u;++a)NV(this._mods[a],o,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=P3(be),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function NV(e,t,n,i){const r=i.sort,s=r&&!i.ignorePeers,o=i.frame||[null,0],a=e.data(n),u=a.length,l=s?Ac(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||En(-1)};t.init();for(let f=0;f<u;++f)PV(c,o,f,u),s&&IV(c,l),t.update(c,a[f])}function PV(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function IV(e,t){const n=e.i0,i=e.i1-1,r=e.compare,s=e.data,o=s.length-1;n>0&&!r(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<o&&!r(s[i],s[i+1])&&(e.i1=t.right(s,s[i]))}const LV=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Xo,bin:g_,collect:m_,compare:I3,countpattern:y_,cross:v_,density:b_,dotbin:w_,expression:j3,extent:__,facet:N0,field:q3,filter:S_,flatten:$_,fold:A_,formula:C_,generate:W3,impute:k_,joinaggregate:M_,kde:F_,key:H3,load:G3,lookup:T_,multiextent:V3,multivalues:Y3,params:X3,pivot:R_,prefacet:K3,project:O_,proxy:Q3,quantile:D_,relay:J3,sample:N_,sequence:P_,sieve:Z3,subflow:E_,timeunit:I_,tupleindex:tP,values:nP,window:L_},Symbol.toStringTag,{value:"Module"}));function Qe(e){return function(){return e}}const _k=Math.abs,on=Math.atan2,$a=Math.cos,zV=Math.max,Yy=Math.min,Rr=Math.sin,Ha=Math.sqrt,un=1e-12,ql=Math.PI,Ng=ql/2,sP=2*ql;function BV(e){return e>1?0:e<-1?ql:Math.acos(e)}function Ek(e){return e>=1?Ng:e<=-1?-Ng:Math.asin(e)}const ex=Math.PI,tx=2*ex,Ia=1e-6,UV=tx-Ia;function oP(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function jV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return oP;const n=10**t;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}let z_=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?oP:jV(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,r){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(t,n,i,r,s,o){this._append`C${+t},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,r,s){if(t=+t,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,u=i-t,l=r-n,c=o-t,f=a-n,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>Ia)if(!(Math.abs(f*u-l*c)>Ia)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=i-o,p=r-a,g=u*u+l*l,m=h*h+p*p,y=Math.sqrt(g),v=Math.sqrt(d),b=s*Math.tan((ex-Math.acos((g+d-m)/(2*y*v)))/2),x=b/v,w=b/y;Math.abs(x-1)>Ia&&this._append`L${t+x*c},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*h>c*p)},${this._x1=t+w*u},${this._y1=n+w*l}`}}arc(t,n,i,r,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),u=i*Math.sin(r),l=t+a,c=n+u,f=1^o,d=o?r-s:s-r;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>Ia||Math.abs(this._y1-c)>Ia)&&this._append`L${l},${c}`,i&&(d<0&&(d=d%tx+tx),d>UV?this._append`A${i},${i},0,1,${f},${t-a},${n-u}A${i},${i},0,1,${f},${this._x1=l},${this._y1=c}`:d>Ia&&this._append`A${i},${i},0,${+(d>=ex)},${f},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}};function P0(){return new z_}P0.prototype=z_.prototype;function I0(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new z_(t)}function qV(e){return e.innerRadius}function WV(e){return e.outerRadius}function HV(e){return e.startAngle}function GV(e){return e.endAngle}function VV(e){return e&&e.padAngle}function YV(e,t,n,i,r,s,o,a){var u=n-e,l=i-t,c=o-r,f=a-s,d=f*u-c*l;if(!(d*d<un))return d=(c*(t-s)-f*(e-r))/d,[e+d*u,t+d*l]}function ap(e,t,n,i,r,s,o){var a=e-n,u=t-i,l=(o?s:-s)/Ha(a*a+u*u),c=l*u,f=-l*a,d=e+c,h=t+f,p=n+c,g=i+f,m=(d+p)/2,y=(h+g)/2,v=p-d,b=g-h,x=v*v+b*b,w=r-s,E=d*g-p*h,_=(b<0?-1:1)*Ha(zV(0,w*w*x-E*E)),$=(E*b-v*_)/x,A=(-E*v-b*_)/x,F=(E*b+v*_)/x,M=(-E*v+b*_)/x,P=$-m,D=A-y,O=F-m,C=M-y;return P*P+D*D>O*O+C*C&&($=F,A=M),{cx:$,cy:A,x01:-c,y01:-f,x11:$*(r/w-1),y11:A*(r/w-1)}}function XV(){var e=qV,t=WV,n=Qe(0),i=null,r=HV,s=GV,o=VV,a=null,u=I0(l);function l(){var c,f,d=+e.apply(this,arguments),h=+t.apply(this,arguments),p=r.apply(this,arguments)-Ng,g=s.apply(this,arguments)-Ng,m=_k(g-p),y=g>p;if(a||(a=c=u()),h<d&&(f=h,h=d,d=f),!(h>un))a.moveTo(0,0);else if(m>sP-un)a.moveTo(h*$a(p),h*Rr(p)),a.arc(0,0,h,p,g,!y),d>un&&(a.moveTo(d*$a(g),d*Rr(g)),a.arc(0,0,d,g,p,y));else{var v=p,b=g,x=p,w=g,E=m,_=m,$=o.apply(this,arguments)/2,A=$>un&&(i?+i.apply(this,arguments):Ha(d*d+h*h)),F=Yy(_k(h-d)/2,+n.apply(this,arguments)),M=F,P=F,D,O;if(A>un){var C=Ek(A/d*Rr($)),R=Ek(A/h*Rr($));(E-=C*2)>un?(C*=y?1:-1,x+=C,w-=C):(E=0,x=w=(p+g)/2),(_-=R*2)>un?(R*=y?1:-1,v+=R,b-=R):(_=0,v=b=(p+g)/2)}var N=h*$a(v),I=h*Rr(v),U=d*$a(w),re=d*Rr(w);if(F>un){var me=h*$a(b),de=h*Rr(b),$e=d*$a(x),Be=d*Rr(x),Ae;if(m<ql)if(Ae=YV(N,I,$e,Be,me,de,U,re)){var et=N-Ae[0],V=I-Ae[1],ce=me-Ae[0],L=de-Ae[1],X=1/Rr(BV((et*ce+V*L)/(Ha(et*et+V*V)*Ha(ce*ce+L*L)))/2),pe=Ha(Ae[0]*Ae[0]+Ae[1]*Ae[1]);M=Yy(F,(d-pe)/(X-1)),P=Yy(F,(h-pe)/(X+1))}else M=P=0}_>un?P>un?(D=ap($e,Be,N,I,h,P,y),O=ap(me,de,U,re,h,P,y),a.moveTo(D.cx+D.x01,D.cy+D.y01),P<F?a.arc(D.cx,D.cy,P,on(D.y01,D.x01),on(O.y01,O.x01),!y):(a.arc(D.cx,D.cy,P,on(D.y01,D.x01),on(D.y11,D.x11),!y),a.arc(0,0,h,on(D.cy+D.y11,D.cx+D.x11),on(O.cy+O.y11,O.cx+O.x11),!y),a.arc(O.cx,O.cy,P,on(O.y11,O.x11),on(O.y01,O.x01),!y))):(a.moveTo(N,I),a.arc(0,0,h,v,b,!y)):a.moveTo(N,I),!(d>un)||!(E>un)?a.lineTo(U,re):M>un?(D=ap(U,re,me,de,d,-M,y),O=ap(N,I,$e,Be,d,-M,y),a.lineTo(D.cx+D.x01,D.cy+D.y01),M<F?a.arc(D.cx,D.cy,M,on(D.y01,D.x01),on(O.y01,O.x01),!y):(a.arc(D.cx,D.cy,M,on(D.y01,D.x01),on(D.y11,D.x11),!y),a.arc(0,0,d,on(D.cy+D.y11,D.cx+D.x11),on(O.cy+O.y11,O.cx+O.x11),y),a.arc(O.cx,O.cy,M,on(O.y11,O.x11),on(O.y01,O.x01),!y))):a.arc(0,0,d,w,x,y)}if(a.closePath(),c)return a=null,c+""||null}return l.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +s.apply(this,arguments))/2-ql/2;return[$a(f)*c,Rr(f)*c]},l.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:Qe(+c),l):e},l.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:Qe(+c),l):t},l.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:Qe(+c),l):n},l.padRadius=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:Qe(+c),l):i},l.startAngle=function(c){return arguments.length?(r=typeof c=="function"?c:Qe(+c),l):r},l.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:Qe(+c),l):s},l.padAngle=function(c){return arguments.length?(o=typeof c=="function"?c:Qe(+c),l):o},l.context=function(c){return arguments.length?(a=c??null,l):a},l}function aP(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function uP(e){this._context=e}uP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function B_(e){return new uP(e)}function lP(e){return e[0]}function cP(e){return e[1]}function fP(e,t){var n=Qe(!0),i=null,r=B_,s=null,o=I0(a);e=typeof e=="function"?e:e===void 0?lP:Qe(e),t=typeof t=="function"?t:t===void 0?cP:Qe(t);function a(u){var l,c=(u=aP(u)).length,f,d=!1,h;for(i==null&&(s=r(h=o())),l=0;l<=c;++l)!(l<c&&n(f=u[l],l,u))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,u),+t(f,l,u));if(h)return s=null,h+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:Qe(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:Qe(+u),a):t},a.defined=function(u){return arguments.length?(n=typeof u=="function"?u:Qe(!!u),a):n},a.curve=function(u){return arguments.length?(r=u,i!=null&&(s=r(i)),a):r},a.context=function(u){return arguments.length?(u==null?i=s=null:s=r(i=u),a):i},a}function dP(e,t,n){var i=null,r=Qe(!0),s=null,o=B_,a=null,u=I0(l);e=typeof e=="function"?e:e===void 0?lP:Qe(+e),t=typeof t=="function"?t:Qe(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?cP:Qe(+n);function l(f){var d,h,p,g=(f=aP(f)).length,m,y=!1,v,b=new Array(g),x=new Array(g);for(s==null&&(a=o(v=u())),d=0;d<=g;++d){if(!(d<g&&r(m=f[d],d,f))===y)if(y=!y)h=d,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=d-1;p>=h;--p)a.point(b[p],x[p]);a.lineEnd(),a.areaEnd()}y&&(b[d]=+e(m,d,f),x[d]=+t(m,d,f),a.point(i?+i(m,d,f):b[d],n?+n(m,d,f):x[d]))}if(v)return a=null,v+""||null}function c(){return fP().defined(r).curve(o).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Qe(+f),i=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Qe(+f),l):e},l.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:Qe(+f),l):i},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Qe(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Qe(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Qe(+f),l):n},l.lineX0=l.lineY0=function(){return c().x(e).y(t)},l.lineY1=function(){return c().x(e).y(n)},l.lineX1=function(){return c().x(i).y(t)},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Qe(!!f),l):r},l.curve=function(f){return arguments.length?(o=f,s!=null&&(a=o(s)),l):o},l.context=function(f){return arguments.length?(f==null?s=a=null:a=o(s=f),l):s},l}const KV={draw(e,t){const n=Ha(t/ql);e.moveTo(n,0),e.arc(0,0,n,0,sP)}};function QV(e,t){let n=null,i=I0(r);e=typeof e=="function"?e:Qe(e||KV),t=typeof t=="function"?t:Qe(t===void 0?64:+t);function r(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:Qe(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:Qe(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function Ko(){}function Pg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function L0(e){this._context=e}L0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Pg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Pg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JV(e){return new L0(e)}function hP(e){this._context=e}hP.prototype={areaStart:Ko,areaEnd:Ko,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Pg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZV(e){return new hP(e)}function pP(e){this._context=e}pP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Pg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eY(e){return new pP(e)}function gP(e,t){this._basis=new L0(e),this._beta=t}gP.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],s=e[n]-i,o=t[n]-r,a=-1,u;++a<=n;)u=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+u*s),this._beta*t[a]+(1-this._beta)*(r+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const tY=(function e(t){function n(i){return t===1?new L0(i):new gP(i,t)}return n.beta=function(i){return e(+i)},n})(.85);function Ig(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function U_(e,t){this._context=e,this._k=(1-t)/6}U_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ig(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ig(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nY=(function e(t){function n(i){return new U_(i,t)}return n.tension=function(i){return e(+i)},n})(0);function j_(e,t){this._context=e,this._k=(1-t)/6}j_.prototype={areaStart:Ko,areaEnd:Ko,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ig(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iY=(function e(t){function n(i){return new j_(i,t)}return n.tension=function(i){return e(+i)},n})(0);function q_(e,t){this._context=e,this._k=(1-t)/6}q_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ig(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const rY=(function e(t){function n(i){return new q_(i,t)}return n.tension=function(i){return e(+i)},n})(0);function W_(e,t,n){var i=e._x1,r=e._y1,s=e._x2,o=e._y2;if(e._l01_a>un){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>un){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,s,o,e._x2,e._y2)}function mP(e,t){this._context=e,this._alpha=t}mP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:W_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const sY=(function e(t){function n(i){return t?new mP(i,t):new U_(i,0)}return n.alpha=function(i){return e(+i)},n})(.5);function yP(e,t){this._context=e,this._alpha=t}yP.prototype={areaStart:Ko,areaEnd:Ko,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:W_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const oY=(function e(t){function n(i){return t?new yP(i,t):new j_(i,0)}return n.alpha=function(i){return e(+i)},n})(.5);function vP(e,t){this._context=e,this._alpha=t}vP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:W_(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aY=(function e(t){function n(i){return t?new vP(i,t):new q_(i,0)}return n.alpha=function(i){return e(+i)},n})(.5);function bP(e){this._context=e}bP.prototype={areaStart:Ko,areaEnd:Ko,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function uY(e){return new bP(e)}function Sk(e){return e<0?-1:1}function $k(e,t,n){var i=e._x1-e._x0,r=t-e._x1,s=(e._y1-e._y0)/(i||r<0&&-0),o=(n-e._y1)/(r||i<0&&-0),a=(s*r+o*i)/(i+r);return(Sk(s)+Sk(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function Ak(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Xy(e,t,n){var i=e._x0,r=e._y0,s=e._x1,o=e._y1,a=(s-i)/3;e._context.bezierCurveTo(i+a,r+a*t,s-a,o-a*n,s,o)}function Lg(e){this._context=e}Lg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Xy(this,this._t0,Ak(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Xy(this,Ak(this,n=$k(this,e,t)),n);break;default:Xy(this,this._t0,n=$k(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function xP(e){this._context=new wP(e)}(xP.prototype=Object.create(Lg.prototype)).point=function(e,t){Lg.prototype.point.call(this,t,e)};function wP(e){this._context=e}wP.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,s){this._context.bezierCurveTo(t,e,i,n,s,r)}};function lY(e){return new Lg(e)}function cY(e){return new xP(e)}function _P(e){this._context=e}_P.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=Ck(e),r=Ck(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],r[0][s],i[1][s],r[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Ck(e){var t,n=e.length-1,i,r=new Array(n),s=new Array(n),o=new Array(n);for(r[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(r[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)r[t]=(o[t]-r[t+1])/s[t];for(s[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-r[t+1];return[r,s]}function fY(e){return new _P(e)}function z0(e,t){this._context=e,this._t=t}z0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function dY(e){return new z0(e,.5)}function hY(e){return new z0(e,0)}function pY(e){return new z0(e,1)}function Wo(e,t){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const gY=()=>typeof Image<"u"?Image:null;function cs(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function la(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const nx=Symbol("implicit");function H_(){var e=new WC,t=[],n=[],i=nx;function r(s){let o=e.get(s);if(o===void 0){if(i!==nx)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new WC;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return H_(t,n).unknown(i)},cs.apply(r,arguments),r}function Rc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function dh(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function ca(){}var uu=.7,Wl=1/uu,Sl="\\s*([+-]?\\d+)\\s*",Od="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mY=/^#([0-9a-f]{3,8})$/,yY=new RegExp(`^rgb\\(${Sl},${Sl},${Sl}\\)$`),vY=new RegExp(`^rgb\\(${Vr},${Vr},${Vr}\\)$`),bY=new RegExp(`^rgba\\(${Sl},${Sl},${Sl},${Od}\\)$`),xY=new RegExp(`^rgba\\(${Vr},${Vr},${Vr},${Od}\\)$`),wY=new RegExp(`^hsl\\(${Od},${Vr},${Vr}\\)$`),_Y=new RegExp(`^hsla\\(${Od},${Vr},${Vr},${Od}\\)$`),kk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Rc(ca,Dd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Mk,formatHex:Mk,formatHex8:EY,formatHsl:SY,formatRgb:Fk,toString:Fk});function Mk(){return this.rgb().formatHex()}function EY(){return this.rgb().formatHex8()}function SY(){return EP(this).formatHsl()}function Fk(){return this.rgb().formatRgb()}function Dd(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=mY.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Tk(t):n===3?new Bt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?up(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?up(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yY.exec(e))?new Bt(t[1],t[2],t[3],1):(t=vY.exec(e))?new Bt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=bY.exec(e))?up(t[1],t[2],t[3],t[4]):(t=xY.exec(e))?up(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wY.exec(e))?Dk(t[1],t[2]/100,t[3]/100,1):(t=_Y.exec(e))?Dk(t[1],t[2]/100,t[3]/100,t[4]):kk.hasOwnProperty(e)?Tk(kk[e]):e==="transparent"?new Bt(NaN,NaN,NaN,0):null}function Tk(e){return new Bt(e>>16&255,e>>8&255,e&255,1)}function up(e,t,n,i){return i<=0&&(e=t=n=NaN),new Bt(e,t,n,i)}function G_(e){return e instanceof ca||(e=Dd(e)),e?(e=e.rgb(),new Bt(e.r,e.g,e.b,e.opacity)):new Bt}function Qo(e,t,n,i){return arguments.length===1?G_(e):new Bt(e,t,n,i??1)}function Bt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Rc(Bt,Qo,dh(ca,{brighter(e){return e=e==null?Wl:Math.pow(Wl,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?uu:Math.pow(uu,e),new Bt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bt(Qa(this.r),Qa(this.g),Qa(this.b),zg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Rk,formatHex:Rk,formatHex8:$Y,formatRgb:Ok,toString:Ok}));function Rk(){return`#${Ga(this.r)}${Ga(this.g)}${Ga(this.b)}`}function $Y(){return`#${Ga(this.r)}${Ga(this.g)}${Ga(this.b)}${Ga((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ok(){const e=zg(this.opacity);return`${e===1?"rgb(":"rgba("}${Qa(this.r)}, ${Qa(this.g)}, ${Qa(this.b)}${e===1?")":`, ${e})`}`}function zg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ga(e){return e=Qa(e),(e<16?"0":"")+e.toString(16)}function Dk(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new tr(e,t,n,i)}function EP(e){if(e instanceof tr)return new tr(e.h,e.s,e.l,e.opacity);if(e instanceof ca||(e=Dd(e)),!e)return new tr;if(e instanceof tr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(t===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-t)/a+2:o=(t-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new tr(o,a,u,e.opacity)}function Bg(e,t,n,i){return arguments.length===1?EP(e):new tr(e,t,n,i??1)}function tr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Rc(tr,Bg,dh(ca,{brighter(e){return e=e==null?Wl:Math.pow(Wl,e),new tr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?uu:Math.pow(uu,e),new tr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Bt(Ky(e>=240?e-240:e+120,r,i),Ky(e,r,i),Ky(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new tr(Nk(this.h),lp(this.s),lp(this.l),zg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=zg(this.opacity);return`${e===1?"hsl(":"hsla("}${Nk(this.h)}, ${lp(this.s)*100}%, ${lp(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Nk(e){return e=(e||0)%360,e<0?e+360:e}function lp(e){return Math.max(0,Math.min(1,e||0))}function Ky(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const SP=Math.PI/180,$P=180/Math.PI,Ug=18,AP=.96422,CP=1,kP=.82521,MP=4/29,$l=6/29,FP=3*$l*$l,AY=$l*$l*$l;function TP(e){if(e instanceof Yr)return new Yr(e.l,e.a,e.b,e.opacity);if(e instanceof zs)return RP(e);e instanceof Bt||(e=G_(e));var t=ev(e.r),n=ev(e.g),i=ev(e.b),r=Qy((.2225045*t+.7168786*n+.0606169*i)/CP),s,o;return t===n&&n===i?s=o=r:(s=Qy((.4360747*t+.3850649*n+.1430804*i)/AP),o=Qy((.0139322*t+.0971045*n+.7141733*i)/kP)),new Yr(116*r-16,500*(s-r),200*(r-o),e.opacity)}function jg(e,t,n,i){return arguments.length===1?TP(e):new Yr(e,t,n,i??1)}function Yr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Rc(Yr,jg,dh(ca,{brighter(e){return new Yr(this.l+Ug*(e??1),this.a,this.b,this.opacity)},darker(e){return new Yr(this.l-Ug*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=AP*Jy(t),e=CP*Jy(e),n=kP*Jy(n),new Bt(Zy(3.1338561*t-1.6168667*e-.4906146*n),Zy(-.9787684*t+1.9161415*e+.033454*n),Zy(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Qy(e){return e>AY?Math.pow(e,1/3):e/FP+MP}function Jy(e){return e>$l?e*e*e:FP*(e-MP)}function Zy(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ev(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function CY(e){if(e instanceof zs)return new zs(e.h,e.c,e.l,e.opacity);if(e instanceof Yr||(e=TP(e)),e.a===0&&e.b===0)return new zs(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*$P;return new zs(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function qg(e,t,n,i){return arguments.length===1?CY(e):new zs(e,t,n,i??1)}function zs(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function RP(e){if(isNaN(e.h))return new Yr(e.l,0,0,e.opacity);var t=e.h*SP;return new Yr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Rc(zs,qg,dh(ca,{brighter(e){return new zs(this.h,this.c,this.l+Ug*(e??1),this.opacity)},darker(e){return new zs(this.h,this.c,this.l-Ug*(e??1),this.opacity)},rgb(){return RP(this).rgb()}}));var OP=-.14861,V_=1.78277,Y_=-.29227,B0=-.90649,Nd=1.97294,Pk=Nd*B0,Ik=Nd*V_,Lk=V_*Y_-B0*OP;function kY(e){if(e instanceof Ja)return new Ja(e.h,e.s,e.l,e.opacity);e instanceof Bt||(e=G_(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(Lk*i+Pk*t-Ik*n)/(Lk+Pk-Ik),s=i-r,o=(Nd*(n-r)-Y_*s)/B0,a=Math.sqrt(o*o+s*s)/(Nd*r*(1-r)),u=a?Math.atan2(o,s)*$P-120:NaN;return new Ja(u<0?u+360:u,a,r,e.opacity)}function ix(e,t,n,i){return arguments.length===1?kY(e):new Ja(e,t,n,i??1)}function Ja(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Rc(Ja,ix,dh(ca,{brighter(e){return e=e==null?Wl:Math.pow(Wl,e),new Ja(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?uu:Math.pow(uu,e),new Ja(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*SP,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Bt(255*(t+n*(OP*i+V_*r)),255*(t+n*(Y_*i+B0*r)),255*(t+n*(Nd*i)),this.opacity)}}));function DP(e,t,n,i,r){var s=e*e,o=s*e;return((1-3*e+3*s-o)*t+(4-6*s+3*o)*n+(1+3*e+3*s-3*o)*i+o*r)/6}function NP(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],s=e[i+1],o=i>0?e[i-1]:2*r-s,a=i<t-1?e[i+2]:2*s-r;return DP((n-i/t)*t,o,r,s,a)}}function PP(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],s=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return DP((n-i/t)*t,r,s,o,a)}}const U0=e=>()=>e;function IP(e,t){return function(n){return e+n*t}}function MY(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function j0(e,t){var n=t-e;return n?IP(e,n>180||n<-180?n-360*Math.round(n/360):n):U0(isNaN(e)?t:e)}function FY(e){return(e=+e)==1?Ut:function(t,n){return n-t?MY(t,n,e):U0(isNaN(t)?n:t)}}function Ut(e,t){var n=t-e;return n?IP(e,n):U0(isNaN(e)?t:e)}const rx=(function e(t){var n=FY(t);function i(r,s){var o=n((r=Qo(r)).r,(s=Qo(s)).r),a=n(r.g,s.g),u=n(r.b,s.b),l=Ut(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i})(1);function LP(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Qo(t[o]),i[o]=a.r||0,r[o]=a.g||0,s[o]=a.b||0;return i=e(i),r=e(r),s=e(s),a.opacity=1,function(u){return a.r=i(u),a.g=r(u),a.b=s(u),a+""}}}var TY=LP(NP),RY=LP(PP);function X_(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=e[r]*(1-s)+t[r]*s;return i}}function zP(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function OY(e,t){return(zP(t)?X_:BP)(e,t)}function BP(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=fa(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function UP(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function Ji(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function jP(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=fa(e[r],t[r]):i[r]=t[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var sx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tv=new RegExp(sx.source,"g");function DY(e){return function(){return e}}function NY(e){return function(t){return e(t)+""}}function qP(e,t){var n=sx.lastIndex=tv.lastIndex=0,i,r,s,o=-1,a=[],u=[];for(e=e+"",t=t+"";(i=sx.exec(e))&&(r=tv.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,u.push({i:o,x:Ji(i,r)})),n=tv.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?NY(u[0].x):DY(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}function fa(e,t){var n=typeof t,i;return t==null||n==="boolean"?U0(t):(n==="number"?Ji:n==="string"?(i=Dd(t))?(t=i,rx):qP:t instanceof Dd?rx:t instanceof Date?UP:zP(t)?X_:Array.isArray(t)?BP:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?jP:Ji)(e,t)}function PY(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function IY(e,t){var n=j0(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function hh(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var zk=180/Math.PI,ox={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function WP(e,t,n,i,r,s){var o,a,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),e*i<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*zk,skewX:Math.atan(u)*zk,scaleX:o,scaleY:a}}var cp;function LY(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?ox:WP(t.a,t.b,t.c,t.d,t.e,t.f)}function zY(e){return e==null||(cp||(cp=document.createElementNS("http://www.w3.org/2000/svg","g")),cp.setAttribute("transform",e),!(e=cp.transform.baseVal.consolidate()))?ox:(e=e.matrix,WP(e.a,e.b,e.c,e.d,e.e,e.f))}function HP(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function s(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Ji(l,f)},{i:g-2,x:Ji(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Ji(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Ji(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Ji(l,f)},{i:g-2,x:Ji(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),s(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var BY=HP(LY,"px, ","px)","deg)"),UY=HP(zY,", ",")",")"),jY=1e-12;function Bk(e){return((e=Math.exp(e))+1/e)/2}function qY(e){return((e=Math.exp(e))-1/e)/2}function WY(e){return((e=Math.exp(2*e))-1)/(e+1)}const HY=(function e(t,n,i){function r(s,o){var a=s[0],u=s[1],l=s[2],c=o[0],f=o[1],d=o[2],h=c-a,p=f-u,g=h*h+p*p,m,y;if(g<jY)y=Math.log(d/l)/t,m=function(_){return[a+_*h,u+_*p,l*Math.exp(t*_*y)]};else{var v=Math.sqrt(g),b=(d*d-l*l+i*g)/(2*l*n*v),x=(d*d-l*l-i*g)/(2*d*n*v),w=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(x*x+1)-x);y=(E-w)/t,m=function(_){var $=_*y,A=Bk(w),F=l/(n*v)*(A*WY(t*$+w)-qY(w));return[a+F*h,u+F*p,l*A/Bk(t*$+w)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(s){var o=Math.max(.001,+s),a=o*o,u=a*a;return e(o,a,u)},r})(Math.SQRT2,2,4);function GP(e){return function(t,n){var i=e((t=Bg(t)).h,(n=Bg(n)).h),r=Ut(t.s,n.s),s=Ut(t.l,n.l),o=Ut(t.opacity,n.opacity);return function(a){return t.h=i(a),t.s=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const GY=GP(j0);var VY=GP(Ut);function YY(e,t){var n=Ut((e=jg(e)).l,(t=jg(t)).l),i=Ut(e.a,t.a),r=Ut(e.b,t.b),s=Ut(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=i(o),e.b=r(o),e.opacity=s(o),e+""}}function VP(e){return function(t,n){var i=e((t=qg(t)).h,(n=qg(n)).h),r=Ut(t.c,n.c),s=Ut(t.l,n.l),o=Ut(t.opacity,n.opacity);return function(a){return t.h=i(a),t.c=r(a),t.l=s(a),t.opacity=o(a),t+""}}}const XY=VP(j0);var KY=VP(Ut);function YP(e){return(function t(n){n=+n;function i(r,s){var o=e((r=ix(r)).h,(s=ix(s)).h),a=Ut(r.s,s.s),u=Ut(r.l,s.l),l=Ut(r.opacity,s.opacity);return function(c){return r.h=o(c),r.s=a(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i})(1)}const QY=YP(j0);var JY=YP(Ut);function K_(e,t){t===void 0&&(t=e,e=fa);for(var n=0,i=t.length-1,r=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(r,r=t[++n]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[a](o-a)}}function ZY(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}const eX=Object.freeze(Object.defineProperty({__proto__:null,interpolate:fa,interpolateArray:OY,interpolateBasis:NP,interpolateBasisClosed:PP,interpolateCubehelix:QY,interpolateCubehelixLong:JY,interpolateDate:UP,interpolateDiscrete:PY,interpolateHcl:XY,interpolateHclLong:KY,interpolateHsl:GY,interpolateHslLong:VY,interpolateHue:IY,interpolateLab:YY,interpolateNumber:Ji,interpolateNumberArray:X_,interpolateObject:jP,interpolateRgb:rx,interpolateRgbBasis:TY,interpolateRgbBasisClosed:RY,interpolateRound:hh,interpolateString:qP,interpolateTransformCss:BY,interpolateTransformSvg:UY,interpolateZoom:HY,piecewise:K_,quantize:ZY},Symbol.toStringTag,{value:"Module"}));function tX(e){return function(){return e}}function ax(e){return+e}var Uk=[0,1];function Jn(e){return e}function ux(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:tX(isNaN(t)?NaN:.5)}function nX(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function iX(e,t,n){var i=e[0],r=e[1],s=t[0],o=t[1];return r<i?(i=ux(r,i),s=n(o,s)):(i=ux(i,r),s=n(s,o)),function(a){return s(i(a))}}function rX(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)r[o]=ux(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(a){var u=Vo(e,a,1,i)-1;return s[u](r[u](a))}}function ph(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function q0(){var e=Uk,t=Uk,n=fa,i,r,s,o=Jn,a,u,l;function c(){var d=Math.min(e.length,t.length);return o!==Jn&&(o=nX(e[0],e[d-1])),a=d>2?rX:iX,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(u||(u=a(e.map(i),t,n)))(i(o(d)))}return f.invert=function(d){return o(r((l||(l=a(t,e.map(i),Ji)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,ax),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=hh,c()},f.clamp=function(d){return arguments.length?(o=d?!0:Jn,c()):o!==Jn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return i=d,r=h,c()}}function XP(){return q0()(Jn,Jn)}function KP(e,t,n,i){var r=Yo(e,t,n),s;switch(i=au(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=_N(r,o))&&(i.precision=s),I2(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=EN(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=wN(r))&&(i.precision=s-(i.type==="%")*2);break}}return v0(i)}function Du(e){var t=e.domain;return e.ticks=function(n){var i=t();return Bb(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var r=t();return KP(r[0],r[r.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,s=i.length-1,o=i[r],a=i[s],u,l,c=10;for(a<o&&(l=o,o=a,a=l,l=r,r=s,s=l);c-- >0;){if(l=Ub(o,a,n),l===u)return i[r]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;u=l}return e},e}function QP(){var e=XP();return e.copy=function(){return ph(e,QP())},cs.apply(e,arguments),Du(e)}function JP(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,ax),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return JP(e).unknown(t)},e=arguments.length?Array.from(e,ax):[0,1],Du(n)}function ZP(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],s=e[i],o;return s<r&&(o=n,n=i,i=o,o=r,r=s,s=o),e[n]=t.floor(r),e[i]=t.ceil(s),e}function jk(e){return Math.log(e)}function qk(e){return Math.exp(e)}function sX(e){return-Math.log(-e)}function oX(e){return-Math.exp(-e)}function aX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function uX(e){return e===10?aX:e===Math.E?Math.exp:t=>Math.pow(e,t)}function lX(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Wk(e){return(t,n)=>-e(-t,n)}function Q_(e){const t=e(jk,qk),n=t.domain;let i=10,r,s;function o(){return r=lX(i),s=uX(i),n()[0]<0?(r=Wk(r),s=Wk(s),e(sX,oX)):e(jk,qk),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(n(a),o()):n()},t.ticks=a=>{const u=n();let l=u[0],c=u[u.length-1];const f=c<l;f&&([l,c]=[c,l]);let d=r(l),h=r(c),p,g;const m=a==null?10:+a;let y=[];if(!(i%1)&&h-d<m){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<i;++p)if(g=d<0?p/s(-d):p*s(d),!(g<l)){if(g>c)break;y.push(g)}}else for(;d<=h;++d)for(p=i-1;p>=1;--p)if(g=d>0?p/s(-d):p*s(d),!(g<l)){if(g>c)break;y.push(g)}y.length*2<m&&(y=Bb(l,c,m))}else y=Bb(d,h,Math.min(h-d,m)).map(s);return f?y.reverse():y},t.tickFormat=(a,u)=>{if(a==null&&(a=10),u==null&&(u=i===10?"s":","),typeof u!="function"&&(!(i%1)&&(u=au(u)).precision==null&&(u.trim=!0),u=v0(u)),a===1/0)return u;const l=Math.max(1,i*a/t.ticks().length);return c=>{let f=c/s(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=()=>n(ZP(n(),{floor:a=>s(Math.floor(r(a))),ceil:a=>s(Math.ceil(r(a)))})),t}function e5(){const e=Q_(q0()).domain([1,10]);return e.copy=()=>ph(e,e5()).base(e.base()),cs.apply(e,arguments),e}function Hk(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Gk(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function J_(e){var t=1,n=e(Hk(t),Gk(t));return n.constant=function(i){return arguments.length?e(Hk(t=+i),Gk(t)):t},Du(n)}function t5(){var e=J_(q0());return e.copy=function(){return ph(e,t5()).constant(e.constant())},cs.apply(e,arguments)}function Vk(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function cX(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function fX(e){return e<0?-e*e:e*e}function Z_(e){var t=e(Jn,Jn),n=1;function i(){return n===1?e(Jn,Jn):n===.5?e(cX,fX):e(Vk(n),Vk(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},Du(t)}function eE(){var e=Z_(q0());return e.copy=function(){return ph(e,eE()).exponent(e.exponent())},cs.apply(e,arguments),e}function dX(){return eE.apply(null,arguments).exponent(.5)}function n5(){var e=[],t=[],n=[],i;function r(){var o=0,a=Math.max(1,t.length);for(n=new Array(a-1);++o<a;)n[o-1]=gN(e,o/a);return s}function s(o){return o==null||isNaN(o=+o)?i:t[Vo(n,o)]}return s.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(qs),r()},s.range=function(o){return arguments.length?(t=Array.from(o),r()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return n5().domain(e).range(t).unknown(i)},cs.apply(s,arguments)}function i5(){var e=0,t=1,n=1,i=[.5],r=[0,1],s;function o(u){return u!=null&&u<=u?r[Vo(i,u,0,n)]:s}function a(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,a()):[e,t]},o.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,a()):r.slice()},o.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},o.unknown=function(u){return arguments.length&&(s=u),o},o.thresholds=function(){return i.slice()},o.copy=function(){return i5().domain([e,t]).range(r).unknown(s)},cs.apply(Du(o),arguments)}function r5(){var e=[.5],t=[0,1],n,i=1;function r(s){return s!=null&&s<=s?t[Vo(e,s,0,i)]:n}return r.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},r.unknown=function(s){return arguments.length?(n=s,r):n},r.copy=function(){return r5().domain(e).range(t).unknown(n)},cs.apply(r,arguments)}function hX(e){return new Date(e)}function pX(e){return e instanceof Date?+e:+new Date(+e)}function tE(e,t,n,i,r,s,o,a,u,l){var c=XP(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),x=l("%Y");function w(E){return(u(E)<E?h:a(E)<E?p:o(E)<E?g:s(E)<E?m:i(E)<E?r(E)<E?y:v:n(E)<E?b:x)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,pX)):d().map(hX)},c.ticks=function(E){var _=d();return e(_[0],_[_.length-1],E??10)},c.tickFormat=function(E,_){return _==null?w:l(_)},c.nice=function(E){var _=d();return(!E||typeof E.range!="function")&&(E=t(_[0],_[_.length-1],E??10)),E?d(ZP(_,E)):c},c.copy=function(){return ph(c,tE(e,t,n,i,r,s,o,a,u,l))},c}function gX(){return cs.apply(tE(wW,_W,ts,kd,Cc,Ws,w0,b0,Ls,j2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function mX(){return cs.apply(tE(bW,xW,ns,Md,kc,jo,_0,x0,Ls,q2).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function W0(){var e=0,t=1,n,i,r,s,o=Jn,a=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(r===0?.5:(f=(s(f)-n)*r,a?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(a=!!f,l):a},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(fa),l.rangeRound=c(hh),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return s=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function da(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nE(){var e=Du(W0()(Jn));return e.copy=function(){return da(e,nE())},la.apply(e,arguments)}function s5(){var e=Q_(W0()).domain([1,10]);return e.copy=function(){return da(e,s5()).base(e.base())},la.apply(e,arguments)}function o5(){var e=J_(W0());return e.copy=function(){return da(e,o5()).constant(e.constant())},la.apply(e,arguments)}function iE(){var e=Z_(W0());return e.copy=function(){return da(e,iE()).exponent(e.exponent())},la.apply(e,arguments)}function yX(){return iE.apply(null,arguments).exponent(.5)}function H0(){var e=0,t=.5,n=1,i=1,r,s,o,a,u,l=Jn,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-s)*(i*g<i*s?a:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,r=c(e=+e),s=c(t=+t),o=c(n=+n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var y,v,b;return arguments.length?([y,v,b]=m,l=K_(g,[y,v,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(fa),h.rangeRound=p(hh),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,r=g(e),s=g(t),o=g(n),a=r===s?0:.5/(s-r),u=s===o?0:.5/(o-s),i=s<r?-1:1,h}}function a5(){var e=Du(H0()(Jn));return e.copy=function(){return da(e,a5())},la.apply(e,arguments)}function u5(){var e=Q_(H0()).domain([.1,1,10]);return e.copy=function(){return da(e,u5()).base(e.base())},la.apply(e,arguments)}function l5(){var e=J_(H0());return e.copy=function(){return da(e,l5()).constant(e.constant())},la.apply(e,arguments)}function rE(){var e=Z_(H0());return e.copy=function(){return da(e,rE()).exponent(e.exponent())},la.apply(e,arguments)}function vX(){return rE.apply(null,arguments).exponent(.5)}function fs(e){for(var t=e.length/6|0,n=new Array(t),i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}const bX=fs("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),xX=fs("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),wX=fs("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),_X=fs("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),EX=fs("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),SX=fs("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),$X=fs("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),AX=fs("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),CX=fs("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),kX=fs("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function sE(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const MX="identity",Hl="linear",eo="log",gh="pow",mh="sqrt",G0="symlog",lu="time",cu="utc",Xr="sequential",Oc="diverging",Gl="quantile",V0="quantize",Y0="threshold",oE="ordinal",lx="point",c5="band",aE="bin-ordinal",Lt="continuous",yh="discrete",vh="discretizing",Wi="interpolating",uE="temporal";function FX(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function TX(e){return function(t){const n=e.range();let i=t[0],r=t[1],s=-1,o,a,u,l;for(r<i&&(a=i,i=r,r=a),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(s<0&&(s=u),o=u);if(!(s<0))return i=e.invertExtent(n[s]),r=e.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function lE(){const e=H_().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,s,o=!1,a=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],p=sE(f,a,u);let g=i[d-0];r=(h-g)/(p||1),o&&(r=Math.floor(r)),g+=(h-g-r*(f-a))*l,s=r*(1-a),o&&(g=Math.round(g),s=Math.round(s));const m=gi(f).map(y=>g+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return s},e.step=function(){return r},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),a=u,c()):a},e.paddingInner=function(f){return arguments.length?(a=Math.max(0,Math.min(1,f)),c()):a},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],y,v,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>i[1-d])))return y=Math.max(0,Vo(h,g)-1),v=g===m?y:Vo(h,m)-1,g-h[y]>s+1e-10&&++y,d&&(b=y,y=p-v,v=p-b),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return lE().domain(t()).range(i).round(o).paddingInner(a).paddingOuter(u).align(l)},c()}function f5(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return f5(t())},e}function RX(){return f5(lE().paddingInner(1))}var OX=Array.prototype.map;function DX(e){return OX.call(e,pn)}const NX=Array.prototype.slice;function d5(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(Vo(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=DX(i),n):e.slice()},n.range=function(i){return arguments.length?(t=NX.call(i),n):t.slice()},n.tickFormat=function(i,r){return KP(e[0],ze(e),i??10,r)},n.copy=function(){return d5().domain(n.domain()).range(n.range())},n}const Wg=new Map,h5=Symbol("vega_scale");function p5(e){return e[h5]=!0,e}function Yk(e){return e&&e[h5]===!0}function PX(e,t,n){const i=function(){const s=t();return s.invertRange||(s.invertRange=s.invert?FX(s):s.invertExtent?TX(s):void 0),s.type=e,p5(s)};return i.metadata=hr(le(n)),i}function Ge(e,t,n){return arguments.length>1?(Wg.set(e,PX(e,t,n)),this):g5(e)?Wg.get(e):void 0}Ge(MX,JP);Ge(Hl,QP,Lt);Ge(eo,e5,[Lt,eo]);Ge(gh,eE,Lt);Ge(mh,dX,Lt);Ge(G0,t5,Lt);Ge(lu,gX,[Lt,uE]);Ge(cu,mX,[Lt,uE]);Ge(Xr,nE,[Lt,Wi]);Ge(`${Xr}-${Hl}`,nE,[Lt,Wi]);Ge(`${Xr}-${eo}`,s5,[Lt,Wi,eo]);Ge(`${Xr}-${gh}`,iE,[Lt,Wi]);Ge(`${Xr}-${mh}`,yX,[Lt,Wi]);Ge(`${Xr}-${G0}`,o5,[Lt,Wi]);Ge(`${Oc}-${Hl}`,a5,[Lt,Wi]);Ge(`${Oc}-${eo}`,u5,[Lt,Wi,eo]);Ge(`${Oc}-${gh}`,rE,[Lt,Wi]);Ge(`${Oc}-${mh}`,vX,[Lt,Wi]);Ge(`${Oc}-${G0}`,l5,[Lt,Wi]);Ge(Gl,n5,[vh,Gl]);Ge(V0,i5,vh);Ge(Y0,r5,vh);Ge(aE,d5,[yh,vh]);Ge(oE,H_,yh);Ge(c5,lE,yh);Ge(lx,RX,yh);function g5(e){return Wg.has(e)}function Nu(e,t){const n=Wg.get(e);return n&&n.metadata[t]}function cE(e){return Nu(e,Lt)}function Vl(e){return Nu(e,yh)}function cx(e){return Nu(e,vh)}function m5(e){return Nu(e,eo)}function IX(e){return Nu(e,uE)}function y5(e){return Nu(e,Wi)}function v5(e){return Nu(e,Gl)}const LX=["clamp","base","constant","exponent"];function b5(e,t){const n=t[0],i=ze(t)-n;return function(r){return e(n+r*i)}}function X0(e,t,n){return K_(fE(t||"rgb",n),e)}function x5(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function w5(e,t,n){const i=n-t;let r,s,o;return!i||!Number.isFinite(i)?En(.5):(r=(s=e.type).indexOf("-"),s=r<0?s:s.slice(r+1),o=Ge(s)().domain([t,n]).range([0,1]),LX.forEach(a=>e[a]?o[a](e[a]()):0),o)}function fE(e,t){const n=eX[zX(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function zX(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const BX={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},UX={accent:xX,category10:bX,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:wX,observable10:_X,paired:EX,pastel1:SX,pastel2:$X,set1:AX,set2:CX,set3:kX,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"};function _5(e){if(G(e))return e;const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function E5(e,t){for(const n in e)dE(n,t(e[n]))}const Xk={};E5(UX,_5);E5(BX,e=>X0(_5(e)));function dE(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Xk[e]=t,this):Xk[e]}const Xp="symbol",jX="discrete",qX="gradient",WX=e=>G(e)?e.map(t=>String(t)):String(e),HX=(e,t)=>e[1]-t[1],GX=(e,t)=>t[1]-e[1];function hE(e,t,n){let i;return We(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(uh(e.domain())/n||1)+1))),ae(t)&&(i=t.step,t=t.interval),oe(t)&&(t=e.type===lu?Mc(t):e.type==cu?Fc(t):q("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function S5(e,t,n){let i=e.range(),r=i[0],s=ze(i),o=HX;if(r>s&&(i=s,s=r,r=i,o=GX),r=Math.floor(r),s=Math.ceil(s),t=t.map(a=>[a,e(a)]).filter(a=>r<=a[1]&&a[1]<=s).sort(o).map(a=>a[0]),n>0&&t.length>1){const a=[t[0],ze(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=a)}return t}function pE(e,t){return e.bins?S5(e,e.bins,t):e.ticks?e.ticks(t):e.domain()}function $5(e,t,n,i,r,s){const o=t.type;let a=WX;if(o===lu||r===lu)a=e.timeFormat(i);else if(o===cu||r===cu)a=e.utcFormat(i);else if(m5(o)){const u=e.formatFloat(i);if(s||t.bins)a=u;else{const l=A5(t,n,!1);a=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();a=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(a=e.format(i));return a}function A5(e,t,n){const i=pE(e,t),r=e.base(),s=Math.log(r),o=Math.max(1,r*t/i.length),a=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/s));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(a):a}const fx={[Gl]:"quantiles",[V0]:"thresholds",[Y0]:"domain"},C5={[Gl]:"quantiles",[V0]:"domain"};function k5(e,t){return e.bins?XX(e.bins):e.type===eo?A5(e,t,!0):fx[e.type]?YX(e[fx[e.type]]()):pE(e,t)}function VX(e,t,n){const i=t[C5[t.type]](),r=i.length;let s=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)s=Math.min(s,i[o]-i[o-1]);return e.formatSpan(0,s,30,n)}function YX(e){const t=[-1/0].concat(e);return t.max=1/0,t}function XX(e){const t=e.slice(0,-1);return t.max=ze(e),t}const KX=e=>fx[e.type]||e.bins;function M5(e,t,n,i,r,s,o){const a=C5[t.type]&&s!==lu&&s!==cu?VX(e,t,r):$5(e,t,n,r,s,o);return i===Xp&&KX(t)?QX(a):i===jX?JX(a):ZX(a)}const QX=e=>(t,n,i)=>{const r=Kk(i[n+1],Kk(i.max,1/0)),s=Qk(t,e),o=Qk(r,e);return s&&o?s+"  "+o:o?"< "+o:" "+s},Kk=(e,t)=>e??t,JX=e=>(t,n)=>n?e(t):null,ZX=e=>t=>e(t),Qk=(e,t)=>Number.isFinite(e)?t(e):null;function eK(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+ze(t),s=r-i;if(e.type===Y0){const o=n?s/n:.1;i-=o,r+=o,s=r-i}return o=>(o-i)/s}function tK(e,t,n,i){const r=i||t.type;return oe(n)&&IX(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===lu?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===cu?e.utcFormat("%A, %d %B %Y, %X UTC"):M5(e,t,5,null,n,i,!0)}function F5(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=tK(e,t,n.format,n.formatType);if(cx(t.type)){const s=k5(t).slice(1).map(r),o=s.length;return`${o} boundar${o===1?"y":"ies"}: ${s.join(", ")}`}else if(Vl(t.type)){const s=t.domain(),o=s.length,a=o>i?s.slice(0,i-2).map(r).join(", ")+", ending with "+s.slice(-1).map(r):s.map(r).join(", ");return`${o} value${o===1?"":"s"}: ${a}`}else{const s=t.domain();return`values from ${r(s[0])} to ${r(ze(s))}`}}let T5=0;function nK(){T5=0}const Hg="p_";function gE(e){return e&&e.gradient}function R5(e,t,n){const i=e.gradient;let r=e.id,s=i==="radial"?Hg:"";return r||(r=e.id="gradient_"+T5++,i==="radial"?(e.x1=Or(e.x1,.5),e.y1=Or(e.y1,.5),e.r1=Or(e.r1,0),e.x2=Or(e.x2,.5),e.y2=Or(e.y2,.5),e.r2=Or(e.r2,.5),s=Hg):(e.x1=Or(e.x1,0),e.y1=Or(e.y1,0),e.x2=Or(e.x2,1),e.y2=Or(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+s+r+")"}function Or(e,t){return e??t}function O5(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,s){return n.push({offset:r,color:s}),i}}}const Jk={basis:{curve:JV},"basis-closed":{curve:ZV},"basis-open":{curve:eY},bundle:{curve:tY,tension:"beta",value:.85},cardinal:{curve:nY,tension:"tension",value:0},"cardinal-open":{curve:rY,tension:"tension",value:0},"cardinal-closed":{curve:iY,tension:"tension",value:0},"catmull-rom":{curve:sY,tension:"alpha",value:.5},"catmull-rom-closed":{curve:oY,tension:"alpha",value:.5},"catmull-rom-open":{curve:aY,tension:"alpha",value:.5},linear:{curve:B_},"linear-closed":{curve:uY},monotone:{horizontal:cY,vertical:lY},natural:{curve:fY},step:{curve:dY},"step-after":{curve:pY},"step-before":{curve:hY}};function mE(e,t,n){var i=fe(Jk,e)&&Jk[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const iK={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},rK=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,sK=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,oK=/^((\s+,?\s*)|(,\s*))/,aK=/^[01]/;function Yl(e){const t=[];return(e.match(rK)||[]).forEach(i=>{let r=i[0];const s=r.toLowerCase(),o=iK[s],a=uK(s,o,i.slice(1).trim()),u=a.length;if(u<o||u&&u%o!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([r,...a.slice(0,o)]),u!==o){s==="m"&&(r=r==="M"?"L":"l");for(let l=o;l<u;l+=o)t.push([r,...a.slice(l,l+o)])}}),t}function uK(e,t,n){const i=[];for(let r=0;t&&r<n.length;)for(let s=0;s<t;++s){const o=e==="a"&&(s===3||s===4)?aK:sK,a=n.slice(r).match(o);if(a===null)throw Error("Invalid SVG path, incorrect parameter type");r+=a[0].length,i.push(+a[0]);const u=n.slice(r).match(oK);u!==null&&(r+=u[0].length)}return i}const Jo=Math.PI/180,lK=1e-14,Ua=Math.PI/2,Ur=Math.PI*2,Qu=Math.sqrt(3)/2;var nv={},iv={},D5=[].join;function cK(e,t,n,i,r,s,o,a,u){const l=D5.call(arguments);if(nv[l])return nv[l];const c=o*Jo,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(a-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(a-e)*.5;let g=h*h/(n*n)+p*p/(i*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const m=d/n,y=f/n,v=-f/i,b=d/i,x=m*a+y*u,w=v*a+b*u,E=m*e+y*t,_=v*e+b*t;let A=1/((E-x)*(E-x)+(_-w)*(_-w))-.25;A<0&&(A=0);let F=Math.sqrt(A);s==r&&(F=-F);const M=.5*(x+E)-F*(_-w),P=.5*(w+_)+F*(E-x),D=Math.atan2(w-P,x-M);let C=Math.atan2(_-P,E-M)-D;C<0&&s===1?C+=Ur:C>0&&s===0&&(C-=Ur);const R=Math.ceil(Math.abs(C/(Ua+.001))),N=[];for(let I=0;I<R;++I){const U=D+I*C/R,re=D+(I+1)*C/R;N[I]=[M,P,U,re,n,i,f,d]}return nv[l]=N}function fK(e){const t=D5.call(e);if(iv[t])return iv[t];var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7];const c=l*o,f=-u*a,d=u*o,h=l*a,p=Math.cos(r),g=Math.sin(r),m=Math.cos(s),y=Math.sin(s),v=.5*(s-r),b=Math.sin(v*.5),x=8/3*b*b/Math.sin(v),w=n+p-x*g,E=i+g+x*p,_=n+m,$=i+y,A=_+x*y,F=$-x*m;return iv[t]=[c*w+f*E,d*w+h*E,c*A+f*F,d*A+h*F,c*_+f*$,d*_+h*$]}const Ai=["l",0,0,0,0,0,0,0];function dK(e,t,n){const i=Ai[0]=e[0];if(i==="a"||i==="A")Ai[1]=t*e[1],Ai[2]=n*e[2],Ai[3]=e[3],Ai[4]=e[4],Ai[5]=e[5],Ai[6]=t*e[6],Ai[7]=n*e[7];else if(i==="h"||i==="H")Ai[1]=t*e[1];else if(i==="v"||i==="V")Ai[1]=n*e[1];else for(var r=1,s=e.length;r<s;++r)Ai[r]=(r%2==1?t:n)*e[r];return Ai}function Pd(e,t,n,i,r,s){var o,a=null,u=0,l=0,c=0,f=0,d,h,p,g,m=0,y=0;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),s==null&&(s=r),e.beginPath&&e.beginPath();for(var v=0,b=t.length;v<b;++v){switch(o=t[v],(r!==1||s!==1)&&(o=dK(o,r,s)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+i);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+i);break;case"h":u+=o[1],e.lineTo(u+n,l+i);break;case"H":u=o[1],e.lineTo(u+n,l+i);break;case"v":l+=o[1],e.lineTo(u+n,l+i);break;case"V":l=o[1],e.lineTo(u+n,l+i);break;case"m":u+=o[1],l+=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"M":u=o[1],l=o[2],m=u,y=l,e.moveTo(u+n,l+i);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+o[1]+n,l+o[2]+i,d+n,h+i),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+i,d+n,h+i),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],a[0].match(/[QqTt]/)===null?(c=u,f=l):a[0]==="t"?(c=2*u-p,f=2*l-g):a[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":Zk(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+i]),u+=o[6],l+=o[7];break;case"A":Zk(e,u+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),u=o[6],l=o[7];break;case"z":case"Z":u=m,l=y,e.closePath();break}a=o}}function Zk(e,t,n,i){const r=cK(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let s=0;s<r.length;++s){const o=fK(r[s]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const eM=.5773502691896257,tM={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ur)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,s=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-s),e.lineTo(r,-s),e.lineTo(0,-n),e.lineTo(-r,-s),e.lineTo(-i,-s),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n,r=i-n*eM,s=n/4;e.moveTo(0,-i-r),e.lineTo(-s,i-r),e.lineTo(s,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n,r=i-n*eM;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Qu*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function N5(e){return fe(tM,e)?tM[e]:hK(e)}var rv={};function hK(e){if(!fe(rv,e)){const t=Yl(e);rv[e]={draw:function(n,i){Pd(n,t,0,0,Math.sqrt(i)/2)}}}return rv[e]}const yo=.448084975506;function pK(e){return e.x}function gK(e){return e.y}function mK(e){return e.width}function yK(e){return e.height}function Ss(e){return typeof e=="function"?e:()=>+e}function fp(e,t,n){return Math.max(t,Math.min(e,n))}function P5(){var e=pK,t=gK,n=mK,i=yK,r=Ss(0),s=r,o=r,a=r,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,b=fp(+r.call(this,c),0,v),x=fp(+s.call(this,c),0,v),w=fp(+o.call(this,c),0,v),E=fp(+a.call(this,c),0,v);if(u||(u=h=P0()),b<=0&&x<=0&&w<=0&&E<=0)u.rect(p,g,m,y);else{var _=p+m,$=g+y;u.moveTo(p+b,g),u.lineTo(_-x,g),u.bezierCurveTo(_-yo*x,g,_,g+yo*x,_,g+x),u.lineTo(_,$-E),u.bezierCurveTo(_,$-yo*E,_-yo*E,$,_-E,$),u.lineTo(p+w,$),u.bezierCurveTo(p+yo*w,$,p,$-yo*w,p,$-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+yo*b,p+yo*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Ss(c),l):e},l.y=function(c){return arguments.length?(t=Ss(c),l):t},l.width=function(c){return arguments.length?(n=Ss(c),l):n},l.height=function(c){return arguments.length?(i=Ss(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=Ss(c),s=f!=null?Ss(f):r,a=d!=null?Ss(d):r,o=h!=null?Ss(h):s,l):r},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function I5(){var e,t,n,i,r=null,s,o,a,u;function l(f,d,h){const p=h/2;if(s){var g=a-d,m=f-o;if(g||m){var y=Math.hypot(g,m),v=(g/=y)*u,b=(m/=y)*u,x=Math.atan2(m,g);r.moveTo(o-v,a-b),r.lineTo(f-g*p,d-m*p),r.arc(f,d,p,x-Math.PI,x),r.lineTo(o+v,a+b),r.arc(o,a,u,x,x+Math.PI)}else r.arc(f,d,p,0,Ur);r.closePath()}else s=1;o=f,a=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(r==null&&(r=m=P0()),d=0;d<=h;++d)!(d<h&&i(p=f[d],d,f))===g&&(g=!g)&&(s=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function bh(e,t){return e??t}const xh=e=>e.x||0,wh=e=>e.y||0,vK=e=>e.width||0,bK=e=>e.height||0,xK=e=>(e.x||0)+(e.width||0),wK=e=>(e.y||0)+(e.height||0),_K=e=>e.startAngle||0,EK=e=>e.endAngle||0,SK=e=>e.padAngle||0,$K=e=>e.innerRadius||0,AK=e=>e.outerRadius||0,CK=e=>e.cornerRadius||0,kK=e=>bh(e.cornerRadiusTopLeft,e.cornerRadius)||0,MK=e=>bh(e.cornerRadiusTopRight,e.cornerRadius)||0,FK=e=>bh(e.cornerRadiusBottomRight,e.cornerRadius)||0,TK=e=>bh(e.cornerRadiusBottomLeft,e.cornerRadius)||0,RK=e=>bh(e.size,64),OK=e=>e.size||1,K0=e=>e.defined!==!1,DK=e=>N5(e.shape||"circle"),NK=XV().startAngle(_K).endAngle(EK).padAngle(SK).innerRadius($K).outerRadius(AK).cornerRadius(CK),PK=dP().x(xh).y1(wh).y0(wK).defined(K0),IK=dP().y(wh).x1(xh).x0(xK).defined(K0),LK=fP().x(xh).y(wh).defined(K0),zK=P5().x(xh).y(wh).width(vK).height(bK).cornerRadius(kK,MK,FK,TK),BK=QV().type(DK).size(RK),UK=I5().x(xh).y(wh).defined(K0).size(OK);function yE(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function jK(e,t){return NK.context(e)(t)}function qK(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?IK:PK).curve(mE(i,n.orient,n.tension)).context(e)(t)}function WK(e,t){const n=t[0],i=n.interpolate||"linear";return LK.curve(mE(i,n.orient,n.tension)).context(e)(t)}function Dc(e,t,n,i){return zK.context(e)(t,n,i)}function HK(e,t){return(t.mark.shape||t.shape).context(e)(t)}function GK(e,t){return BK.context(e)(t)}function VK(e,t){return UK.context(e)(t)}var L5=1;function YK(){L5=1}function vE(e,t,n){var i=t.clip,r=e._defs,s=t.clip_id||(t.clip_id="clip"+L5++),o=r.clipping[s]||(r.clipping[s]={id:s});return Te(i)?o.path=i(null):yE(n)?o.path=Dc(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")"}function Tt(e){this.clear(),e&&this.union(e)}Tt.prototype={clone(){return new Tt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(e),u=Math.sin(e),l=t-t*a+n*u,c=n-t*u-n*a;return[a*i-u*r+l,u*i+a*r+c,a*i-u*o+l,u*i+a*o+c,a*s-u*r+l,u*s+a*r+c,a*s-u*o+l,u*s+a*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Q0(e){this.mark=e,this.bounds=this.bounds||new Tt}function J0(e){Q0.call(this,e),this.items=this.items||[]}te(J0,Q0);class z5{constructor(t){this._pending=0,this._loader=t||S0()}pending(){return this._pending}sanitizeURL(t){const n=this;return nM(n),n._loader.sanitize(t,{context:"href"}).then(i=>(uf(n),i)).catch(()=>(uf(n),null))}loadImage(t){const n=this,i=gY();return nM(n),n._loader.sanitize(t,{context:"image"}).then(r=>{const s=r.href;if(!s||!i)throw{url:s};const o=new i,a=fe(r,"crossOrigin")?r.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>uf(n),o.onerror=()=>uf(n),o.src=s,o}).catch(r=>(uf(n),{complete:!1,width:0,height:0,src:r&&r.url||""}))}ready(){const t=this;return new Promise(n=>{function i(r){t.pending()?setTimeout(()=>{i(!0)},10):n(r)}i(!1)})}}function nM(e){e._pending+=1}function uf(e){e._pending-=1}function oo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?XK(t,i):0))}return e}function XK(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const KK=Ur-1e-8;let Z0,Kp,Qp,Va,dx,Jp,hx,px;const To=(e,t)=>Z0.add(e,t),Zp=(e,t)=>To(Kp=e,Qp=t),iM=e=>To(e,Z0.y1),rM=e=>To(Z0.x1,e),ja=(e,t)=>dx*e+hx*t,qa=(e,t)=>Jp*e+px*t,sv=(e,t)=>To(ja(e,t),qa(e,t)),ov=(e,t)=>Zp(ja(e,t),qa(e,t));function _h(e,t){return Z0=e,t?(Va=t*Jo,dx=px=Math.cos(Va),Jp=Math.sin(Va),hx=-Jp):(dx=px=1,Va=Jp=hx=0),QK}const QK={beginPath(){},closePath(){},moveTo:ov,lineTo:ov,rect(e,t,n,i){Va?(sv(e+n,t),sv(e+n,t+i),sv(e,t+i),ov(e,t)):(To(e+n,t+i),Zp(e,t))},quadraticCurveTo(e,t,n,i){const r=ja(e,t),s=qa(e,t),o=ja(n,i),a=qa(n,i);sM(Kp,r,o,iM),sM(Qp,s,a,rM),Zp(o,a)},bezierCurveTo(e,t,n,i,r,s){const o=ja(e,t),a=qa(e,t),u=ja(n,i),l=qa(n,i),c=ja(r,s),f=qa(r,s);oM(Kp,o,u,c,iM),oM(Qp,a,l,f,rM),Zp(c,f)},arc(e,t,n,i,r,s){if(i+=Va,r+=Va,Kp=n*Math.cos(r)+e,Qp=n*Math.sin(r)+t,Math.abs(r-i)>KK)To(e-n,t-n),To(e+n,t+n);else{const o=l=>To(n*Math.cos(l)+e,n*Math.sin(l)+t);let a,u;if(o(i),o(r),r!==i)if(i=i%Ur,i<0&&(i+=Ur),r=r%Ur,r<0&&(r+=Ur),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=Ur,a=i-i%Ua,u=0;u<4&&a>r;++u,a-=Ua)o(a);else for(a=i-i%Ua+Ua,u=0;u<4&&a<r;++u,a=a+Ua)o(a)}}};function sM(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function oM(e,t,n,i,r){const s=i-e+3*t-3*n,o=e+n-2*t,a=e-t;let u=0,l=0,c;Math.abs(s)>lK?(c=o*o+a*s,c>=0&&(c=Math.sqrt(c),u=(-o+c)/s,l=(-o-c)/s)):u=.5*a/o,0<u&&u<1&&r(aM(u,e,t,n,i)),0<l&&l<1&&r(aM(l,e,t,n,i))}function aM(e,t,n,i,r){const s=1-e,o=s*s,a=e*e;return o*s*t+3*o*e*n+3*s*a*i+a*e*r}var Ho=(Ho=Wo(1,1))?Ho.getContext("2d"):null;const gx=new Tt;function bE(e){return function(t,n){if(!Ho)return!0;e(Ho,t),gx.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=gx;for(let a=r;a<=o;++a)for(let u=i;u<=s;++u)if(Ho.isPointInPath(u,a))return!0;return!1}}function xE(e,t){return t.contains(e.x||0,e.y||0)}function B5(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,s=e.height||0;return t.intersects(gx.set(n,i,n+r,i+s))}function U5(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,s=e.y2!=null?e.y2:i;return hl(t,n,i,r,s)}function hl(e,t,n,i,r){const{x1:s,y1:o,x2:a,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(s-t)),m===1&&(h=l,p=a-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Xl(e,t){e.globalCompositeOperation=t.blend||"source-over"}function Yi(e,t){return e??t}function uM(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function JK(e,t,n){const i=n.width(),r=n.height();let s;if(t.gradient==="radial")s=e.createRadialGradient(n.x1+Yi(t.x1,.5)*i,n.y1+Yi(t.y1,.5)*r,Math.max(i,r)*Yi(t.r1,0),n.x1+Yi(t.x2,.5)*i,n.y1+Yi(t.y2,.5)*r,Math.max(i,r)*Yi(t.r2,.5));else{const o=Yi(t.x1,0),a=Yi(t.y1,0),u=Yi(t.x2,1),l=Yi(t.y2,0);if(o===u||a===l||i===r)s=e.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+u*i,n.y1+l*r);else{const c=Wo(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=uM(f.createLinearGradient(o,a,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return uM(s,t.stops)}function j5(e,t,n){return gE(n)?JK(e,n,t.bounds):n}function Gg(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=j5(e,t,t.fill),!0):!1}var ZK=[];function Kl(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=j5(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||ZK),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function eQ(e,t){return e.zindex-t.zindex||e.index-t.index}function wE(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,s;for(r=0,s=t.length;r<s;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(eQ)}function gr(e,t){var n=e.items,i,r;if(!n||!n.length)return;const s=wE(e);if(s&&s.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=s}for(i=0,r=n.length;i<r;++i)t(n[i])}function Vg(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const s=wE(e);for(s&&s.length&&(n=s),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===s){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function _E(e){return function(t,n,i){gr(n,r=>{(!i||i.intersects(r.bounds))&&q5(e,t,r,r)})}}function tQ(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&q5(e,t,n.items[0],n.items)}}function q5(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Xl(t,n),n.fill&&Gg(t,n,r)&&t.fill(),n.stroke&&Kl(t,n,r)&&t.stroke()))}function e1(e){return e=e||Li,function(t,n,i,r,s,o){return i*=t.pixelRatio,r*=t.pixelRatio,Vg(n,a=>{const u=a.bounds;if(!(u&&!u.contains(s,o)||!u)&&e(t,a,i,r,s,o))return a})}}function Eh(e,t){return function(n,i,r,s){var o=Array.isArray(i)?i[0]:i,a=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,i)?!1:a&&n.isPointInPath(r,s)||u&&n.isPointInStroke(r,s)}}function EE(e){return e1(Eh(e))}function Za(e,t){return"translate("+e+","+t+")"}function SE(e){return"rotate("+e+")"}function nQ(e,t){return"scale("+e+","+t+")"}function W5(e){return Za(e.x||0,e.y||0)}function iQ(e){return Za(e.x||0,e.y||0)+(e.angle?" "+SE(e.angle):"")}function rQ(e){return Za(e.x||0,e.y||0)+(e.angle?" "+SE(e.angle):"")+(e.scaleX||e.scaleY?" "+nQ(e.scaleX||1,e.scaleY||1):"")}function $E(e,t,n){function i(o,a){o("transform",iQ(a)),o("d",t(null,a))}function r(o,a){return t(_h(o,a.angle),a),oo(o,a).translate(a.x||0,a.y||0)}function s(o,a){var u=a.x||0,l=a.y||0,c=a.angle||0;o.translate(u,l),c&&o.rotate(c*=Jo),o.beginPath(),t(o,a),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:_E(s),pick:EE(s),isect:n||bE(s)}}var sQ=$E("arc",jK);function oQ(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,s=1/0,o,a;--r>=0;)e[r].defined!==!1&&(a=Math.abs(e[r][i]-n),a<s&&(s=a,o=e[r]));return o}function aQ(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,s,o;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],s=e[i].y-t[1],o=r*r+s*s,o<n))return e[i];return null}function uQ(e,t){for(var n=e.length,i,r,s;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],s=i*i+r*r,i=e[n].size||1,s<i*i))return e[n];return null}function AE(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(_h(u),c),oo(u,c[0]))}function s(u,l){u.beginPath(),t(u,l)}const o=Eh(s);function a(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:tQ(s),pick:a,isect:xE,tip:n}}var lQ=AE("area",qK,oQ);function cQ(e,t){var n=t.clip;e.save(),Te(n)?(e.beginPath(),n(e),e.clip()):H5(e,t.group)}function H5(e,t){e.beginPath(),yE(t)?Dc(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function G5(e){const t=Yi(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function fQ(e,t){e("transform",W5(t))}function V5(e,t){const n=G5(t);e("d",Dc(null,t,n,n))}function dQ(e,t){e("class","background"),e("aria-hidden",!0),V5(e,t)}function hQ(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?V5(e,t):e("d","")}function pQ(e,t,n){const i=t.clip?vE(n,t,t):null;e("clip-path",i)}function gQ(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),oo(e,t),e.translate(t.x||0,t.y||0)}function Id(e,t,n,i){const r=G5(t);e.beginPath(),Dc(e,t,(n||0)+r,(i||0)+r)}const mQ=Eh(Id),yQ=Eh(Id,!1),vQ=Eh(Id,!0);function bQ(e,t,n,i){gr(t,r=>{const s=r.x||0,o=r.y||0,a=r.strokeForeground,u=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&u&&(Id(e,r,s,o),Xl(e,r),r.fill&&Gg(e,r,u)&&e.fill(),r.stroke&&!a&&Kl(e,r,u)&&e.stroke()),e.save(),e.translate(s,o),r.clip&&H5(e,r),n&&n.translate(-s,-o),gr(r,l=>{(l.marktype==="group"||i==null||i.includes(l.marktype))&&this.draw(e,l,n,i)}),n&&n.translate(s,o),e.restore(),a&&r.stroke&&u&&(Id(e,r,s,o),Xl(e,r),Kl(e,r,u)&&e.stroke())})}function xQ(e,t,n,i,r,s){if(t.bounds&&!t.bounds.contains(r,s)||!t.items)return null;const o=n*e.pixelRatio,a=i*e.pixelRatio;return Vg(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,s))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(r<c||r>h||s<f||s>p))return;if(e.save(),e.translate(c,f),c=r-c,f=s-f,g&&yE(u)&&!vQ(e,u,o,a))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&yQ(e,u,o,a)?(e.restore(),u):(l=Vg(u,v=>wQ(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&mQ(e,u,o,a)&&(l=u),e.restore(),l||null)})}function wQ(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var _Q={type:"group",tag:"g",nested:!1,attr:fQ,bound:gQ,draw:bQ,pick:xQ,isect:B5,content:pQ,background:dQ,foreground:hQ},Ld={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function CE(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function kE(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function ME(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function t1(e,t){return e==="center"?t/2:e==="right"?t:0}function n1(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function EQ(e,t,n){const i=CE(t,n),r=kE(t,i),s=ME(t,i),o=(t.x||0)-t1(t.align,r),a=(t.y||0)-n1(t.baseline,s),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,Ld["xmlns:xlink"],"xlink:href"),e("transform",Za(o,a)),e("width",r),e("height",s),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function SQ(e,t){const n=t.image,i=kE(t,n),r=ME(t,n),s=(t.x||0)-t1(t.align,i),o=(t.y||0)-n1(t.baseline,r);return e.set(s,o,s+i,o+r)}function $Q(e,t,n){gr(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=CE(i,this);let s=kE(i,r),o=ME(i,r);if(s===0||o===0)return;let a=(i.x||0)-t1(i.align,s),u=(i.y||0)-n1(i.baseline,o),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=s/c,u+=(o-d)/2,o=d):(d=o*c,a+=(s-d)/2,s=d))),(r.complete||r.toDataURL)&&(Xl(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,a,u,s,o))})}var AQ={type:"image",tag:"image",nested:!1,attr:EQ,bound:SQ,draw:$Q,pick:e1(),isect:Li,get:CE,xOffset:t1,yOffset:n1},CQ=AE("line",WK,aQ);function kQ(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",rQ(t)),e("d",t.path)}function eg(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,s=t.scaleX||1,o=t.scaleY||1,a=(t.angle||0)*Jo,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Yl(n)).path=n),a&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(a),Pd(e,u,0,0,s,o),e.rotate(-a),e.translate(-i,-r)):Pd(e,u,i,r,s,o)}function MQ(e,t){return eg(_h(e,t.angle),t)?e.set(0,0,0,0):oo(e,t,!0)}var FQ={type:"path",tag:"path",nested:!1,attr:kQ,bound:MQ,draw:_E(eg),pick:EE(eg),isect:bE(eg)};function TQ(e,t){e("d",Dc(null,t))}function RQ(e,t){var n,i;return oo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function lM(e,t){e.beginPath(),Dc(e,t)}var OQ={type:"rect",tag:"path",nested:!1,attr:TQ,bound:RQ,draw:_E(lM),pick:EE(lM),isect:B5};function DQ(e,t){e("transform",W5(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function NQ(e,t){var n,i;return oo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function Y5(e,t,n){var i,r,s,o;return t.stroke&&Kl(e,t,n)?(i=t.x||0,r=t.y||0,s=t.x2!=null?t.x2:i,o=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(s,o),!0):!1}function PQ(e,t,n){gr(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&Y5(e,i,r)&&(Xl(e,i),e.stroke())}})}function IQ(e,t,n,i){return e.isPointInStroke?Y5(e,t,1)&&e.isPointInStroke(n,i):!1}var LQ={type:"rule",tag:"line",nested:!1,attr:DQ,bound:NQ,draw:PQ,pick:e1(IQ),isect:U5},zQ=$E("shape",HK),BQ=$E("symbol",GK,xE);const cM=nN();var vi={height:ds,measureWidth:FE,estimateWidth:Yg,width:Yg,canvas:X5};X5(!0);function X5(e){vi.width=e&&Ho?FE:Yg}function Yg(e,t){return K5(ea(e,t),ds(e))}function K5(e,t){return~~(.8*e.length*t)}function FE(e,t){return ds(e)<=0||!(t=ea(e,t))?0:Q5(t,i1(e))}function Q5(e,t){const n=`(${t}) ${e}`;let i=cM.get(n);return i===void 0&&(Ho.font=t,i=Ho.measureText(e).width,cM.set(n,i)),i}function ds(e){return e.fontSize!=null?+e.fontSize||0:11}function Zo(e){return e.lineHeight!=null?e.lineHeight:ds(e)+2}function UQ(e){return G(e)?e.length>1?e:e[0]:e}function Sh(e){return UQ(e.lineBreak&&e.text&&!G(e.text)?e.text.split(e.lineBreak):e.text)}function TE(e){const t=Sh(e);return(G(t)?t.length-1:0)*Zo(e)}function ea(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?qQ(e,n):n}function jQ(e){if(vi.width===FE){const t=i1(e);return n=>Q5(n,t)}else if(vi.width===Yg){const t=ds(e);return n=>K5(n,t)}else return t=>vi.width(e,t)}function qQ(e,t){var n=+e.limit,i=jQ(e);if(i(t)<n)return t;var r=e.ellipsis||"",s=e.dir==="rtl",o=0,a=t.length,u;if(n-=i(r),s){for(;o<a;)u=o+a>>>1,i(t.slice(u))>n?o=u+1:a=u;return r+t.slice(o)}else{for(;o<a;)u=1+(o+a>>>1),i(t.slice(0,u))<n?o=u:a=u-1;return t.slice(0,o)+r}}function $h(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function i1(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+ds(e)+"px "+$h(e,t)}function RE(e){var t=e.baseline,n=ds(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*Zo(e):t==="line-bottom"?.29*n-.5*Zo(e):0)}const WQ={left:"start",center:"middle",right:"end"},ad=new Tt;function r1(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Ua,t+=i*Math.cos(r),n+=i*Math.sin(r)),ad.x1=t,ad.y1=n,ad}function HQ(e,t){var n=t.dx||0,i=(t.dy||0)+RE(t),r=r1(t),s=r.x1,o=r.y1,a=t.angle||0,u;e("text-anchor",WQ[t.align]||"start"),a?(u=Za(s,o)+" "+SE(a),(n||i)&&(u+=" "+Za(n,i))):u=Za(s+n,o+i),e("transform",u)}function OE(e,t,n){var i=vi.height(t),r=t.align,s=r1(t),o=s.x1,a=s.y1,u=t.dx||0,l=(t.dy||0)+RE(t)-Math.round(.8*i),c=Sh(t),f;if(G(c)?(i+=Zo(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,vi.width(t,h)),0)):f=vi.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=o,l+=a,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Jo,o,a);else if(n===2)return e.rotatedPoints(t.angle*Jo,o,a);return e}function GQ(e,t,n){gr(t,i=>{var r=i.opacity==null?1:i.opacity,s,o,a,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=i1(i),e.textAlign=i.align||"left",s=r1(i),o=s.x1,a=s.y1,i.angle&&(e.save(),e.translate(o,a),e.rotate(i.angle*Jo),o=a=0),o+=i.dx||0,a+=(i.dy||0)+RE(i),c=Sh(i),Xl(e,i),G(c))for(l=Zo(i),u=0;u<c.length;++u)f=ea(i,c[u]),i.fill&&Gg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Kl(e,i,r)&&e.strokeText(f,o,a),a+=l;else f=ea(i,c),i.fill&&Gg(e,i,r)&&e.fillText(f,o,a),i.stroke&&Kl(e,i,r)&&e.strokeText(f,o,a);i.angle&&e.restore()}})}function VQ(e,t,n,i,r,s){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=r1(t),a=o.x1,u=o.y1,l=OE(ad,t,1),c=-t.angle*Jo,f=Math.cos(c),d=Math.sin(c),h=f*r-d*s+(a-f*a+d*u),p=d*r+f*s+(u-d*a-f*u);return l.contains(h,p)}function YQ(e,t){const n=OE(ad,e,2);return hl(t,n[0],n[1],n[2],n[3])||hl(t,n[0],n[1],n[4],n[5])||hl(t,n[4],n[5],n[6],n[7])||hl(t,n[2],n[3],n[6],n[7])}var XQ={type:"text",tag:"text",nested:!1,attr:HQ,bound:OE,draw:GQ,pick:e1(VQ),isect:YQ},KQ=AE("trail",VK,uQ),Si={arc:sQ,area:lQ,group:_Q,image:AQ,line:CQ,path:FQ,rect:OQ,rule:LQ,shape:zQ,symbol:BQ,text:XQ,trail:KQ};function mx(e,t,n){var i=Si[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Tt),e,n)}var fM={mark:null};function J5(e,t,n){var i=Si[e.marktype],r=i.bound,s=e.items,o=s&&s.length,a,u,l,c;if(i.nested)return o?l=s[0]:(fM.mark=e,l=fM),c=mx(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Tt,o)for(a=0,u=s.length;a<u;++a)t.union(mx(s[a],r,n));return e.bounds=t}const QQ=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Z5(e,t){return JSON.stringify(e,QQ,t)}function eI(e){const t=typeof e=="string"?JSON.parse(e):e;return tI(t)}function tI(e){var t=e.marktype,n=e.items,i,r,s;if(n)for(r=0,s=n.length;r<s;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&tI(n[r]);return t&&J5(e),e}class nI{constructor(t){arguments.length?this.root=eI(t):(this.root=dM({marktype:"group",name:"root",role:"frame"}),this.root.items=[new J0(this.root)])}toJSON(t){return Z5(this.root,t||0)}mark(t,n,i){n=n||this.root.items[0];const r=dM(t,n);return n.items[i]=r,r.zindex&&(r.group.zdirty=!0),r}}function dM(e,t){const n={bounds:new Tt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ro(e,t,n){return!e&&typeof document<"u"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function DE(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Ot(e,t,n,i){var r=e.childNodes[t],s;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(s=r||null,r=Ro(e.ownerDocument,n,i),e.insertBefore(r,s)),r}function ki(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function iI(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function s1(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function JQ(e,t,n,i){var r=e&&e.mark,s,o;if(r&&(s=Si[r.marktype]).tip){for(o=s1(t,n),o[0]-=i[0],o[1]-=i[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=s.tip(r.items,o)}return e}let NE=class{constructor(t,n){this._active=null,this._handlers={},this._loader=t||S0(),this._tooltip=n||ZQ}initialize(t,n,i){return this._el=t,this._obj=i||null,this.origin(n)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,n,i){for(let r=t?t.length:0;--r>=0;)if(t[r].type===n&&(!i||t[r].handler===i))return r;return-1}handlers(t){const n=this._handlers,i=[];if(t)i.push(...n[this.eventName(t)]);else for(const r in n)i.push(...n[r]);return i}eventName(t){const n=t.indexOf(".");return n<0?t:t.slice(0,n)}handleHref(t,n,i){this._loader.sanitize(i,{context:"href"}).then(r=>{const s=new MouseEvent(t.type,t),o=Ro(null,"a");for(const a in r)o.setAttribute(a,r[a]);o.dispatchEvent(s)}).catch(()=>{})}handleTooltip(t,n,i){if(n&&n.tooltip!=null){n=JQ(n,t,this.canvas(),this._origin);const r=i&&n&&n.tooltip||null;this._tooltip.call(this._obj,this,t,n,r)}}getItemBoundingClientRect(t){const n=this.canvas();if(!n)return;const i=n.getBoundingClientRect(),r=this._origin,s=t.bounds,o=s.width(),a=s.height();let u=s.x1+r[0]+i.left,l=s.y1+r[1]+i.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,l+=t.y||0;return{x:u,y:l,width:o,height:a,left:u,top:l,right:u+o,bottom:l+a}}};function ZQ(e,t,n,i){e.element().setAttribute("title",i||"")}class Ah{constructor(t){this._el=null,this._bgcolor=null,this._loader=new z5(t)}initialize(t,n,i,r,s){return this._el=t,this.resize(n,i,r,s)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)}resize(t,n,i,r){return this._width=t,this._height=n,this._origin=i||[0,0],this._scale=r||1,this}dirty(){}render(t,n){const i=this;return i._call=function(){i._render(t,n)},i._call(),i._call=null,i}_render(){}renderAsync(t,n){const i=this.render(t,n);return this._ready?this._ready.then(()=>i):Promise.resolve(i)}_load(t,n){var i=this,r=i._loader[t](n);if(!i._ready){const s=i._call;i._ready=i._loader.ready().then(o=>{o&&s(),i._ready=null})}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const eJ="keydown",tJ="keypress",nJ="keyup",rI="dragenter",tg="dragleave",sI="dragover",yx="pointerdown",iJ="pointerup",Xg="pointermove",ng="pointerout",oI="pointerover",vx="mousedown",rJ="mouseup",aI="mousemove",Kg="mouseout",uI="mouseover",Qg="click",sJ="dblclick",oJ="wheel",lI="mousewheel",Jg="touchstart",Zg="touchmove",em="touchend",aJ=[eJ,tJ,nJ,rI,tg,sI,yx,iJ,Xg,ng,oI,vx,rJ,aI,Kg,uI,Qg,sJ,oJ,lI,Jg,Zg,em],bx=Xg,ud=Kg,xx=Qg;class Ch extends NE{constructor(t,n){super(t,n),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=aJ,this.pointermove=pM([Xg,aI],[oI,uI],[ng,Kg]),this.dragover=pM([sI],[rI],[tg]),this.pointerout=gM([ng,Kg]),this.dragleave=gM([tg])}initialize(t,n,i){return this._canvas=t&&DE(t,"canvas"),[Qg,vx,yx,Xg,ng,tg].forEach(r=>hM(this,r)),super.initialize(t,n,i)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(lI,t)}pointerdown(t){this._down=this._active,this.fire(yx,t)}mousedown(t){this._down=this._active,this.fire(vx,t)}click(t){this._down===this._active&&(this.fire(Qg,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Jg,t,!0)}touchmove(t){this.fire(Zg,t,!0)}touchend(t){this.fire(em,t,!0),this._touch=null}fire(t,n,i){const r=i?this._touch:this._active,s=this._handlers[t];if(n.vegaType=t,t===xx&&r&&r.href?this.handleHref(n,r,r.href):(t===bx||t===ud)&&this.handleTooltip(n,r,t!==ud),s)for(let o=0,a=s.length;o<a;++o)s[o].handler.call(this._obj,n,r)}on(t,n){const i=this.eventName(t),r=this._handlers;return this._handlerIndex(r[i],t,n)<0&&(hM(this,t),(r[i]||(r[i]=[])).push({type:t,handler:n})),this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&r.splice(s,1),this}pickEvent(t){const n=s1(t,this._canvas),i=this._origin;return this.pick(this._scene,n[0],n[1],n[0]-i[0],n[1]-i[1])}pick(t,n,i,r,s){const o=this.context();return Si[t.marktype].pick.call(this,o,t,n,i,r,s)}}const uJ=e=>e===Jg||e===Zg||e===em?[Jg,Zg,em]:[e];function hM(e,t){uJ(t).forEach(n=>lJ(e,n))}function lJ(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function Nf(e,t,n){t.forEach(i=>e.fire(i,n))}function pM(e,t,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r?Nf(this,e,i):((!r||!r.exit)&&Nf(this,n,i),this._active=s,Nf(this,t,i),Nf(this,e,i))}}function gM(e){return function(t){Nf(this,e,t),this._active=null}}function cJ(){return typeof window<"u"&&window.devicePixelRatio||1}function fJ(e,t,n,i,r,s){const o=typeof HTMLElement<"u"&&e instanceof HTMLElement&&e.parentNode!=null,a=e.getContext("2d"),u=o?cJ():r;e.width=t*u,e.height=n*u;for(const l in s)a[l]=s[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*i[0],u*i[1]),e}class tm extends Ah{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Tt,this._tempb=new Tt}initialize(t,n,i,r,s,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Wo(1,1,this._options.type),t&&this._canvas&&(ki(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,n,i,r,s)}resize(t,n,i,r){if(super.resize(t,n,i,r),this._canvas)fJ(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const s=this._options.externalContext;s||q("CanvasRenderer is missing a valid canvas or context"),s.scale(this._scale,this._scale),s.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const n=this._tempb.clear().union(t.bounds);let i=t.mark.group;for(;i;)n.translate(i.x||0,i.y||0),i=i.mark.group;this._dirty.union(n)}_render(t,n){const i=this.context(),r=this._origin,s=this._width,o=this._height,a=this._dirty,u=dJ(r,s,o);i.save();const l=this._redraw||a.empty()?(this._redraw=!1,u.expand(1)):hJ(i,u.intersect(a),r);return this.clear(-r[0],-r[1],s,o),this.draw(i,t,l,n),i.restore(),a.clear(),this}draw(t,n,i,r){if(n.marktype!=="group"&&r!=null&&!r.includes(n.marktype))return;const s=Si[n.marktype];n.clip&&cQ(t,n),s.draw.call(this,t,n,i,r),n.clip&&t.restore()}clear(t,n,i,r){const s=this._options,o=this.context();s.type!=="pdf"&&!s.externalContext&&o.clearRect(t,n,i,r),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(t,n,i,r))}}const dJ=(e,t,n)=>new Tt().set(0,0,t,n).translate(-e[0],-e[1]);function hJ(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}class cI extends NE{constructor(t,n){super(t,n);const i=this;i._hrefHandler=av(i,(r,s)=>{s&&s.href&&i.handleHref(r,s,s.href)}),i._tooltipHandler=av(i,(r,s)=>{i.handleTooltip(r,s,r.type!==ud)})}initialize(t,n,i){let r=this._svg;return r&&(r.removeEventListener(xx,this._hrefHandler),r.removeEventListener(bx,this._tooltipHandler),r.removeEventListener(ud,this._tooltipHandler)),this._svg=r=t&&DE(t,"svg"),r&&(r.addEventListener(xx,this._hrefHandler),r.addEventListener(bx,this._tooltipHandler),r.addEventListener(ud,this._tooltipHandler)),super.initialize(t,n,i)}canvas(){return this._svg}on(t,n){const i=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[i],t,n)<0){const o={type:t,handler:n,listener:av(this,n)};(r[i]||(r[i]=[])).push(o),this._svg&&this._svg.addEventListener(i,o.listener)}return this}off(t,n){const i=this.eventName(t),r=this._handlers[i],s=this._handlerIndex(r,t,n);return s>=0&&(this._svg&&this._svg.removeEventListener(i,r[s].listener),r.splice(s,1)),this}}const av=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)},fI="aria-hidden",PE="aria-label",IE="role",LE="aria-roledescription",dI="graphics-object",zE="graphics-symbol",hI=(e,t,n)=>({[IE]:e,[LE]:t,[PE]:n||void 0}),pJ=hr(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),mM={axis:{desc:"axis",caption:yJ},legend:{desc:"legend",caption:vJ},"title-text":{desc:"title",caption:e=>`Title text '${vM(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${vM(e)}'`}},yM={ariaRole:IE,ariaRoleDescription:LE,description:PE};function pI(e,t){const n=t.aria===!1;if(e(fI,n||void 0),n||t.description==null)for(const i in yM)e(yM[i],void 0);else{const i=t.mark.marktype;e(PE,t.description),e(IE,t.ariaRole||(i==="group"?dI:zE)),e(LE,t.ariaRoleDescription||`${i} mark`)}}function gI(e){return e.aria===!1?{[fI]:!0}:pJ[e.role]?null:mM[e.role]?mJ(e,mM[e.role]):gJ(e)}function gJ(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return hI(n?dI:zE,`${t} mark container`,e.description)}function mJ(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return hI(t.role||zE,t.desc,n.description||i(n))}catch{return null}}function vM(e){return le(e.text).join(" ")}function yJ(e){const t=e.datum,n=e.orient,i=t.title?mI(e):null,r=e.context,s=r.scales[t.scale].value,o=r.dataflow.locale(),a=s.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Vl(a)?"discrete":a} scale with ${F5(o,s,e)}`}function vJ(e){const t=e.datum,n=t.title?mI(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,s=Object.keys(r),o=e.context,a=o.scales[r[s[0]]].value,u=o.dataflow.locale();return xJ(i)+(n?` titled '${n}'`:"")+` for ${bJ(s)} with ${F5(u,a,e)}`}function mI(e){try{return le(ze(e.items).items[0].text).join(" ")}catch{return null}}function bJ(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+ze(e)}function xJ(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const yI=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),wJ=e=>yI(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function BE(){let e="",t="",n="";const i=[],r=()=>t=n="",s=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${wJ(l)}"`),a),a={open(u){s(u),t="<"+u;for(var l=arguments.length,c=new Array(l>1?l-1:0),f=1;f<l;f++)c[f-1]=arguments[f];for(const d of c)for(const h in d)o(h,d[h]);return a},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),a},attr:o,text:u=>(n+=yI(u),a),toString:()=>e};return a}const vI=e=>bI(BE(),e)+"";function bI(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes;for(const i of n)i.nodeType===3?e.text(i.nodeValue):bI(e,i)}return e.close()}const nm={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},im={blend:"mix-blend-mode"},xI={fill:"none","stroke-miterlimit":10},lf=0,bM="http://www.w3.org/2000/xmlns/",Rt=Ld.xmlns;class UE extends Ah{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,n,i,r,s){return this._defs={},this._clearDefs(),t&&(this._svg=Ot(t,0,"svg",Rt),this._svg.setAttributeNS(bM,"xmlns",Rt),this._svg.setAttributeNS(bM,"xmlns:xlink",Ld["xmlns:xlink"]),this._svg.setAttribute("version",Ld.version),this._svg.setAttribute("class","marks"),ki(t,1),this._root=Ot(this._svg,lf,"g",Rt),Oo(this._root,xI),ki(this._svg,lf+1)),this.background(this._bgcolor),super.initialize(t,n,i,r,s)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svg&&(Oo(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,n=this._bgcolor;if(!t)return null;let i;n&&(t.removeAttribute("style"),i=Ot(t,lf,"rect",Rt),Oo(i,{width:this._width,height:this._height,fill:n}));const r=vI(t);return n&&(t.removeChild(i),this._svg.style.setProperty("background-color",n)),r}_render(t,n){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,n),ki(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const n=++this._dirtyID;let i,r,s,o,a,u,l;for(a=0,u=t.length;a<u;++a)if(i=t[a],r=i.mark,r.marktype!==s&&(s=r.marktype,o=Si[s]),r.zdirty&&r.dirty!==n&&(this._dirtyAll=!1,xM(i,n),r.items.forEach(c=>{c.dirty=n})),!r.zdirty){if(i.exit){o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):i._svg&&(l=i._svg.parentNode,l&&l.removeChild(i._svg)),i._svg=null;continue}i=o.nested?r.items[0]:i,i._update!==n&&(!i._svg||!i._svg.ownerSVGElement?(this._dirtyAll=!1,xM(i,n)):this._update(o,i._svg,i),i._update=n)}return!this._dirtyAll}mark(t,n,i,r){if(!this.isDirty(n))return n._svg;const s=this._svg,o=n.marktype,a=Si[o],u=n.interactive===!1?"none":null,l=a.tag==="g",c=wM(n,t,i,"g",s);if(o!=="group"&&r!=null&&!r.includes(o))return ki(c,0),n._svg;c.setAttribute("class",iI(n));const f=gI(n);for(const g in f)Cn(c,g,f[g]);l||Cn(c,"pointer-events",u),Cn(c,"clip-path",n.clip?vE(this,n,n.group):null);let d=null,h=0;const p=g=>{const m=this.isDirty(g),y=wM(g,c,d,a.tag,s);m&&(this._update(a,y,g),l&&SJ(this,y,g,r)),d=y,++h};return a.nested?n.items.length&&p(n.items[0]):gr(n,p),ki(c,h),c}_update(t,n,i){Bs=n,cn=n.__values__,pI(ld,i),t.attr(ld,i,this);const r=AJ[t.type];r&&r.call(this,t,n,i),Bs&&this.style(Bs,i)}style(t,n){if(n!=null){for(const i in nm){let r=i==="font"?$h(n):n[i];if(r===cn[i])continue;const s=nm[i];r==null?t.removeAttribute(s):(gE(r)&&(r=R5(r,this._defs.gradient,wI())),t.setAttribute(s,r+"")),cn[i]=r}for(const i in im)ig(t,im[i],n[i])}}defs(){const t=this._svg,n=this._defs;let i=n.el,r=0;for(const s in n.gradient)i||(n.el=i=Ot(t,lf+1,"defs",Rt)),r=_J(i,n.gradient[s],r);for(const s in n.clipping)i||(n.el=i=Ot(t,lf+1,"defs",Rt)),r=EJ(i,n.clipping[s],r);i&&(r===0?(t.removeChild(i),n.el=null):ki(i,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function xM(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function _J(e,t,n){let i,r,s;if(t.gradient==="radial"){let o=Ot(e,n++,"pattern",Rt);Oo(o,{id:Hg+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Ot(o,0,"rect",Rt),Oo(o,{width:1,height:1,fill:`url(${wI()}#${t.id})`}),e=Ot(e,n++,"radialGradient",Rt),Oo(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Ot(e,n++,"linearGradient",Rt),Oo(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)s=Ot(e,i,"stop",Rt),s.setAttribute("offset",t.stops[i].offset),s.setAttribute("stop-color",t.stops[i].color);return ki(e,i),n}function EJ(e,t,n){let i;return e=Ot(e,n,"clipPath",Rt),e.setAttribute("id",t.id),t.path?(i=Ot(e,0,"path",Rt),i.setAttribute("d",t.path)):(i=Ot(e,0,"rect",Rt),Oo(i,{x:0,y:0,width:t.width,height:t.height})),ki(e,1),n+1}function SJ(e,t,n,i){t=t.lastChild.previousSibling;let r,s=0;gr(n,o=>{r=e.mark(t,o,r,i),++s}),ki(t,1+s)}function wM(e,t,n,i,r){let s=e._svg,o;if(!s&&(o=t.ownerDocument,s=Ro(o,i,Rt),e._svg=s,e.mark&&(s.__data__=e,s.__values__={fill:"default"},i==="g"))){const a=Ro(o,"path",Rt);s.appendChild(a),a.__data__=e;const u=Ro(o,"g",Rt);s.appendChild(u),u.__data__=e;const l=Ro(o,"path",Rt);s.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(s.ownerSVGElement!==r||$J(s,n))&&t.insertBefore(s,n?n.nextSibling:t.firstChild),s}function $J(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Bs=null,cn=null;const AJ={group(e,t,n){const i=Bs=t.childNodes[2];cn=i.__values__,e.foreground(ld,n,this),cn=t.__values__,Bs=t.childNodes[1],e.content(ld,n,this);const r=Bs=t.childNodes[0];e.background(ld,n,this);const s=n.mark.interactive===!1?"none":null;if(s!==cn.events&&(Cn(i,"pointer-events",s),Cn(r,"pointer-events",s),cn.events=s),n.strokeForeground&&n.stroke){const o=n.fill;Cn(i,"display",null),this.style(r,n),Cn(r,"stroke",null),o&&(n.fill=null),cn=i.__values__,this.style(i,n),o&&(n.fill=o),Bs=null}else Cn(i,"display","none")},image(e,t,n){n.smooth===!1?(ig(t,"image-rendering","optimizeSpeed"),ig(t,"image-rendering","pixelated")):ig(t,"image-rendering",null)},text(e,t,n){const i=Sh(n);let r,s,o,a;G(i)?(s=i.map(u=>ea(n,u)),r=s.join(`
`),r!==cn.text&&(ki(t,0),o=t.ownerDocument,a=Zo(n),s.forEach((u,l)=>{const c=Ro(o,"tspan",Rt);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",a)),t.appendChild(c)}),cn.text=r)):(s=ea(n,i),s!==cn.text&&(t.textContent=s,cn.text=s)),Cn(t,"font-family",$h(n)),Cn(t,"font-size",ds(n)+"px"),Cn(t,"font-style",n.fontStyle),Cn(t,"font-variant",n.fontVariant),Cn(t,"font-weight",n.fontWeight)}};function ld(e,t,n){t!==cn[e]&&(n?CJ(Bs,e,t,n):Cn(Bs,e,t),cn[e]=t)}function ig(e,t,n){n!==cn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),cn[t]=n)}function Oo(e,t){for(const n in t)Cn(e,n,t[n])}function Cn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function CJ(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function wI(){let e;return typeof window>"u"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}class _I extends Ah{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const n=BE();n.open("svg",Fe({},Ld,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const i=this._bgcolor;return i&&i!=="transparent"&&i!=="none"&&n.open("rect",{width:this._width,height:this._height,fill:i}).close(),n.open("g",xI,{transform:"translate("+this._origin+")"}),this.mark(n,t),n.close(),this.defs(n),this._text=n.close()+"",this}mark(t,n){const i=Si[n.marktype],r=i.tag,s=[pI,i.attr];t.open("g",{class:iI(n),"clip-path":n.clip?vE(this,n,n.group):null},gI(n),{"pointer-events":r!=="g"&&n.interactive===!1?"none":null});const o=a=>{const u=this.href(a);if(u&&t.open("a",u),t.open(r,this.attr(n,a,s,r!=="g"?r:null)),r==="text"){const l=Sh(a);if(G(l)){const c={x:0,dy:Zo(a)};for(let f=0;f<l.length;++f)t.open("tspan",f?c:null).text(ea(a,l[f])).close()}else t.text(ea(a,l))}else if(r==="g"){const l=a.strokeForeground,c=a.fill,f=a.stroke;l&&f&&(a.stroke=null),t.open("path",this.attr(n,a,i.background,"bgrect")).close(),t.open("g",this.attr(n,a,i.content)),gr(a,d=>this.mark(t,d)),t.close(),l&&f?(c&&(a.fill=null),a.stroke=f,t.open("path",this.attr(n,a,i.foreground,"bgrect")).close(),c&&(a.fill=c)):t.open("path",this.attr(n,a,i.foreground,"bgfore")).close()}t.close(),u&&t.close()};return i.nested?n.items&&n.items.length&&o(n.items[0]):gr(n,o),t.close()}href(t){const n=t.href;let i;if(n){if(i=this._hrefs&&this._hrefs[n])return i;this.sanitizeURL(n).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[n]=r})}return null}attr(t,n,i,r){const s={},o=(a,u,l,c)=>{s[c||a]=u};return Array.isArray(i)?i.forEach(a=>a(o,n,this)):i(o,n,this),r&&kJ(s,n,t,r,this._defs),s}defs(t){const n=this._defs.gradient,i=this._defs.clipping;if(Object.keys(n).length+Object.keys(i).length!==0){t.open("defs");for(const s in n){const o=n[s],a=o.stops;o.gradient==="radial"?(t.open("pattern",{id:Hg+s,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+s+")"}).close(),t.close(),t.open("radialGradient",{id:s,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):t.open("linearGradient",{id:s,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let u=0;u<a.length;++u)t.open("stop",{offset:a[u].offset,"stop-color":a[u].color}).close();t.close()}for(const s in i){const o=i[s];t.open("clipPath",{id:s}),o.path?t.open("path",{d:o.path}).close():t.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),t.close()}t.close()}}}function kJ(e,t,n,i,r){let s;if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),i==="text"&&(e["font-family"]=$h(t),e["font-size"]=ds(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in nm){let a=t[o];const u=nm[o];a==="transparent"&&(u==="fill"||u==="stroke")||a!=null&&(gE(a)&&(a=R5(a,r.gradient,"")),e[u]=a)}for(const o in im){const a=t[o];a!=null&&(s=s||[],s.push(`${im[o]}: ${a};`))}return s&&(e.style=s.join(" ")),e}const Ki={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function MJ(e){Ki.svgMarkTypes=e.svgMarkTypes??["text"],Ki.svgOnTop=e.svgOnTop??!0,Ki.debug=e.debug??!1}class wx extends Ah{constructor(t){super(t),this._svgRenderer=new UE(t),this._canvasRenderer=new tm(t)}initialize(t,n,i,r,s){this._root_el=Ot(t,0,"div");const o=Ot(this._root_el,0,"div"),a=Ot(this._root_el,1,"div");return this._root_el.style.position="relative",Ki.debug||(o.style.height="100%",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.height="100%",a.style.width="100%"),this._svgEl=Ki.svgOnTop?a:o,this._canvasEl=Ki.svgOnTop?o:a,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,n,i,r,s),this._svgRenderer.initialize(this._svgEl,n,i,r,s),super.initialize(t,n,i,r,s)}dirty(t){return Ki.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,n){const r=(n??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(s=>!Ki.svgMarkTypes.includes(s));this._svgRenderer.render(t,Ki.svgMarkTypes),this._canvasRenderer.render(t,r)}resize(t,n,i,r){return super.resize(t,n,i,r),this._svgRenderer.resize(t,n,i,r),this._canvasRenderer.resize(t,n,i,r),this}background(t){return Ki.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class EI extends Ch{constructor(t,n){super(t,n)}initialize(t,n,i){const r=Ot(Ot(t,0,"div"),Ki.svgOnTop?0:1,"div");return super.initialize(r,n,i)}}const SI="canvas",$I="hybrid",AI="png",CI="svg",kI="none",Do={Canvas:SI,PNG:AI,SVG:CI,Hybrid:$I,None:kI},fu={};fu[SI]=fu[AI]={renderer:tm,headless:tm,handler:Ch};fu[CI]={renderer:UE,headless:_I,handler:cI};fu[$I]={renderer:wx,headless:wx,handler:EI};fu[kI]={};function o1(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(fu[e]=t,this):fu[e]}function MI(e,t,n){const i=[],r=new Tt().union(t),s=e.marktype;return s?FI(e,r,n,i):s==="group"?TI(e,r,n,i):q("Intersect scene must be mark node or group item.")}function FI(e,t,n,i){if(FJ(e,t,n)){const r=e.items,s=e.marktype,o=r.length;let a=0;if(s==="group")for(;a<o;++a)TI(r[a],t,n,i);else for(const u=Si[s].isect;a<o;++a){const l=r[a];RI(l,t,u)&&i.push(l)}}return i}function FJ(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function TI(e,t,n,i){n&&n(e.mark)&&RI(e,t,Si.group.isect)&&i.push(e);const r=e.items,s=r&&r.length;if(s){const o=e.x||0,a=e.y||0;t.translate(-o,-a);for(let u=0;u<s;++u)FI(r[u],t,n,i);t.translate(o,a)}return i}function RI(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const uv=new Tt;function OI(e){const t=e.clip;if(Te(t))t(_h(uv.clear()));else if(t)uv.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(uv)}const TJ=1e-9;function jE(e,t,n){return e===t?!0:n==="path"?DI(e,t):e instanceof Date&&t instanceof Date?+e==+t:We(e)&&We(t)?Math.abs(e-t)<=TJ:!e||!t||!ae(e)&&!ae(t)?e==t:RJ(e,t)}function DI(e,t){return jE(Yl(e),Yl(t))}function RJ(e,t){var n=Object.keys(e),i=Object.keys(t),r,s;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),s=n.length-1;s>=0;s--)if(n[s]!=i[s])return!1;for(s=n.length-1;s>=0;s--)if(r=n[s],!jE(e[r],t[r],r))return!1;return typeof e==typeof t}function OJ(){YK(),nK()}const Ql="top",nr="left",rr="right",ta="bottom",DJ="top-left",NJ="top-right",PJ="bottom-left",IJ="bottom-right",qE="start",_x="middle",kn="end",LJ="x",zJ="y",a1="group",WE="axis",HE="title",BJ="frame",UJ="scope",GE="legend",NI="row-header",PI="row-footer",II="row-title",LI="column-header",zI="column-footer",BI="column-title",jJ="padding",qJ="symbol",UI="fit",jI="fit-x",qI="fit-y",WJ="pad",VE="none",dp="all",Ex="each",YE="flush",No="column",Po="row";function WI(e){z.call(this,null,e)}te(WI,z,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,s=Si[r],o=s.bound;let a=i.bounds,u;if(s.nested)i.items.length&&n.dirty(i.items[0]),a=hp(i,o),i.items.forEach(l=>{l.bounds.clear().union(a)});else if(r===a1||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),a.clear(),i.items.forEach(l=>a.union(hp(l,o))),i.role){case WE:case GE:case HE:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{a.union(hp(l,o))}),t.visit(t.MOD,l=>{u=u||a.alignsWith(l.bounds),n.dirty(l),a.union(hp(l,o))}),u&&(a.clear(),i.items.forEach(l=>a.union(l.bounds)));return OI(i),t.modifies("bounds")}});function hp(e,t,n){return t(e.bounds.clear(),e,n)}const _M=":vega_identifier:";function XE(e){z.call(this,0,e)}XE.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};te(XE,z,{transform(e,t){const n=HJ(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,s=>s[i]=s[i]||++r),n.set(this.value=r),t}});function HJ(e){return e._signals[_M]||(e._signals[_M]=e.add(0))}function HI(e){z.call(this,null,e)}te(HI,z,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,GJ(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===a1?J0:Q0;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function GJ(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function GI(e){z.call(this,null,e)}const EM={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!VI(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},VI=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),SM=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,s;n<i;r=s,++n)if(VI(r,s=e[n].bounds,t))return!0},VJ=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},YJ=(e,t,n)=>{var i=e.range(),r=new Tt;return t===Ql||t===ta?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),s=>r.encloses(s.bounds)},$M=e=>(e.forEach(t=>t.opacity=1),e),AM=(e,t)=>e.reflow(t.modified()).modifies("opacity");te(GI,z,{transform(e,t){const n=EM[e.method]||EM.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,s,o;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&($M(r),t=AM(t,e)),t;if(r=r.filter(VJ),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),s=$M(r),t=AM(t,e),s.length>=3&&SM(s,i)){do s=n(s,i);while(s.length>=3&&SM(s,i));s.length<3&&!ze(r).opacity&&(s.length>1&&(ze(s).opacity=0),ze(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=YJ(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{o(u)||(u.opacity=0)}));const a=s[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&a.union(u.bounds)}),t}});function YI(e){z.call(this,null,e)}te(YI,z,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const ln=new Tt;function pl(e,t,n){return e[t]===n?0:(e[t]=n,1)}function XJ(e){var t=e.items[0].orient;return t===nr||t===rr}function KJ(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function QJ(e,t,n,i){var r=t.items[0],s=r.datum,o=r.translate!=null?r.translate:.5,a=r.orient,u=KJ(s),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,p=s.title&&r.items[u[2]].items[0],g=r.titlePadding,m=r.bounds,y=p&&TE(p),v=0,b=0,x,w;switch(ln.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(r.items[x].bounds),(x=u[1])>-1&&m.union(r.items[x].bounds),a){case Ql:v=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&pp(e,p,w,g,y,0,-1,m);break;case nr:v=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&pp(e,p,w,g,y,1,-1,m);break;case rr:v=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&pp(e,p,w,g,y,1,1,m);break;case ta:v=f||0,b=i+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&pp(e,p,w,g,0,0,1,m);break;default:v=r.x,b=r.y}return oo(m.translate(v,b),r),pl(r,"x",v+o)|pl(r,"y",b+o)&&(r.bounds=ln,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function pp(e,t,n,i,r,s,o,a){const u=t.bounds;if(t.auto){const l=o*(n+r+i);let c=0,f=0;e.dirty(t),s?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}a.union(u)}const CM=(e,t)=>Math.floor(Math.min(e,t)),kM=(e,t)=>Math.ceil(Math.max(e,t));function JJ(e){var t=e.items,n=t.length,i=0,r,s;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],s=r.items,r.marktype===a1)switch(r.role){case WE:case GE:case HE:break;case NI:o.rowheaders.push(...s);break;case PI:o.rowfooters.push(...s);break;case LI:o.colheaders.push(...s);break;case zI:o.colfooters.push(...s);break;case II:o.rowtitle=s[0];break;case BI:o.coltitle=s[0];break;default:o.marks.push(...s)}return o}function ZJ(e){return new Tt().set(0,0,e.width||0,e.height||0)}function eZ(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function pt(e,t,n){const i=ae(e)?e[t]:e;return i??(n!==void 0?n:0)}function MM(e){return e<0?Math.ceil(-e):0}function XI(e,t,n){var i=!n.nodirty,r=n.bounds===YE?ZJ:eZ,s=ln.set(0,0,0,0),o=pt(n.align,No),a=pt(n.align,Po),u=pt(n.padding,No),l=pt(n.padding,Po),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),y=Array(f),v=0,b=Array(d),x=Array(d),w=Array(d),E,_,$,A,F,M,P,D,O,C,R;for(_=0;_<c;++_)p[_]=0;for(_=0;_<f;++_)y[_]=0;for(_=0;_<d;++_)M=t[_],F=w[_]=r(M),M.x=M.x||0,b[_]=0,M.y=M.y||0,x[_]=0,$=_%c,A=~~(_/c),g=Math.max(g,P=Math.ceil(F.x2)),v=Math.max(v,D=Math.ceil(F.y2)),p[$]=Math.max(p[$],P),y[A]=Math.max(y[A],D),h[_]=u+MM(F.x1),m[_]=l+MM(F.y1),i&&e.dirty(t[_]);for(_=0;_<d;++_)_%c===0&&(h[_]=0),_<c&&(m[_]=0);if(o===Ex)for($=1;$<c;++$){for(R=0,_=$;_<d;_+=c)R<h[_]&&(R=h[_]);for(_=$;_<d;_+=c)h[_]=R+p[$-1]}else if(o===dp){for(R=0,_=0;_<d;++_)_%c&&R<h[_]&&(R=h[_]);for(_=0;_<d;++_)_%c&&(h[_]=R+g)}else for(o=!1,$=1;$<c;++$)for(_=$;_<d;_+=c)h[_]+=p[$-1];if(a===Ex)for(A=1;A<f;++A){for(R=0,_=A*c,E=_+c;_<E;++_)R<m[_]&&(R=m[_]);for(_=A*c;_<E;++_)m[_]=R+y[A-1]}else if(a===dp){for(R=0,_=c;_<d;++_)R<m[_]&&(R=m[_]);for(_=c;_<d;++_)m[_]=R+v}else for(a=!1,A=1;A<f;++A)for(_=A*c,E=_+c;_<E;++_)m[_]+=y[A-1];for(O=0,_=0;_<d;++_)O=h[_]+(_%c?O:0),b[_]+=O-t[_].x;for($=0;$<c;++$)for(C=0,_=$;_<d;_+=c)C+=m[_],x[_]+=C-t[_].y;if(o&&pt(n.center,No)&&f>1)for(_=0;_<d;++_)F=o===dp?g:p[_%c],O=F-w[_].x2-t[_].x-b[_],O>0&&(b[_]+=O/2);if(a&&pt(n.center,Po)&&c!==1)for(_=0;_<d;++_)F=a===dp?v:y[~~(_/c)],C=F-w[_].y2-t[_].y-x[_],C>0&&(x[_]+=C/2);for(_=0;_<d;++_)s.union(w[_].translate(b[_],x[_]));switch(O=pt(n.anchor,LJ),C=pt(n.anchor,zJ),pt(n.anchor,No)){case kn:O-=s.width();break;case _x:O-=s.width()/2}switch(pt(n.anchor,Po)){case kn:C-=s.height();break;case _x:C-=s.height()/2}for(O=Math.round(O),C=Math.round(C),s.clear(),_=0;_<d;++_)t[_].mark.bounds.clear();for(_=0;_<d;++_)M=t[_],M.x+=b[_]+=O,M.y+=x[_]+=C,s.union(M.mark.bounds.union(M.bounds.translate(b[_],x[_]))),i&&e.dirty(M);return s}function tZ(e,t,n){var i=JJ(t),r=i.marks,s=n.bounds===YE?nZ:iZ,o=n.offset,a=n.columns||r.length,u=a<=0?1:Math.ceil(r.length/a),l=u*a,c,f,d,h,p,g,m;const y=XI(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(g=pt(n.headerBand,Po,null),c=gp(e,i.rowheaders,r,a,u,-pt(o,"rowHeader"),CM,0,s,"x1",0,a,1,g)),i.colheaders&&(g=pt(n.headerBand,No,null),f=gp(e,i.colheaders,r,a,a,-pt(o,"columnHeader"),CM,1,s,"y1",0,1,a,g)),i.rowfooters&&(g=pt(n.footerBand,Po,null),d=gp(e,i.rowfooters,r,a,u,pt(o,"rowFooter"),kM,0,s,"x2",a-1,a,1,g)),i.colfooters&&(g=pt(n.footerBand,No,null),h=gp(e,i.colfooters,r,a,a,pt(o,"columnFooter"),kM,1,s,"y2",l-a,1,a,g)),i.rowtitle&&(p=pt(n.titleAnchor,Po),m=pt(o,"rowTitle"),m=p===kn?d+m:c-m,g=pt(n.titleBand,Po,.5),FM(e,i.rowtitle,m,0,y,g)),i.coltitle&&(p=pt(n.titleAnchor,No),m=pt(o,"columnTitle"),m=p===kn?h+m:f-m,g=pt(n.titleBand,No,.5),FM(e,i.coltitle,m,1,y,g))}function nZ(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function iZ(e,t){return e.bounds[t]}function gp(e,t,n,i,r,s,o,a,u,l,c,f,d,h){var p=n.length,g=0,m=0,y,v,b,x,w,E,_,$,A;if(!p)return g;for(y=c;y<p;y+=f)n[y]&&(g=o(g,u(n[y],l)));if(!t.length)return g;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),g+=s,v=0,x=t.length;v<x;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,x=t.length;v<x;++v,y+=f){for(E=t[v],w=E.mark.bounds,b=y;b>=0&&(_=n[b])==null;b-=d);a?($=h==null?_.x:Math.round(_.bounds.x1+h*_.bounds.width()),A=g):($=g,A=h==null?_.y:Math.round(_.bounds.y1+h*_.bounds.height())),w.union(E.bounds.translate($-(E.x||0),A-(E.y||0))),E.x=$,E.y=A,e.dirty(E),m=o(m,w[l])}return m}function FM(e,t,n,i,r,s){if(t){e.dirty(t);var o=n,a=n;i?o=Math.round(r.x1+s*r.width()):a=Math.round(r.y1+s*r.height()),t.bounds.translate(o-(t.x||0),a-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=a,e.dirty(t)}}function rZ(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function sZ(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function oZ(e,t,n,i,r,s,o){const a=rZ(n,t),u=sZ(e,a("offset",0)),l=a("anchor",qE),c=l===kn?1:l===_x?.5:0,f={align:Ex,bounds:a("bounds",YE),columns:a("direction")==="vertical"?1:e.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(t){case nr:f.anchor={x:Math.floor(i.x1)-u,column:kn,y:c*(o||i.height()+2*i.y1),row:l};break;case rr:f.anchor={x:Math.ceil(i.x2)+u,y:c*(o||i.height()+2*i.y1),row:l};break;case Ql:f.anchor={y:Math.floor(r.y1)-u,row:kn,x:c*(s||r.width()+2*r.x1),column:l};break;case ta:f.anchor={y:Math.ceil(r.y2)+u,x:c*(s||r.width()+2*r.x1),column:l};break;case DJ:f.anchor={x:u,y:u};break;case NJ:f.anchor={x:s-u,y:u,column:kn};break;case PJ:f.anchor={x:u,y:o-u,row:kn};break;case IJ:f.anchor={x:s-u,y:o-u,column:kn,row:kn};break}return f}function aZ(e,t){var n=t.items[0],i=n.datum,r=n.orient,s=n.bounds,o=n.x,a=n.y,u,l;return n._bounds?n._bounds.clear().union(s):n._bounds=s.clone(),s.clear(),lZ(e,n,n.items[0].items[0]),s=uZ(n,s),u=2*n.padding,l=2*n.padding,s.empty()||(u=Math.ceil(s.width()+u),l=Math.ceil(s.height()+l)),i.type===qJ&&cZ(n.items[0].items[0].items[0].items),r!==VE&&(n.x=o=0,n.y=a=0),n.width=u,n.height=l,oo(s.set(o,a,o+u,a+l),n),n.mark.bounds.clear().union(s),n}function uZ(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function lZ(e,t,n){var i=t.padding,r=i-n.x,s=i-n.y;if(!t.datum.title)(r||s)&&cf(e,n,r,s);else{var o=t.items[1].items[0],a=o.anchor,u=t.titlePadding||0,l=i-o.x,c=i-o.y;switch(o.orient){case nr:r+=Math.ceil(o.bounds.width())+u;break;case rr:case ta:break;default:s+=o.bounds.height()+u}switch((r||s)&&cf(e,n,r,s),o.orient){case nr:c+=Ju(t,n,o,a,1,1);break;case rr:l+=Ju(t,n,o,kn,0,0)+u,c+=Ju(t,n,o,a,1,1);break;case ta:l+=Ju(t,n,o,a,0,0),c+=Ju(t,n,o,kn,-1,0,1)+u;break;default:l+=Ju(t,n,o,a,0,0)}(l||c)&&cf(e,o,l,c),(l=Math.round(o.bounds.x1-i))<0&&(cf(e,n,-l,0),cf(e,o,-l,0))}}function Ju(e,t,n,i,r,s,o){const a=e.datum.type!=="symbol",u=n.datum.vgrad,l=a&&(s||!u)&&!o?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&s?c:0,d=u&&s?0:c,h=r<=0?0:TE(n);return Math.round(i===qE?f:i===kn?d-h:.5*(c-h))}function cf(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function cZ(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function fZ(e,t,n,i,r){var s=t.items[0],o=s.frame,a=s.orient,u=s.anchor,l=s.offset,c=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],h=a===nr||a===rr?i:n,p=0,g=0,m=0,y=0,v=0,b;if(o!==a1?a===nr?(p=r.y2,h=r.y1):a===rr?(p=r.y1,h=r.y2):(p=r.x1,h=r.x2):a===nr&&(p=i,h=0),b=u===qE?p:u===kn?h:(p+h)/2,d&&d.text){switch(a){case Ql:case ta:v=f.bounds.height()+c;break;case nr:y=f.bounds.width()+c;break;case rr:y=-f.bounds.width()-c;break}ln.clear().union(d.bounds),ln.translate(y-(d.x||0),v-(d.y||0)),pl(d,"x",y)|pl(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(ln),d.mark.bounds.clear().union(ln),e.dirty(d)),ln.clear().union(d.bounds)}else ln.clear();switch(ln.union(f.bounds),a){case Ql:g=b,m=r.y1-ln.height()-l;break;case nr:g=r.x1-ln.width()-l,m=b;break;case rr:g=r.x2+ln.width()+l,m=b;break;case ta:g=b,m=r.y2+l;break;default:g=s.x,m=s.y}return pl(s,"x",g)|pl(s,"y",m)&&(ln.translate(g,m),e.dirty(s),s.bounds.clear().union(ln),t.bounds.clear().union(ln),e.dirty(s)),s.bounds}function KI(e){z.call(this,null,e)}te(KI,z,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&tZ(n,i,e.layout),hZ(n,i,e)}),dZ(e.mark.group)?t.reflow():t}});function dZ(e){return e&&e.mark.role!=="legend-entry"}function hZ(e,t,n){var i=t.items,r=Math.max(0,t.width||0),s=Math.max(0,t.height||0),o=new Tt().set(0,0,r,s),a=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=i.length;p<g;++p)switch(f=i[p],f.role){case WE:h=XJ(f)?a:u,h.union(QJ(e,f,r,s));break;case HE:c=f;break;case GE:l.push(aZ(e,f));break;case BJ:case UJ:case NI:case PI:case II:case LI:case zI:case BI:a.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||rr,d!==VE&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];XI(e,v,oZ(v,y,n.legends,a,u,r,s))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&(n.autosize.type===UI||n.autosize.type===jI||n.autosize.type===qI))switch(y.orient){case nr:case rr:o.add(v.x1,0).add(v.x2,0);break;case Ql:case ta:o.add(0,v.y1).add(0,v.y2)}else o.union(v)})}o.union(a).union(u),c&&o.union(fZ(e,c,r,s,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),pZ(e,t,o,n)}function pZ(e,t,n,i){const r=i.autosize||{},s=r.type;if(e._autosize<1||!s)return;let o=e._width,a=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===jJ){const p=e.padding();o-=p.left+p.right,a-=p.top+p.bottom}s===VE?(l=0,f=0,u=o,c=a):s===UI?(u=Math.max(0,o-l-d),c=Math.max(0,a-f-h)):s===jI?(u=Math.max(0,o-l-d),a=c+f+h):s===qI?(o=u+l+d,c=Math.max(0,a-f-h)):s===WJ&&(o=u+l+d,a=c+f+h),e._resizeView(o,a,u,c,[l,f],r.resize)}const gZ=Object.freeze(Object.defineProperty({__proto__:null,bound:WI,identifier:XE,mark:HI,overlap:GI,render:YI,viewlayout:KI},Symbol.toStringTag,{value:"Module"}));function QI(e){z.call(this,null,e)}te(QI,z,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,a=hE(s,o,e.minstep),u=e.format||$5(n,s,a,e.formatSpecifier,e.formatType,!!e.values),l=e.values?S5(s,e.values,a):pE(s,a);return r&&(i.rem=r),r=l.map((c,f)=>Ve({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ve({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function JI(e){z.call(this,null,e)}function mZ(){return Ve({})}function yZ(e){const t=$c().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}te(JI,z,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||mZ,s=e.key||be,o=this.value;return G(i.encode)&&(i.encode=null),o&&(e.modified("key")||t.modified(s))&&q("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=yZ(s)),t.visit(t.ADD,a=>{const u=s(a);let l=o.get(u);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(a),o.set(u,l),i.add.push(l)),l.datum=a,l.exit=!1}),t.visit(t.MOD,a=>{const u=s(a),l=o.get(u);l&&(l.datum=a,i.mod.push(l))}),t.visit(t.REM,a=>{const u=s(a),l=o.get(u);a===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function ZI(e){z.call(this,null,e)}te(ZI,z,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,s=t.encode;if(G(s))if(n.changed()||s.every(f=>r[f]))s=s[0],n.encode=null;else return t.StopPropagation;var o=s==="enter",a=r.update||vo,u=r.enter||vo,l=r.exit||vo,c=(s&&!o?r[s]:a)||vo;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),a(f,e)}),n.modifies(u.output),n.modifies(a.output),c!==vo&&c!==a&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==vo&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==vo){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function eL(e){z.call(this,[],e)}te(eL,z,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,s=e.type||Xp,o=e.scale,a=+e.limit,u=hE(o,e.count==null?5:e.count,e.minstep),l=!!e.values||s===Xp,c=e.format||M5(n,o,u,s,e.formatSpecifier,e.formatType,l),f=e.values||k5(o,u),d,h,p,g,m;return r&&(i.rem=r),s===Xp?(a&&f.length>a?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,a-1),m=!0):r=f,Te(p=e.size)?(!e.values&&o(r[0])===0&&(r=r.slice(1)),g=r.reduce((y,v)=>Math.max(y,p(v,e)),0)):p=En(g=p||8),r=r.map((y,v)=>Ve({index:v,label:c(y,v,r),value:y,offset:g,size:p(y,e)})),m&&(m=f[r.length],r.push(Ve({index:r.length,label:`${f.length-r.length} entries`,value:m,offset:g,size:p(m,e)})))):s===qX?(d=o.domain(),h=w5(o,d[0],ze(d)),f.length<3&&!e.values&&d[0]!==ze(d)&&(f=[d[0],ze(d)]),r=f.map((y,v)=>Ve({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(p=f.length-1,h=eK(o),r=f.map((y,v)=>Ve({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===p?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const vZ=e=>e.source.x,bZ=e=>e.source.y,xZ=e=>e.target.x,wZ=e=>e.target.y;function KE(e){z.call(this,{},e)}KE.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};te(KE,z,{transform(e,t){var n=e.sourceX||vZ,i=e.sourceY||bZ,r=e.targetX||xZ,s=e.targetY||wZ,o=e.as||"path",a=e.orient||"vertical",u=e.shape||"line",l=TM.get(u+"-"+a)||TM.get(u);return l||q("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),i(c),r(c),s(c))}),t.reflow(e.modified()).modifies(o)}});const tL=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,_Z=(e,t,n,i)=>tL(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),nL=(e,t,n,i)=>{var r=n-e,s=i-t,o=Math.hypot(r,s)/2,a=180*Math.atan2(s,r)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+a+" 0 1 "+n+","+i},EZ=(e,t,n,i)=>nL(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),iL=(e,t,n,i)=>{const r=n-e,s=i-t,o=.2*(r+s),a=.2*(s-r);return"M"+e+","+t+"C"+(e+o)+","+(t+a)+" "+(n+a)+","+(i-o)+" "+n+","+i},SZ=(e,t,n,i)=>iL(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),$Z=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,AZ=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,CZ=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*s+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*a+"L"+i*o+","+i*a},kZ=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},MZ=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},FZ=(e,t,n,i)=>{const r=Math.cos(e),s=Math.sin(e),o=Math.cos(n),a=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*s+"C"+u*r+","+u*s+" "+u*o+","+u*a+" "+i*o+","+i*a},TM=$c({line:tL,"line-radial":_Z,arc:nL,"arc-radial":EZ,curve:iL,"curve-radial":SZ,"orthogonal-horizontal":$Z,"orthogonal-vertical":AZ,"orthogonal-radial":CZ,"diagonal-horizontal":kZ,"diagonal-vertical":MZ,"diagonal-radial":FZ});function QE(e){z.call(this,null,e)}QE.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};te(QE,z,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],s=e.field||wc,o=e.startAngle||0,a=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(s),c=l.length,f=o,d=(a-o)/vN(l),h=gi(c),p,g,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[i]=f,g[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const TZ=5;function RZ(e){const t=e.type;return!e.bins&&(t===Hl||t===gh||t===mh)}function rL(e){return cE(e)&&e!==Xr}const OZ=hr(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function sL(e){z.call(this,null,e),this.modified(!0)}te(sL,z,{transform(e,t){var n=t.dataflow,i=this.value,r=DZ(e);(!i||r!==i.type)&&(this.value=i=Ge(r)());for(r in e)if(!OZ[r]){if(r==="padding"&&rL(i.type))continue;Te(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return BZ(i,e,zZ(i,e,PZ(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function DZ(e){var t=e.type,n="",i;return t===Xr?Xr+"-"+Hl:(NZ(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Xr+"-":i===3?Oc+"-":""),(n+t||Hl).toLowerCase())}function NZ(e){const t=e.type;return cE(t)&&t!==lu&&t!==cu&&(e.scheme||e.range&&e.range.length&&e.range.every(oe))}function PZ(e,t,n){const i=IZ(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,s=e.type,o=t.zero||t.zero===void 0&&RZ(e),a,u;if(!r)return 0;if((o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(a=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[a]<0&&(r[a]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[a]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[a]?a+1:u<r[0]?0:a;l!==a&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return rL(s)&&t.padding&&r[0]!==ze(r)&&(r=LZ(s,r,t.range,t.padding,t.exponent,t.constant)),e.domain(oL(s,r,n)),s===oE&&e.unknown(t.domainImplicit?nx:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&hE(e,t.nice)||null),r.length}function IZ(e,t,n){return t?(e.domain(oL(e.type,t,n)),t.length):-1}function LZ(e,t,n,i,r,s){var o=Math.abs(ze(n)-n[0]),a=o/(o-2*i),u=e===eo?C2(t,null,a):e===mh?Cg(t,null,a,.5):e===gh?Cg(t,null,a,r||1):e===G0?k2(t,null,a,s||1):A2(t,null,a);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function oL(e,t,n){if(m5(e)){var i=Math.abs(t.reduce((r,s)=>r+(s<0?-1:s>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+ee(t))}return t}function zZ(e,t,n){let i=t.bins;if(i&&!G(i)){const r=e.domain(),s=r[0],o=ze(r),a=i.step;let u=i.start==null?s:i.start,l=i.stop==null?o:i.stop;a||q("Scale bins parameter missing step property."),u<s&&(u=a*Math.ceil(s/a)),l>o&&(l=a*Math.floor(o/a)),i=gi(u,l+a/2,a)}return i?e.bins=i:e.bins&&delete e.bins,e.type===aE&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function BZ(e,t,n){var i=e.type,r=t.round||!1,s=t.range;if(t.rangeStep!=null)s=UZ(i,t,n);else if(t.scheme&&(s=jZ(i,t,n),Te(s))){if(e.interpolator)return e.interpolator(s);q(`Scale type ${i} does not support interpolating color schemes.`)}if(s&&y5(i))return e.interpolator(X0(Sx(s,t.reverse),t.interpolate,t.interpolateGamma));s&&t.interpolate&&e.interpolate?e.interpolate(fE(t.interpolate,t.interpolateGamma)):Te(e.round)?e.round(r):Te(e.rangeRound)&&e.interpolate(r?hh:fa),s&&e.range(Sx(s,t.reverse))}function UZ(e,t,n){e!==c5&&e!==lx&&q("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===lx?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*sE(n,r,i)]}function jZ(e,t,n){var i=t.schemeExtent,r,s;return G(t.scheme)?s=X0(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),s=dE(r),s||q(`Unrecognized scheme name: ${t.scheme}`)),n=e===Y0?n+1:e===aE?n-1:e===Gl||e===V0?+t.schemeCount||TZ:n,y5(e)?RM(s,i,t.reverse):Te(s)?x5(RM(s,i),n):e===oE?s:s.slice(0,n)}function RM(e,t,n){return Te(e)&&(t||n)?b5(e,Sx(t||[0,1],n)):e}function Sx(e,t){return t?e.slice().reverse():e}function aL(e){z.call(this,null,e)}te(aL,z,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Ru(e.sort)),this.modified(n),t}});const OM="zero",uL="center",lL="normalize",cL=["y0","y1"];function JE(e){z.call(this,null,e)}JE.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:OM,values:[OM,uL,lL]},{name:"as",type:"string",array:!0,length:2,default:cL}]};te(JE,z,{transform(e,t){var n=e.as||cL,i=n[0],r=n[1],s=Ru(e.sort),o=e.field||wc,a=e.offset===uL?qZ:e.offset===lL?WZ:HZ,u,l,c,f;for(u=GZ(t.source,e.groupby,s,o),l=0,c=u.length,f=u.max;l<c;++l)a(u[l],f,o,i,r);return t.reflow(e.modified()).modifies(n)}});function qZ(e,t,n,i,r){for(var s=(t-e.sum)/2,o=e.length,a=0,u;a<o;++a)u=e[a],u[i]=s,u[r]=s+=Math.abs(n(u))}function WZ(e,t,n,i,r){for(var s=1/e.sum,o=0,a=e.length,u=0,l=0,c;u<a;++u)c=e[u],c[i]=o,c[r]=o=s*(l+=Math.abs(n(c)))}function HZ(e,t,n,i,r){for(var s=0,o=0,a=e.length,u=0,l,c;u<a;++u)c=e[u],l=+n(c),l<0?(c[i]=o,c[r]=o+=l):(c[i]=s,c[r]=s+=l)}function GZ(e,t,n,i){var r=[],s=g=>g(c),o,a,u,l,c,f,d,h,p;if(t==null)r.push(e.slice());else for(o={},a=0,u=e.length;a<u;++a)c=e[a],f=t.map(s),d=o[f],d||(o[f]=d=[],r.push(d)),d.push(c);for(f=0,p=0,l=r.length;f<l;++f){for(d=r[f],a=0,h=0,u=d.length;a<u;++a)h+=Math.abs(i(d[a]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return r.max=p,r}const VZ=Object.freeze(Object.defineProperty({__proto__:null,axisticks:QI,datajoin:JI,encode:ZI,legendentries:eL,linkpath:KE,pie:QE,scale:sL,sortitems:aL,stack:JE},Symbol.toStringTag,{value:"Module"}));var we=1e-6,rm=1e-12,Ne=Math.PI,Et=Ne/2,sm=Ne/4,zn=Ne*2,$t=180/Ne,De=Ne/180,Le=Math.abs,Nc=Math.atan,Ui=Math.atan2,_e=Math.cos,mp=Math.ceil,fL=Math.exp,$x=Math.hypot,om=Math.log,lv=Math.pow,xe=Math.sin,Ti=Math.sign||function(e){return e>0?1:e<0?-1:0},Bn=Math.sqrt,ZE=Math.tan;function dL(e){return e>1?0:e<-1?Ne:Math.acos(e)}function ni(e){return e>1?Et:e<-1?-Et:Math.asin(e)}function en(){}function am(e,t){e&&NM.hasOwnProperty(e.type)&&NM[e.type](e,t)}var DM={Feature:function(e,t){am(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)am(n[i].geometry,t)}},NM={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ax(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Ax(n[i],t,0)},Polygon:function(e,t){PM(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)PM(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)am(n[i],t)}};function Ax(e,t,n){var i=-1,r=e.length-n,s;for(t.lineStart();++i<r;)s=e[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function PM(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Ax(e[n],t,1);t.polygonEnd()}function Ds(e,t){e&&DM.hasOwnProperty(e.type)?DM[e.type](e,t):am(e,t)}var um=new In,lm=new In,hL,pL,Cx,kx,Mx,rs={point:en,lineStart:en,lineEnd:en,polygonStart:function(){um=new In,rs.lineStart=YZ,rs.lineEnd=XZ},polygonEnd:function(){var e=+um;lm.add(e<0?zn+e:e),this.lineStart=this.lineEnd=this.point=en},sphere:function(){lm.add(zn)}};function YZ(){rs.point=KZ}function XZ(){gL(hL,pL)}function KZ(e,t){rs.point=gL,hL=e,pL=t,e*=De,t*=De,Cx=e,kx=_e(t=t/2+sm),Mx=xe(t)}function gL(e,t){e*=De,t*=De,t=t/2+sm;var n=e-Cx,i=n>=0?1:-1,r=i*n,s=_e(t),o=xe(t),a=Mx*o,u=kx*s+a*_e(r),l=a*i*xe(r);um.add(Ui(l,u)),Cx=e,kx=s,Mx=o}function QZ(e){return lm=new In,Ds(e,rs),lm*2}function cm(e){return[Ui(e[1],e[0]),ni(e[2])]}function du(e){var t=e[0],n=e[1],i=_e(n);return[i*_e(t),i*xe(t),xe(n)]}function yp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Jl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cv(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function vp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function fm(e){var t=Bn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var yt,Xn,wt,di,La,mL,yL,Al,cd,Ao,to,Ts={point:Fx,lineStart:IM,lineEnd:LM,polygonStart:function(){Ts.point=bL,Ts.lineStart=JZ,Ts.lineEnd=ZZ,cd=new In,rs.polygonStart()},polygonEnd:function(){rs.polygonEnd(),Ts.point=Fx,Ts.lineStart=IM,Ts.lineEnd=LM,um<0?(yt=-(wt=180),Xn=-(di=90)):cd>we?di=90:cd<-we&&(Xn=-90),to[0]=yt,to[1]=wt},sphere:function(){yt=-(wt=180),Xn=-(di=90)}};function Fx(e,t){Ao.push(to=[yt=e,wt=e]),t<Xn&&(Xn=t),t>di&&(di=t)}function vL(e,t){var n=du([e*De,t*De]);if(Al){var i=Jl(Al,n),r=[i[1],-i[0],0],s=Jl(r,i);fm(s),s=cm(s);var o=e-La,a=o>0?1:-1,u=s[0]*$t*a,l,c=Le(o)>180;c^(a*La<u&&u<a*e)?(l=s[1]*$t,l>di&&(di=l)):(u=(u+360)%360-180,c^(a*La<u&&u<a*e)?(l=-s[1]*$t,l<Xn&&(Xn=l)):(t<Xn&&(Xn=t),t>di&&(di=t))),c?e<La?fi(yt,e)>fi(yt,wt)&&(wt=e):fi(e,wt)>fi(yt,wt)&&(yt=e):wt>=yt?(e<yt&&(yt=e),e>wt&&(wt=e)):e>La?fi(yt,e)>fi(yt,wt)&&(wt=e):fi(e,wt)>fi(yt,wt)&&(yt=e)}else Ao.push(to=[yt=e,wt=e]);t<Xn&&(Xn=t),t>di&&(di=t),Al=n,La=e}function IM(){Ts.point=vL}function LM(){to[0]=yt,to[1]=wt,Ts.point=Fx,Al=null}function bL(e,t){if(Al){var n=e-La;cd.add(Le(n)>180?n+(n>0?360:-360):n)}else mL=e,yL=t;rs.point(e,t),vL(e,t)}function JZ(){rs.lineStart()}function ZZ(){bL(mL,yL),rs.lineEnd(),Le(cd)>we&&(yt=-(wt=180)),to[0]=yt,to[1]=wt,Al=null}function fi(e,t){return(t-=e)<0?t+360:t}function eee(e,t){return e[0]-t[0]}function zM(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function tee(e){var t,n,i,r,s,o,a;if(di=wt=-(yt=Xn=1/0),Ao=[],Ds(e,Ts),n=Ao.length){for(Ao.sort(eee),t=1,i=Ao[0],s=[i];t<n;++t)r=Ao[t],zM(i,r[0])||zM(i,r[1])?(fi(i[0],r[1])>fi(i[0],i[1])&&(i[1]=r[1]),fi(r[0],i[1])>fi(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,n=s.length-1,t=0,i=s[n];t<=n;i=r,++t)r=s[t],(a=fi(i[1],r[0]))>o&&(o=a,yt=r[0],wt=i[1])}return Ao=to=null,yt===1/0||Xn===1/0?[[NaN,NaN],[NaN,NaN]]:[[yt,Xn],[wt,di]]}var Pf,dm,hm,pm,gm,mm,ym,vm,Tx,Rx,Ox,xL,wL,Tn,Rn,On,sr={sphere:en,point:eS,lineStart:BM,lineEnd:UM,polygonStart:function(){sr.lineStart=ree,sr.lineEnd=see},polygonEnd:function(){sr.lineStart=BM,sr.lineEnd=UM}};function eS(e,t){e*=De,t*=De;var n=_e(t);kh(n*_e(e),n*xe(e),xe(t))}function kh(e,t,n){++Pf,hm+=(e-hm)/Pf,pm+=(t-pm)/Pf,gm+=(n-gm)/Pf}function BM(){sr.point=nee}function nee(e,t){e*=De,t*=De;var n=_e(t);Tn=n*_e(e),Rn=n*xe(e),On=xe(t),sr.point=iee,kh(Tn,Rn,On)}function iee(e,t){e*=De,t*=De;var n=_e(t),i=n*_e(e),r=n*xe(e),s=xe(t),o=Ui(Bn((o=Rn*s-On*r)*o+(o=On*i-Tn*s)*o+(o=Tn*r-Rn*i)*o),Tn*i+Rn*r+On*s);dm+=o,mm+=o*(Tn+(Tn=i)),ym+=o*(Rn+(Rn=r)),vm+=o*(On+(On=s)),kh(Tn,Rn,On)}function UM(){sr.point=eS}function ree(){sr.point=oee}function see(){_L(xL,wL),sr.point=eS}function oee(e,t){xL=e,wL=t,e*=De,t*=De,sr.point=_L;var n=_e(t);Tn=n*_e(e),Rn=n*xe(e),On=xe(t),kh(Tn,Rn,On)}function _L(e,t){e*=De,t*=De;var n=_e(t),i=n*_e(e),r=n*xe(e),s=xe(t),o=Rn*s-On*r,a=On*i-Tn*s,u=Tn*r-Rn*i,l=$x(o,a,u),c=ni(l),f=l&&-c/l;Tx.add(f*o),Rx.add(f*a),Ox.add(f*u),dm+=c,mm+=c*(Tn+(Tn=i)),ym+=c*(Rn+(Rn=r)),vm+=c*(On+(On=s)),kh(Tn,Rn,On)}function aee(e){Pf=dm=hm=pm=gm=mm=ym=vm=0,Tx=new In,Rx=new In,Ox=new In,Ds(e,sr);var t=+Tx,n=+Rx,i=+Ox,r=$x(t,n,i);return r<rm&&(t=mm,n=ym,i=vm,dm<we&&(t=hm,n=pm,i=gm),r=$x(t,n,i),r<rm)?[NaN,NaN]:[Ui(n,t)*$t,ni(i/r)*$t]}function Dx(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Nx(e,t){return Le(e)>Ne&&(e-=Math.round(e/zn)*zn),[e,t]}Nx.invert=Nx;function EL(e,t,n){return(e%=zn)?t||n?Dx(qM(e),WM(t,n)):qM(e):t||n?WM(t,n):Nx}function jM(e){return function(t,n){return t+=e,Le(t)>Ne&&(t-=Math.round(t/zn)*zn),[t,n]}}function qM(e){var t=jM(e);return t.invert=jM(-e),t}function WM(e,t){var n=_e(e),i=xe(e),r=_e(t),s=xe(t);function o(a,u){var l=_e(u),c=_e(a)*l,f=xe(a)*l,d=xe(u),h=d*n+c*i;return[Ui(f*r-h*s,c*n-d*i),ni(h*r+f*s)]}return o.invert=function(a,u){var l=_e(u),c=_e(a)*l,f=xe(a)*l,d=xe(u),h=d*r-f*s;return[Ui(f*r+d*s,c*n+h*i),ni(h*n-c*i)]},o}function uee(e){e=EL(e[0]*De,e[1]*De,e.length>2?e[2]*De:0);function t(n){return n=e(n[0]*De,n[1]*De),n[0]*=$t,n[1]*=$t,n}return t.invert=function(n){return n=e.invert(n[0]*De,n[1]*De),n[0]*=$t,n[1]*=$t,n},t}function lee(e,t,n,i,r,s){if(n){var o=_e(t),a=xe(t),u=i*n;r==null?(r=t+i*zn,s=t-u/2):(r=HM(o,r),s=HM(o,s),(i>0?r<s:r>s)&&(r+=i*zn));for(var l,c=r;i>0?c>s:c<s;c-=u)l=cm([o,-a*_e(c),-a*xe(c)]),e.point(l[0],l[1])}}function HM(e,t){t=du(t),t[0]-=e,fm(t);var n=dL(-t[1]);return((-t[2]<0?-n:n)+zn-we)%zn}function SL(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:en,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function rg(e,t){return Le(e[0]-t[0])<we&&Le(e[1]-t[1])<we}function bp(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function $L(e,t,n,i,r){var s=[],o=[],a,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],y=p[g],v;if(rg(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),a=0;a<g;++a)r.point((m=p[a])[0],m[1]);r.lineEnd();return}y[0]+=2*we}s.push(v=new bp(m,p,null,!0)),o.push(v.o=new bp(m,null,v,!1)),s.push(v=new bp(y,p,null,!1)),o.push(v.o=new bp(y,null,v,!0))}}),!!s.length){for(o.sort(t),GM(s),GM(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var l=s[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(a=0,u=c.length;a<u;++a)r.point((f=c[a])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function GM(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function fv(e){return Le(e[0])<=Ne?e[0]:Ti(e[0])*((Le(e[0])+Ne)%zn-Ne)}function cee(e,t){var n=fv(t),i=t[1],r=xe(i),s=[xe(n),-_e(n),0],o=0,a=0,u=new In;r===1?i=Et+we:r===-1&&(i=-Et-we);for(var l=0,c=e.length;l<c;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=fv(h),g=h[1]/2+sm,m=xe(g),y=_e(g),v=0;v<d;++v,p=x,m=E,y=_,h=b){var b=f[v],x=fv(b),w=b[1]/2+sm,E=xe(w),_=_e(w),$=x-p,A=$>=0?1:-1,F=A*$,M=F>Ne,P=m*E;if(u.add(Ui(P*A*xe(F),y*_+P*_e(F))),o+=M?$+A*zn:$,M^p>=n^x>=n){var D=Jl(du(h),du(b));fm(D);var O=Jl(s,D);fm(O);var C=(M^$>=0?-1:1)*ni(O[2]);(i>C||i===C&&(D[0]||D[1]))&&(a+=M^$>=0?1:-1)}}return(o<-we||o<we&&u<-rm)^a&1}function AL(e,t,n,i){return function(r){var s=t(r),o=SL(),a=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=yN(c);var x=cee(l,i);c.length?(u||(r.polygonStart(),u=!0),$L(c,dee,x,n,r)):x&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(x,w){e(x,w)&&r.point(x,w)}function p(x,w){s.point(x,w)}function g(){d.point=p,s.lineStart()}function m(){d.point=h,s.lineEnd()}function y(x,w){f.push([x,w]),a.point(x,w)}function v(){a.lineStart(),f=[]}function b(){y(f[0][0],f[0][1]),a.lineEnd();var x=a.clean(),w=o.result(),E,_=w.length,$,A,F;if(f.pop(),l.push(f),f=null,!!_){if(x&1){if(A=w[0],($=A.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),E=0;E<$;++E)r.point((F=A[E])[0],F[1]);r.lineEnd()}return}_>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(fee))}}return d}}function fee(e){return e.length>1}function dee(e,t){return((e=e.x)[0]<0?e[1]-Et-we:Et-e[1])-((t=t.x)[0]<0?t[1]-Et-we:Et-t[1])}const VM=AL(function(){return!0},hee,gee,[-Ne,-Et]);function hee(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(s,o){var a=s>0?Ne:-Ne,u=Le(s-t);Le(u-Ne)<we?(e.point(t,n=(n+o)/2>0?Et:-Et),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(s,n),r=0):i!==a&&u>=Ne&&(Le(t-i)<we&&(t-=i*we),Le(s-a)<we&&(s-=a*we),n=pee(t,n,s,o),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(a,n),r=0),e.point(t=s,n=o),i=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function pee(e,t,n,i){var r,s,o=xe(e-n);return Le(o)>we?Nc((xe(t)*(s=_e(i))*xe(n)-xe(i)*(r=_e(t))*xe(e))/(r*s*o)):(t+i)/2}function gee(e,t,n,i){var r;if(e==null)r=n*Et,i.point(-Ne,r),i.point(0,r),i.point(Ne,r),i.point(Ne,0),i.point(Ne,-r),i.point(0,-r),i.point(-Ne,-r),i.point(-Ne,0),i.point(-Ne,r);else if(Le(e[0]-t[0])>we){var s=e[0]<t[0]?Ne:-Ne;r=n*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(t[0],t[1])}function mee(e){var t=_e(e),n=2*De,i=t>0,r=Le(t)>we;function s(c,f,d,h){lee(h,e,n,d,c,f)}function o(c,f){return _e(c)*_e(f)>t}function a(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,y){var v=[m,y],b,x=o(m,y),w=i?x?0:l(m,y):x?l(m+(m<0?Ne:-Ne),y):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,v),(!b||rg(f,b)||rg(v,b))&&(v[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(v,f),c.point(b[0],b[1])):(b=u(f,v),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(r&&f&&i^x){var E;!(w&d)&&(E=u(v,f,!0))&&(g=0,i?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}x&&(!f||!rg(f,v))&&c.point(v[0],v[1]),f=v,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=du(c),p=du(f),g=[1,0,0],m=Jl(h,p),y=yp(m,m),v=m[0],b=y-v*v;if(!b)return!d&&c;var x=t*y/b,w=-t*v/b,E=Jl(g,m),_=vp(g,x),$=vp(m,w);cv(_,$);var A=E,F=yp(_,A),M=yp(A,A),P=F*F-M*(yp(_,_)-1);if(!(P<0)){var D=Bn(P),O=vp(A,(-F-D)/M);if(cv(O,_),O=cm(O),!d)return O;var C=c[0],R=f[0],N=c[1],I=f[1],U;R<C&&(U=C,C=R,R=U);var re=R-C,me=Le(re-Ne)<we,de=me||re<we;if(!me&&I<N&&(U=N,N=I,I=U),de?me?N+I>0^O[1]<(Le(O[0]-C)<we?N:I):N<=O[1]&&O[1]<=I:re>Ne^(C<=O[0]&&O[0]<=R)){var $e=vp(A,(-F+D)/M);return cv($e,_),[O,cm($e)]}}}function l(c,f){var d=i?e:Ne-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return AL(o,a,s,i?[0,-e]:[-Ne,e-Ne])}function yee(e,t,n,i,r,s){var o=e[0],a=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-a,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=r-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=i-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=s-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=a+c*h),f<1&&(t[0]=o+f*d,t[1]=a+f*h),!0}}}}}var If=1e9,xp=-If;function CL(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function s(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return Le(l[0]-e)<we?c>0?0:3:Le(l[0]-n)<we?c>0?2:1:Le(l[1]-t)<we?c>0?1:0:c>0?3:2}function a(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=SL(),d,h,p,g,m,y,v,b,x,w,E,_={point:$,lineStart:P,lineEnd:D,polygonStart:F,polygonEnd:M};function $(C,R){r(C,R)&&c.point(C,R)}function A(){for(var C=0,R=0,N=h.length;R<N;++R)for(var I=h[R],U=1,re=I.length,me=I[0],de,$e,Be=me[0],Ae=me[1];U<re;++U)de=Be,$e=Ae,me=I[U],Be=me[0],Ae=me[1],$e<=i?Ae>i&&(Be-de)*(i-$e)>(Ae-$e)*(e-de)&&++C:Ae<=i&&(Be-de)*(i-$e)<(Ae-$e)*(e-de)&&--C;return C}function F(){c=f,d=[],h=[],E=!0}function M(){var C=A(),R=E&&C,N=(d=yN(d)).length;(R||N)&&(l.polygonStart(),R&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),N&&$L(d,a,C,s,l),l.polygonEnd()),c=l,d=h=p=null}function P(){_.point=O,h&&h.push(p=[]),w=!0,x=!1,v=b=NaN}function D(){d&&(O(g,m),y&&x&&f.rejoin(),d.push(f.result())),_.point=$,x&&c.lineEnd()}function O(C,R){var N=r(C,R);if(h&&p.push([C,R]),w)g=C,m=R,y=N,w=!1,N&&(c.lineStart(),c.point(C,R));else if(N&&x)c.point(C,R);else{var I=[v=Math.max(xp,Math.min(If,v)),b=Math.max(xp,Math.min(If,b))],U=[C=Math.max(xp,Math.min(If,C)),R=Math.max(xp,Math.min(If,R))];yee(I,U,e,t,n,i)?(x||(c.lineStart(),c.point(I[0],I[1])),c.point(U[0],U[1]),N||c.lineEnd(),E=!1):N&&(c.lineStart(),c.point(C,R),E=!1)}v=C,b=R,x=N}return _}}function YM(e,t,n){var i=gi(e,t-we,n).concat(t);return function(r){return i.map(function(s){return[r,s]})}}function XM(e,t,n){var i=gi(e,t-we,n).concat(t);return function(r){return i.map(function(s){return[s,r]})}}function vee(){var e,t,n,i,r,s,o,a,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return gi(mp(i/c)*c,n,c).map(p).concat(gi(mp(a/f)*f,o,f).map(g)).concat(gi(mp(t/u)*u,e,u).filter(function(b){return Le(b%c)>we}).map(d)).concat(gi(mp(s/l)*l,r,l).filter(function(b){return Le(b%f)>we}).map(h))}return y.lines=function(){return v().map(function(b){return{type:"LineString",coordinates:b}})},y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},y.extent=function(b){return arguments.length?y.extentMajor(b).extentMinor(b):y.extentMinor()},y.extentMajor=function(b){return arguments.length?(i=+b[0][0],n=+b[1][0],a=+b[0][1],o=+b[1][1],i>n&&(b=i,i=n,n=b),a>o&&(b=a,a=o,o=b),y.precision(m)):[[i,a],[n,o]]},y.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],s=+b[0][1],r=+b[1][1],t>e&&(b=t,t=e,e=b),s>r&&(b=s,s=r,r=b),y.precision(m)):[[t,s],[e,r]]},y.step=function(b){return arguments.length?y.stepMajor(b).stepMinor(b):y.stepMinor()},y.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],y):[c,f]},y.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],y):[u,l]},y.precision=function(b){return arguments.length?(m=+b,d=YM(s,r,90),h=XM(t,e,m),p=YM(a,o,90),g=XM(i,n,m),y):m},y.extentMajor([[-180,-90+we],[180,90-we]]).extentMinor([[-180,-80-we],[180,80+we]])}const zd=e=>e;var dv=new In,Px=new In,kL,ML,Ix,Lx,Ns={point:en,lineStart:en,lineEnd:en,polygonStart:function(){Ns.lineStart=bee,Ns.lineEnd=wee},polygonEnd:function(){Ns.lineStart=Ns.lineEnd=Ns.point=en,dv.add(Le(Px)),Px=new In},result:function(){var e=dv/2;return dv=new In,e}};function bee(){Ns.point=xee}function xee(e,t){Ns.point=FL,kL=Ix=e,ML=Lx=t}function FL(e,t){Px.add(Lx*e-Ix*t),Ix=e,Lx=t}function wee(){FL(kL,ML)}var Zl=1/0,bm=Zl,Bd=-Zl,xm=Bd,wm={point:_ee,lineStart:en,lineEnd:en,polygonStart:en,polygonEnd:en,result:function(){var e=[[Zl,bm],[Bd,xm]];return Bd=xm=-(bm=Zl=1/0),e}};function _ee(e,t){e<Zl&&(Zl=e),e>Bd&&(Bd=e),t<bm&&(bm=t),t>xm&&(xm=t)}var zx=0,Bx=0,Lf=0,_m=0,Em=0,gl=0,Ux=0,jx=0,zf=0,TL,RL,jr,qr,Mi={point:hu,lineStart:KM,lineEnd:QM,polygonStart:function(){Mi.lineStart=$ee,Mi.lineEnd=Aee},polygonEnd:function(){Mi.point=hu,Mi.lineStart=KM,Mi.lineEnd=QM},result:function(){var e=zf?[Ux/zf,jx/zf]:gl?[_m/gl,Em/gl]:Lf?[zx/Lf,Bx/Lf]:[NaN,NaN];return zx=Bx=Lf=_m=Em=gl=Ux=jx=zf=0,e}};function hu(e,t){zx+=e,Bx+=t,++Lf}function KM(){Mi.point=Eee}function Eee(e,t){Mi.point=See,hu(jr=e,qr=t)}function See(e,t){var n=e-jr,i=t-qr,r=Bn(n*n+i*i);_m+=r*(jr+e)/2,Em+=r*(qr+t)/2,gl+=r,hu(jr=e,qr=t)}function QM(){Mi.point=hu}function $ee(){Mi.point=Cee}function Aee(){OL(TL,RL)}function Cee(e,t){Mi.point=OL,hu(TL=jr=e,RL=qr=t)}function OL(e,t){var n=e-jr,i=t-qr,r=Bn(n*n+i*i);_m+=r*(jr+e)/2,Em+=r*(qr+t)/2,gl+=r,r=qr*e-jr*t,Ux+=r*(jr+e),jx+=r*(qr+t),zf+=r*3,hu(jr=e,qr=t)}function DL(e){this._context=e}DL.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,zn);break}}},result:en};var qx=new In,hv,NL,PL,Bf,Uf,Ud={point:en,lineStart:function(){Ud.point=kee},lineEnd:function(){hv&&IL(NL,PL),Ud.point=en},polygonStart:function(){hv=!0},polygonEnd:function(){hv=null},result:function(){var e=+qx;return qx=new In,e}};function kee(e,t){Ud.point=IL,NL=Bf=e,PL=Uf=t}function IL(e,t){Bf-=e,Uf-=t,qx.add(Bn(Bf*Bf+Uf*Uf)),Bf=e,Uf=t}let JM,Sm,ZM,eF;class tF{constructor(t){this._append=t==null?LL:Mee(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==ZM||this._append!==Sm){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,ZM=i,Sm=this._append,eF=this._,this._=r}this._+=eF;break}}}result(){const t=this._;return this._="",t.length?t:null}}function LL(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Mee(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return LL;if(t!==JM){const n=10**t;JM=t,Sm=function(r){let s=1;this._+=r[0];for(const o=r.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}return Sm}function zL(e,t){let n=3,i=4.5,r,s;function o(a){return a&&(typeof i=="function"&&s.pointRadius(+i.apply(this,arguments)),Ds(a,r(s))),s.result()}return o.area=function(a){return Ds(a,r(Ns)),Ns.result()},o.measure=function(a){return Ds(a,r(Ud)),Ud.result()},o.bounds=function(a){return Ds(a,r(wm)),wm.result()},o.centroid=function(a){return Ds(a,r(Mi)),Mi.result()},o.projection=function(a){return arguments.length?(r=a==null?(e=null,zd):(e=a).stream,o):e},o.context=function(a){return arguments.length?(s=a==null?(t=null,new tF(n)):new DL(t=a),typeof i!="function"&&s.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(s.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return t===null&&(s=new tF(n)),o},o.projection(e).digits(n).context(t)}function u1(e){return function(t){var n=new Wx;for(var i in e)n[i]=e[i];return n.stream=t,n}}function Wx(){}Wx.prototype={constructor:Wx,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function tS(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Ds(n,e.stream(wm)),t(wm.result()),i!=null&&e.clipExtent(i),e}function l1(e,t,n){return tS(e,function(i){var r=t[1][0]-t[0][0],s=t[1][1]-t[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+t[0][0]+(r-o*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(s-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,u])},n)}function nS(e,t,n){return l1(e,[[0,0],t],n)}function iS(e,t,n){return tS(e,function(i){var r=+t,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];e.scale(150*s).translate([o,a])},n)}function rS(e,t,n){return tS(e,function(i){var r=+t,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,a])},n)}var nF=16,Fee=_e(30*De);function iF(e,t){return+t?Ree(e,t):Tee(e)}function Tee(e){return u1({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Ree(e,t){function n(i,r,s,o,a,u,l,c,f,d,h,p,g,m){var y=l-i,v=c-r,b=y*y+v*v;if(b>4*t&&g--){var x=o+d,w=a+h,E=u+p,_=Bn(x*x+w*w+E*E),$=ni(E/=_),A=Le(Le(E)-1)<we||Le(s-f)<we?(s+f)/2:Ui(w,x),F=e(A,$),M=F[0],P=F[1],D=M-i,O=P-r,C=v*D-y*O;(C*C/b>t||Le((y*D+v*O)/b-.5)>.3||o*d+a*h+u*p<Fee)&&(n(i,r,s,o,a,u,M,P,A,x/=_,w/=_,E,g,m),m.point(M,P),n(M,P,A,x,w,E,l,c,f,d,h,p,g,m))}}return function(i){var r,s,o,a,u,l,c,f,d,h,p,g,m={point:y,lineStart:v,lineEnd:x,polygonStart:function(){i.polygonStart(),m.lineStart=w},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y($,A){$=e($,A),i.point($[0],$[1])}function v(){f=NaN,m.point=b,i.lineStart()}function b($,A){var F=du([$,A]),M=e($,A);n(f,d,c,h,p,g,f=M[0],d=M[1],c=$,h=F[0],p=F[1],g=F[2],nF,i),i.point(f,d)}function x(){m.point=y,i.lineEnd()}function w(){v(),m.point=E,m.lineEnd=_}function E($,A){b(r=$,A),s=f,o=d,a=h,u=p,l=g,m.point=b}function _(){n(f,d,c,h,p,g,s,o,r,a,u,l,nF,i),m.lineEnd=x,x()}return m}}var Oee=u1({point:function(e,t){this.stream.point(e*De,t*De)}});function Dee(e){return u1({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function Nee(e,t,n,i,r){function s(o,a){return o*=i,a*=r,[t+e*o,n-e*a]}return s.invert=function(o,a){return[(o-t)/e*i,(n-a)/e*r]},s}function rF(e,t,n,i,r,s){if(!s)return Nee(e,t,n,i,r);var o=_e(s),a=xe(s),u=o*e,l=a*e,c=o/e,f=a/e,d=(a*n-o*t)/e,h=(a*t+o*n)/e;function p(g,m){return g*=i,m*=r,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[i*(c*g-f*m+d),r*(h-f*g-c*m)]},p}function hs(e){return BL(function(){return e})()}function BL(e){var t,n=150,i=480,r=250,s=0,o=0,a=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=VM,m=null,y,v,b,x=zd,w=.5,E,_,$,A,F;function M(C){return $(C[0]*De,C[1]*De)}function P(C){return C=$.invert(C[0],C[1]),C&&[C[0]*$t,C[1]*$t]}M.stream=function(C){return A&&F===C?A:A=Oee(Dee(c)(g(E(x(F=C)))))},M.preclip=function(C){return arguments.length?(g=C,p=void 0,O()):g},M.postclip=function(C){return arguments.length?(x=C,m=y=v=b=null,O()):x},M.clipAngle=function(C){return arguments.length?(g=+C?mee(p=C*De):(p=null,VM),O()):p*$t},M.clipExtent=function(C){return arguments.length?(x=C==null?(m=y=v=b=null,zd):CL(m=+C[0][0],y=+C[0][1],v=+C[1][0],b=+C[1][1]),O()):m==null?null:[[m,y],[v,b]]},M.scale=function(C){return arguments.length?(n=+C,D()):n},M.translate=function(C){return arguments.length?(i=+C[0],r=+C[1],D()):[i,r]},M.center=function(C){return arguments.length?(s=C[0]%360*De,o=C[1]%360*De,D()):[s*$t,o*$t]},M.rotate=function(C){return arguments.length?(a=C[0]%360*De,u=C[1]%360*De,l=C.length>2?C[2]%360*De:0,D()):[a*$t,u*$t,l*$t]},M.angle=function(C){return arguments.length?(f=C%360*De,D()):f*$t},M.reflectX=function(C){return arguments.length?(d=C?-1:1,D()):d<0},M.reflectY=function(C){return arguments.length?(h=C?-1:1,D()):h<0},M.precision=function(C){return arguments.length?(E=iF(_,w=C*C),O()):Bn(w)},M.fitExtent=function(C,R){return l1(M,C,R)},M.fitSize=function(C,R){return nS(M,C,R)},M.fitWidth=function(C,R){return iS(M,C,R)},M.fitHeight=function(C,R){return rS(M,C,R)};function D(){var C=rF(n,0,0,d,h,f).apply(null,t(s,o)),R=rF(n,i-C[0],r-C[1],d,h,f);return c=EL(a,u,l),_=Dx(t,R),$=Dx(c,_),E=iF(_,w),O()}function O(){return A=F=null,M}return function(){return t=e.apply(this,arguments),M.invert=t.invert&&P,D()}}function sS(e){var t=0,n=Ne/3,i=BL(e),r=i(t,n);return r.parallels=function(s){return arguments.length?i(t=s[0]*De,n=s[1]*De):[t*$t,n*$t]},r}function Pee(e){var t=_e(e);function n(i,r){return[i*t,xe(r)/t]}return n.invert=function(i,r){return[i/t,ni(r*t)]},n}function Iee(e,t){var n=xe(e),i=(n+xe(t))/2;if(Le(i)<we)return Pee(e);var r=1+n*(2*i-n),s=Bn(r)/i;function o(a,u){var l=Bn(r-2*i*xe(u))/i;return[l*xe(a*=i),s-l*_e(a)]}return o.invert=function(a,u){var l=s-u,c=Ui(a,Le(l))*Ti(l);return l*i<0&&(c-=Ne*Ti(a)*Ti(l)),[c/i,ni((r-(a*a+l*l)*i*i)/(2*i))]},o}function $m(){return sS(Iee).scale(155.424).center([0,33.6442])}function UL(){return $m().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Lee(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function zee(){var e,t,n=UL(),i,r=$m().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=$m().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,i.point(h,p),u||(s.point(h,p),u)||(a.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?r:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=Lee([n.stream(t=d),r.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return i=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),s=r.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+we,g+.12*h+we],[p-.214*h-we,g+.234*h-we]]).stream(l),a=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+we,g+.166*h+we],[p-.115*h-we,g+.234*h-we]]).stream(l),f()},c.fitExtent=function(d,h){return l1(c,d,h)},c.fitSize=function(d,h){return nS(c,d,h)},c.fitWidth=function(d,h){return iS(c,d,h)},c.fitHeight=function(d,h){return rS(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function jL(e){return function(t,n){var i=_e(t),r=_e(n),s=e(i*r);return s===1/0?[2,0]:[s*r*xe(t),s*xe(n)]}}function Mh(e){return function(t,n){var i=Bn(t*t+n*n),r=e(i),s=xe(r),o=_e(r);return[Ui(t*s,i*o),ni(i&&n*s/i)]}}var qL=jL(function(e){return Bn(2/(1+e))});qL.invert=Mh(function(e){return 2*ni(e/2)});function Bee(){return hs(qL).scale(124.75).clipAngle(180-.001)}var WL=jL(function(e){return(e=dL(e))&&e/xe(e)});WL.invert=Mh(function(e){return e});function Uee(){return hs(WL).scale(79.4188).clipAngle(180-.001)}function c1(e,t){return[e,om(ZE((Et+t)/2))]}c1.invert=function(e,t){return[e,2*Nc(fL(t))-Et]};function jee(){return HL(c1).scale(961/zn)}function HL(e){var t=hs(e),n=t.center,i=t.scale,r=t.translate,s=t.clipExtent,o=null,a,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=a=u=l=null:(o=+f[0][0],a=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,a],[u,l]]};function c(){var f=Ne*i(),d=t(uee(t.rotate()).invert([0,0]));return s(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===c1?[[Math.max(d[0]-f,o),a],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,a)],[u,Math.min(d[1]+f,l)]])}return c()}function wp(e){return ZE((Et+e)/2)}function qee(e,t){var n=_e(e),i=e===t?xe(e):om(n/_e(t))/om(wp(t)/wp(e)),r=n*lv(wp(e),i)/i;if(!i)return c1;function s(o,a){r>0?a<-Et+we&&(a=-Et+we):a>Et-we&&(a=Et-we);var u=r/lv(wp(a),i);return[u*xe(i*o),r-u*_e(i*o)]}return s.invert=function(o,a){var u=r-a,l=Ti(i)*Bn(o*o+u*u),c=Ui(o,Le(u))*Ti(u);return u*i<0&&(c-=Ne*Ti(o)*Ti(u)),[c/i,2*Nc(lv(r/l,1/i))-Et]},s}function Wee(){return sS(qee).scale(109.5).parallels([30,30])}function Am(e,t){return[e,t]}Am.invert=Am;function Hee(){return hs(Am).scale(152.63)}function Gee(e,t){var n=_e(e),i=e===t?xe(e):(n-_e(t))/(t-e),r=n/i+e;if(Le(i)<we)return Am;function s(o,a){var u=r-a,l=i*o;return[u*xe(l),r-u*_e(l)]}return s.invert=function(o,a){var u=r-a,l=Ui(o,Le(u))*Ti(u);return u*i<0&&(l-=Ne*Ti(o)*Ti(u)),[l/i,r-Ti(i)*Bn(o*o+u*u)]},s}function Vee(){return sS(Gee).scale(131.154).center([0,13.9389])}var fd=1.340264,dd=-.081106,hd=893e-6,pd=.003796,Cm=Bn(3)/2,Yee=12;function GL(e,t){var n=ni(Cm*xe(t)),i=n*n,r=i*i*i;return[e*_e(n)/(Cm*(fd+3*dd*i+r*(7*hd+9*pd*i))),n*(fd+dd*i+r*(hd+pd*i))]}GL.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,s=0,o,a,u;s<Yee&&(a=n*(fd+dd*i+r*(hd+pd*i))-t,u=fd+3*dd*i+r*(7*hd+9*pd*i),n-=o=a/u,i=n*n,r=i*i*i,!(Le(o)<rm));++s);return[Cm*e*(fd+3*dd*i+r*(7*hd+9*pd*i))/_e(n),ni(xe(n)/Cm)]};function Xee(){return hs(GL).scale(177.158)}function VL(e,t){var n=_e(t),i=_e(e)*n;return[n*xe(e)/i,xe(t)/i]}VL.invert=Mh(Nc);function Kee(){return hs(VL).scale(144.049).clipAngle(60)}function Qee(){var e=1,t=0,n=0,i=1,r=1,s=0,o,a,u=null,l,c,f,d=1,h=1,p=u1({point:function(x,w){var E=b([x,w]);this.stream.point(E[0],E[1])}}),g=zd,m,y;function v(){return d=e*i,h=e*r,m=y=null,b}function b(x){var w=x[0]*d,E=x[1]*h;if(s){var _=E*o-w*a;w=w*o+E*a,E=_}return[w+t,E+n]}return b.invert=function(x){var w=x[0]-t,E=x[1]-n;if(s){var _=E*o+w*a;w=w*o-E*a,E=_}return[w/d,E/h]},b.stream=function(x){return m&&y===x?m:m=p(g(y=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,v()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,zd):CL(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),v()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,v()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],v()):[t,n]},b.angle=function(x){return arguments.length?(s=x%360*De,a=xe(s),o=_e(s),v()):s*$t},b.reflectX=function(x){return arguments.length?(i=x?-1:1,v()):i<0},b.reflectY=function(x){return arguments.length?(r=x?-1:1,v()):r<0},b.fitExtent=function(x,w){return l1(b,x,w)},b.fitSize=function(x,w){return nS(b,x,w)},b.fitWidth=function(x,w){return iS(b,x,w)},b.fitHeight=function(x,w){return rS(b,x,w)},b}function YL(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}YL.invert=function(e,t){var n=t,i=25,r;do{var s=n*n,o=s*s;n-=r=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-t)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(Le(r)>we&&--i>0);return[e/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function Jee(){return hs(YL).scale(175.295)}function XL(e,t){return[_e(t)*xe(e),xe(t)]}XL.invert=Mh(ni);function Zee(){return hs(XL).scale(249.5).clipAngle(90+we)}function KL(e,t){var n=_e(t),i=1+_e(e)*n;return[n*xe(e)/i,xe(t)/i]}KL.invert=Mh(function(e){return 2*Nc(e)});function ete(){return hs(KL).scale(250).clipAngle(142)}function QL(e,t){return[om(ZE((Et+t)/2)),-e]}QL.invert=function(e,t){return[-t,2*Nc(fL(e))-Et]};function tte(){var e=HL(QL),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var nte=Math.abs,Hx=Math.cos,km=Math.sin,ite=1e-6,JL=Math.PI,Gx=JL/2,sF=rte(2);function oF(e){return e>1?Gx:e<-1?-Gx:Math.asin(e)}function rte(e){return e>0?Math.sqrt(e):0}function ste(e,t){var n=e*km(t),i=30,r;do t-=r=(t+km(t)-n)/(1+Hx(t));while(nte(r)>ite&&--i>0);return t/2}function ote(e,t,n){function i(r,s){return[e*r*Hx(s=ste(n,s)),t*km(s)]}return i.invert=function(r,s){return s=oF(s/t),[r/(e*Hx(s)),oF((2*s+km(2*s))/n)]},i}var ate=ote(sF/Gx,sF,JL);function ute(){return hs(ate).scale(169.529)}const lte=zL(),Vx=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function cte(e,t){return function n(){const i=t();return i.type=e,i.path=zL().projection(i),i.copy=i.copy||function(){const r=n();return Vx.forEach(s=>{i[s]&&r[s](i[s]())}),r.path.pointRadius(i.path.pointRadius()),r},p5(i)}}function oS(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Mm[e]=cte(e,t),this):Mm[e]||null}function ZL(e){return e&&e.path||lte}const Mm={albers:UL,albersusa:zee,azimuthalequalarea:Bee,azimuthalequidistant:Uee,conicconformal:Wee,conicequalarea:$m,conicequidistant:Vee,equalEarth:Xee,equirectangular:Hee,gnomonic:Kee,identity:Qee,mercator:jee,mollweide:ute,naturalEarth1:Jee,orthographic:Zee,stereographic:ete,transversemercator:tte};for(const e in Mm)oS(e,Mm[e]);function fte(){}const $s=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function e6(){var e=1,t=1,n=a;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return s(u,l,d=>{n(d,u,l),dte(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(hte((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function s(u,l,c){var f=[],d=[],h,p,g,m,y,v;for(h=p=-1,m=u[0]>=l,$s[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,$s[g|m<<1].forEach(b);for($s[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,y=u[p*e]>=l,$s[m<<1|y<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,v=y,y=u[p*e+h+1]>=l,$s[g|m<<1|y<<2|v<<3].forEach(b);$s[m|y<<3].forEach(b)}for(h=-1,y=u[p*e]>=l,$s[y<<2].forEach(b);++h<e-1;)v=y,y=u[p*e+h+1]>=l,$s[y<<2|v<<3].forEach(b);$s[y<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],E=[x[1][0]+h,x[1][1]+p],_=o(w),$=o(E),A,F;(A=d[_])?(F=f[$])?(delete d[A.end],delete f[F.start],A===F?(A.ring.push(E),c(A.ring)):f[A.start]=d[F.end]={start:A.start,end:F.end,ring:A.ring.concat(F.ring)}):(delete d[A.end],A.ring.push(E),d[A.end=$]=A):(A=f[$])?(F=d[_])?(delete f[A.start],delete d[F.end],A===F?(A.ring.push(E),c(A.ring)):f[F.start]=d[A.end]={start:F.start,end:A.end,ring:F.ring.concat(A.ring)}):(delete f[A.start],A.ring.unshift(w),f[A.start=_]=A):f[_]=d[$]={start:_,end:$,ring:[w,E]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function a(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,y=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||q("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?a:fte,i):n===a},i}function dte(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function hte(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=pte(e,t[n]))return r;return 0}function pte(e,t){for(var n=t[0],i=t[1],r=-1,s=0,o=e.length,a=o-1;s<o;a=s++){var u=e[s],l=u[0],c=u[1],f=e[a],d=f[0],h=f[1];if(gte(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function gte(e,t,n){var i;return mte(e,t,n)&&yte(e[i=+(e[0]===t[0])],n[i],t[i])}function mte(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function yte(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function t6(e,t,n){return function(i){var r=es(i),s=n?Math.min(r[0],0):r[0],o=r[1],a=o-s,u=t?Yo(s,o,e):a/(e+1);return gi(s+u,o,u)}}function aS(e){z.call(this,null,e)}aS.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};te(aS,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||_n,s=e6().smooth(e.smooth!==!1),o=e.thresholds||vte(i,r,e),a=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=s.size([c.width,c.height])(c.values,G(o)?o:o(c.values));bte(f,c,l,e),f.forEach(d=>{u.push(C0(l,Ve(a!=null?{[a]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function vte(e,t,n){const i=t6(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Ka(t(r).values)))}function bte(e,t,n,i){let r=i.scale||t.scale,s=i.translate||t.translate;if(Te(r)&&(r=r(n,i)),Te(s)&&(s=s(n,i)),(r===1||r==null)&&!s)return;const o=(We(r)?r:r[0])||1,a=(We(r)?r:r[1])||1,u=s&&s[0]||0,l=s&&s[1]||0;e.forEach(n6(t,o,a,u,l))}function n6(e,t,n,i,r){const s=e.x1||0,o=e.y1||0,a=t*n<0;function u(f){f.forEach(l)}function l(f){a&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-s)*t+i,f[1]=(f[1]-o)*n+r}return function(f){return f.coordinates.forEach(u),f}}function aF(e,t,n){const i=e>=0?e:Z2(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function pv(e){return Te(e)?e:En(+e)}function i6(){var e=u=>u[0],t=u=>u[1],n=wc,i=[-1,-1],r=960,s=500,o=2;function a(u,l){const c=aF(i[0],u,e)>>o,f=aF(i[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(r>>o),g=2*h+(s>>o),m=new Float32Array(p*g),y=new Float32Array(p*g);let v=m;u.forEach(x=>{const w=d+(+e(x)>>o),E=h+(+t(x)>>o);w>=0&&w<p&&E>=0&&E<g&&(m[w+E*p]+=+n(x))}),c>0&&f>0?(Zu(p,g,m,y,c),el(p,g,y,m,f),Zu(p,g,m,y,c),el(p,g,y,m,f),Zu(p,g,m,y,c),el(p,g,y,m,f)):c>0?(Zu(p,g,m,y,c),Zu(p,g,y,m,c),Zu(p,g,m,y,c),v=y):f>0&&(el(p,g,m,y,f),el(p,g,y,m,f),el(p,g,m,y,f),v=y);const b=l?Math.pow(2,-2*o):1/vN(v);for(let x=0,w=p*g;x<w;++x)v[x]*=b;return{values:v,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(r>>o),y2:h+(s>>o)}}return a.x=function(u){return arguments.length?(e=pv(u),a):e},a.y=function(u){return arguments.length?(t=pv(u),a):t},a.weight=function(u){return arguments.length?(n=pv(u),a):n},a.size=function(u){if(!arguments.length)return[r,s];var l=+u[0],c=+u[1];return l>=0&&c>=0||q("invalid size"),r=l,s=c,a},a.cellSize=function(u){return arguments.length?((u=+u)>=1||q("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),a):1<<o},a.bandwidth=function(u){return arguments.length?(u=le(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&q("invalid bandwidth"),i=u,a):i},a}function Zu(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<t;++o)for(let a=0,u=0;a<e+r;++a)a<e&&(u+=n[a+o*e]),a>=r&&(a>=s&&(u-=n[a-s+o*e]),i[a-r+o*e]=u/Math.min(a+1,e-1+s-a,s))}function el(e,t,n,i,r){const s=(r<<1)+1;for(let o=0;o<e;++o)for(let a=0,u=0;a<t+r;++a)a<t&&(u+=n[o+a*e]),a>=r&&(a>=s&&(u-=n[o+(a-s)*e]),i[o+(a-r)*e]=u/Math.min(a+1,t-1+s-a,s))}function uS(e){z.call(this,null,e)}uS.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const xte=["x","y","weight","size","cellSize","bandwidth"];function r6(e,t){return xte.forEach(n=>t[n]!=null?e[n](t[n]):0),e}te(uS,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=wte(i,e.groupby),s=(e.groupby||[]).map(St),o=r6(i6(),e),a=e.as||"grid",u=[];function l(c,f){for(let d=0;d<s.length;++d)c[s[d]]=f[d];return c}return u=r.map(c=>Ve(l({[a]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function wte(e,t){var n=[],i=c=>c(a),r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function lS(e){z.call(this,null,e)}lS.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};te(lS,z,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e6().smooth(e.smooth!==!1),r=e.values,s=e.thresholds||t6(e.count||10,e.nice,!!r),o=e.size,a,u;return r||(r=t.materialize(t.SOURCE).source,a=r6(i6(),e)(r,!0),u=n6(a,a.scale||1,a.scale||1,0,0),o=[a.width,a.height],r=a.values),s=G(s)?s:s(r),r=i.size(o)(r,s),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ve),n}});const Yx="Feature",cS="FeatureCollection",_te="MultiPoint";function fS(e){z.call(this,null,e)}fS.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};te(fS,z,{transform(e,t){var n=this._features,i=this._points,r=e.fields,s=r&&r[0],o=r&&r[1],a=e.geojson||!r&&_n,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(yn(a))||s&&t.modified(yn(s))||o&&t.modified(yn(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),a&&t.visit(u,c=>n.push(a(c))),s&&o&&(t.visit(u,c=>{var f=s(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:Yx,geometry:{type:_te,coordinates:i}})),this.value={type:cS,features:n}}});function dS(e){z.call(this,null,e)}dS.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};te(dS,z,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||_n,s=e.as||"path",o=n.SOURCE;!i||e.modified()?(this.value=i=ZL(e.projection),n.materialize().reflow()):o=r===_n||t.modified(r.fields)?n.ADD_MOD:n.ADD;const a=Ete(i,e.pointRadius);return n.visit(o,u=>u[s]=i(r(u))),i.pointRadius(a),n.modifies(s)}});function Ete(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function hS(e){z.call(this,null,e)}hS.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};te(hS,z,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],s=e.as||["x","y"],o=s[0],a=s[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[o]=f[0],c[a]=f[1]):(c[o]=void 0,c[a]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(s)}});function pS(e){z.call(this,null,e)}pS.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};te(pS,z,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",s=n.ADD;return(!i||e.modified())&&(this.value=i=Ste(ZL(e.projection),e.field||Ii("datum"),e.pointRadius),n.materialize().reflow(),s=n.SOURCE),n.visit(s,o=>o[r]=i),n.modifies(r)}});function Ste(e,t,n){const i=n==null?r=>e(t(r)):r=>{var s=e.pointRadius(),o=e.pointRadius(n)(t(r));return e.pointRadius(s),o};return i.context=r=>(e.context(r),i),i}function gS(e){z.call(this,[],e),this.generator=vee()}gS.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};te(gS,z,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const s in e)Te(i[s])&&i[s](e[s]);return r=i(),n.length?t.mod.push(h3(n[0],r)):t.add.push(Ve(r)),n[0]=r,t}});function mS(e){z.call(this,null,e)}mS.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};te(mS,z,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||_n,s=Ate(e.opacity,e),o=$te(e.color,e),a=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?Ka(n.map(l=>Ka(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=Fe({},l,u);i||(f.$max=Ka(c.values||[])),l[a]=Cte(c,f,o.dep?o:En(o(f)),s.dep?s:En(s(f)))}),t.reflow(!0).modifies(a)}});function $te(e,t){let n;return Te(e)?(n=i=>Qo(e(i,t)),n.dep=s6(e)):n=En(Qo(e||"#888")),n}function Ate(e,t){let n;return Te(e)?(n=i=>e(i,t),n.dep=s6(e)):e?n=En(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function s6(e){if(!Te(e))return!1;const t=hr(yn(e));return t.$x||t.$y||t.$value||t.$max}function Cte(e,t,n,i){const r=e.width,s=e.height,o=e.x1||0,a=e.y1||0,u=e.x2||r,l=e.y2||s,c=e.values,f=c?m=>c[m]:Fo,d=Wo(u-o,l-a),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-a),g=p.data;for(let m=a,y=0;m<l;++m){t.$y=m-a;for(let v=o,b=m*r;v<u;++v,y+=4){t.$x=v-o,t.$value=f(v+b);const x=n(t);g[y+0]=x.r,g[y+1]=x.g,g[y+2]=x.b,g[y+3]=~~(255*i(t))}}return h.putImageData(p,0,0),d}function o6(e){z.call(this,null,e),this.modified(!0)}te(o6,z,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=Mte(e.type),Vx.forEach(i=>{e[i]!=null&&uF(n,i,e[i])})):Vx.forEach(i=>{e.modified(i)&&uF(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&kte(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function kte(e,t){const n=Fte(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function Mte(e){const t=oS((e||"mercator").toLowerCase());return t||q("Unrecognized projection type: "+e),t()}function uF(e,t,n){Te(e[t])&&e[t](n)}function Fte(e){return e=le(e),e.length===1?e[0]:{type:cS,features:e.reduce((t,n)=>t.concat(Tte(n)),[])}}function Tte(e){return e.type===cS?e.features:le(e).filter(t=>t!=null).map(t=>t.type===Yx?t:{type:Yx,geometry:t})}const Rte=Object.freeze(Object.defineProperty({__proto__:null,contour:lS,geojson:fS,geopath:dS,geopoint:hS,geoshape:pS,graticule:gS,heatmap:mS,isocontour:aS,kde2d:uS,projection:o6},Symbol.toStringTag,{value:"Module"}));function Ote(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var s,o=n.length,a,u=0,l=0;for(s=0;s<o;++s)a=n[s],u+=a.x,l+=a.y;for(u=(u/o-e)*i,l=(l/o-t)*i,s=0;s<o;++s)a=n[s],a.x-=u,a.y-=l}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(e=+s,r):e},r.y=function(s){return arguments.length?(t=+s,r):t},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function Dte(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return a6(this.cover(t,n),t,n,e)}function a6(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,s=e._root,o={data:i},a=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,y,v;if(!s)return e._root=o,e;for(;s.length;)if((g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=s,!(s=s[y=m<<1|g]))return r[y]=o,e;if(h=+e._x.call(null,s.data),p=+e._y.call(null,s.data),t===h&&n===p)return o.next=s,r?r[y]=o:e._root=o,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(g=t>=(f=(a+l)/2))?a=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|g)===(v=(p>=d)<<1|h>=f));return r[v]=s,r[y]=o,e}function Nte(e){var t,n,i=e.length,r,s,o=new Array(i),a=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||(o[n]=r,a[n]=s,r<u&&(u=r),r>c&&(c=r),s<l&&(l=s),s>f&&(f=s));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)a6(this,o[n],a[n],e[n]);return this}function Pte(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,s=(i=Math.floor(t))+1;else{for(var o=r-n||1,a=this._root,u,l;n>e||e>=r||i>t||t>=s;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=a,a=u,o*=2,l){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function Ite(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Lte(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Dn(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function zte(e,t,n){var i,r=this._x0,s=this._y0,o,a,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new Dn(h,r,s,c,f)),n==null?n=1/0:(r=e-n,s=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(a=p.y0)>f||(u=p.x1)<r||(l=p.y1)<s))if(h.length){var m=(o+u)/2,y=(a+l)/2;d.push(new Dn(h[3],m,y,u,l),new Dn(h[2],o,y,m,l),new Dn(h[1],m,a,u,y),new Dn(h[0],o,a,m,y)),(g=(t>=y)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var v=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);r=e-w,s=t-w,c=e+w,f=t+w,i=h.data}}return i}function Bte(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,s,o=this._x0,a=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,y;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(a+l)/2))?a=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):t?(s?t[m]=s:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=s,this)}function Ute(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function jte(){return this._root}function qte(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function Wte(e){var t=[],n,i=this._root,r,s,o,a,u;for(i&&t.push(new Dn(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,s=n.x0,o=n.y0,a=n.x1,u=n.y1)&&i.length){var l=(s+a)/2,c=(o+u)/2;(r=i[3])&&t.push(new Dn(r,l,c,a,u)),(r=i[2])&&t.push(new Dn(r,s,c,l,u)),(r=i[1])&&t.push(new Dn(r,l,o,a,c)),(r=i[0])&&t.push(new Dn(r,s,o,l,c))}return this}function Hte(e){var t=[],n=[],i;for(this._root&&t.push(new Dn(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var s,o=i.x0,a=i.y0,u=i.x1,l=i.y1,c=(o+u)/2,f=(a+l)/2;(s=r[0])&&t.push(new Dn(s,o,a,c,f)),(s=r[1])&&t.push(new Dn(s,c,a,u,f)),(s=r[2])&&t.push(new Dn(s,o,f,c,l)),(s=r[3])&&t.push(new Dn(s,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Gte(e){return e[0]}function Vte(e){return arguments.length?(this._x=e,this):this._x}function Yte(e){return e[1]}function Xte(e){return arguments.length?(this._y=e,this):this._y}function yS(e,t,n){var i=new vS(t??Gte,n??Yte,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function vS(e,t,n,i,r,s){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function lF(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var jn=yS.prototype=vS.prototype;jn.copy=function(){var e=new vS(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=lF(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=lF(i));return e};jn.add=Dte;jn.addAll=Nte;jn.cover=Pte;jn.data=Ite;jn.extent=Lte;jn.find=zte;jn.remove=Bte;jn.removeAll=Ute;jn.root=jte;jn.size=qte;jn.visit=Wte;jn.visitAfter=Hte;jn.x=Vte;jn.y=Xte;function Nn(e){return function(){return e}}function Io(e){return(e()-.5)*1e-6}function Kte(e){return e.x+e.vx}function Qte(e){return e.y+e.vy}function Jte(e){var t,n,i,r=1,s=1;typeof e!="function"&&(e=Nn(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,y=0;y<s;++y)for(f=yS(t,Kte,Qte).visitAfter(a),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(v);function v(b,x,w,E,_){var $=b.data,A=b.r,F=g+A;if($){if($.index>d.index){var M=h-$.x-$.vx,P=p-$.y-$.vy,D=M*M+P*P;D<F*F&&(M===0&&(M=Io(i),D+=M*M),P===0&&(P=Io(i),D+=P*P),D=(F-(D=Math.sqrt(D)))/D*r,d.vx+=(M*=D)*(F=(A*=A)/(m+A)),d.vy+=(P*=D)*F,$.vx-=M*(F=1-F),$.vy-=P*F)}return}return x>h+F||E<h-F||w>p+F||_<p-F}}function a(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,i=c,u()},o.iterations=function(l){return arguments.length?(s=+l,o):s},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:Nn(+l),u(),o):e},o}function Zte(e){return e.index}function cF(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function ene(e){var t=Zte,n=f,i,r=Nn(30),s,o,a,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var b=0,x,w,E,_,$,A,F;b<v;++b)x=e[b],w=x.source,E=x.target,_=E.x+E.vx-w.x-w.vx||Io(l),$=E.y+E.vy-w.y-w.vy||Io(l),A=Math.sqrt(_*_+$*$),A=(A-s[b])/A*m*i[b],_*=A,$*=A,E.vx-=_*(F=u[b]),E.vy-=$*F,w.vx+=_*(F=1-F),w.vy+=$*F}function h(){if(o){var m,y=o.length,v=e.length,b=new Map(o.map((w,E)=>[t(w,E,o),w])),x;for(m=0,a=new Array(y);m<v;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=cF(b,x.source)),typeof x.target!="object"&&(x.target=cF(b,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)x=e[m],u[m]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(v),p(),s=new Array(v),g()}}function p(){if(o)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function g(){if(o)for(var m=0,y=e.length;m<y;++m)s[m]=+r(e[m],m,e)}return d.initialize=function(m,y){o=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Nn(+m),p(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:Nn(+m),g(),d):r},d}var tne={value:()=>{}};function u6(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new sg(n)}function sg(e){this._=e}function nne(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}sg.prototype=u6.prototype={constructor:sg,on:function(e,t){var n=this._,i=nne(e+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(e=i[s]).type)&&(r=ine(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(r=(e=i[s]).type)n[r]=fF(n[r],e.name,t);else if(t==null)for(r in n)n[r]=fF(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new sg(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],i=0,r=s.length;i<r;++i)s[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)}};function ine(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function fF(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=tne,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var ec=0,jf=0,ff=0,l6=1e3,Fm,qf,Tm=0,pu=0,f1=0,jd=typeof performance=="object"&&performance.now?performance:Date,c6=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function bS(){return pu||(c6(rne),pu=jd.now()+f1)}function rne(){pu=0}function Rm(){this._call=this._time=this._next=null}Rm.prototype=f6.prototype={constructor:Rm,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?bS():+n)+(t==null?0:+t),!this._next&&qf!==this&&(qf?qf._next=this:Fm=this,qf=this),this._call=e,this._time=n,Xx()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xx())}};function f6(e,t,n){var i=new Rm;return i.restart(e,t,n),i}function sne(){bS(),++ec;for(var e=Fm,t;e;)(t=pu-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ec}function dF(){pu=(Tm=jd.now())+f1,ec=jf=0;try{sne()}finally{ec=0,ane(),pu=0}}function one(){var e=jd.now(),t=e-Tm;t>l6&&(f1-=t,Tm=e)}function ane(){for(var e,t=Fm,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Fm=n);qf=e,Xx(i)}function Xx(e){if(!ec){jf&&(jf=clearTimeout(jf));var t=e-pu;t>24?(e<1/0&&(jf=setTimeout(dF,e-jd.now()-f1)),ff&&(ff=clearInterval(ff))):(ff||(Tm=jd.now(),ff=setInterval(one,l6)),ec=1,c6(dF))}}function une(e,t,n){var i=new Rm,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(s,o,a){o=+o,a=a==null?bS():+a,i._restart(function u(l){l+=r,i._restart(u,r+=o,a),s(l)},o,a)},i.restart(e,t,n),i)}const lne=1664525,cne=1013904223,hF=4294967296;function fne(){let e=1;return()=>(e=(lne*e+cne)%hF)/hF}function dne(e){return e.x}function hne(e){return e.y}var pne=10,gne=Math.PI*(3-Math.sqrt(5));function mne(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,u=f6(f),l=u6("tick","end"),c=fne();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(g){var m,y=e.length,v;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return t}function h(){for(var g=0,m=e.length,y;g<m;++g){if(y=e[g],y.index=g,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=pne*Math.sqrt(.5+g),b=g*gne;y.x=v*Math.cos(b),y.y=v*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),a.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(i=+g,t):i},alphaDecay:function(g){return arguments.length?(r=+g,t):+r},alphaTarget:function(g){return arguments.length?(s=+g,t):s},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,a.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?a.delete(g):a.set(g,p(m)),t):a.get(g)},find:function(g,m,y){var v=0,b=e.length,x,w,E,_,$;for(y==null?y=1/0:y*=y,v=0;v<b;++v)_=e[v],x=g-_.x,w=m-_.y,E=x*x+w*w,E<y&&($=_,y=E);return $},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function yne(){var e,t,n,i,r=Nn(-30),s,o=1,a=1/0,u=.81;function l(h){var p,g=e.length,m=yS(e,dne,hne).visitAfter(f);for(i=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(e){var h,p=e.length,g;for(s=new Array(p),h=0;h<p;++h)g=e[h],s[g.index]=+r(g,h,e)}}function f(h){var p=0,g,m,y=0,v,b,x;if(h.length){for(v=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,y+=m,v+=m*g.x,b+=m*g.y);h.x=v/y,h.y=b/y}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,b=m-p,x=y*y+v*v;if(b*b/u<x)return x<a&&(y===0&&(y=Io(n),x+=y*y),v===0&&(v=Io(n),x+=v*v),x<o&&(x=Math.sqrt(o*x)),t.vx+=y*h.value*i/x,t.vy+=v*h.value*i/x),!0;if(h.length||x>=a)return;(h.data!==t||h.next)&&(y===0&&(y=Io(n),x+=y*y),v===0&&(v=Io(n),x+=v*v),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=s[h.data.index]*i/x,t.vx+=y*b,t.vy+=v*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:Nn(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function vne(e){var t=Nn(.1),n,i,r;typeof e!="function"&&(e=Nn(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Nn(+a),o(),s):t},s.x=function(a){return arguments.length?(e=typeof a=="function"?a:Nn(+a),o(),s):e},s}function bne(e){var t=Nn(.1),n,i,r;typeof e!="function"&&(e=Nn(e==null?0:+e));function s(a){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*a}function o(){if(n){var a,u=n.length;for(i=new Array(u),r=new Array(u),a=0;a<u;++a)i[a]=isNaN(r[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Nn(+a),o(),s):t},s.y=function(a){return arguments.length?(e=typeof a=="function"?a:Nn(+a),o(),s):e},s}const pF={center:Ote,collide:Jte,nbody:yne,link:ene,x:vne,y:bne},Wf="forces",Kx=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],xne=["static","iterations"],d6=["x","y","vx","vy"];function xS(e){z.call(this,null,e)}xS.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:d6}]};te(xS,z,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(Kx),s=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&h6(n,e,0,t)):(this.value=n=_ne(t.source,e),n.on("tick",wne(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(xne)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/s)),e.static)for(n.stop();--s>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let a=this._argops,u=0,l=a.length,c;u<l;++u)if(c=a[u],!(c.name!==Wf||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,s=i.length,o;r<s;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(d6)}});function wne(e,t){return()=>e.touch(t).run()}function _ne(e,t){const n=mne(e),i=n.stop,r=n.restart;let s=!1;return n.stopped=()=>s,n.restart=()=>(s=!1,r()),n.stop=()=>(s=!0,i()),h6(n,t,!0).on("end",()=>s=!0)}function h6(e,t,n,i){var r=le(t.forces),s,o,a,u;for(s=0,o=Kx.length;s<o;++s)a=Kx[s],a!==Wf&&t.modified(a)&&e[a](t[a]);for(s=0,o=r.length;s<o;++s)u=Wf+s,a=n||t.modified(Wf,s)?Sne(r[s]):i&&Ene(r[s],i)?e.force(u):null,a&&e.force(u,a);for(o=e.numForces||0;s<o;++s)e.force(Wf+s,null);return e.numForces=r.length,e}function Ene(e,t){var n,i;for(n in e)if(Te(i=e[n])&&t.modified(yn(i)))return 1;return 0}function Sne(e){var t,n;fe(pF,e.force)||q("Unrecognized force: "+e.force),t=pF[e.force]();for(n in e)Te(t[n])&&$ne(t[n],e[n],e);return t}function $ne(e,t,n){e(Te(t)?i=>t(i,n):t)}const Ane=Object.freeze(Object.defineProperty({__proto__:null,force:xS},Symbol.toStringTag,{value:"Module"}));function Cne(e,t){return e.parent===t.parent?1:2}function kne(e){return e.reduce(Mne,0)/e.length}function Mne(e,t){return e+t.x}function Fne(e){return 1+e.reduce(Tne,0)}function Tne(e,t){return Math.max(e,t.y)}function Rne(e){for(var t;t=e.children;)e=t[0];return e}function One(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Dne(){var e=Cne,t=1,n=1,i=!1;function r(s){var o,a=0;s.eachAfter(function(d){var h=d.children;h?(d.x=kne(h),d.y=Fne(h)):(d.x=o?a+=e(d,o):0,d.y=0,o=d)});var u=Rne(s),l=One(s),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return s.eachAfter(i?function(d){d.x=(d.x-s.x)*t,d.y=(s.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(s.y?d.y/s.y:1))*n})}return r.separation=function(s){return arguments.length?(e=s,r):e},r.size=function(s){return arguments.length?(i=!1,t=+s[0],n=+s[1],r):i?null:[t,n]},r.nodeSize=function(s){return arguments.length?(i=!0,t=+s[0],n=+s[1],r):i?[t,n]:null},r}function Nne(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function Pne(){return this.eachAfter(Nne)}function Ine(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function Lne(e,t){for(var n=this,i=[n],r,s,o=-1;n=i.pop();)if(e.call(t,n,++o,this),r=n.children)for(s=r.length-1;s>=0;--s)i.push(r[s]);return this}function zne(e,t){for(var n=this,i=[n],r=[],s,o,a,u=-1;n=i.pop();)if(r.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)i.push(s[o]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function Bne(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function Une(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function jne(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function qne(e){for(var t=this,n=Wne(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function Wne(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function Hne(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Gne(){return Array.from(this)}function Vne(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Yne(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Xne(){var e=this,t,n=[e],i,r,s;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,s=i.length;r<s;++r)n.push(i[r]);while(n.length)}function wS(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Jne)):t===void 0&&(t=Qne);for(var n=new tc(e),i,r=[n],s,o,a,u;i=r.pop();)if((o=t(i.data))&&(u=(o=Array.from(o)).length))for(i.children=o,a=u-1;a>=0;--a)r.push(s=o[a]=new tc(o[a])),s.parent=i,s.depth=i.depth+1;return n.eachBefore(p6)}function Kne(){return wS(this).eachBefore(Zne)}function Qne(e){return e.children}function Jne(e){return Array.isArray(e)?e[1]:null}function Zne(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function p6(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function tc(e){this.data=e,this.depth=this.height=0,this.parent=null}tc.prototype=wS.prototype={constructor:tc,count:Pne,each:Ine,eachAfter:zne,eachBefore:Lne,find:Bne,sum:Une,sort:jne,path:qne,ancestors:Hne,descendants:Gne,leaves:Vne,links:Yne,copy:Kne,[Symbol.iterator]:Xne};function og(e){return e==null?null:g6(e)}function g6(e){if(typeof e!="function")throw new Error;return e}function Wa(){return 0}function ll(e){return function(){return e}}const eie=1664525,tie=1013904223,gF=4294967296;function nie(){let e=1;return()=>(e=(eie*e+tie)%gF)/gF}function iie(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function rie(e,t){let n=e.length,i,r;for(;n;)r=t()*n--|0,i=e[n],e[n]=e[r],e[r]=i;return e}function sie(e,t){for(var n=0,i=(e=rie(Array.from(e),t)).length,r=[],s,o;n<i;)s=e[n],o&&m6(o,s)?++n:(o=aie(r=oie(r,s)),n=0);return o}function oie(e,t){var n,i;if(gv(t,e))return[t];for(n=0;n<e.length;++n)if(_p(t,e[n])&&gv(Hf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(_p(Hf(e[n],e[i]),t)&&_p(Hf(e[n],t),e[i])&&_p(Hf(e[i],t),e[n])&&gv(y6(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function _p(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function m6(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function gv(e,t){for(var n=0;n<t.length;++n)if(!m6(e,t[n]))return!1;return!0}function aie(e){switch(e.length){case 1:return uie(e[0]);case 2:return Hf(e[0],e[1]);case 3:return y6(e[0],e[1],e[2])}}function uie(e){return{x:e.x,y:e.y,r:e.r}}function Hf(e,t){var n=e.x,i=e.y,r=e.r,s=t.x,o=t.y,a=t.r,u=s-n,l=o-i,c=a-r,f=Math.sqrt(u*u+l*l);return{x:(n+s+u/f*c)/2,y:(i+o+l/f*c)/2,r:(f+r+a)/2}}function y6(e,t,n){var i=e.x,r=e.y,s=e.r,o=t.x,a=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-o,h=i-l,p=r-a,g=r-c,m=u-s,y=f-s,v=i*i+r*r-s*s,b=v-o*o-a*a+u*u,x=v-l*l-c*c+f*f,w=h*p-d*g,E=(p*x-g*b)/(w*2)-i,_=(g*m-p*y)/w,$=(h*b-d*x)/(w*2)-r,A=(d*y-h*m)/w,F=_*_+A*A-1,M=2*(s+E*_+$*A),P=E*E+$*$-s*s,D=-(Math.abs(F)>1e-6?(M+Math.sqrt(M*M-4*F*P))/(2*F):P/M);return{x:i+E+_*D,y:r+$+A*D,r:D}}function mF(e,t,n){var i=e.x-t.x,r,s,o=e.y-t.y,a,u,l=i*i+o*o;l?(s=t.r+n.r,s*=s,u=e.r+n.r,u*=u,s>u?(r=(l+u-s)/(2*l),a=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-a*o,n.y=e.y-r*o+a*i):(r=(l+s-u)/(2*l),a=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x+r*i-a*o,n.y=t.y+r*o+a*i)):(n.x=t.x+n.r,n.y=t.y)}function yF(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function vF(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,s=(t.y*n.r+n.y*t.r)/i;return r*r+s*s}function Ep(e){this._=e,this.next=null,this.previous=null}function lie(e,t){if(!(s=(e=iie(e)).length))return 0;var n,i,r,s,o,a,u,l,c,f,d;if(n=e[0],n.x=0,n.y=0,!(s>1))return n.r;if(i=e[1],n.x=-i.r,i.x=n.r,i.y=0,!(s>2))return n.r+i.r;mF(i,n,r=e[2]),n=new Ep(n),i=new Ep(i),r=new Ep(r),n.next=r.previous=i,i.next=n.previous=r,r.next=i.previous=n;e:for(u=3;u<s;++u){mF(n._,i._,r=e[u]),r=new Ep(r),l=i.next,c=n.previous,f=i._.r,d=n._.r;do if(f<=d){if(yF(l._,r._)){i=l,n.next=i,i.previous=n,--u;continue e}f+=l._.r,l=l.next}else{if(yF(c._,r._)){n=c,n.next=i,i.previous=n,--u;continue e}d+=c._.r,c=c.previous}while(l!==c.next);for(r.previous=n,r.next=i,n.next=i.previous=i=r,o=vF(n);(r=r.next)!==i;)(a=vF(r))<o&&(n=r,o=a);i=n.next}for(n=[i._],r=i;(r=r.next)!==i;)n.push(r._);for(r=sie(n,t),u=0;u<s;++u)n=e[u],n.x-=r.x,n.y-=r.y;return r.r}function cie(e){return Math.sqrt(e.value)}function fie(){var e=null,t=1,n=1,i=Wa;function r(s){const o=nie();return s.x=t/2,s.y=n/2,e?s.eachBefore(bF(e)).eachAfter(mv(i,.5,o)).eachBefore(xF(1)):s.eachBefore(bF(cie)).eachAfter(mv(Wa,1,o)).eachAfter(mv(i,s.r/Math.min(t,n),o)).eachBefore(xF(Math.min(t,n)/(2*s.r))),s}return r.radius=function(s){return arguments.length?(e=og(s),r):e},r.size=function(s){return arguments.length?(t=+s[0],n=+s[1],r):[t,n]},r.padding=function(s){return arguments.length?(i=typeof s=="function"?s:ll(+s),r):i},r}function bF(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function mv(e,t,n){return function(i){if(r=i.children){var r,s,o=r.length,a=e(i)*t||0,u;if(a)for(s=0;s<o;++s)r[s].r+=a;if(u=lie(r,n),a)for(s=0;s<o;++s)r[s].r-=a;i.r=u+a}}}function xF(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function v6(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Fh(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(i-t)/e.value;++a<u;)o=s[a],o.y0=n,o.y1=r,o.x0=t,o.x1=t+=o.value*l}function die(){var e=1,t=1,n=0,i=!1;function r(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/a,o.eachBefore(s(t,a)),i&&o.eachBefore(v6),o}function s(o,a){return function(u){u.children&&Fh(u,u.x0,o*(u.depth+1)/a,u.x1,o*(u.depth+2)/a);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(e=+o[0],t=+o[1],r):[e,t]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var hie={depth:-1},wF={},yv={};function pie(e){return e.id}function gie(e){return e.parentId}function _F(){var e=pie,t=gie,n;function i(r){var s=Array.from(r),o=e,a=t,u,l,c,f,d,h,p,g,m=new Map;if(n!=null){const y=s.map((x,w)=>mie(n(x,w,r))),v=y.map(EF),b=new Set(y).add("");for(const x of v)b.has(x)||(b.add(x),y.push(x),v.push(EF(x)),s.push(yv));o=(x,w)=>y[w],a=(x,w)=>v[w]}for(c=0,u=s.length;c<u;++c)l=s[c],h=s[c]=new tc(l),(p=o(l,c,r))!=null&&(p+="")&&(g=h.id=p,m.set(g,m.has(g)?wF:h)),(p=a(l,c,r))!=null&&(p+="")&&(h.parent=p);for(c=0;c<u;++c)if(h=s[c],p=h.parent){if(d=m.get(p),!d)throw new Error("missing: "+p);if(d===wF)throw new Error("ambiguous: "+p);d.children?d.children.push(h):d.children=[h],h.parent=d}else{if(f)throw new Error("multiple roots");f=h}if(!f)throw new Error("no root");if(n!=null){for(;f.data===yv&&f.children.length===1;)f=f.children[0],--u;for(let y=s.length-1;y>=0&&(h=s[y],h.data===yv);--y)h.data=null}if(f.parent=hie,f.eachBefore(function(y){y.depth=y.parent.depth+1,--u}).eachBefore(p6),f.parent=null,u>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(e=og(r),i):e},i.parentId=function(r){return arguments.length?(t=og(r),i):t},i.path=function(r){return arguments.length?(n=og(r),i):n},i}function mie(e){e=`${e}`;let t=e.length;return Qx(e,t-1)&&!Qx(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function EF(e){let t=e.length;if(t<2)return"";for(;--t>1&&!Qx(e,t););return e.slice(0,t)}function Qx(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function yie(e,t){return e.parent===t.parent?1:2}function vv(e){var t=e.children;return t?t[0]:e.t}function bv(e){var t=e.children;return t?t[t.length-1]:e.t}function vie(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function bie(e){for(var t=0,n=0,i=e.children,r=i.length,s;--r>=0;)s=i[r],s.z+=t,s.m+=t,t+=s.s+(n+=s.c)}function xie(e,t,n){return e.a.parent===t.parent?e.a:n}function ag(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}ag.prototype=Object.create(tc.prototype);function wie(e){for(var t=new ag(e,0),n,i=[t],r,s,o,a;n=i.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)i.push(r=n.children[o]=new ag(s[o],o)),r.parent=n;return(t.parent=new ag(null,0)).children=[t],t}function _ie(){var e=yie,t=1,n=1,i=null;function r(l){var c=wie(l);if(c.eachAfter(s),c.parent.m=-c.z,c.eachBefore(o),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+g)*m,v.y=v.depth*y})}return l}function s(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){bie(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,y=h.m,v=p.m,b=g.m,x;p=bv(p),d=vv(d),p&&d;)g=vv(g),h=bv(h),h.a=l,x=p.z+v-d.z-m+e(p._,d._),x>0&&(vie(xie(p,l,f),l,x),m+=x,y+=x),v+=p.m,m+=d.m,b+=g.m,y+=h.m;p&&!bv(h)&&(h.t=p,h.m+=v-y),d&&!vv(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function d1(e,t,n,i,r){for(var s=e.children,o,a=-1,u=s.length,l=e.value&&(r-n)/e.value;++a<u;)o=s[a],o.x0=t,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var b6=(1+Math.sqrt(5))/2;function x6(e,t,n,i,r,s){for(var o=[],a=t.children,u,l,c=0,f=0,d=a.length,h,p,g=t.value,m,y,v,b,x,w,E;c<d;){h=r-n,p=s-i;do m=a[f++].value;while(!m&&f<d);for(y=v=m,w=Math.max(p/h,h/p)/(g*e),E=m*m*w,x=Math.max(v/E,E/y);f<d;++f){if(m+=l=a[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*w,b=Math.max(v/E,E/y),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:a.slice(c,f)}),u.dice?Fh(u,n,i,r,g?i+=p*m/g:s):d1(u,n,i,g?n+=h*m/g:r,s),g-=m,c=f}return o}const w6=(function e(t){function n(i,r,s,o,a){x6(t,i,r,s,o,a)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n})(b6);function Eie(){var e=w6,t=!1,n=1,i=1,r=[0],s=Wa,o=Wa,a=Wa,u=Wa,l=Wa;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(v6),d}function f(d){var h=r[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,y=d.y1-h;m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=s(d)/2,p+=l(d)-h,g+=o(d)-h,m-=a(d)-h,y-=u(d)-h,m<p&&(p=m=(p+m)/2),y<g&&(g=y=(g+y)/2),e(d,p,g,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=g6(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(s=typeof d=="function"?d:ll(+d),c):s},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:ll(+d),c):o},c.paddingRight=function(d){return arguments.length?(a=typeof d=="function"?d:ll(+d),c):a},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:ll(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:ll(+d),c):l},c}function Sie(e,t,n,i,r){var s=e.children,o,a=s.length,u,l=new Array(a+1);for(l[0]=u=o=0;o<a;++o)l[o+1]=u+=s[o].value;c(0,a,e.value,t,n,i,r);function c(f,d,h,p,g,m,y){if(f>=d-1){var v=s[f];v.x0=p,v.y0=g,v.x1=m,v.y1=y;return}for(var b=l[f],x=h/2+b,w=f+1,E=d-1;w<E;){var _=w+E>>>1;l[_]<x?w=_+1:E=_}x-l[w-1]<l[w]-x&&f+1<w&&--w;var $=l[w]-b,A=h-$;if(m-p>y-g){var F=h?(p*A+m*$)/h:m;c(f,w,$,p,g,F,y),c(w,d,A,F,g,m,y)}else{var M=h?(g*A+y*$)/h:y;c(f,w,$,p,g,m,M),c(w,d,A,p,M,m,y)}}}function $ie(e,t,n,i,r){(e.depth&1?d1:Fh)(e,t,n,i,r)}const Aie=(function e(t){function n(i,r,s,o,a){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=i.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Fh(l,r,s,o,g?s+=(a-s)*l.value/g:a):d1(l,r,s,g?r+=(o-r)*l.value/g:o,a),g-=l.value}else i._squarify=u=x6(t,i,r,s,o,a),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n})(b6);function Jx(e,t,n){const i={};return e.each(r=>{const s=r.data;n(s)&&(i[t(s)]=r)}),e.lookup=i,e}function _S(e){z.call(this,null,e)}_S.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Cie=e=>e.values;te(_S,z,{transform(e,t){t.source||q("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),s=this.value;return(!s||i||t.changed())&&(s&&s.each(o=>{o.children&&A0(o.data)&&r.rem.push(o.data)}),this.value=s=wS({values:le(e.keys).reduce((o,a)=>(o.key(a),o),kie()).entries(r.source)},Cie),n&&s.each(o=>{o.children&&(o=Ve(o.data),r.add.push(o),r.source.push(o))}),Jx(s,be,be)),r.source.root=s,r}});function kie(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,s){if(s>=e.length)return r;const o=r.length,a=e[s++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=a(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],s);return l}function i(r,s){if(++s>e.length)return r;const o=[];for(const a in r)o.push({key:a,values:i(r[a],s)});return o}return t}function ao(e){z.call(this,null,e)}const Mie=(e,t)=>e.parent===t.parent?1:2;te(ao,z,{transform(e,t){(!t.source||!t.source.root)&&q(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,s=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Ru(e.sort,o=>o.data)),Fie(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Mie:wc);try{this.value=n(r)}catch(o){q(o)}return r.each(o=>Tie(o,i,s)),t.reflow(e.modified()).modifies(s).modifies("leaf")}});function Fie(e,t,n){for(let i,r=0,s=t.length;r<s;++r)i=t[r],i in n&&e[i](n[i])}function Tie(e,t,n){const i=e.data,r=t.length-1;for(let s=0;s<r;++s)i[n[s]]=e[t[s]];i[n[r]]=e.children?e.children.length:0}const Zx=["x","y","r","depth","children"];function ES(e){ao.call(this,e)}ES.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Zx.length,default:Zx}]};te(ES,ao,{layout:fie,params:["radius","size","padding"],fields:Zx});const ew=["x0","y0","x1","y1","depth","children"];function SS(e){ao.call(this,e)}SS.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:ew.length,default:ew}]};te(SS,ao,{layout:die,params:["size","round","padding"],fields:ew});function $S(e){z.call(this,null,e)}$S.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};te($S,z,{transform(e,t){t.source||q("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),s=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),s&&(n=r.source.length?Jx(_F().id(e.key).parentId(e.parentKey)(r.source),e.key,Li):Jx(_F()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const SF={tidy:_ie,cluster:Dne},tw=["x","y","depth","children"];function AS(e){ao.call(this,e)}AS.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:tw.length,default:tw}]};te(AS,ao,{layout(e){const t=e||"tidy";if(fe(SF,t))return SF[t]();q("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:tw});function CS(e){z.call(this,[],e)}CS.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};te(CS,z,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),s={};return i||q("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,o=>s[be(o)]=1),i.each(o=>{const a=o.data,u=o.parent&&o.parent.data;u&&s[be(a)]&&s[be(u)]&&r.add.push(Ve({source:u,target:a}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>s[be(o)]=1),n.forEach(o=>{(s[be(o.source)]||s[be(o.target)])&&r.mod.push(o)})),r}});const $F={binary:Sie,dice:Fh,slice:d1,slicedice:$ie,squarify:w6,resquarify:Aie},nw=["x0","y0","x1","y1","depth","children"];function kS(e){ao.call(this,e)}kS.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:nw.length,default:nw}]};te(kS,ao,{layout(){const e=Eie();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{fe($F,t)?e.tile($F[t]):q("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:nw});const Rie=Object.freeze(Object.defineProperty({__proto__:null,nest:_S,pack:ES,partition:SS,stratify:$S,tree:AS,treelinks:CS,treemap:kS},Symbol.toStringTag,{value:"Module"})),xv=4278190080;function Oie(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function Die(e,t,n,i,r){const s=e.width,o=e.height,a=i||r,u=Wo(s,o).getContext("2d"),l=Wo(s,o).getContext("2d"),c=a&&Wo(s,o).getContext("2d");n.forEach($=>ug(u,$,!1)),ug(l,t,!1),a&&ug(c,t,!0);const f=wv(u,s,o),d=wv(l,s,o),h=a&&wv(c,s,o),p=e.bitmap(),g=a&&e.bitmap();let m,y,v,b,x,w,E,_;for(y=0;y<o;++y)for(m=0;m<s;++m)x=y*s+m,w=f[x]&xv,_=d[x]&xv,E=a&&h[x]&xv,(w||E||_)&&(v=e(m),b=e(y),!r&&(w||_)&&p.set(v,b),a&&(w||E)&&g.set(v,b));return[p,g]}function wv(e,t,n){return new Uint32Array(e.getImageData(0,0,t,n).data.buffer)}function ug(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(s=>ug(e,s.items,n))}):Si[i].draw(e,{items:n?t.map(Nie):t})}function Nie(e){const t=C0(e,{});return t.stroke&&t.strokeOpacity!==0||t.fill&&t.fillOpacity!==0?{...t,strokeOpacity:1,stroke:"#000",fillOpacity:0}:t}const As=5,Sn=31,qd=32,Co=new Uint32Array(qd+1),Zi=new Uint32Array(qd+1);Zi[0]=0;Co[0]=~Zi[0];for(let e=1;e<=qd;++e)Zi[e]=Zi[e-1]<<1|1,Co[e]=~Zi[e];function Pie(e,t){const n=new Uint32Array(~~((e*t+qd)/qd));function i(s,o){n[s]|=o}function r(s,o){n[s]&=o}return{array:n,get:(s,o)=>{const a=o*e+s;return n[a>>>As]&1<<(a&Sn)},set:(s,o)=>{const a=o*e+s;i(a>>>As,1<<(a&Sn))},clear:(s,o)=>{const a=o*e+s;r(a>>>As,~(1<<(a&Sn)))},getRange:(s,o,a,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+s,f=l*e+a,d=c>>>As,h=f>>>As,d===h){if(n[d]&Co[c&Sn]&Zi[(f&Sn)+1])return!0}else{if(n[d]&Co[c&Sn]||n[h]&Zi[(f&Sn)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>As,d=c>>>As,f===d)i(f,Co[l&Sn]&Zi[(c&Sn)+1]);else for(i(f,Co[l&Sn]),i(d,Zi[(c&Sn)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(s,o,a,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+s,c=o*e+a,f=l>>>As,d=c>>>As,f===d)r(f,Zi[l&Sn]|Co[(c&Sn)+1]);else for(r(f,Zi[l&Sn]),r(d,Co[(c&Sn)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(s,o,a,u)=>s<0||o<0||u>=t||a>=e}}function Iie(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),s=~~((t+2*n+i)/i),o=a=>~~((a+n)/i);return o.invert=a=>a*i-n,o.bitmap=()=>Pie(r,s),o.ratio=i,o.padding=n,o.width=e,o.height=t,o}function Lie(e,t,n,i){const r=e.width,s=e.height;return function(o){const a=o.datum.datum.items[i].items,u=a.length,l=o.datum.fontSize,c=vi.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,y,v;for(let b=0;b<u;++b)d=a[b].x,p=a[b].y,h=a[b].x2===void 0?d:a[b].x2,g=a[b].y2===void 0?p:a[b].y2,m=(d+h)/2,y=(p+g)/2,v=Math.abs(h-d+g-p),v>=f&&(f=v,o.x=m,o.y=y);return m=c/2,y=l/2,d=o.x-m,h=o.x+m,p=o.y-y,g=o.y+y,o.align="center",d<0&&h<=r?o.align="left":0<=d&&r<h&&(o.align="right"),o.baseline="middle",p<0&&g<=s?o.baseline="top":0<=p&&s<g&&(o.baseline="bottom"),!0}}function Om(e,t,n,i,r,s){let o=n/2;return e-o<0||e+o>r||t-(o=i/2)<0||t+o>s}function Lo(e,t,n,i,r,s,o,a){const u=r*s/(i*2),l=e(t-u),c=e(t+u),f=e(n-(s=s/2)),d=e(n+s);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||a&&a.getRange(l,f,c,d)}function zie(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,y=s,v;if(!Om(p,g,d,h,r,s)&&!Lo(e,p,g,h,d,m,o,a)&&!Lo(e,p,g,h,d,h,o,null)){for(;y-m>=1;)v=(m+y)/2,Lo(e,p,g,h,d,v,o,a)?y=v:m=v;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=vi.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,y=0,v,b,x,w,E,_,$,A,F,M,P,D,O,C,R,N,I;for(let U=0;U<f;++U){for(v=c[U].x,x=c[U].y,b=c[U].x2===void 0?v:c[U].x2,w=c[U].y2===void 0?x:c[U].y2,v>b&&(I=v,v=b,b=I),x>w&&(I=x,x=w,w=I),F=e(v),P=e(b),M=~~((F+P)/2),D=e(x),C=e(w),O=~~((D+C)/2),$=M;$>=F;--$)for(A=O;A>=D;--A)N=u($,A,p,h,d),N&&([l.x,l.y,p,g]=N);for($=M;$<=P;++$)for(A=O;A<=C;++A)N=u($,A,p,h,d),N&&([l.x,l.y,p,g]=N);!g&&!n&&(R=Math.abs(b-v+w-x),E=(v+b)/2,_=(x+w)/2,R>=y&&!Om(E,_,h,d,r,s)&&!Lo(e,E,_,d,h,d,o,null)&&(y=R,l.x=E,l.y=_,m=!0))}return g||m?(E=h/2,_=d/2,o.setRange(e(l.x-E),e(l.y-_),e(l.x+E),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const Bie=[-1,-1,1,1],Uie=[-1,1,-1,1];function jie(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[i].items,f=c.length,d=l.datum.fontSize,h=vi.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,y=!1,v=0,b,x,w,E,_,$,A,F,M,P,D,O;for(let C=0;C<f;++C){for(b=c[C].x,w=c[C].y,x=c[C].x2===void 0?b:c[C].x2,E=c[C].y2===void 0?w:c[C].y2,p.push([e((b+x)/2),e((w+E)/2)]);p.length;)if([A,F]=p.pop(),!(o.get(A,F)||a.get(A,F)||u.get(A,F))){u.set(A,F);for(let R=0;R<4;++R)_=A+Bie[R],$=F+Uie[R],u.outOfBounds(_,$,_,$)||p.push([_,$]);if(_=e.invert(A),$=e.invert(F),M=g,P=s,!Om(_,$,h,d,r,s)&&!Lo(e,_,$,d,h,M,o,a)&&!Lo(e,_,$,d,h,d,o,null)){for(;P-M>=1;)D=(M+P)/2,Lo(e,_,$,d,h,D,o,a)?P=D:M=D;M>g&&(l.x=_,l.y=$,g=M,m=!0)}}!m&&!n&&(O=Math.abs(x-b+E-w),_=(b+x)/2,$=(w+E)/2,O>=v&&!Om(_,$,h,d,r,s)&&!Lo(e,_,$,d,h,d,o,null)&&(v=O,l.x=_,l.y=$,y=!0))}return m||y?(_=h/2,$=d/2,o.setRange(e(l.x-_),e(l.y-$),e(l.x+_),e(l.y+$)),l.align="center",l.baseline="middle",!0):!1}}const qie=["right","center","left"],Wie=["bottom","middle","top"];function Hie(e,t,n,i){const r=e.width,s=e.height,o=t[0],a=t[1],u=i.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>r||c[3]>s)return!1;let d=l.textWidth??0,h,p,g,m,y,v,b,x,w,E,_,$,A,F,M;for(let P=0;P<u;++P){if(h=(n[P]&3)-1,p=(n[P]>>>2&3)-1,g=h===0&&p===0||i[P]<0,m=h&&p?Math.SQRT1_2:1,y=i[P]<0?-1:1,v=c[1+h]+i[P]*h*m,_=c[4+p]+y*f*p/2+i[P]*p*m,x=_-f/2,w=_+f/2,$=e(v),F=e(x),M=e(w),!d)if(AF($,$,F,M,o,a,v,v,x,w,c,g))d=vi.width(l.datum,l.datum.text);else continue;if(E=v+y*d*h/2,v=E-d/2,b=E+d/2,$=e(v),A=e(b),AF($,A,F,M,o,a,v,b,x,w,c,g))return l.x=h?h*y<0?b:v:E,l.y=p?p*y<0?w:x:_,l.align=qie[h*y+1],l.baseline=Wie[p*y+1],o.setRange($,F,A,M),!0}return!1}}function AF(e,t,n,i,r,s,o,a,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&s||r).getRange(e,n,t,i))}const _v=0,Ev=4,Sv=8,$v=0,Av=1,Cv=2,Gie={"top-left":_v+$v,top:_v+Av,"top-right":_v+Cv,left:Ev+$v,middle:Ev+Av,right:Ev+Cv,"bottom-left":Sv+$v,bottom:Sv+Av,"bottom-right":Sv+Cv},Vie={naive:Lie,"reduced-search":zie,floodfill:jie};function Yie(e,t,n,i,r,s,o,a,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=Xie(i,f),h=Kie(r,f),p=Qie(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",y=Jie(p,g,a,u),v=l===null||l===1/0,b=m&&c==="naive";let x=-1,w=-1;const E=e.map(F=>{const M=v?vi.width(F,F.text):void 0;return x=Math.max(x,M),w=Math.max(w,F.fontSize),{datum:F,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(F),textWidth:M}});l=l===null||l===1/0?Math.max(x,w)+Math.max(...i):l;const _=Iie(t[0],t[1],l);let $;if(!b){n&&E.sort((P,D)=>n(P.datum,D.datum));let F=!1;for(let P=0;P<h.length&&!F;++P)F=h[P]===5||d[P]<0;const M=(p&&o||m)&&e.map(P=>P.datum);$=s.length||M?Die(_,M||[],s,F,m):Oie(_,o&&E)}const A=m?Vie[c](_,$,o,u):Hie(_,$,h,d);return E.forEach(F=>F.opacity=+A(F)),E}function Xie(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Kie(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=Gie[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Qie(e){return e&&e.mark&&e.mark.marktype}function Jie(e,t,n,i){const r=s=>[s.x,s.x,s.x,s.y,s.y,s.y];return e?e==="line"||e==="area"?s=>r(s.datum):t==="line"?s=>{const o=s.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:s=>{const o=s.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const iw=["x","y","opacity","align","baseline"],_6=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function MS(e){z.call(this,null,e)}MS.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:_6},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:iw.length,default:iw}]};te(MS,z,{transform(e,t){function n(s){const o=e[s];return Te(o)&&t.modified(o.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&q("Size parameter should be specified as a [width, height] array.");const r=e.as||iw;return Yie(t.materialize(t.SOURCE).source||[],e.size,e.sort,le(e.offset==null?1:e.offset),le(e.anchor||_6),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(s=>{const o=s.datum;o[r[0]]=s.x,o[r[1]]=s.y,o[r[2]]=s.opacity,o[r[3]]=s.align,o[r[4]]=s.baseline}),t.reflow(i).modifies(r)}});const Zie=Object.freeze(Object.defineProperty({__proto__:null,label:MS},Symbol.toStringTag,{value:"Module"}));function E6(e,t){var n=[],i=function(c){return c(a)},r,s,o,a,u,l;if(t==null)n.push(e);else for(r={},s=0,o=e.length;s<o;++s)a=e[s],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(a);return n}function FS(e){z.call(this,null,e)}FS.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};te(FS,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=E6(i,e.groupby),s=(e.groupby||[]).map(St),o=s.length,a=e.as||[St(e.x),St(e.y)],u=[];r.forEach(l=>{T3(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[s[d]]=l.dims[d];f[a[0]]=c[0],f[a[1]]=c[1],u.push(Ve(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const rw={constant:f_,linear:d_,log:C3,exp:k3,pow:M3,quad:h_,poly:F3},ere=(e,t)=>e==="poly"?t:e==="quad"?2:1;function TS(e){z.call(this,null,e)}TS.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(rw)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};te(TS,z,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=E6(i,e.groupby),s=(e.groupby||[]).map(St),o=e.method||"linear",a=e.order==null?3:e.order,u=ere(o,a),l=e.as||[St(e.x),St(e.y)],c=rw[o],f=[];let d=e.extent;fe(rw,o)||q("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,a);if(e.params){f.push(Ve({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||es(h,e.x),y=v=>{const b={};for(let x=0;x<s.length;++x)b[s[x]]=h.dims[x];b[l[0]]=v[0],b[l[1]]=v[1],f.push(Ve(b))};o==="linear"||o==="constant"?m.forEach(v=>y([v,g.predict(v)])):D0(g.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});const tre=Object.freeze(Object.defineProperty({__proto__:null,loess:FS,regression:TS},Symbol.toStringTag,{value:"Module"})),Hs=11102230246251565e-32,an=134217729,nre=(3+8*Hs)*Hs;function kv(e,t,n,i,r){let s,o,a,u,l=t[0],c=i[0],f=0,d=0;c>l==c>-l?(s=l,l=t[++f]):(s=c,c=i[++d]);let h=0;if(f<e&&d<n)for(c>l==c>-l?(o=l+s,a=s-(o-l),l=t[++f]):(o=c+s,a=s-(o-c),c=i[++d]),s=o,a!==0&&(r[h++]=a);f<e&&d<n;)c>l==c>-l?(o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f]):(o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d]),s=o,a!==0&&(r[h++]=a);for(;f<e;)o=s+l,u=o-s,a=s-(o-u)+(l-u),l=t[++f],s=o,a!==0&&(r[h++]=a);for(;d<n;)o=s+c,u=o-s,a=s-(o-u)+(c-u),c=i[++d],s=o,a!==0&&(r[h++]=a);return(s!==0||h===0)&&(r[h++]=s),h}function ire(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function Th(e){return new Float64Array(e)}const rre=(3+16*Hs)*Hs,sre=(2+12*Hs)*Hs,ore=(9+64*Hs)*Hs*Hs,tl=Th(4),CF=Th(8),kF=Th(12),MF=Th(16),$n=Th(4);function are(e,t,n,i,r,s,o){let a,u,l,c,f,d,h,p,g,m,y,v,b,x,w,E,_,$;const A=e-r,F=n-r,M=t-s,P=i-s;x=A*P,d=an*A,h=d-(d-A),p=A-h,d=an*P,g=d-(d-P),m=P-g,w=p*m-(x-h*g-p*g-h*m),E=M*F,d=an*M,h=d-(d-M),p=M-h,d=an*F,g=d-(d-F),m=F-g,_=p*m-(E-h*g-p*g-h*m),y=w-_,f=w-y,tl[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,tl[1]=b-(y+f)+(f-E),$=v+y,f=$-v,tl[2]=v-($-f)+(y-f),tl[3]=$;let D=ire(4,tl),O=sre*o;if(D>=O||-D>=O||(f=e-A,a=e-(A+f)+(f-r),f=n-F,l=n-(F+f)+(f-r),f=t-M,u=t-(M+f)+(f-s),f=i-P,c=i-(P+f)+(f-s),a===0&&u===0&&l===0&&c===0)||(O=ore*o+nre*Math.abs(D),D+=A*c+P*a-(M*l+F*u),D>=O||-D>=O))return D;x=a*P,d=an*a,h=d-(d-a),p=a-h,d=an*P,g=d-(d-P),m=P-g,w=p*m-(x-h*g-p*g-h*m),E=u*F,d=an*u,h=d-(d-u),p=u-h,d=an*F,g=d-(d-F),m=F-g,_=p*m-(E-h*g-p*g-h*m),y=w-_,f=w-y,$n[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,$n[1]=b-(y+f)+(f-E),$=v+y,f=$-v,$n[2]=v-($-f)+(y-f),$n[3]=$;const C=kv(4,tl,4,$n,CF);x=A*c,d=an*A,h=d-(d-A),p=A-h,d=an*c,g=d-(d-c),m=c-g,w=p*m-(x-h*g-p*g-h*m),E=M*l,d=an*M,h=d-(d-M),p=M-h,d=an*l,g=d-(d-l),m=l-g,_=p*m-(E-h*g-p*g-h*m),y=w-_,f=w-y,$n[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,$n[1]=b-(y+f)+(f-E),$=v+y,f=$-v,$n[2]=v-($-f)+(y-f),$n[3]=$;const R=kv(C,CF,4,$n,kF);x=a*c,d=an*a,h=d-(d-a),p=a-h,d=an*c,g=d-(d-c),m=c-g,w=p*m-(x-h*g-p*g-h*m),E=u*l,d=an*u,h=d-(d-u),p=u-h,d=an*l,g=d-(d-l),m=l-g,_=p*m-(E-h*g-p*g-h*m),y=w-_,f=w-y,$n[0]=w-(y+f)+(f-_),v=x+y,f=v-x,b=x-(v-f)+(y-f),y=b-E,f=b-y,$n[1]=b-(y+f)+(f-E),$=v+y,f=$-v,$n[2]=v-($-f)+(y-f),$n[3]=$;const N=kv(R,kF,4,$n,MF);return MF[N-1]}function Sp(e,t,n,i,r,s){const o=(t-s)*(n-r),a=(e-r)*(i-s),u=o-a,l=Math.abs(o+a);return Math.abs(u)>=rre*l?u:-are(e,t,n,i,r,s,l)}const FF=Math.pow(2,-52),$p=new Uint32Array(512);class Dm{static from(t,n=dre,i=hre){const r=t.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=t[o];s[2*o]=n(a),s[2*o+1]=i(a)}return new Dm(s)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=t.length>>1;let a=1/0,u=1/0,l=-1/0,c=-1/0;for(let A=0;A<o;A++){const F=t[2*A],M=t[2*A+1];F<a&&(a=F),M<u&&(u=M),F>l&&(l=F),M>c&&(c=M),this._ids[A]=A}const f=(a+l)/2,d=(u+c)/2;let h,p,g;for(let A=0,F=1/0;A<o;A++){const M=Mv(f,d,t[2*A],t[2*A+1]);M<F&&(h=A,F=M)}const m=t[2*h],y=t[2*h+1];for(let A=0,F=1/0;A<o;A++){if(A===h)continue;const M=Mv(m,y,t[2*A],t[2*A+1]);M<F&&M>0&&(p=A,F=M)}let v=t[2*p],b=t[2*p+1],x=1/0;for(let A=0;A<o;A++){if(A===h||A===p)continue;const F=cre(m,y,v,b,t[2*A],t[2*A+1]);F<x&&(g=A,x=F)}let w=t[2*g],E=t[2*g+1];if(x===1/0){for(let M=0;M<o;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];ml(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let F=0;for(let M=0,P=-1/0;M<o;M++){const D=this._ids[M],O=this._dists[D];O>P&&(A[F++]=D,P=O)}this.hull=A.subarray(0,F),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Sp(m,y,v,b,w,E)<0){const A=p,F=v,M=b;p=g,v=w,b=E,g=A,w=F,E=M}const _=fre(m,y,v,b,w,E);this._cx=_.x,this._cy=_.y;for(let A=0;A<o;A++)this._dists[A]=Mv(t[2*A],t[2*A+1],_.x,_.y);ml(this._ids,this._dists,0,o-1),this._hullStart=h;let $=3;i[h]=n[g]=p,i[p]=n[h]=g,i[g]=n[p]=h,r[h]=0,r[p]=1,r[g]=2,s.fill(-1),s[this._hashKey(m,y)]=h,s[this._hashKey(v,b)]=p,s[this._hashKey(w,E)]=g,this.trianglesLen=0,this._addTriangle(h,p,g,-1,-1,-1);for(let A=0,F,M;A<this._ids.length;A++){const P=this._ids[A],D=t[2*P],O=t[2*P+1];if(A>0&&Math.abs(D-F)<=FF&&Math.abs(O-M)<=FF||(F=D,M=O,P===h||P===p||P===g))continue;let C=0;for(let re=0,me=this._hashKey(D,O);re<this._hashSize&&(C=s[(me+re)%this._hashSize],!(C!==-1&&C!==i[C]));re++);C=n[C];let R=C,N;for(;N=i[R],Sp(D,O,t[2*R],t[2*R+1],t[2*N],t[2*N+1])>=0;)if(R=N,R===C){R=-1;break}if(R===-1)continue;let I=this._addTriangle(R,P,i[R],-1,-1,r[R]);r[P]=this._legalize(I+2),r[R]=I,$++;let U=i[R];for(;N=i[U],Sp(D,O,t[2*U],t[2*U+1],t[2*N],t[2*N+1])<0;)I=this._addTriangle(U,P,N,r[P],-1,r[U]),r[P]=this._legalize(I+2),i[U]=U,$--,U=N;if(R===C)for(;N=n[R],Sp(D,O,t[2*N],t[2*N+1],t[2*R],t[2*R+1])<0;)I=this._addTriangle(N,P,R,-1,r[R],r[N]),this._legalize(I+2),r[N]=I,i[R]=R,$--,R=N;this._hullStart=n[P]=R,i[R]=n[U]=P,i[P]=U,s[this._hashKey(D,O)]=P,s[this._hashKey(t[2*R],t[2*R+1])]=R}this.hull=new Uint32Array($);for(let A=0,F=this._hullStart;A<$;A++)this.hull[A]=F,F=i[F];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(ure(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[t],u=t-t%3;if(o=u+(t+2)%3,a===-1){if(s===0)break;t=$p[--s];continue}const l=a-a%3,c=u+(t+1)%3,f=l+(a+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(lre(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*g],r[2*g+1])){n[t]=g,n[a]=d;const y=i[f];if(y===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,y),this._link(a,i[o]),this._link(o,f);const v=l+(a+1)%3;s<$p.length&&($p[s++]=v)}else{if(s===0)break;t=$p[--s]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function ure(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Mv(e,t,n,i){const r=e-n,s=t-i;return r*r+s*s}function lre(e,t,n,i,r,s,o,a){const u=e-o,l=t-a,c=n-o,f=i-a,d=r-o,h=s-a,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function cre(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=(l*c-a*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function fre(e,t,n,i,r,s){const o=n-e,a=i-t,u=r-e,l=s-t,c=o*o+a*a,f=u*u+l*l,d=.5/(o*l-a*u),h=e+(l*c-a*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function ml(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const s=e[r],o=t[s];let a=r-1;for(;a>=n&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=s}else{const r=n+i>>1;let s=n+1,o=i;df(e,r,s),t[e[n]]>t[e[i]]&&df(e,n,i),t[e[s]]>t[e[i]]&&df(e,s,i),t[e[n]]>t[e[s]]&&df(e,n,s);const a=e[s],u=t[a];for(;;){do s++;while(t[e[s]]<u);do o--;while(t[e[o]]>u);if(o<s)break;df(e,s,o)}e[n+1]=e[o],e[o]=a,i-s+1>=o-n?(ml(e,t,s,i),ml(e,t,n,o-1)):(ml(e,t,n,o-1),ml(e,t,s,i))}}function df(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function dre(e){return e[0]}function hre(e){return e[1]}const TF=1e-6;class Ya{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,s=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>TF||Math.abs(this._y1-s)>TF)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class sw{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}let pre=class{constructor(t,[n,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,m=0,y=i.length,v,b;g<y;g+=3,m+=2){const x=i[g]*2,w=i[g+1]*2,E=i[g+2]*2,_=t[x],$=t[x+1],A=t[w],F=t[w+1],M=t[E],P=t[E+1],D=A-_,O=F-$,C=M-_,R=P-$,N=(D*R-O*C)*2;if(Math.abs(N)<1e-9){if(s===void 0){s=o=0;for(const U of n)s+=t[U*2],o+=t[U*2+1];s/=n.length,o/=n.length}const I=1e9*Math.sign((s-_)*R-(o-$)*C);v=(_+M)/2-I*R,b=($+P)/2+I*C}else{const I=1/N,U=D*D+O*O,re=C*C+R*R;v=_+(R*U-O*re)*I,b=$+(D*re-C*U)*I}a[m]=v,a[m+1]=b}let u=n[n.length-1],l,c=u*4,f,d=t[2*u],h,p=t[2*u+1];r.fill(0);for(let g=0;g<n.length;++g)u=n[g],l=c,f=d,h=p,c=u*4,d=t[2*u],p=t[2*u+1],r[l+2]=r[c]=h-p,r[l+3]=r[c+1]=d-f}render(t){const n=t==null?t=new Ya:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],y=o[p],v=o[p+1];this._renderSegment(g,m,y,v,t)}let u,l=s[s.length-1];for(let c=0;c<s.length;++c){u=l,l=s[c];const f=Math.floor(r[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,a[p+2],a[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new Ya:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new Ya:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new sw;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,s){let o;const a=this._regioncode(t,n),u=this._regioncode(i,r);a===0&&u===0?(s.moveTo(t,n),s.lineTo(i,r)):(o=this._clipSegment(t,n,i,r,a,u))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,u=r.length;a<u;a+=2)if(n[s]===r[a]&&n[s+1]===r[a+1]&&n[(s+2)%o]===r[(a+u-2)%u]&&n[(s+3)%o]===r[(a+u-1)%u]){yield i;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[t];if(o===-1)return null;const a=[];let u=o;do{const l=Math.floor(u/3);if(a.push(n[l*2],n[l*2+1]),u=u%3===2?u-2:u+1,s[u]!==t)break;u=r[u]}while(u!==o&&u!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n))}_clipFinite(t,n){const i=n.length;let r=null,s,o,a=n[i-2],u=n[i-1],l,c=this._regioncode(a,u),f,d=0;for(let h=0;h<i;h+=2)if(s=a,o=u,a=n[h],u=n[h+1],l=c,c=this._regioncode(a,u),l===0&&c===0)f=d,d=0,r?r.push(a,u):r=[a,u];else{let p,g,m,y,v;if(l===0){if((p=this._clipSegment(s,o,a,u,l,c))===null)continue;[g,m,y,v]=p}else{if((p=this._clipSegment(a,u,s,o,c,l))===null)continue;[y,v,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(g,m):r=[g,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,s,o){const a=s<o;for(a&&([t,n,i,r,s,o]=[i,r,t,n,o,s]);;){if(s===0&&o===0)return a?[i,r,t,n]:[t,n,i,r];if(s&o)return null;let u,l,c=s||o;c&8?(u=t+(i-t)*(this.ymax-n)/(r-n),l=this.ymax):c&4?(u=t+(i-t)*(this.ymin-n)/(r-n),l=this.ymin):c&2?(l=n+(r-n)*(this.xmax-t)/(i-t),u=this.xmax):(l=n+(r-n)*(this.xmin-t)/(i-t),u=this.xmin),s?(t=u,n=l,s=this._regioncode(t,n)):(i=u,r=l,o=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,s,o){let a=Array.from(n),u;if((u=this._project(a[0],a[1],i,r))&&a.unshift(u[0],u[1]),(u=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(u[0],u[1]),a=this._clipFinite(t,a))for(let l=0,c=a.length,f,d=this._edgecode(a[c-2],a[c-1]);l<c;l+=2)f=d,d=this._edgecode(a[l],a[l+1]),f&&d&&(l=this._edge(t,f,d,a,l),c=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,i,r,s){for(;n!==i;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(t,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(t,n,i,r){let s=1/0,o,a,u;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<s&&(u=this.ymin,a=t+(s=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<s&&(u=this.ymax,a=t+(s=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<s&&(a=this.xmax,u=n+(s=o)*r)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<s&&(a=this.xmin,u=n+(s=o)*r)}return[a,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let n=0;n<t.length;n+=2){const i=(n+2)%t.length,r=(n+4)%t.length;(t[n]===t[i]&&t[i]===t[r]||t[n+1]===t[i+1]&&t[i+1]===t[r+1])&&(t.splice(i,2),n-=2)}t.length||(t=null)}return t}};const gre=2*Math.PI,nl=Math.pow;function mre(e){return e[0]}function yre(e){return e[1]}function vre(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],s=2*t[i+1],o=2*t[i+2];if((n[o]-n[r])*(n[s+1]-n[r+1])-(n[s]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function bre(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class RS{static from(t,n=mre,i=yre,r){return new RS("length"in t?xre(t,n,i,r):Float64Array.from(wre(t,n,i,r)))}constructor(t){this._delaunator=new Dm(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&vre(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=bre(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new Dm(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=s[u%3===2?u-2:u+1];(i[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=r.length;u<l;++u)a[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new pre(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3===2?l-2:l+1,o[l]!==t)return;if(l=s[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let s;for(;(s=this._step(i,t,n))>=0&&s!==i&&s!==r;)i=s;return s}_step(t,n,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=nl(n-l[t*2],2)+nl(i-l[t*2+1],2);const d=r[t];let h=d;do{let p=u[h];const g=nl(n-l[p*2],2)+nl(i-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3===2?h-2:h+1,u[h]!==t)break;if(h=a[h],h===-1){if(h=s[(o[t]+1)%s.length],h!==p&&nl(n-l[h*2],2)+nl(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new Ya:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const u=r[o];if(u<o)continue;const l=s[o]*2,c=s[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n){n===void 0&&(!t||typeof t.moveTo!="function")&&(n=t,t=null),n=n==null?2:+n;const i=t==null?t=new Ya:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],u=r[s+1];t.moveTo(a+n,u),t.arc(a,u,n,0,gre)}return i&&i.value()}renderHull(t){const n=t==null?t=new Ya:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;t.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const u=2*i[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new sw;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new Ya:void 0,{points:r,triangles:s}=this,o=s[t*=3]*2,a=s[t+1]*2,u=s[t+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new sw;return this.renderTriangle(t,n),n.value()}}function xre(e,t,n,i){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=e[o];s[o*2]=t.call(i,a,o,e),s[o*2+1]=n.call(i,a,o,e)}return s}function*wre(e,t,n,i){let r=0;for(const s of e)yield t.call(i,s,r,e),yield n.call(i,s,r,e),++r}function OS(e){z.call(this,null,e)}OS.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const _re=[-1e5,-1e5,1e5,1e5];te(OS,z,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:_re;const s=this.value=RS.from(i,e.x,e.y).voronoi(r);for(let o=0,a=i.length;o<a;++o){const u=s.cellPolygon(o);i[o][n]=u&&!Sre(u)?Ere(u):null}return t.reflow(e.modified()).modifies(n)}});function Ere(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}function Sre(e){return e.length===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]}const $re=Object.freeze(Object.defineProperty({__proto__:null,voronoi:OS},Symbol.toStringTag,{value:"Module"}));var Fv=Math.PI/180,Gf=64,lg=2048;function Are(){var e=[256,256],t,n,i,r,s,o,a,u=S6,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Wo()),g=Rre((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,b=[],x=l.map(E=>({text:t(E),font:n(E),style:r(E),weight:s(E),rotate:o(E),size:~~(i(E)+1e-14),padding:a(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,_)=>_.size-E.size);++v<y;){var w=x[v];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Cre(p,w,x,v),w.hasText&&h(g,w,m)&&(b.push(w),m?Mre(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(Gf<<5)/g,p.height=lg/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var y=g.x,v=g.y,b=Math.hypot(e[0],e[1]),x=u(e),w=c()<.5?1:-1,E=-w,_,$,A;(_=x(E+=w))&&($=~~_[0],A=~~_[1],!(Math.min(Math.abs($),Math.abs(A))>=b));)if(g.x=y+$,g.y=v+A,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!kre(g,p,e[0]))&&(!m||Fre(g,m))){for(var F=g.sprite,M=g.width>>5,P=e[0]>>5,D=g.x-(M<<4),O=D&127,C=32-O,R=g.y1-g.y0,N=(g.y+g.y0)*P+(D>>5),I,U=0;U<R;U++){I=0;for(var re=0;re<=M;re++)p[N+re]|=I<<C|(re<M?(I=F[U*M+re])>>>O:0);N+=P}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Aa(p),f):n},f.fontStyle=function(p){return arguments.length?(r=Aa(p),f):r},f.fontWeight=function(p){return arguments.length?(s=Aa(p),f):s},f.rotate=function(p){return arguments.length?(o=Aa(p),f):o},f.text=function(p){return arguments.length?(t=Aa(p),f):t},f.spiral=function(p){return arguments.length?(u=Ore[p]||p,f):u},f.fontSize=function(p){return arguments.length?(i=Aa(p),f):i},f.padding=function(p){return arguments.length?(a=Aa(p),f):a},f.random=function(p){return arguments.length?(c=p,f):c},f}function Cre(e,t,n,i){if(!t.sprite){var r=e.context,s=e.ratio;r.clearRect(0,0,(Gf<<5)/s,lg/s);var o=0,a=0,u=0,l=n.length,c,f,d,h,p;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/s)+"px "+t.font,c=r.measureText(t.text+"m").width*s,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*Fv),m=Math.cos(t.rotate*Fv),y=c*m,v=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,d=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=Gf<<5&&(o=0,a+=u,u=0),a+d>=lg)break;r.translate((o+(c>>1))/s,(a+(d>>1))/s),t.rotate&&r.rotate(t.rotate*Fv),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=a,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=r.getImageData(0,0,(Gf<<5)/s,lg/s).data,E=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(o=t.xoff,o==null)return;a=t.yoff;var _=0,$=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var A=f*p+(h>>5),F=w[(a+p)*(Gf<<5)+(o+h)<<2]?1<<31-h%32:0;E[A]|=F,_|=F}_?$=p:(t.y0++,d--,p--,a++)}t.y1=t.y0+$,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function kre(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,s=e.x-(r<<4),o=s&127,a=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(s>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<a|(d<r?(c=i[f*r+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Mre(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function Fre(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function S6(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Tre(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(s){var o=s<0?-1:1;switch(Math.sqrt(1+4*o*s)-o&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function Rre(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Aa(e){return typeof e=="function"?e:function(){return e}}var Ore={archimedean:S6,rectangular:Tre};const $6=["x","y","font","fontSize","fontStyle","fontWeight","angle"],Dre=["text","font","rotate","fontSize","fontStyle","fontWeight"];function DS(e){z.call(this,Are(),e)}DS.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:$6}]};te(DS,z,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&q("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Te(g)&&t.modified(g.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||Dre.some(n)))return;const r=t.materialize(t.SOURCE).source,s=this.value,o=e.as||$6;let a=e.fontSize||14,u;if(Te(a)?u=e.fontSizeRange:a=En(a),u){const p=a,g=Ge("sqrt")().domain(es(r,p)).range(u);a=m=>g(p(m))}r.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=s.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(a).random(Bi).layout(),c=s.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(i).modifies(o)}});const Nre=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:DS},Symbol.toStringTag,{value:"Module"})),Pre=e=>new Uint8Array(e),Ire=e=>new Uint16Array(e),gd=e=>new Uint32Array(e);function Lre(){let e=8,t=[],n=gd(0),i=Ap(0,e),r=Ap(0,e);return{data:()=>t,seen:()=>n=zre(n,t.length),add(s){for(let o=0,a=t.length,u=s.length,l;o<u;++o)l=s[o],l._index=a++,t.push(l)},remove(s,o){const a=t.length,u=Array(a-s),l=t;let c,f,d;for(f=0;!o[f]&&f<a;++f)u[f]=t[f],l[f]=f;for(d=f;f<a;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:s=>r[s]=i[s],all:()=>e<257?255:e<65537?65535:4294967295,set(s,o){i[s]|=o},clear(s,o){i[s]&=~o},resize(s,o){const a=i.length;(s>a||o>e)&&(e=Math.max(o,e),i=Ap(s,e,i),r=Ap(s,e))}}}function zre(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Ap(e,t,n){const i=(t<257?Pre:t<65537?Ire:gd)(e);return n&&i.set(n),i}function RF(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,s){const o=this,a=o.bisect(o.range,r.value),u=r.index,l=a[0],c=a[1],f=u.length;let d;for(d=0;d<l;++d)s[u[d]]|=i;for(d=c;d<f;++d)s[u[d]]|=i;return o}}}function OF(){let e=gd(0),t=[],n=0;function i(a,u,l){if(!u.length)return[];const c=n,f=u.length,d=gd(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=a(u[m]),d[m]=m;if(h=Bre(h,d),c)p=t,g=e,t=Array(c+f),e=gd(c+f),Ure(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(a,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-a}function s(a){for(let u=0,l=n;u<l;++u)e[u]=a[e[u]]}function o(a,u){let l;return u?l=u.length:(u=t,l=n),[Hq(u,a[0],0,l),Vo(u,a[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:s,index:()=>e,size:()=>n}}function Bre(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],s=e[i];return r<s?-1:r>s?1:0}),Yq(e,t)}function Ure(e,t,n,i,r,s,o,a,u){let l=0,c=0,f;for(f=0;l<i&&c<o;++f)t[l]<r[c]?(a[f]=t[l],u[f]=n[l++]):(a[f]=r[c],u[f]=s[c++]+e);for(;l<i;++l,++f)a[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)a[f]=r[c],u[f]=s[c]+e}function NS(e){z.call(this,Lre(),e),this._indices=null,this._dims=null}NS.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};te(NS,z,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},s=this._dims=[],o=i.length;let a=0,u,l;for(;a<o;++a)u=n[a].fname,l=r[u]||(r[u]=OF()),s.push(RF(l,a,i[a]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,s=this._indices,o=this._dims,a=this.value,u=a.curr(),l=a.prev(),c=a.all(),f=n.rem=n.add,d=n.mod,h=r.length,p={};let g,m,y,v,b,x,w,E,_;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&a.add(t.add),t.mod.length)for(x={},v=t.mod,w=0,E=v.length;w<E;++w)x[v[w]._index]=1;for(w=0;w<h;++w)_=i[w],(!o[w]||e.modified("fields",w)||t.modified(_.fields))&&(y=_.fname,(g=p[y])||(s[y]=m=OF(),p[y]=g=m.insert(_,t.source,0)),o[w]=RF(m,w,r[w]).onAdd(g,u));for(w=0,E=a.data().length;w<E;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return a.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,s=this._dims,o=this._indices,a=e.fields,u={},l=n.add,c=r.size()+i.length,f=s.length;let d=r.size(),h,p,g;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)p=a[h].fname,g=u[p]||(u[p]=o[p].insert(a[h],i,d)),s[h].onAdd(g,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),s=i.all(),o=e.mod;let a,u,l;for(a=0,u=o.length;a<u;++a)l=o[a]._index,r[l]!==s&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,s=r.curr(),o=r.prev(),a=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=s[h],s[h]=a,p!==a&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const s=r.remove(t,n);for(const o in i)i[o].reindex(s)})},update(e,t,n){const i=this._dims,r=e.query,s=t.stamp,o=i.length;let a=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++a);if(a===1)a=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,a=0;l<o;++l)e.modified("query",l)&&(a|=i[l].one,this.incrementAll(i[l],r[l],s,n.add),n.rem=n.add);return a},incrementAll(e,t,n,i){const r=this.value,s=r.seen(),o=r.curr(),a=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;else if(f>h)for(m=h,y=Math.min(f,p);m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;if(d>p)for(m=Math.max(f,p),y=d;m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;else if(d<p)for(m=Math.max(h,d),y=p;m<y;++m)v=u[m],s[v]!==n&&(a[v]=o[v],s[v]=n,i.push(v)),o[v]^=g;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,s=r.curr(),o=e.index(),a=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=a[0],d=a[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],s[m]^=h,i.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],s[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],s[m]^=h,i.push(m);e.range=t.slice()}});function PS(e){z.call(this,null,e)}PS.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};te(PS,z,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)===0)return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),a=i.curr(),u=i.prev(),l=c=>a[c]&n?null:o[c];return s.filter(s.MOD,l),r&r-1?(s.filter(s.ADD,c=>{const f=a[c]&n;return!f&&f^u[c]&n?o[c]:null}),s.filter(s.REM,c=>{const f=a[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(s.filter(s.ADD,l),s.filter(s.REM,c=>(a[c]&n)===r?o[c]:null)),s.filter(s.SOURCE,c=>l(c._index))}});const jre=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:NS,resolvefilter:PS},Symbol.toStringTag,{value:"Module"})),qre="RawCode",gu="Literal",Wre="Property",Hre="Identifier",Gre="ArrayExpression",Vre="BinaryExpression",A6="CallExpression",Yre="ConditionalExpression",Xre="LogicalExpression",Kre="MemberExpression",Qre="ObjectExpression",Jre="UnaryExpression";function xr(e){this.type=e}xr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Zre(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Zre(e){switch(e.type){case Gre:return e.elements;case Vre:case Xre:return[e.left,e.right];case A6:return[e.callee].concat(e.arguments);case Yre:return[e.test,e.consequent,e.alternate];case Kre:return[e.object,e.property];case Qre:return e.properties;case Wre:return[e.key,e.value];case Jre:return[e.argument];case Hre:case gu:case qre:default:return[]}}var ps,ge,j,bn,it,h1=1,Rh=2,mu=3,ha=4,p1=5,Pu=6,Yn=7,Oh=8,ese=9;ps={};ps[h1]="Boolean";ps[Rh]="<end>";ps[mu]="Identifier";ps[ha]="Keyword";ps[p1]="Null";ps[Pu]="Numeric";ps[Yn]="Punctuator";ps[Oh]="String";ps[ese]="RegularExpression";var tse="ArrayExpression",nse="BinaryExpression",ise="CallExpression",rse="ConditionalExpression",C6="Identifier",sse="Literal",ose="LogicalExpression",ase="MemberExpression",use="ObjectExpression",lse="Property",cse="UnaryExpression",jt="Unexpected token %0",fse="Unexpected number",dse="Unexpected string",hse="Unexpected identifier",pse="Unexpected reserved word",gse="Unexpected end of input",ow="Invalid regular expression",Tv="Invalid regular expression: missing /",k6="Octal literals are not allowed in strict mode.",mse="Duplicate data property in object literal not allowed in strict mode",tn="ILLEGAL",Wd="Disabled.",yse=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),vse=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function g1(e,t){if(!e)throw new Error("ASSERT: "+t)}function Rs(e){return e>=48&&e<=57}function IS(e){return"0123456789abcdefABCDEF".includes(e)}function md(e){return"01234567".includes(e)}function bse(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function Hd(e){return e===10||e===13||e===8232||e===8233}function Dh(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&yse.test(String.fromCharCode(e))}function Nm(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&vse.test(String.fromCharCode(e))}const xse={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function M6(){for(;j<bn;){const e=ge.charCodeAt(j);if(bse(e)||Hd(e))++j;else break}}function aw(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<bn&&IS(ge[j])?(i=ge[j++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):qe({},jt,tn);return String.fromCharCode(r)}function wse(){var e,t,n,i;for(e=ge[j],t=0,e==="}"&&qe({},jt,tn);j<bn&&(e=ge[j++],!!IS(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&qe({},jt,tn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function F6(){var e,t;for(e=ge.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(ge.charCodeAt(j)!==117&&qe({},jt,tn),++j,e=aw("u"),(!e||e==="\\"||!Dh(e.charCodeAt(0)))&&qe({},jt,tn),t=e);j<bn&&(e=ge.charCodeAt(j),!!Nm(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ge.charCodeAt(j)!==117&&qe({},jt,tn),++j,e=aw("u"),(!e||e==="\\"||!Nm(e.charCodeAt(0)))&&qe({},jt,tn),t+=e);return t}function _se(){var e,t;for(e=j++;j<bn;){if(t=ge.charCodeAt(j),t===92)return j=e,F6();if(Nm(t))++j;else break}return ge.slice(e,j)}function Ese(){var e,t,n;return e=j,t=ge.charCodeAt(j)===92?F6():_se(),t.length===1?n=mu:xse.hasOwnProperty(t)?n=ha:t==="null"?n=p1:t==="true"||t==="false"?n=h1:n=mu,{type:n,value:t,start:e,end:j}}function Rv(){var e=j,t=ge.charCodeAt(j),n,i=ge[j],r,s,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:Yn,value:String.fromCharCode(t),start:e,end:j};default:if(n=ge.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:Yn,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,ge.charCodeAt(j)===61&&++j,{type:Yn,value:ge.slice(e,j),start:e,end:j}}}if(o=ge.substr(j,4),o===">>>=")return j+=4,{type:Yn,value:o,start:e,end:j};if(s=o.substr(0,3),s===">>>"||s==="<<="||s===">>=")return j+=3,{type:Yn,value:s,start:e,end:j};if(r=s.substr(0,2),i===r[1]&&"+-<>&|".includes(i)||r==="=>")return j+=2,{type:Yn,value:r,start:e,end:j};if(r==="//"&&qe({},jt,tn),"<>=!+-*%&|^/".includes(i))return++j,{type:Yn,value:i,start:e,end:j};qe({},jt,tn)}function Sse(e){let t="";for(;j<bn&&IS(ge[j]);)t+=ge[j++];return t.length===0&&qe({},jt,tn),Dh(ge.charCodeAt(j))&&qe({},jt,tn),{type:Pu,value:parseInt("0x"+t,16),start:e,end:j}}function $se(e){let t="0"+ge[j++];for(;j<bn&&md(ge[j]);)t+=ge[j++];return(Dh(ge.charCodeAt(j))||Rs(ge.charCodeAt(j)))&&qe({},jt,tn),{type:Pu,value:parseInt(t,8),octal:!0,start:e,end:j}}function DF(){var e,t,n;if(n=ge[j],g1(Rs(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=ge[j++],n=ge[j],e==="0"){if(n==="x"||n==="X")return++j,Sse(t);if(md(n))return $se(t);n&&Rs(n.charCodeAt(0))&&qe({},jt,tn)}for(;Rs(ge.charCodeAt(j));)e+=ge[j++];n=ge[j]}if(n==="."){for(e+=ge[j++];Rs(ge.charCodeAt(j));)e+=ge[j++];n=ge[j]}if(n==="e"||n==="E")if(e+=ge[j++],n=ge[j],(n==="+"||n==="-")&&(e+=ge[j++]),Rs(ge.charCodeAt(j)))for(;Rs(ge.charCodeAt(j));)e+=ge[j++];else qe({},jt,tn);return Dh(ge.charCodeAt(j))&&qe({},jt,tn),{type:Pu,value:parseFloat(e),start:t,end:j}}function Ase(){var e="",t,n,i,r,s=!1;for(t=ge[j],g1(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<bn;)if(i=ge[j++],i===t){t="";break}else if(i==="\\")if(i=ge[j++],!i||!Hd(i.charCodeAt(0)))switch(i){case"u":case"x":ge[j]==="{"?(++j,e+=wse()):e+=aw(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:md(i)?(r="01234567".indexOf(i),r!==0&&(s=!0),j<bn&&md(ge[j])&&(s=!0,r=r*8+"01234567".indexOf(ge[j++]),"0123".includes(i)&&j<bn&&md(ge[j])&&(r=r*8+"01234567".indexOf(ge[j++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&ge[j]===`
`&&++j;else{if(Hd(i.charCodeAt(0)))break;e+=i}return t!==""&&qe({},jt,tn),{type:Oh,value:e,octal:s,start:n,end:j}}function Cse(e,t){let n=e;t.includes("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";qe({},ow)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{qe({},ow)}try{return new RegExp(e,t)}catch{return null}}function kse(){var e,t,n,i,r;for(e=ge[j],g1(e==="/","Regular expression literal must start with a slash"),t=ge[j++],n=!1,i=!1;j<bn;)if(e=ge[j++],t+=e,e==="\\")e=ge[j++],Hd(e.charCodeAt(0))&&qe({},Tv),t+=e;else if(Hd(e.charCodeAt(0)))qe({},Tv);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||qe({},Tv),r=t.substr(1,t.length-2),{value:r,literal:t}}function Mse(){var e,t,n;for(t="",n="";j<bn&&(e=ge[j],!!Nm(e.charCodeAt(0)));)++j,e==="\\"&&j<bn?qe({},jt,tn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&qe({},ow,n),{value:n,literal:t}}function Fse(){var e,t,n,i;return it=null,M6(),e=j,t=kse(),n=Mse(),i=Cse(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function Tse(e){return e.type===mu||e.type===ha||e.type===h1||e.type===p1}function T6(){if(M6(),j>=bn)return{type:Rh,start:j,end:j};const e=ge.charCodeAt(j);return Dh(e)?Ese():e===40||e===41||e===59?Rv():e===39||e===34?Ase():e===46?Rs(ge.charCodeAt(j+1))?DF():Rv():Rs(e)?DF():Rv()}function Kn(){const e=it;return j=e.end,it=T6(),j=e.end,e}function R6(){const e=j;it=T6(),j=e}function Rse(e){const t=new xr(tse);return t.elements=e,t}function NF(e,t,n){const i=new xr(e==="||"||e==="&&"?ose:nse);return i.operator=e,i.left=t,i.right=n,i}function Ose(e,t){const n=new xr(ise);return n.callee=e,n.arguments=t,n}function Dse(e,t,n){const i=new xr(rse);return i.test=e,i.consequent=t,i.alternate=n,i}function LS(e){const t=new xr(C6);return t.name=e,t}function Vf(e){const t=new xr(sse);return t.value=e.value,t.raw=ge.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function PF(e,t,n){const i=new xr(ase);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function Nse(e){const t=new xr(use);return t.properties=e,t}function IF(e,t,n){const i=new xr(lse);return i.key=t,i.value=n,i.kind=e,i}function Pse(e,t){const n=new xr(cse);return n.operator=e,n.argument=t,n.prefix=!0,n}function qe(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(s,o)=>(g1(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=j,n.description=r,n}function m1(e){e.type===Rh&&qe(e,gse),e.type===Pu&&qe(e,fse),e.type===Oh&&qe(e,dse),e.type===mu&&qe(e,hse),e.type===ha&&qe(e,pse),qe(e,jt,e.value)}function xn(e){const t=Kn();(t.type!==Yn||t.value!==e)&&m1(t)}function dt(e){return it.type===Yn&&it.value===e}function Ov(e){return it.type===ha&&it.value===e}function Ise(){const e=[];for(j=it.start,xn("[");!dt("]");)dt(",")?(Kn(),e.push(null)):(e.push(yu()),dt("]")||xn(","));return Kn(),Rse(e)}function LF(){j=it.start;const e=Kn();return e.type===Oh||e.type===Pu?(e.octal&&qe(e,k6),Vf(e)):LS(e.value)}function Lse(){var e,t,n,i;if(j=it.start,e=it,e.type===mu)return n=LF(),xn(":"),i=yu(),IF("init",n,i);if(e.type===Rh||e.type===Yn)m1(e);else return t=LF(),xn(":"),i=yu(),IF("init",t,i)}function zse(){var e=[],t,n,i,r={},s=String;for(j=it.start,xn("{");!dt("}");)t=Lse(),t.key.type===C6?n=t.key.name:n=s(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?qe({},mse):r[i]=!0,e.push(t),dt("}")||xn(",");return xn("}"),Nse(e)}function Bse(){xn("(");const e=zS();return xn(")"),e}const Use={if:1};function jse(){var e,t,n;if(dt("("))return Bse();if(dt("["))return Ise();if(dt("{"))return zse();if(e=it.type,j=it.start,e===mu||Use[it.value])n=LS(Kn().value);else if(e===Oh||e===Pu)it.octal&&qe(it,k6),n=Vf(Kn());else{if(e===ha)throw new Error(Wd);e===h1?(t=Kn(),t.value=t.value==="true",n=Vf(t)):e===p1?(t=Kn(),t.value=null,n=Vf(t)):dt("/")||dt("/=")?(n=Vf(Fse()),R6()):m1(Kn())}return n}function qse(){const e=[];if(xn("("),!dt(")"))for(;j<bn&&(e.push(yu()),!dt(")"));)xn(",");return xn(")"),e}function Wse(){j=it.start;const e=Kn();return Tse(e)||m1(e),LS(e.value)}function Hse(){return xn("."),Wse()}function Gse(){xn("[");const e=zS();return xn("]"),e}function Vse(){var e,t,n;for(e=jse();;)if(dt("."))n=Hse(),e=PF(".",e,n);else if(dt("("))t=qse(),e=Ose(e,t);else if(dt("["))n=Gse(),e=PF("[",e,n);else break;return e}function zF(){const e=Vse();if(it.type===Yn&&(dt("++")||dt("--")))throw new Error(Wd);return e}function cg(){var e,t;if(it.type!==Yn&&it.type!==ha)t=zF();else{if(dt("++")||dt("--"))throw new Error(Wd);if(dt("+")||dt("-")||dt("~")||dt("!"))e=Kn(),t=cg(),t=Pse(e.value,t);else{if(Ov("delete")||Ov("void")||Ov("typeof"))throw new Error(Wd);t=zF()}}return t}function BF(e){let t=0;if(e.type!==Yn&&e.type!==ha)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Yse(){var e,t,n,i,r,s,o,a,u,l;if(e=it,u=cg(),i=it,r=BF(i),r===0)return u;for(i.prec=r,Kn(),t=[e,it],o=cg(),s=[u,i,o];(r=BF(it))>0;){for(;s.length>2&&r<=s[s.length-2].prec;)o=s.pop(),a=s.pop().value,u=s.pop(),t.pop(),n=NF(a,u,o),s.push(n);i=Kn(),i.prec=r,s.push(i),t.push(it),n=cg(),s.push(n)}for(l=s.length-1,n=s[l],t.pop();l>1;)t.pop(),n=NF(s[l-1].value,s[l-2],n),l-=2;return n}function yu(){var e,t,n;return e=Yse(),dt("?")&&(Kn(),t=yu(),xn(":"),n=yu(),e=Dse(e,t,n)),e}function zS(){const e=yu();if(dt(","))throw new Error(Wd);return e}function BS(e){ge=e,j=0,bn=ge.length,it=null,R6();const t=zS();if(it.type!==Rh)throw new Error("Unexpect token after expression.");return t}var O6={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function D6(e){function t(o,a,u,l){let c=e(a[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+a.slice(1).map(e).join(",")+")")}function n(o,a,u){return l=>t(o,l,a,u)}const i="new Date",r="String",s="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&q("Missing arguments to clamp function."),o.length>3&&q("Too many arguments to clamp function.");const a=o.map(e);return"Math.max("+a[1]+", Math.min("+a[2]+","+a[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),btoa:"btoa",atob:"atob",regexp:s,test:n("test",s),if:function(o){o.length<3&&q("Missing arguments to if function."),o.length>3&&q("Too many arguments to if function.");const a=o.map(e);return"("+a[0]+"?"+a[1]+":"+a[2]+")"}}}function Xse(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function N6(e){e=e||{};const t=e.allowed?hr(e.allowed):{},n=e.forbidden?hr(e.forbidden):{},i=e.constants||O6,r=(e.functions||D6)(f),s=e.globalvar,o=e.fieldvar,a=Te(s)?s:p=>`${s}["${p}"]`;let u={},l={},c=0;function f(p){if(oe(p))return p;const g=d[p.type];return g==null&&q("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:fe(n,g)?q("Illegal identifier: "+g):fe(i,g)?i[g]:fe(t,g)?g:(u[g]=1,a(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const y=f(p.property);return m===o&&(l[Xse(y)]=1),g&&(c-=1),m+(g?"."+y:"["+y+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&q("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,y=fe(r,g)&&r[g];return y||q("Unrecognized function: "+g),Te(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=r,h.constants=i,h}const UF=Symbol("vega_selection_getter");function P6(e){return(!e.getter||!e.getter[UF])&&(e.getter=Ii(e.field),e.getter[UF]=!0),e.getter}const US="intersect",jF="union",Kse="vlMulti",Qse="vlPoint",qF="or",Jse="and",Br="_vgsid_",Gd=Ii(Br),Zse="E",eoe="R",toe="R-E",noe="R-LE",ioe="R-RE",roe="E-LT",soe="E-LTE",ooe="E-GT",aoe="E-GTE",uoe="E-VALID",loe="E-ONE",Pm="index:unit";function WF(e,t){for(var n=t.fields,i=t.values,r=n.length,s=0,o,a;s<r;++s)if(a=n[s],o=P6(a)(e),Uo(o)&&(o=pn(o)),Uo(i[s])&&(i[s]=pn(i[s])),G(i[s])&&Uo(i[s][0])&&(i[s]=i[s].map(pn)),a.type===Zse){if(G(i[s])?!i[s].includes(o):o!==i[s])return!1}else if(a.type===eoe){if(!dl(o,i[s]))return!1}else if(a.type===ioe){if(!dl(o,i[s],!0,!1))return!1}else if(a.type===toe){if(!dl(o,i[s],!1,!1))return!1}else if(a.type===noe){if(!dl(o,i[s],!1,!0))return!1}else if(a.type===roe){if(o>=i[s])return!1}else if(a.type===soe){if(o>i[s])return!1}else if(a.type===ooe){if(o<=i[s])return!1}else if(a.type===aoe){if(o<i[s])return!1}else if(a.type===uoe){if(o===null||isNaN(o))return!1}else if(a.type===loe&&i[s].indexOf(o)===-1)return!1;return!0}function coe(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],s=i?i[Pm]&&i[Pm].value:void 0,o=n===US,a=r.length,u=0,l,c,f,d,h;u<a;++u)if(l=r[u],s&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=WF(t,l),c[d]=h?-1:++f,h&&s.size===1)return!0;if(!h&&f===s.get(d).count)return!1}else if(h=WF(t,l),o^h)return h;return a&&o}const I6=Ac(Gd),foe=I6.left,doe=I6.right;function hoe(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],s=i?i[Pm]&&i[Pm].value:void 0,o=n===US,a=Gd(t),u=foe(r,a);if(u===r.length||Gd(r[u])!==a)return!1;if(s&&o){if(s.size===1)return!0;if(doe(r,a)-u<s.size)return!1}return!0}function poe(e,t){return e.map(n=>Fe(t.fields?{values:t.fields.map(i=>P6(i)(n.datum))}:{[Br]:Gd(n.datum)},t))}function goe(e,t,n,i){for(var r=this.context.data[e],s=r?r.values.value:[],o={},a={},u={},l,c,f,d,h,p,g,m,y,v,b=s.length,x=0,w,E;x<b;++x)if(l=s[x],d=l.unit,c=l.fields,f=l.values,c&&f){for(w=0,E=c.length;w<E;++w)h=c[w],g=o[h.field]||(o[h.field]={}),m=g[d]||(g[d]=[]),u[h.field]=y=h.type.charAt(0),v=Dv[`${y}_union`],g[d]=v(m,le(f[w]));n&&(m=a[d]||(a[d]=[]),m.push(le(f).reduce((_,$,A)=>(_[c[A].field]=$,_),{})))}else h=Br,p=Gd(l),g=o[h]||(o[h]={}),m=g[d]||(g[d]=[]),m.push(p),n&&(m=a[d]||(a[d]=[]),m.push({[Br]:p}));if(t=t||jF,o[Br]?o[Br]=Dv[`${Br}_${t}`](...Object.values(o[Br])):Object.keys(o).forEach(_=>{o[_]=Object.keys(o[_]).map($=>o[_][$]).reduce(($,A)=>$===void 0?A:Dv[`${u[_]}_${t}`]($,A))}),s=Object.keys(a),n&&s.length){const _=i?Qse:Kse;o[_]=t===jF?{[qF]:s.reduce(($,A)=>($.push(...a[A]),$),[])}:{[Jse]:s.map($=>({[qF]:a[$]}))}}return o}var Dv={[`${Br}_union`]:iW,[`${Br}_intersect`]:tW,E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.includes(t[n])||e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.includes(n)):t},R_union:function(e,t){var n=pn(t[0]),i=pn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=pn(t[0]),i=pn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const moe=":",yoe="@";function jS(e,t,n,i){t[0].type!==gu&&q("First argument to selection functions must be a string literal.");const r=t[0].value,s=t.length>=2&&ze(t).value,o="unit",a=yoe+o,u=moe+r;s===US&&!fe(i,a)&&(i[a]=n.getData(r).indataRef(n,o)),fe(i,u)||(i[u]=n.getData(r).tuplesRef())}function L6(e){const t=this.context.data[e];return t?t.values.value:[]}function voe(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function boe(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Li).insert(t)),1}function xoe(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const Nh=e=>function(t,n){const i=this.context.dataflow.locale();return t===null?"null":i[e](n)(t)},woe=Nh("format"),z6=Nh("timeFormat"),_oe=Nh("utcFormat"),Eoe=Nh("timeParse"),Soe=Nh("utcParse"),Cp=new Date(2e3,0,1);function y1(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Cp.setYear(2e3),Cp.setMonth(e),Cp.setDate(t),z6.call(this,Cp,n))}function $oe(e){return y1.call(this,e,1,"%B")}function Aoe(e){return y1.call(this,e,1,"%b")}function Coe(e){return y1.call(this,0,2+e,"%A")}function koe(e){return y1.call(this,0,2+e,"%a")}const Moe=":",Foe="@",uw="%",B6="$";function qS(e,t,n,i){t[0].type!==gu&&q("First argument to data functions must be a string literal.");const r=t[0].value,s=Moe+r;if(!fe(s,i))try{i[s]=n.getData(r).tuplesRef()}catch{}}function Toe(e,t,n,i){t[0].type!==gu&&q("First argument to indata must be a string literal."),t[1].type!==gu&&q("Second argument to indata must be a string literal.");const r=t[0].value,s=t[1].value,o=Foe+s;fe(o,i)||(i[o]=n.getData(r).indataRef(n,s))}function Ln(e,t,n,i){if(t[0].type===gu)HF(n,i,t[0].value);else for(e in n.scales)HF(n,i,e)}function HF(e,t,n){const i=uw+n;if(!fe(t,i))try{t[i]=e.scaleRef(n)}catch{}}function gs(e,t){if(oe(e)){const n=t.scales[e];return n&&Yk(n.value)?n.value:void 0}else if(Te(e))return Yk(e)?e:void 0}function Roe(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Ln,n._range=Ln,n._scale=Ln;const i=r=>"_["+(r.type===gu?ee(uw+r.value):ee(uw)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function WS(e,t){return function(n,i,r){if(n){const s=gs(n,(r||this).context);return s&&s.path[e](i)}else return t(i)}}const Ooe=WS("area",QZ),Doe=WS("bounds",tee),Noe=WS("centroid",aee);function Poe(e,t){const n=gs(e,(t||this).context);return n&&n.scale()}function Ioe(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function HS(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function Loe(){return HS(this.context.dataflow,"warn",arguments)}function zoe(){return HS(this.context.dataflow,"info",arguments)}function Boe(){return HS(this.context.dataflow,"debug",arguments)}function Nv(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function lw(e){const t=Qo(e),n=Nv(t.r),i=Nv(t.g),r=Nv(t.b);return .2126*n+.7152*i+.0722*r}function Uoe(e,t){const n=lw(e),i=lw(t),r=Math.max(n,i),s=Math.min(n,i);return(r+.05)/(s+.05)}function joe(){const e=[].slice.call(arguments);return e.unshift({}),Fe(...e)}function U6(e,t){return e===t||e!==e&&t!==t?!0:G(e)?G(t)&&e.length===t.length?qoe(e,t):!1:ae(e)&&ae(t)?j6(e,t):!1}function qoe(e,t){for(let n=0,i=e.length;n<i;++n)if(!U6(e[n],t[n]))return!1;return!0}function j6(e,t){for(const n in e)if(!U6(e[n],t[n]))return!1;return!0}function GF(e){return t=>j6(e,t)}function Woe(e,t,n,i,r,s){const o=this.context.dataflow,a=this.context.data[e],u=a.input,l=o.stamp();let c=a.changes,f,d;if(o._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(a.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{a.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Li:G(n)||A0(n)?n:GF(n),c.remove(f)),t&&c.insert(t),i&&(f=GF(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in s)c.modify(r,d,s[d]);return 1}function Hoe(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.hypot(n,i)}function Goe(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const VF={};function Voe(e,t){const n=VF[t]||(VF[t]=Ii(t));return G(e)?e.map(n):n(e)}function v1(e){return G(e)||ArrayBuffer.isView(e)?e:null}function GS(e){return v1(e)||(oe(e)?e:null)}function Yoe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return v1(e).join(...n)}function Xoe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return GS(e).indexOf(...n)}function Koe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return GS(e).lastIndexOf(...n)}function Qoe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return GS(e).slice(...n)}function Joe(e,t,n){return Te(n)&&q("Function argument passed to replace."),!oe(t)&&!T2(t)&&q("Please pass a string or RegExp argument to replace."),String(e).replace(t,n)}function Zoe(e){return v1(e).slice().reverse()}function eae(e){return v1(e).slice().sort(Sc)}function tae(e,t,n){return sE(e||0,t||0,n||0)}function nae(e,t){const n=gs(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function iae(e,t){const n=gs(e,(t||this).context);return n?n.copy():void 0}function rae(e,t){const n=gs(e,(t||this).context);return n?n.domain():[]}function sae(e,t,n){const i=gs(e,(n||this).context);return i?G(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function oae(e,t){const n=gs(e,(t||this).context);return n&&n.range?n.range():[]}function aae(e,t,n){const i=gs(e,(n||this).context);return i?i(t):void 0}function uae(e,t,n,i,r){e=gs(e,(r||this).context);const s=O5(t,n);let o=e.domain(),a=o[0],u=ze(o),l=_n;return u-a?l=w5(e,a,u):e=(e.interpolator?Ge("sequential")().interpolator(e.interpolator()):Ge("linear")().interpolate(e.interpolate()).range(e.range())).domain([a=0,u=1]),e.ticks&&(o=e.ticks(+i||15),a!==o[0]&&o.unshift(a),u!==ze(o)&&o.push(u)),o.forEach(c=>s.stop(l(c),e(c))),s}function lae(e,t,n){const i=gs(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function cae(e){let t=null;return function(n){return n?Pd(n,t=t||Yl(e)):e}}const q6=e=>e.data;function W6(e,t){const n=L6.call(t,e);return n.root&&n.root.lookup||{}}function fae(e,t,n){const i=W6(e,this),r=i[t],s=i[n];return r&&s?r.path(s).map(q6):void 0}function dae(e,t){const n=W6(e,this)[t];return n?n.ancestors().map(q6):void 0}const H6=()=>typeof window<"u"&&window||null;function hae(){const e=H6();return e?e.screen:{}}function pae(){const e=H6();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function gae(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function G6(e,t,n){if(!e)return[];const[i,r]=e,s=new Tt().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return MI(o,s,mae(t))}function mae(e){let t=null;if(e){const n=le(e.marktype),i=le(e.markname);t=r=>(!n.length||n.some(s=>r.marktype===s))&&(!i.length||i.some(s=>r.name===s))}return t}function yae(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:5;e=le(e);const r=e[e.length-1];return r===void 0||Math.hypot(r[0]-t,r[1]-n)>i?[...e,[t,n]]:e}function vae(e){return le(e).reduce((t,n,i)=>{let[r,s]=n;return t+=i==0?`M ${r},${s} `:i===e.length-1?" Z":`L ${r},${s} `},"")}function bae(e,t,n){const{x:i,y:r,mark:s}=n,o=new Tt().set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[u,l]of t)u<o.x1&&(o.x1=u),u>o.x2&&(o.x2=u),l<o.y1&&(o.y1=l),l>o.y2&&(o.y2=l);return o.translate(i,r),G6([[o.x1,o.y1],[o.x2,o.y2]],e,s).filter(u=>xae(u.x,u.y,t))}function xae(e,t,n){let i=0;for(let r=0,s=n.length-1;r<n.length;s=r++){const[o,a]=n[s],[u,l]=n[r];l>t!=a>t&&e<(o-u)*(t-l)/(a-l)+u&&i++}return i&1}const Vd={random(){return Bi()},cumulativeNormal:T0,cumulativeLogNormal:s_,cumulativeUniform:l_,densityNormal:e_,densityLogNormal:r_,densityUniform:u_,quantileNormal:R0,quantileLogNormal:o_,quantileUniform:c_,sampleNormal:F0,sampleLogNormal:i_,sampleUniform:a_,isArray:G,isBoolean:ua,isDate:Uo,isDefined(e){return e!==void 0},isNumber:We,isObject:ae,isRegExp:T2,isString:oe,isTuple:A0,isValid(e){return e!=null&&e===e},toBoolean:O2,toDate(e){return D2(e)},toNumber:pn,toString:N2,indexof:Xoe,join:Yoe,lastindexof:Koe,replace:Joe,reverse:Zoe,sort:eae,slice:Qoe,flush:ZD,lerp:tN,merge:joe,pad:rN,peek:ze,pluck:Voe,span:uh,inrange:dl,truncate:sN,rgb:Qo,lab:jg,hcl:qg,hsl:Bg,luminance:lw,contrast:Uoe,sequence:gi,format:woe,utcFormat:_oe,utcParse:Soe,utcOffset:LN,utcSequence:UN,timeFormat:z6,timeParse:Eoe,timeOffset:IN,timeSequence:BN,timeUnitSpecifier:AN,monthFormat:$oe,monthAbbrevFormat:Aoe,dayFormat:Coe,dayAbbrevFormat:koe,quarter:XD,utcquarter:KD,week:kN,utcweek:TN,dayofyear:CN,utcdayofyear:FN,warn:Loe,info:zoe,debug:Boe,extent(e){return es(e)},inScope:Ioe,intersect:G6,clampRange:QD,pinchDistance:Hoe,pinchAngle:Goe,screen:hae,containerSize:gae,windowSize:pae,bandspace:tae,setdata:boe,pathShape:cae,panLinear:HD,panLog:GD,panPow:VD,panSymlog:YD,zoomLinear:A2,zoomLog:C2,zoomPow:Cg,zoomSymlog:k2,encode:xoe,modify:Woe,lassoAppend:yae,lassoPath:vae,intersectLasso:bae},wae=["view","item","group","xy","x","y"],_ae="event.vega.",V6="this.",VS={},Y6={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${ee(B6+e)}]`,functions:Eae,constants:O6,visitors:VS},cw=N6(Y6);function Eae(e){const t=D6(e);wae.forEach(n=>t[n]=_ae+n);for(const n in Vd)t[n]=V6+n;return Fe(t,Roe(e,Vd,VS)),t}function Mt(e,t,n){return arguments.length===1?Vd[e]:(Vd[e]=t,n&&(VS[e]=n),cw&&(cw.functions[e]=V6+e),this)}Mt("bandwidth",nae,Ln);Mt("copy",iae,Ln);Mt("domain",rae,Ln);Mt("range",oae,Ln);Mt("invert",sae,Ln);Mt("scale",aae,Ln);Mt("gradient",uae,Ln);Mt("geoArea",Ooe,Ln);Mt("geoBounds",Doe,Ln);Mt("geoCentroid",Noe,Ln);Mt("geoShape",lae,Ln);Mt("geoScale",Poe,Ln);Mt("indata",voe,Toe);Mt("data",L6,qS);Mt("treePath",fae,qS);Mt("treeAncestors",dae,qS);Mt("vlSelectionTest",coe,jS);Mt("vlSelectionIdTest",hoe,jS);Mt("vlSelectionResolve",goe,jS);Mt("vlSelectionTuples",poe);function ss(e,t){const n={};let i;try{e=oe(e)?e:ee(e)+"",i=BS(e)}catch{q("Expression parse error: "+e)}i.visit(s=>{if(s.type!==A6)return;const o=s.callee.name,a=Y6.visitors[o];a&&a(o,s.arguments,t,n)});const r=cw(i);return r.globals.forEach(s=>{const o=B6+s;!fe(n,o)&&t.getSignal(s)&&(n[o]=t.signalRef(s))}),{$expr:Fe({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Sae(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const $ae=hr(["rule"]),YF=hr(["group","image","rect"]);function Aae(e,t){let n="";return $ae[t]||(e.x2&&(e.x?(YF[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(YF[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function YS(e){return(e+"").toLowerCase()}function Cae(e){return YS(e)==="operator"}function kae(e){return YS(e)==="collect"}function hf(e,t,n){n.endsWith(";")||(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function Mae(e,t,n,i){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${i}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${i} : `}var Fae={operator:(e,t)=>hf(e,["_"],t.code),parameter:(e,t)=>hf(e,["datum","_"],t.code),event:(e,t)=>hf(e,["event"],t.code),handler:(e,t)=>{const n=`var datum=event.item&&event.item.datum;return ${t.code};`;return hf(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const s in i){const o="o["+ee(s)+"]";r+=`$=${i[s].code};if(${o}!==$)${o}=$,m=1;`}return r+=Aae(i,n),r+="return m;",hf(e,["item","_"],r)},codegen:{get(e){const t=`[${e.map(ee).join("][")}]`,n=Function("_",`return _${t};`);return n.path=t,n},comparator(e,t){let n;const i=(s,o)=>{const a=t[o];let u,l;return s.path?(u=`a${s.path}`,l=`b${s.path}`):((n=n||{})["f"+o]=s,u=`this.f${o}(a)`,l=`this.f${o}(b)`),Mae(u,l,-a,a)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Tae(e){const t=this;Cae(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Rae(e){const t=this;if(e.params){const n=t.get(e.id);n||q("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Oae(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=G(r)?r.map(s=>XF(s,n,t)):XF(r,n,t)}return t}function XF(e,t,n){if(!e||!ae(e))return e;for(let i=0,r=KF.length,s;i<r;++i)if(s=KF[i],fe(e,s.key))return s.parse(e,t,n);return e}var KF=[{key:"$ref",parse:Dae},{key:"$key",parse:Pae},{key:"$expr",parse:Nae},{key:"$field",parse:Iae},{key:"$encode",parse:zae},{key:"$compare",parse:Lae},{key:"$context",parse:Bae},{key:"$subflow",parse:Uae},{key:"$tupleid",parse:jae}];function Dae(e,t){return t.get(e.$ref)||q("Operator not defined: "+e.$ref)}function Nae(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code;return t.fn[i]||(t.fn[i]=oi(t.parameterExpression(e.$expr),e.$fields))}function Pae(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=R2(e.$key,e.$flat,t.expr.codegen))}function Iae(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Ii(e.$field,e.$name,t.expr.codegen))}function Lae(e,t){const n="c:"+e.$compare+"_"+e.$order,i=le(e.$compare).map(r=>r&&r.$tupleid?be:r);return t.fn[n]||(t.fn[n]=M2(i,e.$order,t.expr.codegen))}function zae(e,t){const n=e.$encode,i={};for(const r in n){const s=n[r];i[r]=oi(t.encodeExpression(s.$expr),s.$fields),i[r].output=s.$output}return i}function Bae(e,t){return t}function Uae(e,t){const n=e.$subflow;return function(i,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(s),a.detachSubflow=()=>t.detach(o),a}}function jae(){return be}function qae(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(s=>t.get(s)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(s=>t.get(s)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&q("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function Wae(e){var t=this,n=ae(n=e.source)?n.$ref:n,i=t.get(n),r=null,s=e.update,o=void 0;i||q("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),s&&s.$expr&&(s.$params&&(o=t.parseParameters(s.$params)),s=t.handlerExpression(s.$expr)),t.update(e,i,r,s,o)}const Hae={skip:!0};function Gae(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(s=>{const o=t.signals[s];e.signals(s,o)&&(i[s]=o.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(s=>{const o=t.data[s];e.data(s,o)&&(r[s]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(s=>s.getState(e))),n}function Vae(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(s=>{n.update(t.signals[s],r[s],Hae)}),Object.keys(i||{}).forEach(s=>{n.pulse(t.data[s].input,n.changeset().remove(Li).insert(i[s]))}),(e.subcontext||[]).forEach((s,o)=>{const a=t.subcontext[o];a&&a.setState(s)})}function X6(e,t,n,i){return new K6(e,t,n,i)}function K6(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Fae,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function QF(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}K6.prototype=QF.prototype={fork(){const e=new QF(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),kae(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(i.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),i.connect(s,[t]),t.targets().add(s)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const s in e.data){const o=n.data[s]||(n.data[s]={});e.data[s].forEach(a=>o[a]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[YS(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Sae,parseOperator:Tae,parseOperatorParameters:Rae,parseParameters:Oae,parseStream:qae,parseUpdate:Wae,getState:Gae,setState:Vae};function Yae(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Q6(t,e.description()))}function Q6(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Xae(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const Pv="default";function Kae(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:Pv,item:null}));e.on(e.events("view","pointermove"),t,(n,i)=>{const r=t.value,s=r?oe(r)?r:r.user:Pv,o=i.item&&i.item.cursor||null;return r&&s===r.user&&o==r.item?r:{user:s,item:o}}),e.add(null,function(n){let i=n.cursor,r=this.value;return oe(i)||(r=i.item,i=i.user),fw(e,i&&i!==Pv?i:r||i),r},{cursor:t})}function fw(e,t){const n=e.globalCursor()?typeof document<"u"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function Im(e,t){var n=e._runtime.data;return fe(n,t)||q("Unrecognized data set: "+t),n[t]}function Qae(e,t){return arguments.length<2?Im(this,e).values.value:b1.call(this,e,Ou().remove(Li).insert(t))}function b1(e,t){p3(t)||q("Second argument to changes must be a changeset.");const n=Im(this,e);return n.modified=!0,this.pulse(n.input,t)}function Jae(e,t){return b1.call(this,e,Ou().insert(t))}function Zae(e,t){return b1.call(this,e,Ou().remove(t))}function J6(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Z6(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function x1(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function eue(e){var t=x1(e),n=J6(e),i=Z6(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(s){e.error(s)}})}function tue(e,t,n){var i=e._renderer,r=i&&i.canvas(),s,o,a;return r&&(a=x1(e),o=t.changedTouches?t.changedTouches[0]:t,s=s1(o,r),s[0]-=a[0],s[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=nue(e,n,s),t}function nue(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(o){var a=i,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){a=u;break}}return a&&a.mark&&a.mark.interactive?a:{}}function s(o){if(!o)return n;oe(o)&&(o=r(o));const a=n.slice();for(;o;)a[0]-=o.x||0,a[1]-=o.y||0,o=o.mark&&o.mark.group;return a}return{view:En(e),item:En(t||{}),group:r,xy:s,x:o=>s(o)[0],y:o=>s(o)[1]}}const JF="view",iue="timer",rue="window",sue={trap:!1};function oue(e){const t=Fe({defaults:{}},e),n=(i,r)=>{r.forEach(s=>{G(i[s])&&(i[s]=hr(i[s]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function e4(e,t,n,i){e._eventListeners.push({type:n,sources:le(t),handler:i})}function aue(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function kp(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||ae(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function uue(e,t,n){var i=this,r=new M0(n),s=function(l,c){i.runAsync(null,()=>{e===JF&&aue(i,t)&&l.preventDefault(),r.receive(tue(i,l,c))})},o;if(e===iue)kp(i,"timer",t)&&i.timer(s,t);else if(e===JF)kp(i,"view",t)&&i.addEventListener(t,s,sue);else if(e===rue?kp(i,"window",t)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&kp(i,"selector",t)&&(o=Array.from(document.querySelectorAll(e))),!o)i.warn("Can not resolve event source: "+e);else{for(var a=0,u=o.length;a<u;++a)o[a].addEventListener(t,s);e4(i,o,t,s)}return r}function ZF(e){return e.item}function eT(e){return e.item.mark.source}function tT(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function lue(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","pointerover",ZF),eT,tT(e)),this.on(this.events("view","pointerout",ZF),eT,tT(t)),this}function cue(){var e=this._tooltip,t=this._timers,n=this._handler.handlers(),i=this._eventListeners,r,s,o,a,u;for(r=t.length;--r>=0;)t[r].stop();for(r=i.length;--r>=0;)for(o=i[r],s=o.sources.length;--s>=0;)o.sources[s].removeEventListener(o.type,o.handler);for(e&&e.call(this,this._handler,null,null,null),r=n.length;--r>=0;)u=n[r].type,a=n[r].handler,this._handler.off(u,a);return this}function bi(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const fue="vega-bind",due="vega-bind-name",hue="vega-bind-radio";function pue(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,o)})}},i.debounce&&(r.update=F2(i.debounce,r.update))),(i.input==null&&i.element?gue:yue)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function gue(e,t,n,i){const r=n.event||"input",s=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,s),e4(i,t,r,s),e.set=o=>{t.value=o,t.dispatchEvent(mue(r))}}function mue(e){return typeof Event<"u"?new Event(e):{type:e}}function yue(e,t,n,i){const r=i.signal(n.signal),s=bi("div",{class:fue}),o=n.input==="radio"?s:s.appendChild(bi("label"));o.appendChild(bi("span",{class:due},n.name||n.signal)),t.appendChild(s);let a=vue;switch(n.input){case"checkbox":a=bue;break;case"select":a=xue;break;case"radio":a=wue;break;case"range":a=_ue;break}a(e,o,n,r)}function vue(e,t,n,i){const r=bi("input");for(const s in n)s!=="signal"&&s!=="element"&&r.setAttribute(s==="input"?"type":s,n[s]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=s=>r.value=s}function bue(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const s=bi("input",r);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=o=>s.checked=!!o||null}function xue(e,t,n,i){const r=bi("select",{name:n.signal}),s=n.labels||[];n.options.forEach((o,a)=>{const u={value:o};Lm(o,i)&&(u.selected=!0),r.appendChild(bi("option",u,(s[a]||o)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=o=>{for(let a=0,u=n.options.length;a<u;++a)if(Lm(n.options[a],o)){r.selectedIndex=a;return}}}function wue(e,t,n,i){const r=bi("span",{class:hue}),s=n.labels||[];t.appendChild(r),e.elements=n.options.map((o,a)=>{const u={type:"radio",name:n.signal,value:o};Lm(o,i)&&(u.checked=!0);const l=bi("input",u);l.addEventListener("change",()=>e.update(o));const c=bi("label",{},(s[a]||o)+"");return c.prepend(l),r.appendChild(c),l}),e.set=o=>{const a=e.elements,u=a.length;for(let l=0;l<u;++l)Lm(a[l].value,o)&&(a[l].checked=!0)}}function _ue(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,s=n.min||Math.min(0,r,+i)||0,o=n.step||Yo(s,r,100),a=bi("input",{type:"range",name:n.signal,min:s,max:r,step:o});a.value=i;const u=bi("span",{},+i);t.appendChild(a),t.appendChild(u);const l=()=>{u.textContent=a.value,e.update(+a.value)};a.addEventListener("input",l),a.addEventListener("change",l),e.elements=[a],e.set=c=>{a.value=c,u.textContent=c}}function Lm(e,t){return e===t||e+""==t+""}function t4(e,t,n,i,r,s){return t=t||new i(e.loader()),t.initialize(n,J6(e),Z6(e),x1(e),r,s).background(e.background())}function XS(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Eue(e,t,n,i){const r=new i(e.loader(),XS(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,x1(e),e);return t&&t.handlers().forEach(s=>{r.on(s.type,s.handler)}),r}function Sue(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,s=o1(i);e=n._el=e?Iv(n,e,!0):null,Yae(n),s||n.error("Unrecognized renderer type: "+i);const o=s.handler||Ch,a=e?s.renderer:s.headless;return n._renderer=a?t4(n,n._renderer,e,a):null,n._handler=Eue(n,n._handler,e,o),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=Iv(n,t,!0):e.appendChild(bi("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=Iv(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{pue(n,u.element||t,u)})),n}function Iv(e,t,n){if(typeof t=="string")if(typeof document<"u"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.textContent=""}catch(i){t=null,e.error(i)}return t}const pf=e=>+e||0,$ue=e=>({top:e,bottom:e,left:e,right:e});function nT(e){return ae(e)?{top:pf(e.top),bottom:pf(e.bottom),left:pf(e.left),right:pf(e.right)}:$ue(pf(e))}async function KS(e,t,n,i){const r=o1(t),s=r&&r.headless;return s||q("Unrecognized renderer type: "+t),await e.runAsync(),t4(e,null,null,s,n,i).renderAsync(e._scenegraph.root)}async function Aue(e,t){e!==Do.Canvas&&e!==Do.SVG&&e!==Do.PNG&&q("Unrecognized image type: "+e);const n=await KS(this,e,t);return e===Do.SVG?Cue(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Cue(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function kue(e,t){return(await KS(this,Do.Canvas,e,t)).canvas()}async function Mue(e){return(await KS(this,Do.SVG,e)).svg()}function Fue(e,t,n){return X6(e,jl,Vd,n).parse(t)}function Tue(e){var t=this._runtime.scales;return fe(t,e)||q("Unrecognized scale or projection: "+e),t[e].value}var n4="width",i4="height",QS="padding",iT={skip:!0};function r4(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===QS?i.left+i.right:0)}function s4(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===QS?i.top+i.bottom:0)}function Rue(e){var t=e._signals,n=t[n4],i=t[i4],r=t[QS];function s(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,a=>{e._width=a.size,e._viewWidth=r4(e,a.size),s()},{size:n}),e._resizeHeight=e.add(null,a=>{e._height=a.size,e._viewHeight=s4(e,a.size),s()},{size:i});const o=e.add(null,s,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function Oue(e,t,n,i,r,s){this.runAfter(o=>{let a=0;o._autosize=0,o.width()!==n&&(a=1,o.signal(n4,n,iT),o._resizeWidth.skip(!0)),o.height()!==i&&(a=1,o.signal(i4,i,iT),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),a&&o.run("enter"),s&&o.runAfter(u=>u.resize())},!1,1)}function Due(e){return this._runtime.getState(e||{data:Nue,signals:Pue,recurse:!0})}function Nue(e,t){return t.modified&&G(t.input.value)&&!e.startsWith("_:vega:_")}function Pue(e,t){return!(e==="parent"||t instanceof jl.proxy)}function Iue(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Lue(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(une(n,t))}function zue(e,t,n,i){const r=e.element();r&&r.setAttribute("title",Bue(i))}function Bue(e){return e==null?"":G(e)?o4(e):ae(e)&&!Uo(e)?Uue(e):e+""}function Uue(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(G(n)?o4(n):a4(n))}).join(`
`)}function o4(e){return"["+e.map(a4).join(", ")+"]"}function a4(e){return G(e)?"[]":ae(e)&&!Uo(e)?"{}":e}function jue(){if(this.renderer()==="canvas"&&this._renderer._canvas){let e=null;const t=()=>{e?.();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};t()}}function u4(e,t){const n=this;if(t=t||{},El.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const s=Fe({},e.locale,t.locale);n.locale(r3(s.number,s.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Do.Canvas,n._scenegraph=new nI;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||zue,n._redraw=!0,n._handler=new Ch().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=oue(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=Fue(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(s=>({state:null,param:Fe({},s)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=r4(n,n._width),n._viewHeight=s4(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Rue(n),Xae(n),Kae(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio()}function Mp(e,t){return fe(e._signals,t)?e._signals[t]:q("Unrecognized signal name: "+ee(t))}function l4(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function rT(e,t,n,i){let r=l4(n,i);return r||(r=XS(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function sT(e,t,n){const i=l4(t,n);return i&&t._targets.remove(i),e}te(u4,El,{async evaluate(e,t,n){if(await El.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,eue(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Vp(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Q6(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=Mp(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",nT(e)):nT(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(o1(e)||q("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(El.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Mp(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Oue,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=XS(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,s;--i>=0;)if(s=n[i].type,r=n[i].handler,e===s&&(t===r||t===r.raw)){this._handler.off(s,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return rT(this,e,Mp(this,e),t)},removeSignalListener(e,t){return sT(this,Mp(this,e),t)},addDataListener(e,t){return rT(this,e,Im(this,e).values,t)},removeDataListener(e,t){return sT(this,Im(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=fw(this,null);this._globalCursor=!!e,t&&fw(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Lue,events:uue,finalize:cue,hover:lue,data:Qae,change:b1,insert:Jae,remove:Zae,scale:Tue,initialize:Sue,toImageURL:Aue,toCanvas:kue,toSVG:Mue,getState:Due,setState:Iue,_watchPixelRatio:jue});const que="view",zm="[",Bm="]",c4="{",f4="}",Wue=":",d4=",",Hue="@",Gue=">",Vue=/[[\]{}]/,Yue={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let h4,p4;function pa(e,t,n){return h4=t||que,p4=n||Yue,g4(e.trim()).map(dw)}function Xue(e){return p4[e]}function yd(e,t,n,i,r){const s=e.length;let o=0,a;for(;t<s;++t){if(a=e[t],!o&&a===n)return t;r&&r.includes(a)?--o:i&&i.includes(a)&&++o}return t}function g4(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=yd(e,r,d4,zm+c4,Bm+f4),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function dw(e){return e[0]==="["?Kue(e):Que(e)}function Kue(e){const t=e.length;let n=1,i;if(n=yd(e,n,Bm,zm,Bm),n===t)throw"Empty between selector: "+e;if(i=g4(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Gue)throw"Expected '>' after between selector: "+e;i=i.map(dw);const r=dw(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Que(e){const t={source:h4},n=[];let i=[0,0],r=0,s=0,o=e.length,a=0,u,l;if(e[o-1]===f4){if(a=e.lastIndexOf(c4),a>=0){try{i=Jue(e.substring(a+1,o-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,a).trim(),o=e.length}else throw"Unmatched right brace: "+e;a=0}if(!o)throw e;if(e[0]===Hue&&(r=++a),u=yd(e,a,Wue),u<o&&(n.push(e.substring(s,u).trim()),s=a=++u),a=yd(e,a,zm),a===o)n.push(e.substring(s,o).trim());else if(n.push(e.substring(s,a).trim()),l=[],s=++a,s===o)throw"Unmatched left bracket: "+e;for(;a<o;){if(a=yd(e,a,Bm),a===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(s,a).trim()),a<o-1&&e[++a]!==zm)throw"Expected left bracket: "+e;s=++a}if(!(o=n.length)||Vue.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],r?t.markname=n[0].slice(1):Xue(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function Jue(e){const t=e.split(d4);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Zue(e){return ae(e)?e:{type:e||"pad"}}const gf=e=>+e||0,ele=e=>({top:e,bottom:e,left:e,right:e});function tle(e){return ae(e)?e.signal?e:{top:gf(e.top),bottom:gf(e.bottom),left:gf(e.left),right:gf(e.right)}:ele(gf(e))}const qt=e=>ae(e)&&!G(e)?Fe({},e):{value:e};function oT(e,t,n,i){return n!=null?(ae(n)&&!G(n)||G(n)&&n.length&&ae(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function rn(e,t,n){for(const i in t)oT(e,i,t[i]);for(const i in n)oT(e,i,n[i],"update")}function Pc(e,t,n){for(const i in t)n&&fe(n,i)||(e[i]=Fe(e[i]||{},t[i]));return e}function cl(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const JS="mark",ZS="frame",e$="scope",nle="axis",ile="axis-domain",rle="axis-grid",sle="axis-label",ole="axis-tick",ale="axis-title",ule="legend",lle="legend-band",cle="legend-entry",fle="legend-gradient",m4="legend-label",dle="legend-symbol",hle="legend-title",ple="title",gle="title-text",mle="title-subtitle";function yle(e,t,n,i,r){const s={},o={};let a,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!cl(u,e)&&Lv(s,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===ZS?r.group:n===JS?Fe({},r.mark,r[t]):null;for(u in c)l=cl(u,e)||(u==="fill"||u==="stroke")&&(cl("fill",e)||cl("stroke",e)),l||Lv(s,u,c[u]);le(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)cl(h,e)||Lv(s,h,d[h])}),e=Fe({},e);for(u in s)c=s[u],c.signal?(a=a||{})[u]=c:o[u]=c;return e.enter=Fe(o,e.enter),a&&(e.update=Fe(a,e.update)),e}function Lv(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const y4=e=>oe(e)?ee(e):e.signal?`(${e.signal})`:v4(e);function w1(e){if(e.gradient!=null)return ble(e);let t=e.signal?`(${e.signal})`:e.color?vle(e.color):e.field!=null?v4(e.field):e.value!==void 0?ee(e.value):void 0;return e.scale!=null&&(t=xle(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${fg(e.exponent)})`),e.mult!=null&&(t+=`*${fg(e.mult)}`),e.offset!=null&&(t+=`+${fg(e.offset)}`),e.round&&(t=`round(${t})`),t}const Fp=(e,t,n,i)=>`(${e}(${[t,n,i].map(w1).join(",")})+'')`;function vle(e){return e.c?Fp("hcl",e.h,e.c,e.l):e.h||e.s?Fp("hsl",e.h,e.s,e.l):e.l||e.a?Fp("lab",e.l,e.a,e.b):e.r||e.g||e.b?Fp("rgb",e.r,e.g,e.b):null}function ble(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:ee(n));for(;t.length&&ze(t)==null;)t.pop();return t.unshift(y4(e.gradient)),`gradient(${t.join(",")})`}function fg(e){return ae(e)?"("+w1(e)+")":e}function v4(e){return b4(ae(e)?e:{datum:e})}function b4(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):q("Invalid field reference: "+ee(e));return e.signal||(i=oe(i)?ls(i).map(ee).join("]["):b4(i)),t+"["+i+"]"}function xle(e,t){const n=y4(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+fg(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function wle(e){let t="";return e.forEach(n=>{const i=w1(n);t+=n.test?`(${n.test})?${i}:`:i}),ze(t)===":"&&(t+="null"),t}function x4(e,t,n,i,r,s){const o={};s=s||{},s.encoders={$encode:o},e=yle(e,t,n,i,r.config);for(const a in e)o[a]=_le(e[a],t,s,r);return s}function _le(e,t,n,i){const r={},s={};for(const o in e)e[o]!=null&&(r[o]=Sle(Ele(e[o]),i,n,s));return{$expr:{marktype:t,channels:r},$fields:Object.keys(s),$output:Object.keys(e)}}function Ele(e){return G(e)?wle(e):w1(e)}function Sle(e,t,n,i){const r=ss(e,t);return r.$fields.forEach(s=>i[s]=1),Fe(n,r.$params),r.$expr}const $le="outer",Ale=["value","update","init","react","bind"];function aT(e,t){q(e+' for "outer" push: '+ee(t))}function w4(e,t){const n=e.name;if(e.push===$le)t.signals[n]||aT("No prior signal definition",n),Ale.forEach(i=>{e[i]!==void 0&&aT("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function hw(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function _1(e,t,n,i){return new hw(e,t,n,i)}function Um(e,t){return _1("operator",e,t)}function ve(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Yd(e,t){return t?{$field:e,$name:t}:{$field:e}}const pw=Yd("key");function uT(e,t){return{$compare:e,$order:t}}function Cle(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const kle="ascending",Mle="descending";function Fle(e){return ae(e)?(e.order===Mle?"-":"+")+E1(e.op,e.field):""}function E1(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const t$="scope",gw="view";function Pt(e){return e&&e.signal}function Tle(e){return e&&e.expr}function dg(e){if(Pt(e))return!0;if(ae(e)){for(const t in e)if(dg(e[t]))return!0}return!1}function Qi(e,t){return e??t}function eu(e){return e&&e.signal||e}const lT="timer";function Xd(e,t){return(e.merge?Ole:e.stream?Dle:e.type?Nle:q("Invalid stream specification: "+ee(e)))(e,t)}function Rle(e){return e===t$?gw:e||gw}function Ole(e,t){const n=e.merge.map(r=>Xd(r,t)),i=n$({merge:n},e,t);return t.addStream(i).id}function Dle(e,t){const n=Xd(e.stream,t),i=n$({stream:n},e,t);return t.addStream(i).id}function Nle(e,t){let n;e.type===lT?(n=t.event(lT,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Rle(e.source),e.type);const i=n$({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function n$(e,t,n){let i=t.between;return i&&(i.length!==2&&q('Stream "between" parameter must have 2 entries: '+ee(t)),e.between=[Xd(i[0],n),Xd(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Ple(t.marktype,t.markname,t.markrole)),t.source===t$&&i.push("inScope(event.item)"),i.length&&(e.filter=ss("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Ple(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Ile={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Lle(e,t,n){const i=e.encode,r={target:n};let s=e.events,o=e.update,a=[];s||q("Signal update missing events specification."),oe(s)&&(s=pa(s,t.isSubscope()?t$:gw)),s=le(s).filter(u=>u.signal||u.scale?(a.push(u),0):1),a.length>1&&(a=[Ble(a)]),s.length&&a.push(s.length>1?{merge:s}:s[0]),i!=null&&(o&&q("Signal encode and update are mutually exclusive."),o="encode(item(),"+ee(i)+")"),r.update=oe(o)?ss(o,t):o.expr!=null?ss(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:Ile,$params:{$value:t.signalRef(o.signal)}}:q("Invalid signal update specification."),e.force&&(r.options={force:!0}),a.forEach(u=>t.addUpdate(Fe(zle(u,t),r)))}function zle(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Xd(e,t)}}function Ble(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Ule(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?q("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=ss(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>Lle(r,t,n.id))}const st=e=>(t,n,i)=>_1(e,n,t||void 0,i),_4=st("aggregate"),jle=st("axisticks"),E4=st("bound"),wr=st("collect"),cT=st("compare"),qle=st("datajoin"),S4=st("encode"),Wle=st("expression"),Hle=st("facet"),Gle=st("field"),Vle=st("key"),Yle=st("legendentries"),Xle=st("load"),Kle=st("mark"),Qle=st("multiextent"),Jle=st("multivalues"),Zle=st("overlap"),ece=st("params"),$4=st("prefacet"),tce=st("projection"),nce=st("proxy"),ice=st("relay"),A4=st("render"),rce=st("scale"),Iu=st("sieve"),sce=st("sortitems"),C4=st("viewlayout"),oce=st("values");let ace=0;const k4={min:"min",max:"max",count:"sum"};function uce(e,t){const n=e.type||"linear";g5(n)||q("Unrecognized scale type: "+ee(n)),t.addScale(e.name,{type:n,domain:void 0})}function lce(e,t){const n=t.getScale(e.name).params;let i;n.domain=M4(e.domain,e,t),e.range!=null&&(n.range=T4(e,t,n)),e.interpolate!=null&&bce(e.interpolate,n),e.nice!=null&&(n.nice=vce(e.nice,t)),e.bins!=null&&(n.bins=yce(e.bins,t));for(i in e)fe(n,i)||i==="name"||(n[i]=Ri(e[i],t))}function Ri(e,t){return ae(e)?e.signal?t.signalRef(e.signal):q("Unsupported object: "+ee(e)):e}function hg(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Ri(n,t))}function S1(e){q("Can not find data set: "+ee(e))}function M4(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&q("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(G(e)?cce:e.fields?dce:fce)(e,t,n)}function cce(e,t,n){return e.map(i=>Ri(i,n))}function fce(e,t,n){const i=n.getData(e.data);return i||S1(e.data),Vl(t.type)?i.valuesRef(n,e.field,F4(e.sort,!1)):v5(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function dce(e,t,n){const i=e.data,r=e.fields.reduce((s,o)=>(o=oe(o)?{data:i,field:o}:G(o)||o.signal?hce(o,n):o,s.push(o),s),[]);return(Vl(t.type)?pce:v5(t.type)?gce:mce)(e,n,r)}function hce(e,t){const n="_:vega:_"+ace++,i=wr({});if(G(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+ee(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,Iu({})]),{data:n,field:"data"}}function pce(e,t,n){const i=F4(e.sort,!0);let r,s;const o=n.map(l=>{const c=t.getData(l.data);return c||S1(l.data),c.countsRef(t,l.field,i)}),a={groupby:pw,pulse:o};i&&(r=i.op||"count",s=i.field?E1(r,i.field):"count",a.ops=[k4[r]],a.fields=[t.fieldRef(s)],a.as=[s]),r=t.add(_4(a));const u=t.add(wr({pulse:ve(r)}));return s=t.add(oce({field:pw,sort:t.sortRef(i),pulse:ve(u)})),ve(s)}function F4(e,t){return e&&(!e.field&&!e.op?ae(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?q("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!k4[e.op]&&q("Multiple domain scales can not be sorted using "+e.op)),e}function gce(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||S1(r.data),s.domainRef(t,r.field)});return ve(t.add(Jle({values:i})))}function mce(e,t,n){const i=n.map(r=>{const s=t.getData(r.data);return s||S1(r.data),s.extentRef(t,r.field)});return ve(t.add(Qle({extents:i})))}function yce(e,t){return e.signal||G(e)?hg(e,t):t.objectProperty(e)}function vce(e,t){return e.signal?t.signalRef(e.signal):ae(e)?{interval:Ri(e.interval),step:Ri(e.step)}:Ri(e)}function bce(e,t){t.interpolate=Ri(e.type||e),e.gamma!=null&&(t.interpolateGamma=Ri(e.gamma))}function T4(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(oe(r)){if(i&&fe(i,r))return e=Fe({},e,{range:i[r]}),T4(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Vl(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:q("Unrecognized scale range value: "+ee(r))}else if(r.scheme){n.scheme=G(r.scheme)?hg(r.scheme,t):Ri(r.scheme,t),r.extent&&(n.schemeExtent=hg(r.extent,t)),r.count&&(n.schemeCount=Ri(r.count,t));return}else if(r.step){n.rangeStep=Ri(r.step,t);return}else{if(Vl(e.type)&&!G(r))return M4(r,e,t);G(r)||q("Unsupported range type: "+ee(r))}return r.map(s=>(G(s)?hg:Ri)(s,t))}function xce(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=mw(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=mw(n[r],r,t));t.addProjection(e.name,i)}function mw(e,t,n){return G(e)?e.map(i=>mw(i,t,n)):ae(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:q("Unsupported parameter object: "+ee(e)):e}const _r="top",Ic="left",Lc="right",na="bottom",R4="center",wce="vertical",_ce="start",Ece="middle",Sce="end",yw="index",i$="label",$ce="offset",nc="perc",Ace="perc2",Di="value",Ph="guide-label",r$="guide-title",Cce="group-title",kce="group-subtitle",fT="symbol",pg="gradient",vw="discrete",bw="size",Mce="shape",Fce="fill",Tce="stroke",Rce="strokeWidth",Oce="strokeDash",Dce="opacity",s$=[bw,Mce,Fce,Tce,Rce,Oce,Dce],Ih={name:1,style:1,interactive:1},je={value:0},Ni={value:1},$1="group",O4="rect",o$="rule",Nce="symbol",Lu="text";function Kd(e){return e.type=$1,e.interactive=e.interactive||!1,e}function ai(e,t){const n=(i,r)=>Qi(e[i],Qi(t[i],r));return n.isVertical=i=>wce===Qi(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>Qi(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>Qi(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>Qi(e.columns,Qi(t.columns,+n.isVertical(!0))),n}function D4(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Pce(e,t,n){const i=t.config.style[n];return i&&i[e]}function A1(e,t,n){return`item.anchor === '${_ce}' ? ${e} : item.anchor === '${Sce}' ? ${t} : ${n}`}const a$=A1(ee(Ic),ee(Lc),ee(R4));function Ice(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},ae(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function N4(e,t){return t?e?ae(e)?Object.assign({},e,{offset:N4(e.offset,t)}):{value:e,offset:t}:t:e}function $i(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Pc(e.encode,t,Ih)):e.interactive=!1,e}function Lce(e,t,n,i){const r=ai(e,n),s=r.isVertical(),o=r.gradientThickness(),a=r.gradientLength();let u,l,c,f,d;s?(l=[0,1],c=[0,0],f=o,d=a):(l=[0,0],c=[1,0],f=a,d=o);const h={enter:u={opacity:je,x:je,y:je,width:qt(f),height:qt(d)},update:Fe({},u,{opacity:Ni,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:je}};return rn(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),$i({type:O4,role:fle,encode:h},i)}function zce(e,t,n,i,r){const s=ai(e,n),o=s.isVertical(),a=s.gradientThickness(),u=s.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:je,fill:{scale:t,field:Di}};p[l]={signal:h+"datum."+nc,mult:u},p[c]=je,p[f]={signal:h+"datum."+Ace,mult:u},p[d]=qt(a);const g={enter:p,update:Fe({},p,{opacity:Ni}),exit:{opacity:je}};return rn(g,{stroke:s("gradientStrokeColor"),strokeWidth:s("gradientStrokeWidth")},{opacity:s("gradientOpacity")}),$i({type:O4,role:lle,key:Di,from:r,encode:g},i)}const Bce=`datum.${nc}<=0?"${Ic}":datum.${nc}>=1?"${Lc}":"${R4}"`,Uce=`datum.${nc}<=0?"${na}":datum.${nc}>=1?"${_r}":"${Ece}"`;function dT(e,t,n,i){const r=ai(e,t),s=r.isVertical(),o=qt(r.gradientThickness()),a=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:je},update:c={opacity:Ni,text:{field:i$}},exit:{opacity:je}};return rn(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:Qi(e.labelLimit,t.gradientLabelLimit)}),s?(l.align={value:"left"},l.baseline=c.baseline={signal:Uce},f="y",d="x",h="1-"):(l.align=c.align={signal:Bce},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+nc,mult:a},l[d]=c[d]=o,o.offset=Qi(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+yw}:void 0,$i({type:Lu,role:m4,style:Ph,key:Di,from:i,encode:p,overlap:u},n)}function jce(e,t,n,i,r){const s=ai(e,t),o=n.entries,a=!!(o&&o.interactive),u=o?o.name:void 0,l=s("clipHeight"),c=s("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${$ce} : datum.${bw}`,h=l?qt(l):{field:bw},p=`datum.${yw}`,g=`max(1, ${r})`;let m,y,v,b,x;h.mult=.5,m={enter:y={opacity:je,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Ni,x:y.x,y:y.y},exit:{opacity:je}};let w=null,E=null;e.fill||(w=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),rn(m,{fill:s("symbolFillColor",w),shape:s("symbolType"),size:s("symbolSize"),stroke:s("symbolStrokeColor",E),strokeDash:s("symbolDash"),strokeDashOffset:s("symbolDashOffset"),strokeWidth:s("symbolStrokeWidth")},{opacity:s("symbolOpacity")}),s$.forEach(F=>{e[F]&&(v[F]=y[F]={scale:e[F],field:Di})});const _=$i({type:Nce,role:dle,key:Di,from:f,clip:l?!0:void 0,encode:m},n.symbols),$=qt(c);$.offset=s("labelOffset"),m={enter:y={opacity:je,x:{signal:d,offset:$},y:h},update:v={opacity:Ni,text:{field:i$},x:y.x,y:y.y},exit:{opacity:je}},rn(m,{align:s("labelAlign"),baseline:s("labelBaseline"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:s("labelLimit")});const A=$i({type:Lu,role:m4,style:Ph,key:Di,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:je,height:l?qt(l):je,opacity:je},exit:{opacity:je},update:v={opacity:Ni,row:{signal:null},column:{signal:null}}},s.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${b}`,v.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,x={field:p}),v.column.signal=`(${r})?${v.column.signal}:${p}`,i={facet:{data:i,name:"value",groupby:yw}},Kd({role:e$,from:i,encode:Pc(m,o,Ih),marks:[_,A],name:u,interactive:a,sort:x})}function qce(e,t){const n=ai(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const u$='item.orient === "left"',l$='item.orient === "right"',C1=`(${u$} || ${l$})`,Wce=`datum.vgrad && ${C1}`,Hce=A1('"top"','"bottom"','"middle"'),Gce=A1('"right"','"left"','"center"'),Vce=`datum.vgrad && ${l$} ? (${Gce}) : (${C1} && !(datum.vgrad && ${u$})) ? "left" : ${a$}`,Yce=`item._anchor || (${C1} ? "middle" : "start")`,Xce=`${Wce} ? (${u$} ? -90 : 90) : 0`,Kce=`${C1} ? (datum.vgrad ? (${l$} ? "bottom" : "top") : ${Hce}) : "top"`;function Qce(e,t,n,i){const r=ai(e,t),s={enter:{opacity:je},update:{opacity:Ni,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:je}};return rn(s,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:Yce},angle:{signal:Xce},align:{signal:Vce},baseline:{signal:Kce},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),$i({type:Lu,role:hle,style:r$,from:i,encode:s},n)}function Jce(e,t){let n;return ae(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+hT(e.path)+")":e.sphere&&(n="geoShape("+hT(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function hT(e){return ae(e)&&e.signal?e.signal:ee(e)}function P4(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===$1?e$:t||JS}function Zce(e){return{marktype:e.type,name:e.name||void 0,role:e.role||P4(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function efe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function c$(e,t){const n=y3(e.type);n||q("Unrecognized transform type: "+ee(e.type));const i=_1(n.type.toLowerCase(),null,I4(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function I4(e,t,n){const i={},r=e.params.length;for(let s=0;s<r;++s){const o=e.params[s];i[o.name]=tfe(o,t,n)}return i}function tfe(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return nfe(e,t,n);if(r===void 0){e.required&&q("Missing required "+ee(t.type)+" parameter: "+ee(e.name));return}else{if(i==="param")return ife(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!Pt(r)?r.map(s=>pT(e,s,n)):pT(e,r,n)}function pT(e,t,n){const i=e.type;if(Pt(t))return mT(i)?q("Expression references can not be signals."):zv(i)?n.fieldRef(t):yT(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||zv(i);return r&&rfe(t)?n.exprRef(t.expr,t.as):r&&sfe(t)?Yd(t.field,t.as):mT(i)?ss(t,n):ofe(i)?ve(n.getData(t).values):zv(i)?Yd(t):yT(i)?n.compareRef(t):t}}function nfe(e,t,n){return oe(t.from)||q('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function ife(e,t,n){const i=t[e.name];return e.array?(G(i)||q("Expected an array of sub-parameters. Instead: "+ee(i)),i.map(r=>gT(e,r,n))):gT(e,i,n)}function gT(e,t,n){const i=e.params.length;let r;for(let o=0;o<i;++o){r=e.params[o];for(const a in r.key)if(r.key[a]!==t[a]){r=null;break}if(r)break}r||q("Unsupported parameter: "+ee(t));const s=Fe(I4(r,t,n),r.key);return ve(n.add(ece(s)))}const rfe=e=>e&&e.expr,sfe=e=>e&&e.field,ofe=e=>e==="data",mT=e=>e==="expr",zv=e=>e==="field",yT=e=>e==="compare";function afe(e,t,n){let i,r,s,o,a;return e?(i=e.facet)&&(t||q("Only group marks can be faceted."),i.field!=null?o=a=gg(i,n):(e.data?a=ve(n.getData(e.data).aggregate):(s=c$(Fe({type:"aggregate",groupby:le(i.groupby)},i.aggregate),n),s.params.key=n.keyRef(i.groupby),s.params.pulse=gg(i,n),o=a=ve(n.add(s))),r=n.keyRef(i.groupby,!0))):o=ve(n.add(wr(null,[{}]))),o||(o=gg(e,n)),{key:r,pulse:o,parent:a}}function gg(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ve(t.getData(e.data).output)}function vu(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}vu.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let s=t[0],o=null,a=1;for(s&&s.type==="load"&&(s=t[1]),e.add(t[0]);a<n;++a)t[a].params.pulse=ve(t[a-1]),e.add(t[a]),t[a].type==="aggregate"&&(o=t[a]);return new vu(e,s,r,i,o)};function L4(e){return oe(e)?e:null}function vT(e,t,n){const i=E1(n.op,n.field);let r;if(t.ops){for(let s=0,o=t.as.length;s<o;++s)if(t.as[s]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function mf(e,t,n,i,r,s,o){const a=t[n]||(t[n]={}),u=Fle(s);let l=L4(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=a[l]),!c){const d=s?{field:pw,pulse:t.countsRef(e,r,s)}:{field:e.fieldRef(r),pulse:ve(t.output)};u&&(d.sort=e.sortRef(s)),f=e.add(_1(i,void 0,d)),o&&(t.index[r]=f),c=ve(f),l!=null&&(a[l]=c)}return c}vu.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),s=L4(t);let o,a,u;return s!=null&&(e=i.scope,o=r[s]),o?n&&n.field&&vT(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ve(i.output)},n&&n.field&&vT(e,u,n),a=e.add(_4(u)),o=e.add(wr({pulse:ve(a)})),o={agg:a,ref:ve(o)},s!=null&&(r[s]=o)),o.ref},tuplesRef(){return ve(this.values)},extentRef(e,t){return mf(e,this,"extent","extent",t,!1)},domainRef(e,t){return mf(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return mf(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return mf(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return mf(e,this,"indata","tupleindex",t,!0,!0)}};function ufe(e,t,n){const i=e.from.facet,r=i.name,s=gg(i,t);let o;i.name||q("Facet must have a name: "+ee(i)),i.data||q("Facet must reference a data set: "+ee(i)),i.field?o=t.add($4({field:t.fieldRef(i.field),pulse:s})):i.groupby?o=t.add(Hle({key:t.keyRef(i.groupby),group:ve(t.proxy(n.parent)),pulse:s})):q("Facet must specify groupby or field: "+ee(i));const a=t.fork(),u=a.add(wr()),l=a.add(Iu({pulse:ve(u)}));a.addData(r,new vu(a,u,u,l)),a.addSignal("parent",null),o.params.subflow={$subflow:a.parse(e).toRuntime()}}function lfe(e,t,n){const i=t.add($4({pulse:n.pulse})),r=t.fork();r.add(Iu()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function z4(e,t,n){const i=e.remove,r=e.insert,s=e.toggle,o=e.modify,a=e.values,u=t.add(Um()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,s,o,a].map(f=>f??"null").join(",")+"),0)",c=ss(l,t);u.update=c.$expr,u.params=c.$params}function k1(e,t){const n=P4(e),i=e.type===$1,r=e.from&&e.from.facet,s=e.overlap;let o=e.layout||n===e$||n===ZS,a,u,l,c,f,d,h;const p=n===JS||o||r,g=afe(e.from,i,t);u=t.add(qle({key:g.key||(e.key?Yd(e.key):void 0),pulse:g.pulse,clean:!i}));const m=ve(u);u=l=t.add(wr({pulse:m})),u=t.add(Kle({markdef:Zce(e),interactive:efe(e.interactive,t),clip:Jce(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ve(u)}));const y=ve(u);u=c=t.add(S4(x4(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const _=c$(E,t),$=_.metadata;($.generates||$.changes)&&q("Mark transforms should not generate new data."),$.nomod||(c.params.mod=!0),_.params.pulse=ve(u),t.add(u=_)}),e.sort&&(u=t.add(sce({sort:t.compareRef(e.sort),pulse:ve(u)})));const v=ve(u);(r||o)&&(o=t.add(C4({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ve(o));const b=t.add(E4({mark:y,pulse:d||v}));h=ve(b),i&&(p&&(a=t.operators,a.pop(),o&&a.pop()),t.pushState(v,d||h,m),r?ufe(e,t,g):p?lfe(e,t,g):t.parse(e),t.popState(),p&&(o&&a.push(o),a.push(b))),s&&(h=cfe(s,h,t));const x=t.add(A4({pulse:h})),w=t.add(Iu({pulse:ve(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new vu(t,l,x,w)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&q("Marks only support modify triggers."),z4(E,t,f)}))}function cfe(e,t,n){const i=e.method,r=e.bound,s=e.separation,o={separation:Pt(s)?n.signalRef(s.signal):s,method:Pt(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),r){const a=r.tolerance;o.boundTolerance=Pt(a)?n.signalRef(a.signal):+a,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return ve(n.add(Zle(o)))}function ffe(e,t){const n=t.config.legend,i=e.encode||{},r=ai(e,n),s=i.legend||{},o=s.name||void 0,a=s.interactive,u=s.style,l={};let c=0,f,d,h;s$.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||q("Missing valid scale for legend.");const p=dfe(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&r.isVertical()},m=ve(t.add(wr(null,[g]))),y={enter:{x:{value:0},y:{value:0}}},v=ve(t.add(Yle(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===pg?(h=[Lce(e,c,n,i.gradient),dT(e,n,i.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${eu(r.gradientLength())})/100))`)):p===vw?h=[zce(e,c,n,i.gradient,v),dT(e,n,i.labels,v)]:(f=qce(e,n),h=[jce(e,n,i,v,eu(f.columns))],d.size=gfe(e,t,h[0].marks)),h=[Kd({role:cle,from:m,encode:y,marks:h,layout:f,interactive:a})],g.title&&h.push(Qce(e,n,i.title,m)),k1(Kd({role:ule,from:m,encode:Pc(pfe(r,e,n),s,Ih),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:a,style:u}),t)}function dfe(e,t){let n=e.type||fT;return!e.type&&hfe(e)===1&&(e.fill||e.stroke)&&(n=cE(t)?pg:cx(t)?vw:fT),n!==pg?n:cx(t)?vw:pg}function hfe(e){return s$.reduce((t,n)=>t+(e[n]?1:0),0)}function pfe(e,t,n){const i={enter:{},update:{}};return rn(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function gfe(e,t,n){const i=eu(bT("size",e,n)),r=eu(bT("strokeWidth",e,n)),s=eu(mfe(n[1].encode,t,Ph));return ss(`max(ceil(sqrt(${i})+${r}),${s})`,t)}function bT(e,t,n){return t[e]?`scale("${t[e]}",datum)`:D4(e,n[0].encode)}function mfe(e,t,n){return D4("fontSize",e)||Pce("fontSize",t,n)}const yfe=`item.orient==="${Ic}"?-90:item.orient==="${Lc}"?90:0`;function vfe(e,t){e=oe(e)?{text:e}:e;const n=ai(e,t.config.title),i=e.encode||{},r=i.group||{},s=r.name||void 0,o=r.interactive,a=r.style,u=[],l={},c=ve(t.add(wr(null,[l])));return u.push(wfe(e,n,bfe(e),c)),e.subtitle&&u.push(_fe(e,n,i.subtitle,c)),k1(Kd({role:ple,from:c,encode:xfe(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:s,interactive:o,style:a}),t)}function bfe(e){const t=e.encode;return t&&t.title||Fe({name:e.name,interactive:e.interactive,style:e.style},t)}function xfe(e,t){const n={enter:{},update:{}};return rn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:a$},angle:{signal:yfe},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Pc(n,t,Ih)}function wfe(e,t,n,i){const r={value:0},s=e.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return rn(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$i({type:Lu,role:gle,style:Cce,from:i,encode:o},n)}function _fe(e,t,n,i){const r={value:0},s=e.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return rn(o,{text:s,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),$i({type:Lu,role:mle,style:kce,from:i,encode:o},n)}function Efe(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(c$(i,t))}),e.on&&e.on.forEach(i=>{z4(i,t,e.name)}),t.addDataPipeline(e.name,Sfe(e,t,n))}function Sfe(e,t,n){const i=[];let r=null,s=!1,o=!1,a,u,l,c,f;for(e.values?Pt(e.values)||dg(e.format)?(i.push(xT(t,e)),i.push(r=Ca())):i.push(r=Ca({$ingest:e.values,$format:e.format})):e.url?dg(e.url)||dg(e.format)?(i.push(xT(t,e)),i.push(r=Ca())):i.push(r=Ca({$request:e.url,$format:e.format})):e.source&&(r=a=le(e.source).map(d=>ve(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=Ca()),i.push(c),f.generates&&(o=!0),f.modifies&&!o&&(s=!0),f.source?r=c:f.changes&&(r=null);return a&&(l=a.length-1,i[0]=ice({derive:s,pulse:l?a:a[0]}),(s||l)&&i.splice(1,0,Ca())),r||i.push(Ca()),i.push(Iu({})),i}function Ca(e){const t=wr({},e);return t.metadata={source:!0},t}function xT(e,t){return Xle({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const B4=e=>e===na||e===_r,M1=(e,t,n)=>Pt(e)?kfe(e.signal,t,n):e===Ic||e===_r?t:n,Wt=(e,t,n)=>Pt(e)?Afe(e.signal,t,n):B4(e)?t:n,cr=(e,t,n)=>Pt(e)?Cfe(e.signal,t,n):B4(e)?n:t,U4=(e,t,n)=>Pt(e)?Mfe(e.signal,t,n):e===_r?{value:t}:{value:n},$fe=(e,t,n)=>Pt(e)?Ffe(e.signal,t,n):e===Lc?{value:t}:{value:n},Afe=(e,t,n)=>j4(`${e} === '${_r}' || ${e} === '${na}'`,t,n),Cfe=(e,t,n)=>j4(`${e} !== '${_r}' && ${e} !== '${na}'`,t,n),kfe=(e,t,n)=>f$(`${e} === '${Ic}' || ${e} === '${_r}'`,t,n),Mfe=(e,t,n)=>f$(`${e} === '${_r}'`,t,n),Ffe=(e,t,n)=>f$(`${e} === '${Lc}'`,t,n),j4=(e,t,n)=>(t=t!=null?qt(t):t,n=n!=null?qt(n):n,wT(t)&&wT(n)?(t=t?t.signal||ee(t.value):null,n=n?n.signal||ee(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Fe({test:e},t)].concat(n||[])),wT=e=>e==null||Object.keys(e).length===1,f$=(e,t,n)=>({signal:`${e} ? (${yl(t)}) : (${yl(n)})`}),Tfe=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${Ic}' ? (${yl(i)}) : `:"")+(n!=null?`${e} === '${na}' ? (${yl(n)}) : `:"")+(r!=null?`${e} === '${Lc}' ? (${yl(r)}) : `:"")+(t!=null?`${e} === '${_r}' ? (${yl(t)}) : `:"")+"(null)"}),yl=e=>Pt(e)?e.signal:e==null?null:ee(e),Rfe=(e,t)=>t===0?0:Pt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},Cl=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function il(e,t,n,i){let r;if(t&&fe(t,e))return t[e];if(fe(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[r$][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Ph][r]}return null}function _T(e){const t={};for(const n of e)if(n)for(const i in n)t[i]=1;return Object.keys(t)}function Ofe(e,t){var n=t.config,i=n.style,r=n.axis,s=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,a,u,l;if(Pt(o)){const f=_T([n.axisX,n.axisY]),d=_T([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(l of f)a[l]=Wt(o,il(l,n.axisX,r,i),il(l,n.axisY,r,i));u={};for(l of d)u[l]=Tfe(o.signal,il(l,n.axisTop,r,i),il(l,n.axisBottom,r,i),il(l,n.axisLeft,r,i),il(l,n.axisRight,r,i))}else a=o===_r||o===na?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return a||u||s?Fe({},r,a,u,s):r}function Dfe(e,t,n,i){const r=ai(e,t),s=e.orient;let o,a;const u={enter:o={opacity:je},update:a={opacity:Ni},exit:{opacity:je}};rn(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=ET(e,0),c=ET(e,1);return o.x=a.x=Wt(s,l,je),o.x2=a.x2=Wt(s,c),o.y=a.y=cr(s,l,je),o.y2=a.y2=cr(s,c),$i({type:o$,role:ile,from:i,encode:u},n)}function ET(e,t){return{scale:e.scale,range:t}}function Nfe(e,t,n,i,r){const s=ai(e,t),o=e.orient,a=e.gridScale,u=M1(o,1,-1),l=Pfe(e.offset,u);let c,f,d;const h={enter:c={opacity:je},update:d={opacity:Ni},exit:f={opacity:je}};rn(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});const p={scale:e.scale,field:Di,band:r.band,extra:r.extra,offset:r.offset,round:s("tickRound")},g=Wt(o,{signal:"height"},{signal:"width"}),m=a?{scale:a,range:0,mult:u,offset:l}:{value:0,offset:l},y=a?{scale:a,range:1,mult:u,offset:l}:Fe(g,{mult:u,offset:l});return c.x=d.x=Wt(o,p,m),c.y=d.y=cr(o,p,m),c.x2=d.x2=cr(o,y),c.y2=d.y2=Wt(o,y),f.x=Wt(o,p),f.y=cr(o,p),$i({type:o$,role:rle,key:Di,from:i,encode:h},n)}function Pfe(e,t){if(t!==1)if(!ae(e))e=Pt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Fe({},e);for(;n.mult!=null;)if(ae(n.mult))n=n.mult=Fe({},n.mult);else return n.mult=Pt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Ife(e,t,n,i,r,s){const o=ai(e,t),a=e.orient,u=M1(a,-1,1);let l,c,f;const d={enter:l={opacity:je},update:f={opacity:Ni},exit:c={opacity:je}};rn(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=qt(r);h.mult=u;const p={scale:e.scale,field:Di,band:s.band,extra:s.extra,offset:s.offset,round:o("tickRound")};return f.y=l.y=Wt(a,je,p),f.y2=l.y2=Wt(a,h),c.x=Wt(a,p),f.x=l.x=cr(a,je,p),f.x2=l.x2=cr(a,h),c.y=cr(a,p),$i({type:o$,role:ole,key:Di,from:i,encode:d},n)}function Bv(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function Lfe(e,t,n,i,r,s){const o=ai(e,t),a=e.orient,u=e.scale,l=M1(a,-1,1),c=eu(o("labelFlush")),f=eu(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=qt(r);m.mult=l,m.offset=qt(o("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Di,band:.5,offset:N4(s.offset,o("labelOffset"))},v=Wt(a,p?Bv(u,c,'"left"','"right"','"center"'):{value:"center"},$fe(a,"left","right")),b=Wt(a,U4(a,"bottom","top"),p?Bv(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=Bv(u,c,`-(${f})`,f,0);p=p&&f;const w={opacity:je,x:Wt(a,y,m),y:cr(a,y,m)},E={enter:w,update:g={opacity:Ni,text:{field:i$},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:je,x:w.x,y:w.y}};rn(E,{dx:!d&&p?Wt(a,x):null,dy:!h&&p?cr(a,x):null}),rn(E,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const _=o("labelBound");let $=o("labelOverlap");return $=$||_?{separation:o("labelSeparation"),method:$,order:"datum.index",bound:_?{scale:u,orient:a,tolerance:_}:null}:void 0,g.align!==v&&(g.align=Cl(g.align,v)),g.baseline!==b&&(g.baseline=Cl(g.baseline,b)),$i({type:Lu,role:sle,style:Ph,key:Di,from:i,encode:E,overlap:$},n)}function zfe(e,t,n,i){const r=ai(e,t),s=e.orient,o=M1(s,-1,1);let a,u;const l={enter:a={opacity:je,anchor:qt(r("titleAnchor",null)),align:{signal:a$}},update:u=Fe({},a,{opacity:Ni,text:qt(e.title)}),exit:{opacity:je}},c={signal:`lerp(range("${e.scale}"), ${A1(0,1,.5)})`};return u.x=Wt(s,c),u.y=cr(s,c),a.angle=Wt(s,je,Rfe(o,90)),a.baseline=Wt(s,U4(s,na,_r),{value:na}),u.angle=a.angle,u.baseline=a.baseline,rn(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),Bfe(r,s,l,n),l.update.align=Cl(l.update.align,a.align),l.update.angle=Cl(l.update.angle,a.angle),l.update.baseline=Cl(l.update.baseline,a.baseline),$i({type:Lu,role:ale,style:r$,from:i,encode:l},n)}function Bfe(e,t,n,i){const r=(a,u)=>a!=null?(n.update[u]=Cl(qt(a),n.update[u]),!1):!cl(u,i),s=r(e("titleX"),"x"),o=r(e("titleY"),"y");n.enter.auto=o===s?qt(o):Wt(t,qt(o),qt(s))}function Ufe(e,t){const n=Ofe(e,t),i=e.encode||{},r=i.axis||{},s=r.name||void 0,o=r.interactive,a=r.style,u=ai(e,n),l=Ice(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ve(t.add(wr({},[c]))),d=ve(t.add(jle({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Nfe(e,n,i.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Ife(e,n,i.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(Lfe(e,n,i.labels,d,p,l))),c.domain&&h.push(Dfe(e,n,i.domain,f)),c.title&&h.push(zfe(e,n,i.title,f)),k1(Kd({role:nle,from:f,encode:Pc(jfe(u,e),r,Ih),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:s,interactive:o,style:a}),t)}function jfe(e,t){const n={enter:{},update:{}};return rn(n,{orient:e("orient"),offset:e("offset")||0,position:Qi(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function q4(e,t,n){const i=le(e.signals),r=le(e.scales);return n||i.forEach(s=>w4(s,t)),le(e.projections).forEach(s=>xce(s,t)),r.forEach(s=>uce(s,t)),le(e.data).forEach(s=>Efe(s,t)),r.forEach(s=>lce(s,t)),(n||i).forEach(s=>Ule(s,t)),le(e.axes).forEach(s=>Ufe(s,t)),le(e.marks).forEach(s=>k1(s,t)),le(e.legends).forEach(s=>ffe(s,t)),e.title&&vfe(e.title,t),t.parseLambdas(),t}const qfe=e=>Pc({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Wfe(e,t){const n=t.config,i=ve(t.root=t.add(Um())),r=Hfe(e,n);r.forEach(l=>w4(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const s=t.add(wr()),o=t.add(S4(x4(qfe(e.encode),$1,ZS,e.style,t,{pulse:ve(s)}))),a=t.add(C4({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ve(o)}));t.operators.pop(),t.pushState(ve(o),ve(a),null),q4(e,t,r),t.operators.push(a);let u=t.add(E4({mark:i,pulse:ve(a)}));return u=t.add(A4({pulse:ve(u)})),u=t.add(Iu({pulse:ve(u)})),t.addData("root",new vu(t,s,s,u)),t}function yf(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Hfe(e,t){const n=o=>Qi(e[o],t[o]),i=[yf("background",n("background")),yf("autosize",Zue(n("autosize"))),yf("padding",tle(n("padding"))),yf("width",n("width")||0),yf("height",n("height")||0)],r=i.reduce((o,a)=>(o[a.name]=a,o),{}),s={};return le(e.signals).forEach(o=>{fe(r,o.name)?o=Fe(r[o.name],o):i.push(o),s[o.name]=o}),le(t.signals).forEach(o=>{!fe(s,o.name)&&!fe(r,o.name)&&i.push(o)}),i}function W4(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ST(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}W4.prototype=ST.prototype={parse(e){return q4(e,this)},fork(){return new ST(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof hw?ve(e):e;return this.add(nce({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,s){let o,a;i&&(o=i.data||(i.data={}),a=o[r]||(o[r]=[]),a.push(s))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ve(this.add(Iu({pulse:e})))),this._parent.push(t),this._lookup.push(n?ve(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return ze(this._parent)},encode(){return ze(this._encode)},lookup(){return ze(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(oe(e))return Yd(e,t);e.signal||q("Unsupported field reference: "+ee(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ve(this.add(Gle(r)))}return i},compareRef(e){let t=!1;const n=s=>Pt(s)?(t=!0,this.signalRef(s.signal)):Tle(s)?(t=!0,this.exprRef(s.expr)):s,i=le(e.field).map(n),r=le(e.order).map(n);return t?ve(this.add(cT({fields:i,orders:r}))):uT(i,r)},keyRef(e,t){let n=!1;const i=s=>Pt(s)?(n=!0,ve(r[s.signal])):s,r=this.signals;return e=le(e).map(i),n?ve(this.add(Vle({fields:e,flat:t}))):Cle(e,t)},sortRef(e){if(!e)return e;const t=E1(e.op,e.field),n=e.order||kle;return n.signal?ve(this.add(cT({fields:t,orders:this.signalRef(n.signal)}))):uT(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return fe(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&q("Duplicate signal name: "+ee(e));const n=t instanceof hw?t:this.add(Um(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||q("Unrecognized signal name: "+ee(e)),this.signals[e]},signalRef(e){return this.signals[e]?ve(this.signals[e]):(fe(this.lambdas,e)||(this.lambdas[e]=this.add(Um(null))),ve(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=ss(i,this),s=this.lambdas[i];s.params=r.$params,s.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!ae(e)?e:this.signalRef(e.signal||d$(e))},exprRef(e,t){const n={expr:ss(e,this)};return t&&(n.expr.$name=t),ve(this.add(Wle(n)))},addBinding(e,t){this.bindings||q("Nested signals do not support binding: "+ee(e)),this.bindings.push(Fe({signal:e},t))},addScaleProj(e,t){fe(this.scales,e)&&q("Duplicate scale or projection name: "+ee(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,rce(t))},addProjection(e,t){this.addScaleProj(e,tce(t))},getScale(e){return this.scales[e]||q("Unrecognized scale name: "+ee(e)),this.scales[e]},scaleRef(e){return ve(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return fe(this.data,e)&&q("Duplicate data set name: "+ee(e)),this.data[e]=t},getData(e){return this.data[e]||q("Undefined data set name: "+ee(e)),this.data[e]},addDataPipeline(e,t){return fe(this.data,e)&&q("Duplicate data set name: "+ee(e)),this.addData(e,vu.fromEntries(this,t))}};function d$(e){return(G(e)?Gfe:Vfe)(e)}function Gfe(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(ae(r)?r.signal||d$(r):ee(r))}return n+"]"}function Vfe(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+ee(i)+":"+(ae(r)?r.signal||d$(r):ee(r));return t+"}"}function Yfe(){const e="sans-serif",i="#4c78a8",r="#000",s="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:s,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:s,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:s,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Xfe(e,t,n){return ae(e)||q("Input Vega specification must be an object."),t=_c(Yfe(),t,e.config),Wfe(e,new W4(t,n)).toRuntime()}var Kfe="6.1.2";Fe(jl,LV,gZ,VZ,Rte,Ane,Zie,Rie,tre,$re,Nre,jre);const Qfe=Kfe,Jfe=Object.freeze(Object.defineProperty({__proto__:null,Bounds:Tt,CanvasHandler:Ch,CanvasRenderer:tm,DATE:ti,DAY:hn,DAYOFYEAR:is,Dataflow:El,Debug:BD,Error:E2,EventStream:M0,Gradient:O5,GroupItem:J0,HOURS:_i,Handler:NE,HybridHandler:EI,HybridRenderer:wx,Info:zD,Item:Q0,MILLISECONDS:pr,MINUTES:Ei,MONTH:vn,Marks:Si,MultiPulse:X2,None:LD,Operator:ot,Parameters:k0,Pulse:qo,QUARTER:ei,RenderType:Do,Renderer:Ah,ResourceLoader:z5,SECONDS:zi,SVGHandler:cI,SVGRenderer:UE,SVGStringRenderer:_I,Scenegraph:nI,TIME_UNITS:z2,Transform:z,View:u4,WEEK:Dt,Warn:S2,YEAR:nn,accessor:oi,accessorFields:yn,accessorName:St,array:le,ascending:Sc,bandwidthNRD:Z2,bin:x3,bootstrapCI:w3,boundClip:OI,boundContext:_h,boundItem:mx,boundMark:J5,boundStroke:oo,changeset:Ou,clampRange:QD,codegenExpression:N6,compare:M2,constant:En,cumulativeLogNormal:s_,cumulativeNormal:T0,cumulativeUniform:l_,dayofyear:CN,debounce:F2,defaultLocale:W2,definition:y3,densityLogNormal:r_,densityNormal:e_,densityUniform:u_,domChild:Ot,domClear:ki,domCreate:Ro,domFind:DE,dotbin:_3,error:q,expressionFunction:Mt,extend:Fe,extent:es,extentIndex:JD,falsy:vo,fastmap:$c,field:Ii,flush:ZD,font:i1,fontFamily:$h,fontSize:ds,format:Gp,formatLocale:Og,formats:V2,hasOwnProperty:fe,id:ah,identity:_n,inferType:o3,inferTypes:a3,ingest:Ve,inherits:te,inrange:dl,interpolate:fE,interpolateColors:X0,interpolateRange:b5,intersect:MI,intersectBoxLine:hl,intersectPath:bE,intersectPoint:xE,intersectRule:U5,isArray:G,isBoolean:ua,isDate:Uo,isFunction:Te,isIterable:eN,isNumber:We,isObject:ae,isRegExp:T2,isString:oe,isTuple:A0,key:R2,lerp:tN,lineHeight:Zo,loader:S0,locale:r3,logger:$2,lruCache:nN,markup:BE,merge:iN,mergeConfig:_c,multiLineOffset:TE,one:wc,pad:rN,panLinear:HD,panLog:GD,panPow:VD,panSymlog:YD,parse:Xfe,parseExpression:BS,parseSelector:pa,path:P0,pathCurves:mE,pathEqual:DI,pathParse:Yl,pathRectangle:P5,pathRender:Pd,pathSymbols:N5,pathTrail:I5,peek:ze,point:s1,projection:oS,quantileLogNormal:o_,quantileNormal:R0,quantileUniform:c_,quantiles:Q2,quantizeInterpolator:x5,quarter:XD,quartiles:J2,get random(){return Bi},randomInteger:jG,randomKDE:n_,randomLCG:UG,randomLogNormal:S3,randomMixture:$3,randomNormal:t_,randomUniform:A3,read:c3,regressionConstant:f_,regressionExp:k3,regressionLinear:d_,regressionLoess:T3,regressionLog:C3,regressionPoly:F3,regressionPow:M3,regressionQuad:h_,renderModule:o1,repeat:Cf,resetDefaultLocale:LH,resetSVGDefIds:OJ,responseType:l3,runtimeContext:X6,sampleCurve:D0,sampleLogNormal:i_,sampleNormal:F0,sampleUniform:a_,scale:Ge,sceneEqual:jE,sceneFromJSON:eI,scenePickVisit:Vg,sceneToJSON:Z5,sceneVisit:gr,sceneZOrder:wE,scheme:dE,serializeXML:vI,setHybridRendererOptions:MJ,setRandom:zG,span:uh,splitAccessPath:ls,stringValue:ee,textMetrics:vi,timeBin:WN,timeFloor:DN,timeFormatLocale:Fd,timeInterval:Mc,timeOffset:IN,timeSequence:BN,timeUnitSpecifier:AN,timeUnits:B2,toBoolean:O2,toDate:D2,toNumber:pn,toSet:hr,toString:N2,transform:v3,transforms:jl,truncate:sN,truthy:Li,tupleid:be,typeParsers:Jb,utcFloor:NN,utcInterval:Fc,utcOffset:LN,utcSequence:UN,utcdayofyear:FN,utcquarter:KD,utcweek:TN,version:Qfe,visitArray:So,week:kN,writeConfig:Ec,zero:Fo,zoomLinear:A2,zoomLog:C2,zoomPow:Cg,zoomSymlog:k2},Symbol.toStringTag,{value:"Module"}));function Zfe(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var ede={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},tde={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},nde={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const ide=Array.prototype.slice,ka=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,ide.call(t,1))},rde=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return oe(e)?new Date(e):new Date(e,t,n,i,r,s,o)};var sde={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:rde,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return ka("join",arguments)},indexof:function(){return ka("indexOf",arguments)},lastindexof:function(){return ka("lastIndexOf",arguments)},slice:function(){return ka("slice",arguments)},reverse:e=>e.slice().reverse(),sort:e=>e.slice().sort(Sc),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return ka("substring",arguments,String)},split:function(){return ka("split",arguments,String)},replace:function(){return ka("replace",arguments,String)},trim:e=>String(e).trim(),btoa:e=>btoa(e),atob:e=>atob(e),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const ode=["view","item","group","xy","x","y"],xw=new Set([Function,eval,setTimeout,setInterval]);typeof setImmediate=="function"&&xw.add(setImmediate);const ade={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:ede[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);if(n&&(e.memberDepth-=1),xw.has(i[r])){console.error(`Prevented interpretation of member "${r}" which could lead to insecure code execution`);return}return i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||sde[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>tde[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>nde[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,xw.has(e(i.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):n[r]=e(i.value),n},{})};function vf(e,t,n,i,r,s){const o=a=>ade[a.type](o,a);return o.memberDepth=0,o.fn=Object.create(t),o.params=n,o.datum=i,o.event=r,o.item=s,ode.forEach(a=>o.fn[a]=function(){return r.vega[a](...arguments)}),o(e)}var ude={operator(e,t){const n=t.ast,i=e.functions;return r=>vf(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,s)=>vf(n,i,s,r)},event(e,t){const n=t.ast,i=e.functions;return r=>vf(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,s)=>{const o=s.item&&s.item.datum;return vf(n,i,r,o,s)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,s=n==="group"||n==="image"||n==="rect";return(o,a)=>{const u=o.datum;let l=0,c;for(const f in i)c=vf(i[f].ast,r,a,u,void 0,o),o[f]!==c&&(o[f]=c,l=1);return n!=="rule"&&Zfe(o,i,s),l}}},lde="6.3.1",cde={version:lde};function h$(e){return K(e,"or")}function p$(e){return K(e,"and")}function g$(e){return K(e,"not")}function mg(e,t){if(g$(e))mg(e.not,t);else if(p$(e))for(const n of e.and)mg(n,t);else if(h$(e))for(const n of e.or)mg(n,t);else t(e)}function kl(e,t){return g$(e)?{not:kl(e.not,t)}:p$(e)?{and:e.and.map(n=>kl(n,t))}:h$(e)?{or:e.or.map(n=>kl(n,t))}:t(e)}const Ce=structuredClone;function H4(e){throw new Error(e)}function ic(e,t){const n={};for(const i of t)fe(e,i)&&(n[i]=e[i]);return n}function xi(e,t){const n={...e};for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>Ze(e)).join(",")})`};function Ie(e){if(We(e))return e;const t=oe(e)?e:Ze(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function ww(e){return e===!1||e===null}function Pe(e,t){return e.includes(t)}function rc(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function m$(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function G4(e,...t){for(const n of t)fde(e,n??{});return e}function fde(e,t){for(const n of Y(t))Ec(e,n,t[n],!0)}function Wr(e,t){const n=[],i={};let r;for(const s of e)r=t(s),!(r in i)&&(i[r]=1,n.push(s));return n}function dde(e,t){const n=Y(e),i=Y(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function V4(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function y$(e,t){for(const n of e)if(t.has(n))return!0;return!1}function _w(e){const t=new Set;for(const n of e){const r=ls(n).map((o,a)=>a===0?o:`[${o}]`),s=r.map((o,a)=>r.slice(0,a+1).join(""));for(const o of s)t.add(o)}return t}function v$(e,t){return e===void 0||t===void 0?!0:y$(_w(e),_w(t))}function at(e){return Y(e).length===0}const Y=Object.keys,Ft=Object.values,ia=Object.entries;function Qd(e){return e===!0||e===!1}function gt(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function vd(e,t){return g$(e)?`!(${vd(e.not,t)})`:p$(e)?`(${e.and.map(n=>vd(n,t)).join(") && (")})`:h$(e)?`(${e.or.map(n=>vd(n,t)).join(") || (")})`:t(e)}function jm(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&jm(e[n],t)&&delete e[n],at(e)}function Lh(e){return e.charAt(0).toUpperCase()+e.substr(1)}function b$(e,t="datum"){const n=ls(e),i=[];for(let r=1;r<=n.length;r++){const s=`[${n.slice(0,r).map(ee).join("][")}]`;i.push(`${t}${s}`)}return i.join(" && ")}function Y4(e,t="datum"){return`${t}[${ee(ls(e).join("."))}]`}function nt(e){return`datum['${e.replaceAll("'","\\'")}']`}function X4(e){return e.replaceAll("\\'","'").replaceAll("\\.",".")}function hde(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ji(e){return`${ls(e).map(hde).join("\\.")}`}function bu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function zc(e){return`${ls(e).join(".")}`}function sc(e){return e?ls(e).length:0}function Ct(...e){return e.find(t=>t!==void 0)}let K4=42;function Q4(e){const t=++K4;return e?String(e)+t:t}function pde(){K4=42}function J4(e){return Z4(e)?e:`__${e}`}function Z4(e){return e.startsWith("__")}function Jd(e){if(e!==void 0)return(e%360+360)%360}function F1(e){return We(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const $T=Object.getPrototypeOf(structuredClone({}));function mi(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!mi(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;for(const s of e.entries())if(!mi(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==$T.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==$T.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;i--!==0;){const s=r[i];if(!mi(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function Ze(e){const t=[];return(function n(i){if(i?.toJSON&&typeof i.toJSON=="function"&&(i=i.toJSON()),i===void 0)return;if(typeof i=="number")return isFinite(i)?`${i}`:"null";if(typeof i!="object")return JSON.stringify(i);let r,s;if(Array.isArray(i)){for(s="[",r=0;r<i.length;r++)r&&(s+=","),s+=n(i[r])||"null";return`${s}]`}if(i===null)return"null";if(t.includes(i))throw new TypeError("Converting circular structure to JSON");const o=t.push(i)-1,a=Object.keys(i).sort();for(s="",r=0;r<a.length;r++){const u=a[r],l=n(i[u]);l&&(s&&(s+=","),s+=`${JSON.stringify(u)}:${l}`)}return t.splice(o,1),`{${s}}`})(e)}function K(e,t){return ae(e)&&fe(e,t)&&e[t]!==void 0}const Gs="row",Vs="column",T1="facet",mt="x",Xt="y",Er="x2",ms="y2",ga="xOffset",Bc="yOffset",Sr="radius",uo="radius2",Hi="theta",lo="theta2",$r="latitude",Ar="longitude",Cr="latitude2",qi="longitude2",ma="time",ii="color",ys="fill",vs="stroke",ri="shape",co="size",zu="angle",fo="opacity",ya="fillOpacity",va="strokeOpacity",ba="strokeWidth",xa="strokeDash",zh="text",oc="order",Bh="detail",R1="key",xu="tooltip",O1="href",D1="url",N1="description",gde={x:1,y:1,x2:1,y2:1},ez={theta:1,theta2:1,radius:1,radius2:1};function tz(e){return fe(ez,e)}const x$={longitude:1,longitude2:1,latitude:1,latitude2:1};function nz(e){switch(e){case $r:return"y";case Cr:return"y2";case Ar:return"x";case qi:return"x2"}}function iz(e){return fe(x$,e)}const mde=Y(x$),w$={...gde,...ez,...x$,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,time:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function Ml(e){return e===ii||e===ys||e===vs}const rz={row:1,column:1,facet:1},Oi=Y(rz),_$={...w$,...rz},yde=Y(_$),{order:Nxe,detail:Pxe,tooltip:Ixe,...vde}=_$,{row:Lxe,column:zxe,facet:Bxe,...bde}=vde;function xde(e){return fe(bde,e)}function sz(e){return fe(_$,e)}const wde=[Er,ms,Cr,qi,lo,uo];function oz(e){return Bu(e)!==e}function Bu(e){switch(e){case Er:return mt;case ms:return Xt;case Cr:return $r;case qi:return Ar;case lo:return Hi;case uo:return Sr}return e}function ra(e){if(tz(e))switch(e){case Hi:return"startAngle";case lo:return"endAngle";case Sr:return"outerRadius";case uo:return"innerRadius"}return e}function bs(e){switch(e){case mt:return Er;case Xt:return ms;case $r:return Cr;case Ar:return qi;case Hi:return lo;case Sr:return uo}}function si(e){switch(e){case mt:case Er:return"width";case Xt:case ms:return"height"}}function az(e){switch(e){case mt:return"xOffset";case Xt:return"yOffset";case Er:return"x2Offset";case ms:return"y2Offset";case Hi:return"thetaOffset";case Sr:return"radiusOffset";case lo:return"theta2Offset";case uo:return"radius2Offset"}}function E$(e){switch(e){case mt:return"xOffset";case Xt:return"yOffset"}}function _de(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const Ede=Y(w$),{x:Uxe,y:jxe,x2:qxe,y2:Wxe,xOffset:Hxe,yOffset:Gxe,latitude:Vxe,longitude:Yxe,latitude2:Xxe,longitude2:Kxe,theta:Qxe,theta2:Jxe,radius:Zxe,radius2:ewe,...S$}=w$,Sde=Y(S$),$$={x:1,y:1},ho=Y($$);function kt(e){return fe($$,e)}const A$={theta:1,radius:1},$de=Y(A$);function P1(e){return e==="width"?mt:Xt}const uz={xOffset:1,yOffset:1};function Uh(e){return fe(uz,e)}const Ade={time:1};function Uv(e){return e in Ade}const{text:twe,tooltip:nwe,href:iwe,url:rwe,description:swe,detail:owe,key:awe,order:uwe,...lz}=S$,Cde=Y(lz);function kde(e){return fe(S$,e)}function Mde(e){switch(e){case ii:case ys:case vs:case co:case ri:case fo:case ba:case xa:return!0;case ya:case va:case zu:case ma:return!1}}const cz={...$$,...A$,...uz,...lz},C$=Y(cz);function xs(e){return fe(cz,e)}function Fde(e,t){return Rde(e)[t]}const fz={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:lwe,...Tde}=fz;function Rde(e){switch(e){case ii:case ys:case vs:case N1:case Bh:case R1:case xu:case O1:case oc:case fo:case ya:case va:case ba:case T1:case Gs:case Vs:return fz;case mt:case Xt:case ga:case Bc:case $r:case Ar:case ma:return Tde;case Er:case ms:case Cr:case qi:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case co:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case xa:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case ri:return{point:"always",geoshape:"always"};case zh:return{text:"always"};case zu:return{point:"always",square:"always",text:"always"};case D1:return{image:"always"};case Hi:return{text:"always",arc:"always"};case Sr:return{text:"always",arc:"always"};case lo:case uo:return{arc:"always"}}}function jv(e){switch(e){case mt:case Xt:case Hi:case Sr:case ga:case Bc:case co:case zu:case ba:case fo:case ya:case va:case ma:case Er:case ms:case lo:case uo:return;case T1:case Gs:case Vs:case ri:case xa:case zh:case xu:case O1:case D1:case N1:return"discrete";case ii:case ys:case vs:return"flexible";case $r:case Ar:case Cr:case qi:case Bh:case R1:case oc:return}}const Ode={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Dde={count:1,min:1,max:1};function no(e){return K(e,"argmin")}function wa(e){return K(e,"argmax")}function k$(e){return oe(e)&&fe(Ode,e)}const Nde=new Set(["count","valid","missing","distinct"]);function I1(e){return oe(e)&&Nde.has(e)}function Pde(e){return oe(e)&&Pe(["min","max"],e)}const Ide=new Set(["count","sum","distinct","valid","missing"]),Lde=new Set(["mean","average","median","q1","q3","min","max"]);function dz(e){return ua(e)&&(e=X1(e,void 0)),`bin${Y(e).map(t=>L1(e[t])?gt(`_${t}_${ia(e[t])}`):gt(`_${t}_${e[t]}`)).join("")}`}function ft(e){return e===!0||Uu(e)&&!e.binned}function Kt(e){return e==="binned"||Uu(e)&&e.binned===!0}function Uu(e){return ae(e)}function L1(e){return K(e,"param")}function AT(e){switch(e){case Gs:case Vs:case co:case ii:case ys:case vs:case ba:case fo:case ya:case va:case ri:return 6;case xa:return 4;default:return 10}}function jh(e){return K(e,"expr")}function Qt(e,{level:t}={level:0}){const n=Y(e||{}),i={};for(const r of n)i[r]=t===0?hi(e[r]):Qt(e[r],{level:t-1});return i}function hz(e){const{anchor:t,frame:n,offset:i,orient:r,angle:s,limit:o,color:a,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:p,...g}=e,m={...g,...a?{fill:a}:{}},y={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...s!==void 0?{angle:s}:{},...o!==void 0?{limit:o}:{}},v={...u?{subtitleColor:u}:{},...l?{subtitleFont:l}:{},...c?{subtitleFontSize:c}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...h?{subtitleLineHeight:h}:{},...p?{subtitlePadding:p}:{}},b=ic(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:b,nonMarkTitleProperties:y,subtitle:v}}function ko(e){return oe(e)||G(e)&&oe(e[0])}function ye(e){return K(e,"signal")}function ju(e){return K(e,"step")}function zde(e){return G(e)?!1:K(e,"fields")&&!K(e,"data")}function Bde(e){return G(e)?!1:K(e,"fields")&&K(e,"data")}function Us(e){return G(e)?!1:K(e,"field")&&K(e,"data")}const Ude={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},jde=Y(Ude),qde={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Ew=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"],Wde="  ";function pz(e){const t=G(e.condition)?e.condition.map(CT):CT(e.condition);return{...hi(e),condition:t}}function hi(e){if(jh(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function CT(e){if(jh(e)){const{expr:t,...n}=e;return{signal:t,...n}}return e}function ht(e){if(jh(e)){const{expr:t,...n}=e;return{signal:t,...n}}return ye(e)?e:e!==void 0?{value:e}:void 0}function Hde(e){return ye(e)?e.signal:ee(e)}function kT(e){return ye(e)?e.signal:ee(e.value)}function or(e){return ye(e)?e.signal:e==null?null:ee(e)}function Gde(e,t,n){for(const i of n){const r=os(i,t.markDef,t.config);r!==void 0&&(e[i]=ht(r))}return e}function gz(e){return[].concat(e.type,e.style??[])}function Je(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:s}=i;return r&&K(t,r)?t[r]:t[e]!==void 0?t[e]:s&&(!r||r===e)?void 0:os(e,t,n,i)}function os(e,t,n,{vgChannel:i}={}){const r=Sw(e,t,n.style);return Ct(i?r:void 0,r,i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function Sw(e,t,n){return mz(e,gz(t),n)}function mz(e,t,n){t=le(t);let i;for(const r of t){const s=n[r];K(s,e)&&(i=s[e])}return i}function yz(e,t){return le(e).reduce((n,i)=>(n.field.push(ne(i,t)),n.order.push(i.sort??"ascending"),n),{field:[],order:[]})}function vz(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(mi(r,i))return;n.push(i)}),n}function bz(e,t){return mi(e,t)||!t?e:e?[...le(e),...le(t)].join(", "):t}function xz(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((ko(n)||ye(n))&&(ko(i)||ye(i)))return{explicit:e.explicit,value:bz(n,i)};if(ko(n)||ye(n))return{explicit:e.explicit,value:n};if(ko(i)||ye(i))return{explicit:e.explicit,value:i};if(!ko(n)&&!ye(n)&&!ko(i)&&!ye(i))return{explicit:e.explicit,value:vz(n,i)};throw new Error("It should never reach here")}function M$(e){return`Invalid specification ${Ze(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Vde='Autosize "fit" only works for single views and layered views.';function MT(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function FT(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function TT(e){return e?`Dropping "fit-${e}" because spec has discrete ${si(e)}.`:'Dropping "fit" because spec has discrete size.'}function F$(e){return`Unknown field for ${e}. Cannot calculate view size.`}function RT(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Yde(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Xde(e){return`The "nearest" transform is not supported for ${e} marks.`}function wz(e){return`Selection not supported for ${e} yet.`}function Kde(e){return`Cannot find a selection named "${e}".`}const Qde="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Jde="Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc",Zde="Legend bindings are only supported for selections over an individual field or encoding channel.";function ehe(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function the(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const nhe="The same selection must be used to override scale domains in a layered view.",ihe='Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.';function rhe(e){return`Unknown repeated value "${e}".`}function OT(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const she="Multiple timer selections in one unit spec are not supported. Ignoring all but the first.",T$="Animation involving facet, layer, or concat is currently unsupported.";function ohe(e){return`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${ee(e)}.`}function ahe(e,t,n,i){return`${e.length?"Multiple ":"No "}matching ${ee(t)} encoding found for selection ${ee(n.param)}. Using "field": ${ee(i)}.`}const uhe="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function lhe(e){return`Unrecognized parse "${e}".`}function DT(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const che="Attempt to add the same child twice.";function fhe(e){return`Ignoring an invalid transform: ${Ze(e)}.`}const dhe='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function NT(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function hhe(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${Ze(t)} is overridden by a child projection ${Ze(n)}.`}const phe="Arc marks uses theta channel rather than angle, replacing angle with theta.";function ghe(e){return`${e}Offset dropped because ${e} is continuous`}function mhe(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${Ze(n)}}.`}function _z(e){return`Invalid field type "${e}".`}function yhe(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function vhe(e){return`Invalid aggregation operator "${e}".`}function Ez(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function bhe(e){return`Position range does not support relative band size for ${e}.`}function $w(e,t){return`Dropping ${Ze(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const xhe="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function z1(e,t,n){return`${e} dropped as it is incompatible with "${t}".`}function whe(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function _he(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Ehe(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function She(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function qv(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function $he(e){return`The ${e} for range marks cannot be an expression`}function Ahe(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Che(e,t){return`Specified orient "${e}" overridden with "${t}".`}function khe(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Mhe(e){return`Cannot use the relative band size with ${e} scale.`}function Fhe(e){return`Using unaggregated domain with raw field has no effect (${Ze(e)}).`}function The(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Rhe(e){return`Unaggregated domain is currently unsupported for log scale (${Ze(e)}).`}function Ohe(e){return`Cannot apply size to non-oriented mark "${e}".`}function Dhe(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function Nhe(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function Sz(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function $z(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Phe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ze(n)} and ${Ze(i)}). Using ${Ze(n)}.`}function Ihe(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${Ze(n)} and ${Ze(i)}). Using the union of the two domains.`}function Lhe(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function zhe(e){return`Dropping sort property ${Ze(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const PT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Bhe="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Uhe="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",jhe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function qhe(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Whe(e){return`Stack is applied to a non-linear scale (${e}).`}function Hhe(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function qm(e,t){return`Invalid ${e}: ${Ze(t)}.`}function Ghe(e){return`Dropping day from datetime ${Ze(e)} as day cannot be combined with other units.`}function Vhe(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Yhe(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Xhe(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function IT(e){return`1D error band does not support ${e}.`}function Az(e){return`Channel ${e} is required for "binned" bin.`}function Khe(e){return`Channel ${e} should not be used with "binned" bin.`}function Qhe(e){return`Domain for ${e} is required for threshold scale.`}const Cz=$2(S2);let wu=Cz;function Jhe(e){return wu=e,wu}function Zhe(){return wu=Cz,wu}function R$(...e){wu.error(...e)}function Q(...e){wu.warn(...e)}function epe(...e){wu.debug(...e)}function qu(e){if(e&&ae(e)){for(const t of D$)if(K(e,t))return!0}return!1}const kz=["january","february","march","april","may","june","july","august","september","october","november","december"],tpe=kz.map(e=>e.substr(0,3)),Mz=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],npe=Mz.map(e=>e.substr(0,3));function ipe(e){if(F1(e)&&(e=+e),We(e))return e>4&&Q(qm("quarter",e)),e-1;throw new Error(qm("quarter",e))}function rpe(e){if(F1(e)&&(e=+e),We(e))return e-1;{const t=e.toLowerCase(),n=kz.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=tpe.indexOf(i);if(r!==-1)return r;throw new Error(qm("month",e))}}function spe(e){if(F1(e)&&(e=+e),We(e))return e%7;{const t=e.toLowerCase(),n=Mz.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=npe.indexOf(i);if(r!==-1)return r;throw new Error(qm("day",e))}}function O$(e,t){const n=[];if(t&&e.day!==void 0&&Y(e).length>1&&(Q(Ghe(e)),e=Ce(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?rpe(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?ipe(e.quarter):e.quarter;n.push(We(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?spe(e.day):e.day;n.push(We(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r>"u"?0:r)}return n}function _u(e){const n=O$(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function ope(e){const n=O$(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function ape(e){const t=O$(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const Fz={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},D$=Y(Fz);function upe(e){return fe(Fz,e)}function Wu(e){return ae(e)?e.binned:Tz(e)}function Tz(e){return e?.startsWith("binned")}function N$(e){return e.startsWith("utc")}function lpe(e){return e.substring(3)}const cpe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function B1(e){return D$.filter(t=>Oz(e,t))}function Rz(e){const t=B1(e);return t[t.length-1]}function Oz(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function fpe(e,t,{end:n}={end:!1}){const i=b$(t),r=N$(e)?"utc":"";function s(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let o;const a={};for(const u of D$)Oz(e,u)&&(a[u]=s(u),o=u);return n&&(a[o]+="+1"),ope(a)}function Dz(e){if(!e)return;const t=B1(e);return`timeUnitSpecifier(${Ze(t)}, ${Ze(cpe)})`}function dpe(e,t,n){if(!e)return;const i=Dz(e);return`${n||N$(e)?"utc":"time"}Format(${t}, ${i})`}function Ht(e){if(!e)return;let t;return oe(e)?Tz(e)?t={unit:e.substring(6),binned:!0}:t={unit:e}:ae(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),N$(t.unit)&&(t.utc=!0,t.unit=lpe(t.unit)),t}function hpe(e){const{utc:t,...n}=Ht(e);return n.unit?(t?"utc":"")+Y(n).map(i=>gt(`${i==="unit"?"":`_${i}_`}${n[i]}`)).join(""):`${t?"utc":""}timeunit${Y(n).map(i=>gt(`_${i}_${n[i]}`)).join("")}`}function Nz(e,t=n=>n){const n=Ht(e),i=Rz(n.unit);if(i&&i!=="day"){const r={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:s,part:o}=Pz(i,n.step),a={...r,[o]:+r[o]+s};return`${t(_u(a))} - ${t(_u(r))}`}}const ppe={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function gpe(e){return fe(ppe,e)}function Pz(e,t=1){if(gpe(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:t*3};case"week":return{part:"date",step:t*7}}}function mpe(e){return K(e,"param")}function P$(e){return!!e?.field&&e.equal!==void 0}function I$(e){return!!e?.field&&e.lt!==void 0}function L$(e){return!!e?.field&&e.lte!==void 0}function z$(e){return!!e?.field&&e.gt!==void 0}function B$(e){return!!e?.field&&e.gte!==void 0}function U$(e){if(e?.field){if(G(e.range)&&e.range.length===2)return!0;if(ye(e.range))return!0}return!1}function j$(e){return!!e?.field&&(G(e.oneOf)||G(e.in))}function ype(e){return!!e?.field&&e.valid!==void 0}function Iz(e){return j$(e)||P$(e)||U$(e)||I$(e)||z$(e)||L$(e)||B$(e)}function Dr(e,t){return K1(e,{timeUnit:t,wrapTime:!0})}function vpe(e,t){return e.map(n=>Dr(n,t))}function Lz(e,t=!0){const{field:n}=e,i=Ht(e.timeUnit),{unit:r,binned:s}=i||{},o=ne(e,{expr:"datum"}),a=r?`time(${s?o:fpe(r,n)})`:o;if(P$(e))return`${a}===${Dr(e.equal,r)}`;if(I$(e)){const u=e.lt;return`${a}<${Dr(u,r)}`}else if(z$(e)){const u=e.gt;return`${a}>${Dr(u,r)}`}else if(L$(e)){const u=e.lte;return`${a}<=${Dr(u,r)}`}else if(B$(e)){const u=e.gte;return`${a}>=${Dr(u,r)}`}else{if(j$(e))return`indexof([${vpe(e.oneOf,r).join(",")}], ${a}) !== -1`;if(ype(e))return U1(a,e.valid);if(U$(e)){const{range:u}=Qt(e),l=ye(u)?{signal:`${u.signal}[0]`}:u[0],c=ye(u)?{signal:`${u.signal}[1]`}:u[1];if(l!==null&&c!==null&&t)return`inrange(${a}, [${Dr(l,r)}, ${Dr(c,r)}])`;const f=[];return l!==null&&f.push(`${a} >= ${Dr(l,r)}`),c!==null&&f.push(`${a} <= ${Dr(c,r)}`),f.length>0?f.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${Ze(e)}`)}function U1(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function bpe(e){return Iz(e)&&e.timeUnit?{...e,timeUnit:Ht(e.timeUnit)}:e}const qh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function xpe(e){return e==="quantitative"||e==="temporal"}function zz(e){return e==="ordinal"||e==="nominal"}const Eu=qh.quantitative,q$=qh.ordinal,ac=qh.temporal,W$=qh.nominal,Uc=qh.geojson;function wpe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Eu:return"quantitative";case"t":case ac:return"temporal";case"o":case q$:return"ordinal";case"n":case W$:return"nominal";case Uc:return"geojson"}}const Jt={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",TIME:"time",UTC:"utc",POINT:"point",BAND:"band"},Aw={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function _pe(e,t){const n=Aw[e],i=Aw[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const Epe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function LT(e){return Epe[e]}const Bz=new Set(["linear","log","pow","sqrt","symlog"]),Uz=new Set([...Bz,"time","utc"]);function jz(e){return Bz.has(e)}const qz=new Set(["quantile","quantize","threshold"]),Spe=new Set([...Uz,...qz,"sequential","identity"]),$pe=new Set(["ordinal","bin-ordinal","point","band"]);function Vt(e){return $pe.has(e)}function mr(e){return Spe.has(e)}function Hr(e){return Uz.has(e)}function uc(e){return qz.has(e)}const Ape={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0,framesPerSecond:2,animationDuration:5};function Cpe(e){return!oe(e)&&K(e,"name")}function Wz(e){return K(e,"param")}function kpe(e){return K(e,"unionWith")}function Mpe(e){return ae(e)&&"field"in e}const Fpe={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:cwe,domain:fwe,range:dwe,rangeMax:hwe,rangeMin:pwe,scheme:gwe,...Tpe}=Fpe,Rpe=Y(Tpe);function Cw(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Hr(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return Hr(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return Hr(e);case"nice":return Hr(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return mr(e)&&!Pe(["log","time","utc","threshold","quantile"],e)}}function Hz(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Ml(e)?void 0:khe(t);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function Ope(e,t){return Pe([q$,W$],t)?e===void 0||Vt(e):t===ac?Pe([Jt.TIME,Jt.UTC,void 0],e):t===Eu?jz(e)||uc(e)||e===void 0:!0}function Dpe(e,t,n=!1){if(!xs(e))return!1;switch(e){case mt:case Xt:case ga:case Bc:case Hi:case Sr:return Hr(t)||t==="band"?!0:t==="point"?!n:!1;case ma:return Pe(["linear","band"],t);case co:case ba:case fo:case ya:case va:case zu:return Hr(t)||uc(t)||Pe(["band","point","ordinal"],t);case ii:case ys:case vs:return t!=="band";case xa:case ri:return t==="ordinal"||uc(t)}}function Npe(e){return ae(e)&&"value"in e}const qn={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Gz=qn.arc,j1=qn.area,q1=qn.bar,Ppe=qn.image,W1=qn.line,H1=qn.point,Ipe=qn.rect,Wm=qn.rule,Vz=qn.text,H$=qn.tick,Lpe=qn.trail,G$=qn.circle,V$=qn.square,Yz=qn.geoshape;function _a(e){return["line","area","trail"].includes(e)}function Zd(e){return["rect","bar","image","arc","tick"].includes(e)}const zpe=new Set(Y(qn));function as(e){return K(e,"type")}const Bpe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Upe=["fill","fillOpacity"],jpe=[...Bpe,...Upe],qpe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},zT=Y(qpe),Wv=["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],Wpe={area:["line","point"],bar:Wv,rect:Wv,line:["point"],tick:["bandSize","thickness",...Wv]},Hpe={color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},Gpe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},Xz=Y(Gpe);function Su(e){return K(e,"band")}const Vpe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Ype=5,Y$={binSpacing:0,continuousBandSize:Ype,minBandSize:.25,timeUnitBandPosition:.5},Xpe={...Y$,binSpacing:1},Kpe={...Y$,thickness:1};function Qpe(e){return as(e)?e.type:e}function Kz(e,{isPath:t}){return e===void 0||e==="break-paths-show-path-domains"?t?"break-paths-show-domains":"filter":e===null?"show":e}function X$({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){if(!i||!mr(i)||r)return"always-valid";const s=Kz(Je("invalid",e,t),{isPath:_a(e.type)});return t.scale?.invalid?.[n]!==void 0?"show":s}function Jpe(e){return e==="break-paths-filter-domains"||e==="break-paths-show-domains"}function Qz({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,s=`peek(${i})`,o=t.domainHasZero();return o==="definitely"?{scale:e,value:0}:o==="maybe"?{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${n==="zeroOrMin"?r:s})`}:{signal:`scale('${e}', ${n==="zeroOrMin"?r:s})`}}function Jz({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:s}){const o=n?.get("type"),a=vr(t),u=I1(a?.aggregate),l=X$({scaleChannel:e,markDef:r,config:s,scaleType:o,isCountAggregate:u});if(a&&l==="show"){const c=s.scale.invalid?.[e]??"zero-or-min";return{test:U1(ne(a,{expr:"datum"}),!1),...Zpe(c,n,i)}}}function Zpe(e,t,n){if(Npe(e)){const{value:i}=e;return ye(i)?{signal:i.signal}:{value:i}}return Qz({scale:t,scaleName:n,mode:"zeroOrMin"})}function K$(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:s,config:o}=e,a=Bu(t),u=Q$(e),l=Jz({scaleChannel:a,channelDef:n,scale:r,scaleName:s,markDef:i,config:o});return l!==void 0?[l,u]:u}function ege(e){const{datum:t}=e;return qu(t)?_u(t):`${Ze(t)}`}function tu(e,t,n,i){const r={};if(t&&(r.scale=t),ws(e)){const{datum:s}=e;qu(s)?r.signal=_u(s):ye(s)?r.signal=s.signal:jh(s)?r.signal=s.expr:r.value=s}else r.field=ne(e,n);if(i){const{offset:s,band:o}=i;s&&(r.offset=s),o&&(r.band=o)}return r}function Hm({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:s="end",bandPosition:o=.5}){const a=!ye(o)&&0<o&&o<1?"datum":void 0,u=ne(t,{expr:a,suffix:r}),l=n!==void 0?ne(n,{expr:a}):ne(t,{suffix:s,expr:a}),c={};if(o===0||o===1){c.scale=e;const f=o===0?u:l;c.field=f}else{const f=ye(o)?`(1-${o.signal}) * ${u} + ${o.signal} * ${l}`:`${1-o} * ${u} + ${o} * ${l}`;c.signal=`scale("${e}", ${f})`}return i&&(c.offset=i),c}function tge({scaleName:e,fieldDef:t}){const n=ne(t,{expr:"datum"}),i=ne(t,{expr:"datum",suffix:"end"});return`abs(scale("${e}", ${i}) - scale("${e}", ${n}))`}function Q$({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l,bandPosition:c}){if(t){if(Me(t)){const f=o?.get("type");if(Un(t)){c??=sa({fieldDef:t,fieldDef2:n,markDef:i,config:r});const{bin:d,timeUnit:h,type:p}=t;if(ft(d)||c&&h&&p===ac)return a?.impute?tu(t,s,{binSuffix:"mid"},{offset:u}):c&&!Vt(f)?Hm({scaleName:s,fieldOrDatumDef:t,bandPosition:c,offset:u}):tu(t,s,Yh(t,e)?{binSuffix:"range"}:{},{offset:u});if(Kt(d)){if(J(n))return Hm({scaleName:s,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});Q(Az(e===mt?Er:ms))}}return tu(t,s,Vt(f)?{binSuffix:"range"}:{},{offset:u,band:f==="band"?c??t.bandPosition??.5:void 0})}else if(yr(t)){const f=t.value,d=u?{offset:u}:{};return{...bd(e,f),...d}}}return Te(l)&&(l=l()),l&&{...l,...u?{offset:u}:{}}}function bd(e,t){return Pe(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Pe(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:ht(t)}function $u(e){return e&&e!=="number"&&e!=="time"}function Zz(e,t,n){return`${e}(${t}${n?`, ${Ze(n)}`:""})`}function J$({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s}){if($u(n))return ar({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:s});const o=e8(e,i,r),a=lc(e);if(t===void 0&&n===void 0&&s.customFormatTypes){if(a==="quantitative"){if(r&&s.normalizedNumberFormatType)return ar({fieldOrDatumDef:e,format:s.normalizedNumberFormat,formatType:s.normalizedNumberFormatType,expr:i,config:s});if(s.numberFormatType)return ar({fieldOrDatumDef:e,format:s.numberFormat,formatType:s.numberFormatType,expr:i,config:s})}if(a==="temporal"&&s.timeFormatType&&J(e)&&e.timeUnit===void 0)return ar({fieldOrDatumDef:e,format:s.timeFormat,formatType:s.timeFormatType,expr:i,config:s})}function u(l){return J(l)?Ht(l.timeUnit)||{}:{unit:void 0,utc:void 0}}if(fc(e)){const{unit:l,utc:c}=u(e),f=ige({field:o,timeUnit:l,format:t,formatType:s.timeFormatType,rawTimeFormat:s.timeFormat,isUTCScale:c||Hu(e)&&e.scale?.type===Jt.UTC});return f?{signal:f}:void 0}if(t=kw({type:a,specifiedFormat:t,config:s,normalizeStack:r}),J(e)&&ft(e.bin)){const l=ne(e,{expr:i,binSuffix:"end"});return{signal:Wh(o,l,t,n,s)}}else return t||lc(e)==="quantitative"?{signal:`${i8(o,t)}`}:{signal:`isValid(${o}) ? ${o} : ""+${o}`}}function e8(e,t,n){return J(e)?n?`${ne(e,{expr:t,suffix:"end"})}-${ne(e,{expr:t,suffix:"start"})}`:ne(e,{expr:t}):ege(e)}function ar({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:s,field:o}){if(o??=e8(e,i,r),o!=="datum.value"&&J(e)&&ft(e.bin)){const a=ne(e,{expr:i,binSuffix:"end"});return{signal:Wh(o,a,t,n,s)}}return{signal:Zz(n,o,t)}}function t8(e,t,n,i,r,s){if(!(oe(i)&&$u(i))&&!(n===void 0&&i===void 0&&r.customFormatTypes&&lc(e)==="quantitative"&&(r.normalizedNumberFormatType&&cc(e)&&e.stack==="normalize"||r.numberFormatType))){if(cc(e)&&e.stack==="normalize"&&r.normalizedNumberFormat)return kw({type:"quantitative",config:r,normalizeStack:!0});if(fc(e)){const o=J(e)?Ht(e.timeUnit)?.unit:void 0;return o===void 0&&r.customFormatTypes&&r.timeFormatType?void 0:nge({specifiedFormat:n,timeUnit:o,config:r,omitTimeFormatConfig:s})}return kw({type:t,specifiedFormat:n,config:r})}}function n8(e,t,n){if(e&&(ye(e)||e==="number"||e==="time"))return e;if(fc(t)&&n!=="time"&&n!=="utc")return J(t)&&Ht(t?.timeUnit)?.utc?"utc":"time"}function kw({type:e,specifiedFormat:t,config:n,normalizeStack:i}){if(oe(t))return t;if(e===Eu)return i?n.normalizedNumberFormat:n.numberFormat}function nge({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){return e||(t?{signal:Dz(t)}:i?void 0:n.timeFormat)}function i8(e,t){return`format(${e}, "${t||""}")`}function BT(e,t,n,i){return $u(n)?Zz(n,e,t):i8(e,(oe(t)?t:void 0)??i.numberFormat)}function Wh(e,t,n,i,r){if(n===void 0&&i===void 0&&r.customFormatTypes&&r.numberFormatType)return Wh(e,t,r.numberFormat,r.numberFormatType,r);const s=BT(e,n,i,r),o=BT(t,n,i,r);return`${U1(e,!1)} ? "null" : ${s} + "${Wde}" + ${o}`}function ige({field:e,timeUnit:t,format:n,formatType:i,rawTimeFormat:r,isUTCScale:s}){return!t||n?!t&&i?`${i}(${e}, ${Ze(n)})`:(n=oe(n)?n:r,`${s?"utc":"time"}Format(${e}, ${Ze(n)})`):dpe(t,e,s)}const G1="min",rge={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function UT(e){return fe(rge,e)}function sge(e){return K(e,"encoding")}function Ys(e){return e&&(e.op==="count"||K(e,"field"))}function r8(e){return e&&G(e)}function Hh(e){return K(e,"row")||K(e,"column")}function Z$(e){return K(e,"header")}function V1(e){return K(e,"facet")}function oge(e){return K(e,"param")}function age(e){return!oe(e)&&K(e,"repeat")}function jT(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t}}function eA(e){return K(e,"sort")}function sa({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(Me(e)&&e.bandPosition!==void 0)return e.bandPosition;if(J(e)){const{timeUnit:r,bin:s}=e;if(r&&!t)return os("timeUnitBandPosition",n,i);if(ft(s))return .5}}function s8({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:s,useVlSizeChannel:o}){const a=si(e),u=Je(o?"size":a,i,r,{vgChannel:a});if(u!==void 0)return u;if(J(t)){const{timeUnit:l,bin:c}=t;if(l&&!n)return{band:os("timeUnitBandSize",i,r)};if(ft(c)&&!Vt(s))return{band:1}}if(Zd(i.type))return s?Vt(s)?r[i.type]?.discreteBandSize||{band:1}:r[i.type]?.continuousBandSize:r[i.type]?.discreteBandSize}function o8(e,t,n,i){return ft(e.bin)||e.timeUnit&&Un(e)&&e.type==="temporal"?sa({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function a8(e){return K(e,"sort")&&!K(e,"field")}function Gh(e){return K(e,"condition")}function Y1(e){const t=e?.condition;return!!t&&!G(t)&&J(t)}function Vh(e){const t=e?.condition;return!!t&&!G(t)&&Me(t)}function uge(e){const t=e?.condition;return!!t&&(G(t)||yr(t))}function J(e){return K(e,"field")||e?.aggregate==="count"}function lc(e){return e?.type}function ws(e){return K(e,"datum")}function zo(e){return Un(e)&&!Vm(e)||Gm(e)}function qT(e){return Un(e)&&e.type==="quantitative"&&!e.bin||Gm(e)}function Gm(e){return ws(e)&&We(e.datum)}function Me(e){return J(e)||ws(e)}function Un(e){return e&&(K(e,"field")||e.aggregate==="count")&&K(e,"type")}function yr(e){return K(e,"value")}function Hu(e){return K(e,"scale")||K(e,"sort")}function cc(e){return K(e,"axis")||K(e,"stack")||K(e,"impute")}function u8(e){return K(e,"legend")}function l8(e){return K(e,"format")||K(e,"formatType")}function lge(e){return xi(e,["legend","axis","header","scale"])}function cge(e){return K(e,"op")}function ne(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,s="";if(dge(e))n=J4("count");else{let o;if(!t.nofn)if(cge(e))o=e.op;else{const{bin:a,aggregate:u,timeUnit:l}=e;ft(a)?(o=dz(a),r=(t.binSuffix??"")+(t.suffix??"")):u?wa(u)?(s=`["${n}"]`,n=`argmax_${u.argmax}`):no(u)?(s=`["${n}"]`,n=`argmin_${u.argmin}`):o=String(u):l&&!Wu(l)&&(o=hpe(l),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""))}o&&(n=n?`${o}_${n}`:o)}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?zc(n):t.expr?Y4(n,t.expr)+s:ji(n)+s}function Vm(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return J(e)&&!!e.bin;case"temporal":return!1}throw new Error(_z(e.type))}function fge(e){return Hu(e)&&uc(e.scale?.type)}function dge(e){return e.aggregate==="count"}function hge(e,t){const{field:n,bin:i,timeUnit:r,aggregate:s}=e;if(s==="count")return t.countTitle;if(ft(i))return`${n} (binned)`;if(r&&!Wu(r)){const o=Ht(r)?.unit;if(o)return`${n} (${B1(o).join("-")})`}else if(s)return wa(s)?`${n} for max ${s.argmax}`:no(s)?`${n} for min ${s.argmin}`:`${Lh(s)} of ${n}`;return n}function pge(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(wa(t))return`${r} for argmax(${t.argmax})`;if(no(t))return`${r} for argmin(${t.argmin})`;const s=i&&!Wu(i)?Ht(i):void 0,o=t||s?.unit||s?.maxbins&&"timeunit"||ft(n)&&"bin";return o?`${o.toUpperCase()}(${r})`:r}const c8=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return pge(e);default:return hge(e,t)}};let f8=c8;function d8(e){f8=e}function gge(){d8(c8)}function Fl(e,t,{allowDisabling:n,includeDefault:i=!0}){const r=tA(e)?.title;if(!J(e))return r??e.title;const s=e,o=i?nA(s,t):void 0;return n?Ct(r,s.title,o):r??s.title??o}function tA(e){if(cc(e)&&e.axis)return e.axis;if(u8(e)&&e.legend)return e.legend;if(Z$(e)&&e.header)return e.header}function nA(e,t){return f8(e,t)}function Ym(e){if(l8(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n}}else{const t=tA(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i}}}function mge(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(eA(e)&&G(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!wa(n)&&!no(n))return"quantitative";if(Hu(e)&&e.scale?.type)switch(Aw[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function vr(e){if(J(e))return e;if(Y1(e))return e.condition}function Nt(e){if(Me(e))return e;if(Vh(e))return e.condition}function h8(e,t,n,i={}){if(oe(e)||We(e)||ua(e)){const r=oe(e)?"string":We(e)?"number":"boolean";return Q(mhe(t,r,e)),{value:e}}return Me(e)?Xm(e,t,n,i):Vh(e)?{...e,condition:Xm(e.condition,t,n,i)}:e}function Xm(e,t,n,i){if(l8(e)){const{format:r,formatType:s,...o}=e;if($u(s)&&!n.customFormatTypes)return Q(NT(t)),Xm(o,t,n,i)}else{const r=cc(e)?"axis":u8(e)?"legend":Z$(e)?"header":null;if(r&&e[r]){const{format:s,formatType:o,...a}=e[r];if($u(o)&&!n.customFormatTypes)return Q(NT(t)),Xm({...e,[r]:a},t,n,i)}}return J(e)?iA(e,t,i):yge(e)}function yge(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=We(n)?"quantitative":oe(n)?"nominal":qu(n)?"temporal":void 0,{...e,type:t}}function iA(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:s,field:o}=e,a={...e};if(!n&&i&&!k$(i)&&!wa(i)&&!no(i)&&(Q(vhe(i)),delete a.aggregate),r&&(a.timeUnit=Ht(r)),o&&(a.field=`${o}`),ft(s)&&(a.bin=X1(s,t)),Kt(s)&&!kt(t)&&Q(Khe(t)),Un(a)){const{type:u}=a,l=wpe(u);u!==l&&(a.type=l),u!=="quantitative"&&I1(i)&&(Q(yhe(u,i)),a.type="quantitative")}else if(!oz(t)){const u=mge(a,t);a.type=u}if(Un(a)){const{compatible:u,warning:l}=vge(a,t)||{};u===!1&&Q(l)}if(eA(a)&&oe(a.sort)){const{sort:u}=a;if(UT(u))return{...a,sort:{encoding:u}};const l=u.substring(1);if(u.charAt(0)==="-"&&UT(l))return{...a,sort:{encoding:l,order:"descending"}}}if(Z$(a)){const{header:u}=a;if(u){const{orient:l,...c}=u;if(l)return{...a,header:{...c,labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l}}}}return a}function X1(e,t){return ua(e)?{maxbins:AT(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?{...e,maxbins:AT(t)}:e}const rl={compatible:!0};function vge(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Gs:case Vs:case T1:return Vm(e)?rl:{compatible:!1,warning:_he(t)};case mt:case Xt:case ga:case Bc:case ii:case ys:case vs:case zh:case Bh:case R1:case xu:case O1:case D1:case zu:case Hi:case Sr:case N1:return rl;case Ar:case qi:case $r:case Cr:return n!==Eu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:rl;case fo:case ya:case va:case ba:case co:case lo:case uo:case Er:case ms:case ma:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:rl;case ri:case xa:return!Vm(e)&&!fge(e)?{compatible:!1,warning:Ehe(t)}:rl;case oc:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:rl}}function fc(e){const{formatType:t}=Ym(e);return t==="time"||!t&&bge(e)}function bge(e){return e&&(e.type==="temporal"||J(e)&&!!e.timeUnit)}function K1(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){const s=t&&Ht(t)?.unit;let o=s||n==="temporal",a;return jh(e)?a=e.expr:ye(e)?a=e.signal:qu(e)?(o=!0,a=_u(e)):(oe(e)||We(e))&&o&&(a=`datetime(${Ze(e)})`,upe(s)&&(We(e)&&e<1e4||oe(e)&&isNaN(Date.parse(e)))&&(a=_u({[s]:e}))),a?i&&o?`time(${a})`:a:r?void 0:Ze(e)}function p8(e,t){const{type:n}=e;return t.map(i=>{const r=J(e)&&!Wu(e.timeUnit)?e.timeUnit:void 0,s=K1(i,{timeUnit:r,type:n,undefinedIfExprNotRequired:!0});return s!==void 0?{signal:s}:i})}function Yh(e,t){return ft(e.bin)?xs(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const WT={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Xh(e){return e?.condition}const g8=["domain","grid","labels","ticks","title"],xge={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},m8={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},wge={...m8,style:1,labelExpr:1,encoding:1};function HT(e){return fe(wge,e)}const _ge={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},y8=Y(_ge);function po(e){return K(e,"mark")}class Q1{name;run;constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return po(t)?Qpe(t.mark)===this.name:!1}}function nu(e,t){const n=e?.[t];return n?G(n)?rc(n,i=>!!i.field):J(n)||Y1(n):!1}function v8(e,t){const n=e?.[t];return n?G(n)?rc(n,i=>!!i.field):J(n)||ws(n)||Vh(n):!1}function b8(e,t){if(kt(t)){const n=e[t];if((J(n)||ws(n))&&(zz(n.type)||J(n)&&n.timeUnit)){const i=E$(t);return v8(e,i)}}return!1}function x8(e){return rc(yde,t=>{if(nu(e,t)){const n=e[t];if(G(n))return rc(n,i=>!!i.aggregate);{const i=vr(n);return i&&!!i.aggregate}}return!1})}function w8(e,t){const n=[],i=[],r=[],s=[],o={};return rA(e,(a,u)=>{if(J(a)){const{field:l,aggregate:c,bin:f,timeUnit:d,...h}=a;if(c||d||f){const g=tA(a)?.title;let m=ne(a,{forAs:!0});const y={...g?[]:{title:Fl(a,t,{allowDisabling:!0})},...h,field:m};if(c){let v;if(wa(c)?(v="argmax",m=ne({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):no(c)?(v="argmin",m=ne({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const b={op:v,as:m};l&&(b.field=l),s.push(b)}}else if(n.push(m),Un(a)&&ft(f)){if(i.push({bin:f,field:l,as:m}),n.push(ne(a,{binSuffix:"end"})),Yh(a,u)&&n.push(ne(a,{binSuffix:"range"})),kt(u)){const v={field:`${m}_end`};o[`${u}2`]=v}y.bin="binned",oz(u)||(y.type=Eu)}else if(d&&!Wu(d)){r.push({timeUnit:d,field:l,as:m});const v=Un(a)&&a.type!==ac&&"time";v&&(u===zh||u===xu?y.formatType=v:kde(u)?y.legend={formatType:v,...y.legend}:kt(u)&&(y.axis={formatType:v,...y.axis}))}o[u]=y}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:i,timeUnits:r,aggregate:s,groupby:n,encoding:o}}function Ege(e,t,n){const i=Fde(t,n);if(i){if(i==="binned"){const r=e[t===Er?mt:Xt];return!!(J(r)&&J(e[t])&&Kt(r.bin))}}else return!1;return!0}function Sge(e,t,n,i){const r={};for(const s of Y(e))sz(s)||Q(whe(s));for(let s of Ede){if(!e[s])continue;const o=e[s];if(Uh(s)){const a=_de(s),u=r[a];if(J(u)&&xpe(u.type)&&J(o)&&!u.timeUnit){Q(ghe(a));continue}}if(s==="angle"&&t==="arc"&&!e.theta&&(Q(phe),s=Hi),!Ege(e,s,t)){Q(z1(s,t));continue}if(s===co&&t==="line"&&vr(e[s])?.aggregate){Q(xhe);continue}if(s===ii&&(n?"fill"in e:"stroke"in e)){Q(Ez("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(s===Bh||s===oc&&!G(o)&&!yr(o)||s===xu&&G(o)){if(o){if(s===oc){const a=e[s];if(a8(a)){r[s]=a;continue}}r[s]=le(o).reduce((a,u)=>(J(u)?a.push(iA(u,s)):Q($w(u,s)),a),[])}}else{if(s===xu&&o===null)r[s]=null;else if(!J(o)&&!ws(o)&&!yr(o)&&!Gh(o)&&!ye(o)){Q($w(o,s));continue}r[s]=h8(o,s,i)}}return r}function J1(e,t){const n={};for(const i of Y(e)){const r=h8(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function $ge(e){const t=[];for(const n of Y(e))if(nu(e,n)){const i=e[n],r=le(i);for(const s of r)J(s)?t.push(s):Y1(s)&&t.push(s.condition)}return t}function rA(e,t,n){if(e)for(const i of Y(e)){const r=e[i];if(G(r))for(const s of r)t.call(n,s,i);else t.call(n,r,i)}}function Age(e,t,n,i){return e?Y(e).reduce((r,s)=>{const o=e[s];return G(o)?o.reduce((a,u)=>t.call(i,a,u,s),r):t.call(i,r,o,s)},n):n}function _8(e,t){return Y(t).reduce((n,i)=>{switch(i){case mt:case Xt:case O1:case N1:case D1:case Er:case ms:case ga:case Bc:case Hi:case lo:case Sr:case uo:case ma:case $r:case Ar:case Cr:case qi:case zh:case ri:case zu:case xu:return n;case oc:if(e==="line"||e==="trail")return n;case Bh:case R1:{const r=t[i];if(G(r)||J(r))for(const s of le(r))s.aggregate||n.push(ne(s,{}));return n}case co:if(e==="trail")return n;case ii:case ys:case vs:case fo:case ya:case va:case xa:case ba:{const r=vr(t[i]);return r&&!r.aggregate&&n.push(ne(r,{})),n}}},[])}function Cge(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(G(t)){for(const s of t)s.aggregate?(i||(i=[]),i.push(s)):(r||(r=[]),r.push(s));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return G(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function Mw(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:o,titlePrefix:a})=>{const u=i?` of ${sA(t)}`:"";return{field:o+t.field,type:t.type,title:ye(a)?{signal:`${a}"${escape(u)}"`}:a+u}}),s=$ge(n).map(lge);return{tooltip:[...r,...Wr(s,Ie)]}}function sA(e){const{title:t,field:n}=e;return Ct(t,n)}function oA(e,t,n,i,r){const{scale:s,axis:o}=n;return({partName:a,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=sA(n);return E8(e,a,r,{mark:u,encoding:{[t]:{field:`${l}_${n.field}`,type:n.type,...d!==void 0?{title:d}:{},...s!==void 0?{scale:s}:{},...o!==void 0?{axis:o}:{}},...oe(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{},...i,...f}})}}function E8(e,t,n,i){const{clip:r,color:s,opacity:o}=e,a=e.type;return e[t]||e[t]===void 0&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...s?{color:s}:{},...o?{opacity:o}:{},...as(i.mark)?i.mark:{type:i.mark},style:`${a}-${String(t)}`,...ua(e[t])?{}:e[t]}}]:[]}function S8(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",s=i[r],o=i[`${r}2`],a=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:Tp(s,n),continuousAxisChannelDef2:Tp(o,n),continuousAxisChannelDefError:Tp(a,n),continuousAxisChannelDefError2:Tp(u,n),continuousAxis:r}}function Tp(e,t){if(e?.aggregate){const{aggregate:n,...i}=e;return n!==t&&Q(Xhe(n,t)),i}else return e}function $8(e,t){const{mark:n,encoding:i}=e,{x:r,y:s}=i;if(as(n)&&n.orient)return n.orient;if(zo(r)){if(zo(s)){const o=J(r)&&r.aggregate,a=J(s)&&s.aggregate;if(!o&&a===t)return"vertical";if(!a&&o===t)return"horizontal";if(o===t&&a===t)throw new Error("Both x and y cannot have aggregate");return fc(s)&&!fc(r)?"horizontal":"vertical"}return"horizontal"}else{if(zo(s))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}const Km="boxplot",kge=["box","median","outliers","rule","ticks"],Mge=new Q1(Km,C8);function A8(e){return We(e)?"tukey":e}function C8(e,{config:t}){e={...e,encoding:J1(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:s,...o}=e,a=as(n)?n:{type:n};r&&Q(wz("boxplot"));const u=a.extent??t.boxplot.extent,l=Je("size",a,t),c=a.invalid,f=A8(u),{bins:d,timeUnits:h,transform:p,continuousAxisChannelDef:g,continuousAxis:m,groupby:y,aggregate:v,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:E}=Fge(e,u,t),_=zc(g.field),{color:$,size:A,...F}=b,M=W=>oA(a,m,g,W,t.boxplot),P=M(F),D=M(b),O=(ae(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",C=M({...F,...A?{size:A}:{},color:{condition:{test:`${nt(`lower_box_${g.field}`)} >= ${nt(`upper_box_${g.field}`)}`,...$||{value:O}}}}),R=Mw([{fieldPrefix:f==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:f==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],g,b),N={type:"tick",color:"black",opacity:1,orient:x,invalid:c,aria:!1},I=f==="min-max"?R:Mw([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],g,b),U=[...P({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:I}),...P({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:I}),...P({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:I}),...P({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:I})],re=[...f!=="tukey"?U:[],...D({partName:"box",mark:{type:"bar",...l?{size:l}:{},orient:w,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:R}),...C({partName:"median",mark:{type:"tick",invalid:c,...ae(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...l?{size:l}:{},orient:x,aria:!1},positionPrefix:"mid_box",extraEncoding:R})];if(f==="min-max")return{...o,transform:(o.transform??[]).concat(p),layer:re};const me=nt(`lower_box_${g.field}`),de=nt(`upper_box_${g.field}`),$e=`(${de} - ${me})`,Be=`${me} - ${u} * ${$e}`,Ae=`${de} + ${u} * ${$e}`,et=nt(g.field),V={joinaggregate:k8(g.field),groupby:y},ce={transform:[{filter:`(${Be} <= ${et}) && (${et} <= ${Ae})`},{aggregate:[{op:"min",field:g.field,as:`lower_whisker_${_}`},{op:"max",field:g.field,as:`upper_whisker_${_}`},{op:"min",field:`lower_box_${g.field}`,as:`lower_box_${_}`},{op:"max",field:`upper_box_${g.field}`,as:`upper_box_${_}`},...v],groupby:y}],layer:U},{tooltip:L,...X}=F,{scale:pe,axis:S}=g,k=sA(g),T=E8(a,"outliers",t.boxplot,{transform:[{filter:`(${et} < ${Be}) || (${et} > ${Ae})`}],mark:"point",encoding:{[m]:{field:g.field,type:g.type,...k!==void 0?{title:k}:{},...pe!==void 0?{scale:pe}:{},...S!==void 0?{axis:S}:{}},...X,...$?{color:$}:{},...E?{tooltip:E}:{}}})[0];let B;const H=[...d,...h,V];return T?B={transform:H,layer:[T,ce]}:(B=ce,B.transform.unshift(...H)),{...o,layer:[B,{transform:p,layer:re}]}}function k8(e){const t=zc(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}]}function Fge(e,t,n){const i=$8(e,Km),{continuousAxisChannelDef:r,continuousAxis:s}=S8(e,i,Km),o=r.field,a=zc(o),u=A8(t),l=[...k8(o),{op:"median",field:o,as:`mid_box_${a}`},{op:"min",field:o,as:(u==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:o,as:(u==="min-max"?"upper_whisker_":"max_")+a}],c=u==="min-max"||u==="tukey"?[]:[{calculate:`${nt(`upper_box_${a}`)} - ${nt(`lower_box_${a}`)}`,as:`iqr_${a}`},{calculate:`min(${nt(`upper_box_${a}`)} + ${nt(`iqr_${a}`)} * ${t}, ${nt(`max_${a}`)})`,as:`upper_whisker_${a}`},{calculate:`max(${nt(`lower_box_${a}`)} - ${nt(`iqr_${a}`)} * ${t}, ${nt(`min_${a}`)})`,as:`lower_whisker_${a}`}],{[s]:f,...d}=e.encoding,{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=Cge(d),{bins:g,timeUnits:m,aggregate:y,groupby:v,encoding:b}=w8(p,n),x=i==="vertical"?"horizontal":"vertical",w=i,E=[...g,...m,{aggregate:[...y,...l],groupby:v},...c];return{bins:g,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:s,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const aA="errorbar",Tge=["ticks","rule"],Rge=new Q1(aA,M8);function M8(e,{config:t}){e={...e,encoding:J1(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,ticksOrient:o,markDef:a,outerSpec:u,tooltipEncoding:l}=F8(e,aA,t);delete s.size;const c=oA(a,r,i,s,t.errorbar),f=a.thickness,d=a.size,h={type:"tick",orient:o,aria:!1,...f!==void 0?{thickness:f}:{},...d!==void 0?{size:d}:{}},p=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...f!==void 0?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...u,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function Oge(e,t){const{encoding:n}=e;if(Dge(n))return{orient:$8(e,t),inputType:"raw"};const i=Nge(n),r=Pge(n),s=n.x,o=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const a=n.x2,u=n.y2;if(Me(a)&&Me(u))throw new Error(`${t} cannot have both x2 and y2`);if(Me(a)){if(zo(s))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(Me(u)){if(zo(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const a=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(Me(u)&&!Me(a))throw new Error(`${t} cannot have xError2 without xError`);if(Me(c)&&!Me(l))throw new Error(`${t} cannot have yError2 without yError`);if(Me(a)&&Me(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(Me(a)){if(zo(s))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(Me(l)){if(zo(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Dge(e){return(Me(e.x)||Me(e.y))&&!Me(e.x2)&&!Me(e.y2)&&!Me(e.xError)&&!Me(e.xError2)&&!Me(e.yError)&&!Me(e.yError2)}function Nge(e){return Me(e.x2)||Me(e.y2)}function Pge(e){return Me(e.xError)||Me(e.xError2)||Me(e.yError)||Me(e.yError2)}function F8(e,t,n){const{mark:i,encoding:r,params:s,projection:o,...a}=e,u=as(i)?i:{type:i};s&&Q(wz(t));const{orient:l,inputType:c}=Oge(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:h,continuousAxisChannelDefError2:p,continuousAxis:g}=S8(e,l,t),{errorBarSpecificAggregate:m,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=Ige(u,f,d,h,p,c,t,n),{[g]:x,[g==="x"?"x2":"y2"]:w,[g==="x"?"xError":"yError"]:E,[g==="x"?"xError2":"yError2"]:_,...$}=r,{bins:A,timeUnits:F,aggregate:M,groupby:P,encoding:D}=w8($,n),O=[...M,...m],C=c!=="raw"?[]:P,R=Mw(v,f,D,b);return{transform:[...a.transform??[],...A,...F,...O.length===0?[]:[{aggregate:O,groupby:C}],...y],groupby:C,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:D,ticksOrient:l==="vertical"?"horizontal":"vertical",markDef:u,outerSpec:a,tooltipEncoding:R}}function Ige(e,t,n,i,r,s,o,a){let u=[],l=[];const c=t.field;let f,d=!1;if(s==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":a.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Q(Yhe(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`${nt(`center_${c}`)} + ${nt(`extent_${c}`)}`,as:`upper_${c}`},{calculate:`${nt(`center_${c}`)} - ${nt(`extent_${c}`)}`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:Lh(h)},{fieldPrefix:"upper_",titlePrefix:GT(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:GT(h,p,"-")}],d=!0;else{let g,m,y;p==="ci"?(g="mean",m="ci0",y="ci1"):(g="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:g,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Fl({field:c,aggregate:y,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Fl({field:c,aggregate:m,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Fl({field:c,aggregate:g,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Q(Vhe(e.center,e.extent)),s==="aggregated-upper-lower"?(f=[],l=[{calculate:nt(n.field),as:`upper_${c}`},{calculate:nt(c),as:`lower_${c}`}]):s==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`${nt(c)} + ${nt(i.field)}`,as:`upper_${c}`}],r?l.push({calculate:`${nt(c)} + ${nt(r.field)}`,as:`lower_${c}`}):l.push({calculate:`${nt(c)} - ${nt(i.field)}`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:bu(bu(h.calculate,"datum['",""),"']","")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function GT(e,t,n){return`${Lh(e)} ${n} ${t}`}const uA="errorband",Lge=["band","borders"],zge=new Q1(uA,T8);function T8(e,{config:t}){e={...e,encoding:J1(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:s,markDef:o,outerSpec:a,tooltipEncoding:u}=F8(e,uA,t),l=o,c=oA(l,r,i,s,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},h={...h,...p,aria:!1}):l.interpolate?Q(IT("interpolate")):l.tension&&Q(IT("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]}}const R8={};function lA(e,t,n){const i=new Q1(e,t);R8[e]={normalizer:i,parts:n}}function Bge(){return Y(R8)}lA(Km,C8,kge);lA(aA,M8,Tge);lA(uA,T8,Lge);const Uge=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],O8={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},D8={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},jge=Y(O8),qge=Y(D8),Wge={header:1,headerRow:1,headerColumn:1,headerFacet:1},N8=Y(Wge),P8=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Hge={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Gge={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},br="_vgsid_",Vge={point:{on:"click",fields:[br],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function cA(e){return e==="legend"||!!e?.legend}function Hv(e){return cA(e)&&ae(e)}function fA(e){return!!e?.select}function I8(e){const t=[];for(const n of e||[]){if(fA(n))continue;const{expr:i,bind:r,...s}=n;if(r&&i){const o={...s,bind:r,init:i};t.push(o)}else{const o={...s,...i?{update:i}:{},...r?{bind:r}:{}};t.push(o)}}return t}function Yge(e){return Z1(e)||hA(e)||dA(e)}function dA(e){return K(e,"concat")}function Z1(e){return K(e,"vconcat")}function hA(e){return K(e,"hconcat")}function L8({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position"}function us(e){return K(e,"step")}function VT(e){return K(e,"view")||K(e,"width")||K(e,"height")}const YT=20,Xge={align:1,bounds:1,center:1,columns:1,spacing:1},Kge=Y(Xge);function Qge(e,t,n){const i=n[t],r={},{spacing:s,columns:o}=i;s!==void 0&&(r.spacing=s),o!==void 0&&(V1(e)&&!Hh(e.facet)||dA(e))&&(r.columns=o),Z1(e)&&(r.columns=1);for(const a of Kge)if(e[a]!==void 0)if(a==="spacing"){const u=e[a];r[a]=We(u)?u:{row:u.row??s,column:u.column??s}}else r[a]=e[a];return r}function Fw(e,t){return e[t]??e[t==="width"?"continuousWidth":"continuousHeight"]}function Tw(e,t){const n=Qm(e,t);return us(n)?n.step:z8}function Qm(e,t){const n=e[t]??e[t==="width"?"discreteWidth":"discreteHeight"];return Ct(n,{step:e.step})}const z8=20,Jge={continuousWidth:300,continuousHeight:300,step:z8},Zge={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Jge,mark:Hpe,arc:{},area:{},bar:Xpe,circle:{},geoshape:{},image:{},line:{},point:{},rect:Y$,rule:{color:"black"},square:{},text:{color:"black"},tick:Kpe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Ape,projection:{},legend:Hge,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Vge,style:{},title:{},facet:{spacing:YT},concat:{spacing:YT},normalizedNumberFormat:".0%"},Cs=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],XT={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},KT={blue:Cs[0],orange:Cs[1],red:Cs[2],teal:Cs[3],green:Cs[4],yellow:Cs[5],purple:Cs[6],pink:Cs[7],brown:Cs[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function eme(e={}){return{signals:[{name:"color",value:ae(e)?{...KT,...e}:KT}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function tme(e){return{signals:[{name:"fontSize",value:ae(e)?{...XT,...e}:XT}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function nme(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function B8(e){const t=Y(e||{}),n={};for(const i of t){const r=e[i];n[i]=Xh(r)?pz(r):hi(r)}return n}function ime(e){const t=Y(e),n={};for(const i of t)n[i]=B8(e[i]);return n}const rme=[...Xz,...y8,...N8,"background","padding","legend","lineBreak","scale","style","title","view"];function U8(e={}){const{color:t,font:n,fontSize:i,selection:r,...s}=e,o=_c({},Ce(Zge),n?nme(n):{},t?eme(t):{},i?tme(i):{},s||{});r&&Ec(o,"selection",r,!0);const a=xi(o,rme);for(const u of["background","lineBreak","padding"])o[u]&&(a[u]=hi(o[u]));for(const u of Xz)o[u]&&(a[u]=Qt(o[u]));for(const u of y8)o[u]&&(a[u]=B8(o[u]));for(const u of N8)o[u]&&(a[u]=Qt(o[u]));if(o.legend&&(a.legend=Qt(o.legend)),o.scale){const{invalid:u,...l}=o.scale,c=Qt(u,{level:1});a.scale={...Qt(l),...Y(c).length>0?{invalid:c}:{}}}return o.style&&(a.style=ime(o.style)),o.title&&(a.title=Qt(o.title)),o.view&&(a.view=Qt(o.view)),a}const sme=new Set(["view",...zpe]),ome=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],ame={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],...Wpe};function ume(e){e=Ce(e);for(const t of ome)delete e[t];if(e.axis)for(const t in e.axis)Xh(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Uge)delete e.legend[t];if(e.mark){for(const t of zT)delete e.mark[t];e.mark.tooltip&&ae(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(I8(e.params)),delete e.params);for(const t of sme){for(const i of zT)delete e[t][i];const n=ame[t];if(n)for(const i of n)delete e[t][i];cme(e,t)}for(const t of Bge())delete e[t];lme(e);for(const t in e)ae(e[t])&&at(e[t])&&delete e[t];return at(e)?void 0:e}function lme(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=hz(e.title);at(t)||(e.style["group-title"]={...e.style["group-title"],...t}),at(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n}),at(i)?delete e.title:e.title=i}function cme(e,t,n,i){const r=e[t];t==="view"&&(n="cell");const s={...r,...e.style[n??t]};at(s)||(e.style[n??t]=s),delete e[t]}function ey(e){return K(e,"layer")}function fme(e){return K(e,"repeat")}function dme(e){return!G(e.repeat)&&K(e.repeat,"layer")}class pA{map(t,n){return V1(t)?this.mapFacet(t,n):fme(t)?this.mapRepeat(t,n):hA(t)?this.mapHConcat(t,n):Z1(t)?this.mapVConcat(t,n):dA(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(ey(t))return this.mapLayer(t,n);if(po(t))return this.mapUnit(t,n);throw new Error(M$(t))}mapLayer(t,n){return{...t,layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))}}mapHConcat(t,n){return{...t,hconcat:t.hconcat.map(i=>this.map(i,n))}}mapVConcat(t,n){return{...t,vconcat:t.vconcat.map(i=>this.map(i,n))}}mapConcat(t,n){const{concat:i,...r}=t;return{...r,concat:i.map(s=>this.map(s,n))}}mapFacet(t,n){return{...t,spec:this.map(t.spec,n)}}mapRepeat(t,n){return{...t,spec:this.map(t.spec,n)}}}const hme={zero:1,center:1,normalize:1};function pme(e){return fe(hme,e)}const gme=new Set([Gz,q1,j1,Wm,H1,G$,V$,W1,Vz,H$]),mme=new Set([q1,j1,Gz]);function sl(e){return J(e)&&lc(e)==="quantitative"&&!e.bin}function QT(e,t,{orient:n,type:i}){const r=t==="x"?"y":"radius",s=t==="x"&&["bar","area"].includes(i),o=e[t],a=e[r];if(J(o)&&J(a))if(sl(o)&&sl(a)){if(o.stack)return t;if(a.stack)return r;const u=J(o)&&!!o.aggregate,l=J(a)&&!!a.aggregate;if(u!==l)return u?t:r;if(s){if(n==="vertical")return r;if(n==="horizontal")return t}}else{if(sl(o))return t;if(sl(a))return r}else{if(sl(o))return s&&n==="vertical"?void 0:t;if(sl(a))return s&&n==="horizontal"?void 0:r}}function yme(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function j8(e,t){const n=as(e)?e:{type:e},i=n.type;if(!gme.has(i))return null;const r=QT(t,"x",n)||QT(t,"theta",n);if(!r)return null;const s=t[r],o=J(s)?ne(s,{}):void 0,a=yme(r),u=[],l=new Set;if(t[a]){const g=t[a],m=J(g)?ne(g,{}):void 0;m&&m!==o&&(u.push(a),l.add(m))}const c=a==="x"?"xOffset":"yOffset",f=t[c],d=J(f)?ne(f,{}):void 0;d&&d!==o&&(u.push(c),l.add(d));const h=Sde.reduce((g,m)=>{if(m!=="tooltip"&&nu(t,m)){const y=t[m];for(const v of le(y)){const b=vr(v);if(b.aggregate)continue;const x=ne(b,{});(!x||!l.has(x))&&g.push({channel:m,fieldDef:b})}}return g},[]);let p;return s.stack!==void 0?ua(s.stack)?p=s.stack?"zero":null:p=s.stack:mme.has(i)&&(p="zero"),!p||!pme(p)||x8(t)&&h.length===0?null:(s?.scale?.type&&s?.scale?.type!==Jt.LINEAR&&s?.stack&&Q(Whe(s.scale.type)),Me(t[bs(r)])?(s.stack!==void 0&&Q(qhe(r)),null):(J(s)&&s.aggregate&&!Ide.has(s.aggregate)&&Q(Hhe(s.aggregate)),{groupbyChannels:u,groupbyFields:l,fieldChannel:r,impute:s.impute===null?!1:_a(i),stackBy:h,offset:p}))}function q8(e,t,n){const i=Qt(e),r=Je("orient",i,n);if(i.orient=wme(i.type,t,r),r!==void 0&&r!==i.orient&&Q(Che(i.orient,r)),i.type==="bar"&&i.orient){const u=Je("cornerRadiusEnd",i,n);if(u!==void 0){const l=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:Vpe[i.orient];for(const c of l)i[c]=u;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}const s=Je("opacity",i,n),o=Je("fillOpacity",i,n);return s===void 0&&o===void 0&&(i.opacity=bme(i.type,t)),Je("cursor",i,n)===void 0&&(i.cursor=vme(i,t,n)),i}function vme(e,t,n){return t.href||e.href||Je("href",e,n)?"pointer":e.cursor}const W8=.7;function bme(e,t){if(Pe([H1,H$,G$,V$],e)&&!x8(t))return W8}function xme(e,t,{graticule:n}){if(n)return!1;const i=os("filled",e,t),r=e.type;return Ct(i,r!==H1&&r!==W1&&r!==Wm)}function wme(e,t,n){switch(e){case H1:case G$:case V$:case Ipe:case Ppe:return}const{x:i,y:r,x2:s,y2:o}=t;switch(e){case Vz:case q1:if(J(i)&&(Kt(i.bin)||J(r)&&r.aggregate&&!i.aggregate))return"vertical";if(J(r)&&(Kt(r.bin)||J(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(o||s){if(n)return n;if(!s)return(J(i)&&i.type===Eu&&!ft(i.bin)||Gm(i))&&J(r)&&Kt(r.bin)?"horizontal":"vertical";if(!o)return(J(r)&&r.type===Eu&&!ft(r.bin)||Gm(r))&&J(i)&&Kt(i.bin)?"vertical":"horizontal"}case Wm:if(s&&!(J(i)&&Kt(i.bin))&&o&&!(J(r)&&Kt(r.bin)))return;case j1:if(o)return J(r)&&Kt(r.bin)?"horizontal":"vertical";if(s)return J(i)&&Kt(i.bin)?"vertical":"horizontal";if(e===Wm){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case W1:case H$:{const a=qT(i),u=qT(r);if(n)return n;if(a&&!u)return e!=="tick"?"horizontal":"vertical";if(!a&&u)return e!=="tick"?"vertical":"horizontal";if(a&&u)return"vertical";{const l=Un(i)&&i.type===ac,c=Un(r)&&r.type===ac;if(l&&!c)return"vertical";if(!l&&c)return"horizontal"}return}}return"vertical"}function _me(e){const{point:t,line:n,...i}=e;return Y(i).length>1?i:i.type}function Eme(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:xi(e[t],["point","line"])});return e}function Gv(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?ae(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?ae(t.point)?t.point:{}:void 0}function JT(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Sme{name="path-overlay";hasMatchingType(t,n){if(po(t)){const{mark:i,encoding:r}=t,s=as(i)?i:{type:i};switch(s.type){case"line":case"rule":case"trail":return!!Gv(s,n[s.type],r);case"area":return!!Gv(s,n[s.type],r)||!!JT(s,n[s.type])}}return!1}run(t,n,i){const{config:r}=n,{params:s,projection:o,mark:a,name:u,encoding:l,...c}=t,f=J1(l,r),d=as(a)?a:{type:a},h=Gv(d,r[d.type],f),p=d.type==="area"&&JT(d,r[d.type]),g=[{name:u,...s?{params:s}:{},mark:_me({...d.type==="area"&&Je("opacity",d,r)==null&&Je("fillOpacity",d,r)==null?{opacity:W8}:{},...d}),encoding:xi(f,["shape"])}],m=j8(q8(d,f,r),f);let y=f;if(m){const{fieldChannel:v,offset:b}=m;y={...f,[v]:{...f[v],...b?{stack:b}:{}}}}return y=xi(y,["y2","x2"]),p&&g.push({...o?{projection:o}:{},mark:{type:"line",...ic(d,["clip","interpolate","tension","tooltip"]),...p},encoding:y}),h&&g.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...ic(d,["clip","tooltip"]),...h},encoding:y}),i({...c,layer:g},{...n,config:Eme(r)})}}function $me(e,t){return t?Hh(e)?G8(e,t):H8(e,t):e}function Vv(e,t){return t?G8(e,t):e}function Rw(e,t,n){const i=t[e];if(age(i)){if(i.repeat in n)return{...t,[e]:n[i.repeat]};Q(rhe(i.repeat));return}return t}function H8(e,t){if(e=Rw("field",e,t),e!==void 0){if(e===null)return null;if(eA(e)&&Ys(e.sort)){const n=Rw("field",e.sort,t);e={...e,...n?{sort:n}:{}}}return e}}function ZT(e,t){if(J(e))return H8(e,t);{const n=Rw("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function eR(e,t){if(Me(e)){const n=ZT(e,t);if(n)return n;if(Gh(e))return{condition:e.condition}}else{if(Vh(e)){const n=ZT(e.condition,t);if(n)return{...e,condition:n};{const{condition:i,...r}=e;return r}}return e}}function G8(e,t){const n={};for(const i in e)if(K(e,i)){const r=e[i];if(G(r))n[i]=r.map(s=>eR(s,t)).filter(s=>s);else{const s=eR(r,t);s!==void 0&&(n[i]=s)}}return n}class Ame{name="RuleForRangedLine";hasMatchingType(t){if(po(t)){const{encoding:n,mark:i}=t;if(i==="line"||as(i)&&i.type==="line")for(const r of wde){const s=Bu(r),o=n[s];if(n[r]&&(J(o)&&!Kt(o.bin)||ws(o)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:s}=t;return Q(Ahe(!!r.x2,!!r.y2)),i({...t,mark:ae(s)?{...s,type:"rule"}:"rule"},n)}}class Cme extends pA{nonFacetUnitNormalizers=[Mge,Rge,zge,new Sme,new Ame];map(t,n){if(po(t)){const i=nu(t.encoding,Gs),r=nu(t.encoding,Vs),s=nu(t.encoding,T1);if(i||r||s)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,s=Vv(t.encoding,n.repeater),o={...t,...t.name?{name:[n.repeaterPrefix,t.name].filter(u=>u).join("_")}:{},...s?{encoding:s}:{}};if(i||r)return this.mapUnitWithParentEncodingOrProjection(o,n);const a=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(o,n.config))return u.run(o,n,a);return o}mapRepeat(t,n){return dme(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r,...s}=t,{row:o,column:a,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return o||a?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:u},spec:r}},n):{...s,layer:u.map(f=>{const d={...l,layer:f},h=`${(r.name?`${r.name}_`:"")+c}child__layer_${gt(f)}`,p=this.mapLayerOrUnit(r,{...n,repeater:d,repeaterPrefix:h});return p.name=h,p})}}mapNonLayerRepeat(t,n){const{repeat:i,spec:r,data:s,...o}=t;!G(i)&&t.columns&&(t=xi(t,["columns"]),Q(OT("repeat")));const a=[],{repeater:u={},repeaterPrefix:l=""}=n,c=!G(i)&&i.row||[u?u.row:null],f=!G(i)&&i.column||[u?u.column:null],d=G(i)&&i||[u?u.repeat:null];for(const p of d)for(const g of c)for(const m of f){const y={repeat:p,row:g,column:m,layer:u.layer},v=`${(r.name?`${r.name}_`:"")+l}child__${G(i)?`${gt(p)}`:(i.row?`row_${gt(g)}`:"")+(i.column?`column_${gt(m)}`:"")}`,b=this.map(r,{...n,repeater:y,repeaterPrefix:v});b.name=v,a.push(xi(b,["data"]))}const h=G(i)?t.columns:i.column?i.column.length:1;return{data:r.data??s,align:"all",...o,columns:h,concat:a}}mapFacet(t,n){const{facet:i}=t;return Hh(i)&&t.columns&&(t=xi(t,["columns"]),Q(OT("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:s,parentProjection:o,config:a}=n,u=nR({parentProjection:o,projection:r}),l=tR({parentEncoding:s,encoding:Vv(i,n.repeater)});return this.mapUnit({...t,...u?{projection:u}:{},...l?{encoding:l}:{}},{config:a})}mapFacetedUnit(t,n){const{row:i,column:r,facet:s,...o}=t.encoding,{mark:a,width:u,projection:l,height:c,view:f,params:d,encoding:h,...p}=t,{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:i,column:r,facet:s},n),y=Vv(o,n.repeater);return this.mapFacet({...p,...m,facet:g,spec:{...u?{width:u}:{},...c?{height:c}:{},...f?{view:f}:{},...l?{projection:l}:{},mark:a,encoding:y,...d?{params:d}:{}}},n)}getFacetMappingAndLayout(t,n){const{row:i,column:r,facet:s}=t;if(i||r){s&&Q(She([...i?[Gs]:[],...r?[Vs]:[]]));const o={},a={};for(const u of[Gs,Vs]){const l=t[u];if(l){const{align:c,center:f,spacing:d,columns:h,...p}=l;o[u]=p;for(const g of["align","center","spacing"])l[g]!==void 0&&(a[g]??={},a[g][u]=l[g])}}return{facetMapping:o,layout:a}}else{const{align:o,center:a,spacing:u,columns:l,...c}=s;return{facetMapping:$me(c,n.repeater),layout:{...o?{align:o}:{},...a?{center:a}:{},...u?{spacing:u}:{},...l?{columns:l}:{}}}}}mapLayer(t,{parentEncoding:n,parentProjection:i,...r}){const{encoding:s,projection:o,...a}=t,u={...r,parentEncoding:tR({parentEncoding:n,encoding:s,layer:!0}),parentProjection:nR({parentProjection:i,projection:o})};return super.mapLayer({...a,...t.name?{name:[u.repeaterPrefix,t.name].filter(l=>l).join("_")}:{}},u)}}function tR({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...Y(e),...Y(t)]);for(const s of r){const o=t[s],a=e[s];if(Me(o)){const u={...a,...o};i[s]=u}else Vh(o)?i[s]={...o,condition:{...a,...o.condition}}:o||o===null?i[s]=o:(n||yr(a)||ye(a)||Me(a)||G(a))&&(i[s]=a)}}else i=t;return!i||at(i)?void 0:i}function nR(e){const{parentProjection:t,projection:n}=e;return t&&n&&Q(hhe({parentProjection:t,projection:n})),n??t}function gA(e){return K(e,"filter")}function kme(e){return K(e,"stop")}function V8(e){return K(e,"lookup")}function Mme(e){return K(e,"data")}function Fme(e){return K(e,"param")}function Tme(e){return K(e,"pivot")}function Rme(e){return K(e,"density")}function Ome(e){return K(e,"quantile")}function Dme(e){return K(e,"regression")}function Nme(e){return K(e,"loess")}function Pme(e){return K(e,"sample")}function Ime(e){return K(e,"window")}function Lme(e){return K(e,"joinaggregate")}function zme(e){return K(e,"flatten")}function Bme(e){return K(e,"calculate")}function Y8(e){return K(e,"bin")}function Ume(e){return K(e,"impute")}function jme(e){return K(e,"timeUnit")}function qme(e){return K(e,"aggregate")}function Wme(e){return K(e,"stack")}function Hme(e){return K(e,"fold")}function Gme(e){return K(e,"extent")&&!K(e,"density")&&!K(e,"regression")}function Vme(e){return e.map(t=>gA(t)?{filter:kl(t.filter,bpe)}:t)}class Yme extends pA{map(t,n){return n.emptySelections??={},n.selectionPredicates??={},t=iR(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=iR(t,n),t.encoding){const i={};for(const[r,s]of ia(t.encoding))i[r]=X8(s,n);t={...t,encoding:i}}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const{selection:i,...r}=t;return i?{...r,params:ia(i).map(([s,o])=>{const{init:a,bind:u,empty:l,...c}=o;c.type==="single"?(c.type="point",c.toggle=!1):c.type==="multi"&&(c.type="point"),n.emptySelections[s]=l!=="none";for(const f of Ft(n.selectionPredicates[s]??{}))f.empty=l!=="none";return{name:s,value:a,select:c,bind:u}})}:t}}function iR(e,t){const{transform:n,...i}=e;if(n){const r=n.map(s=>{if(gA(s))return{filter:Ow(s,t)};if(Y8(s)&&Uu(s.bin))return{...s,bin:K8(s.bin)};if(V8(s)){const{selection:o,...a}=s.from;return o?{...s,from:{param:o,...a}}:s}return s});return{...i,transform:r}}return e}function X8(e,t){const n=Ce(e);if(J(n)&&Uu(n.bin)&&(n.bin=K8(n.bin)),Hu(n)&&n.scale?.domain?.selection){const{selection:i,...r}=n.scale.domain;n.scale.domain={...r,...i?{param:i}:{}}}if(Gh(n))if(G(n.condition))n.condition=n.condition.map(i=>{const{selection:r,param:s,test:o,...a}=i;return s?i:{...a,test:Ow(i,t)}});else{const{selection:i,param:r,test:s,...o}=X8(n.condition,t);n.condition=r?n.condition:{...o,test:Ow(n.condition,t)}}return n}function K8(e){const t=e.extent;if(t?.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}}}return e}function Ow(e,t){const n=i=>kl(i,r=>{const s=t.emptySelections[r]??!0,o={param:r,empty:s};return t.selectionPredicates[r]??=[],t.selectionPredicates[r].push(o),o});return e.selection?n(e.selection):kl(e.test||e.filter,i=>i.selection?n(i.selection):i)}class Dw extends pA{map(t,n){const i=n.selections??[];if(t.params&&!po(t)){const r=[];for(const s of t.params)fA(s)?i.push(s):r.push(s);t.params=r}return n.selections=i,super.map(t,n)}mapUnit(t,n){const i=n.selections;if(!i||!i.length)return t;const r=(n.path??[]).concat(t.name),s=[];for(const o of i)if(!o.views||!o.views.length)s.push(o);else for(const a of o.views)(oe(a)&&(a===t.name||r.includes(a))||G(a)&&a.map(u=>r.indexOf(u)).every((u,l,c)=>u!==-1&&(l===0||u>c[l-1])))&&s.push(o);return s.length&&(t.params=s),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=Dw.prototype[e];Dw.prototype[e]=function(n,i){return t.call(this,n,Xme(n,i))}}function Xme(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t}function Q8(e,t){t===void 0&&(t=U8(e.config));const n=Zme(e,t),{width:i,height:r}=e,s=e0e(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...s?{autosize:s}:{}}}const Kme=new Cme,Qme=new Yme,Jme=new Dw;function Zme(e,t={}){const n={config:t};return Jme.map(Kme.map(Qme.map(e,n),n),n)}function rR(e){return oe(e)?{type:e}:e??{}}function e0e(e,t,n){let{width:i,height:r}=t;const s=po(e)||ey(e),o={};s?i=="container"&&r=="container"?(o.type="fit",o.contains="padding"):i=="container"?(o.type="fit-x",o.contains="padding"):r=="container"&&(o.type="fit-y",o.contains="padding"):(i=="container"&&(Q(MT("width")),i=void 0),r=="container"&&(Q(MT("height")),r=void 0));const a={type:"pad",...o,...n?rR(n.autosize):{},...rR(e.autosize)};if(a.type==="fit"&&!s&&(Q(Vde),a.type="pad"),i=="container"&&!(a.type=="fit"||a.type=="fit-x")&&Q(FT("width")),r=="container"&&!(a.type=="fit"||a.type=="fit-y")&&Q(FT("height")),!mi(a,{type:"pad"}))return a}function t0e(e){return["fit","fit-x","fit-y"].includes(e)}function n0e(e){return e?`fit-${P1(e)}`:"fit"}const i0e=["background","padding"];function sR(e,t){const n={};for(const i of i0e)e&&e[i]!==void 0&&(n[i]=hi(e[i]));return t&&(n.params=e.params),n}class go{explicit;implicit;constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new go(Ce(this.explicit),Ce(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return Ct(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Y(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function Lr(e){return{explicit:!0,value:e}}function ci(e){return{explicit:!1,value:e}}function J8(e){return(t,n,i,r)=>{const s=e(t.value,n.value);return s>0?t:s<0?n:ty(t,n,i,r)}}function ty(e,t,n,i){return e.explicit&&t.explicit&&Q(Phe(n,i,e.value,t.value)),e}function oa(e,t,n,i,r=ty){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:mi(e.value,t.value)?e:r(e,t,n,i)}class r0e extends go{explicit;implicit;parseNothing;constructor(t={},n={},i=!1){super(t,n),this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function dc(e){return K(e,"url")}function eh(e){return K(e,"values")}function Z8(e){return K(e,"name")&&!dc(e)&&!eh(e)&&!Go(e)}function Go(e){return e&&(e9(e)||t9(e)||mA(e))}function e9(e){return K(e,"sequence")}function t9(e){return K(e,"sphere")}function mA(e){return K(e,"graticule")}var xt;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid"})(xt||(xt={}));function n9({invalid:e,isPath:t}){switch(Kz(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"}}}function s0e(e){const{marks:t,scales:n}=n9(e);return t===n?xt.Main:n==="include-invalid-values"?xt.PreFilterInvalid:xt.PostFilterInvalid}class rt{debugName;_children=[];_parent=null;_hash;constructor(t,n){this.debugName=n,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){Q(che);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this);const i=t.parent.removeChild(t);this._parent=n,n.addChild(this,i),t.parent=this}}class Zn extends rt{type;refCounts;_source;_name;clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,n,i,r){super(t,n),this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${Q4()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function Yv(e){return e.as!==void 0}function oR(e){return`${e}_end`}class Kr extends rt{timeUnits;clone(){return new Kr(null,Ce(this.timeUnits))}constructor(t,n){super(t),this.timeUnits=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{const{field:a,timeUnit:u}=s;if(u){let l;if(Wu(u)){if(vt(n)){const{mark:c,markDef:f,config:d}=n,h=sa({fieldDef:s,markDef:f,config:d});(Zd(c)||h)&&(l={timeUnit:Ht(u),field:a})}}else l={as:ne(s,{forAs:!0}),field:a,timeUnit:u};if(vt(n)){const{mark:c,markDef:f,config:d}=n,h=sa({fieldDef:s,markDef:f,config:d});Zd(c)&&kt(o)&&h!==.5&&(l.rectBandPosition=h)}l&&(r[Ie(l)]=l)}return r},{});return at(i)?null:new Kr(t,i)}static makeFromTransform(t,n){const{timeUnit:i,...r}={...n},s=Ht(i),o={...r,timeUnit:s};return new Kr(t,{[Ie(o)]:o})}merge(t){this.timeUnits={...this.timeUnits};for(const n in t.timeUnits)this.timeUnits[n]||(this.timeUnits[n]=t.timeUnits[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of ia(this.timeUnits)){const s=Yv(r)?r.as:`${r.field}_end`;t.has(s)||(n[i]=r)}this.timeUnits=n}producedFields(){return new Set(Ft(this.timeUnits).map(t=>Yv(t)?t.as:oR(t.field)))}dependentFields(){return new Set(Ft(this.timeUnits).map(t=>t.field))}hash(){return`TimeUnit ${Ie(this.timeUnits)}`}assemble(){const t=[];for(const n of Ft(this.timeUnits)){const{rectBandPosition:i}=n,r=Ht(n.timeUnit);if(Yv(n)){const{field:s,as:o}=n,{unit:a,utc:u,...l}=r,c=[o,`${o}_end`];t.push({field:ji(s),type:"timeunit",...a?{units:B1(a)}:{},...u?{timezone:"utc"}:{},...l,as:c}),t.push(...aR(c,i,r))}else if(n){const{field:s}=n,o=X4(s),a=i9({timeUnit:r,field:o}),u=oR(o);t.push({type:"formula",expr:a,as:u}),t.push(...aR([o,u],i,r))}}return t}}const ny="offsetted_rect_start",iy="offsetted_rect_end";function i9({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,s=Rz(i),{part:o,step:a}=Pz(s,e.step);return`${r?"utcOffset":"timeOffset"}('${o}', ${nt(t)}, ${n?-a:a})`}function aR([e,t],n,i){if(n!==void 0&&n!==.5){const r=nt(e),s=nt(t);return[{type:"formula",expr:uR([i9({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${ny}`},{type:"formula",expr:uR([r,s],n+.5),as:`${e}_${iy}`}]}return[]}function uR([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`}const Kh="_tuple_fields";class o0e{hasChannel;hasField;hasSelectionId;timeUnit;items;constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const a0e={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??=new o0e,s={},o={},a=new Set,u=(p,g)=>{const m=g==="visual"?p.channel:p.field;let y=gt(`${i}_${m}`);for(let v=1;a.has(y);v++)y=gt(`${i}_${m}_${v}`);return a.add(y),{[g]:y}},l=t.type,c=e.config.selection[l],f=n.value!==void 0?le(n.value):null;let{fields:d,encodings:h}=ae(n.select)?n.select:{};if(!d&&!h&&f){for(const p of f)if(ae(p))for(const g of Y(p))xde(g)?(h||(h=[])).push(g):l==="interval"?(Q(ihe),h=c.encodings):(d??=[]).push(g)}!d&&!h&&(h=c.encodings,"fields"in c&&(d=c.fields));for(const p of h??[]){const g=e.fieldDef(p);if(g){let m=g.field;if(g.aggregate){Q(Yde(p,g.aggregate));continue}else if(!m){Q(RT(p));continue}if(g.timeUnit&&!Wu(g.timeUnit)){m=e.vgField(p);const y={timeUnit:g.timeUnit,as:m,field:g.field};o[Ie(y)]=y}if(!s[m]){const y=l==="interval"&&xs(p)&&mr(e.getScaleComponent(p).get("type"))?"R":g.bin?"R-RE":"E",v={field:m,channel:p,type:y,index:r.items.length};v.signals={...u(v,"data"),...u(v,"visual")},r.items.push(s[m]=v),r.hasField[m]=s[m],r.hasSelectionId=r.hasSelectionId||m===br,iz(p)?(v.geoChannel=p,v.channel=nz(p),r.hasChannel[v.channel]=s[m]):r.hasChannel[p]=s[m]}}else Q(RT(p))}for(const p of d??[]){if(r.hasField[p])continue;const g={type:"E",field:p,index:r.items.length};g.signals={...u(g,"data")},r.items.push(g),r.hasField[p]=g,r.hasSelectionId=r.hasSelectionId||p===br}f&&(t.init=f.map(p=>r.items.map(g=>ae(p)?p[g.geoChannel||g.channel]!==void 0?p[g.geoChannel||g.channel]:p[g.field]:p))),at(o)||(r.timeUnit=new Kr(null,o))},signals:(e,t,n)=>{const i=t.name+Kh;return n.filter(s=>s.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(a9)})}},r9="_curr",yg="anim_value",fl="anim_clock",Nw="eased_anim_clock",s9="min_extent",o9="max_range_extent",Xv="last_tick_at",Kv="is_playing",u0e=1/60*1e3,l0e=(e,t)=>[{name:Nw,update:fl},{name:`${e}_domain`,init:`domain('${t}')`},{name:s9,init:`extent(${e}_domain)[0]`},{name:o9,init:`extent(range('${t}'))[1]`},{name:yg,update:`invert('${t}', ${Nw})`}],c0e={defined:e=>e.type==="point",topLevelSignals:(e,t,n)=>(Qr(t)&&(n=n.concat([{name:fl,init:"0",on:[{events:{type:"timer",throttle:u0e},update:`${Kv} ? (${fl} + (now() - ${Xv}) > ${o9} ? 0 : ${fl} + (now() - ${Xv})) : ${fl}`}]},{name:Xv,init:"now()",on:[{events:[{signal:fl},{signal:Kv}],update:"now()"}]},{name:Kv,init:"true"}])),n),signals:(e,t,n)=>{const i=t.name,r=i+Kh,s=t.project,o="(item().isVoronoi ? datum.datum : datum)",a=Ft(e.component.selection??{}).reduce((c,f)=>f.type==="interval"?c.concat(f.name+Tl):c,[]).map(c=>`indexof(item().mark.name, '${c}') < 0`).join(" && "),u=`datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0${a?` && ${a}`:""}`;let l=`unit: ${iu(e)}, `;if(t.project.hasSelectionId)l+=`${br}: ${o}[${ee(br)}]`;else if(Qr(t))l+=`fields: ${r}, values: [${yg} ? ${yg} : ${s9}]`;else{const c=s.items.map(f=>e.fieldDef(f.channel)?.bin?`[${o}[${ee(e.vgField(f.channel,{}))}], ${o}[${ee(e.vgField(f.channel,{binSuffix:"end"}))}]]`:`${o}[${ee(f.field)}]`).join(", ");l+=`fields: ${r}, values: [${c}]`}if(Qr(t))return n.concat(l0e(t.name,e.scaleName(ma)),[{name:i+ro,on:[{events:[{signal:Nw},{signal:yg}],update:`{${l}}`,force:!0}]}]);{const c=t.events;return n.concat([{name:i+ro,on:c?[{events:c,update:`${u} ? {${l}} : null`,force:!0}]:[]}])}}};function a9(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=ji(r.field),r}function Au(e,t=!0,n=_n){if(G(e)){const i=e.map(r=>Au(r,t,n));return t?`[${i.join(", ")}]`:i}else if(qu(e))return n(t?_u(e):ape(e));return t?n(Ze(e)):e}function f0e(e,t){for(const n of Ft(e.component.selection??{})){const i=n.name;let r=`${i}${ro}, ${n.resolve==="global"?"true":`{unit: ${iu(e)}}`}`;for(const s of sy)s.defined(n)&&(s.signals&&(t=s.signals(e,n,t)),s.modifyExpr&&(r=s.modifyExpr(e,n,r)));t.push({name:i+L0e,on:[{events:{signal:n.name+ro},update:`modify(${ee(n.name+Cu)}, ${r})`}]})}return yA(t)}function d0e(e,t){if(e.component.selection&&Y(e.component.selection).length){const n=ee(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:pa("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return yA(t)}function h0e(e,t){let n=!1;for(const i of Ft(e.component.selection??{})){const r=i.name,s=ee(r+Cu);if(t.filter(a=>a.name===r).length===0){const a=i.resolve==="global"?"union":i.resolve,u=i.type==="point"?", true, true)":")";t.push({name:i.name,update:`${S9}(${s}, ${ee(a)}${u}`})}n=!0;for(const a of sy)a.defined(i)&&a.topLevelSignals&&(t=a.topLevelSignals(e,i,t))}return n&&t.filter(r=>r.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]}),yA(t)}function p0e(e,t){const n=[],i=[],r=iu(e,{escape:!1});for(const s of Ft(e.component.selection??{})){const o={name:s.name+Cu};if(s.project.hasSelectionId&&(o.transform=[{type:"collect",sort:{field:br}}]),s.init){const u=s.project.items.map(a9);o.values=s.project.hasSelectionId?s.init.map(l=>({unit:r,[br]:Au(l,!1)[0]})):s.init.map(l=>({unit:r,fields:u,values:Au(l,!1)}))}if([...n,...t].filter(u=>u.name===s.name+Cu).length||n.push(o),Qr(s)&&t.length){const u=e.lookupDataSource(e.getDataName(xt.Main)),l=t.find(f=>f.name===u),c=l.transform.find(f=>f.type==="filter"&&f.expr.includes("vlSelectionTest"));if(c){l.transform=l.transform.filter(d=>d!==c);const f={name:l.name+r9,source:l.name,transform:[c]};i.push(f)}}}return n.concat(t,i)}function u9(e,t){for(const n of Ft(e.component.selection??{}))for(const i of sy)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t}function g0e(e,t){for(const n of e.children)vt(n)&&(t=u9(n,t));return t}function m0e(e,t,n,i){const r=M9(e,t.param,t);return{signal:mr(n.get("type"))&&G(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function yA(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Xs={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!xs(r))continue;const s=e.getScaleComponent(r),o=s?s.get("type"):void 0;if(o=="sequential"&&Q(Jde),!s||!mr(o)){Q(Qde);continue}s.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(o=>n.filter(a=>a.name===o.signals.data).length===0);if(!e.parent||Iw(e)||i.length===0)return n;const r=n.find(o=>o.name===t.name);let s=r.update;if(s.includes(S9))r.update=`{${i.map(o=>`${ee(ji(o.field))}: ${o.signals.data}`).join(", ")}}`;else{for(const o of i){const a=`${ee(ji(o.field))}: ${o.signals.data}`;s.includes(a)||(s=`${s.substring(0,s.length-1)}, ${a}}`)}r.update=s}return n.concat(i.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!Iw(e))for(const i of t.scales){const r=n.find(s=>s.name===i.signals.data);r.push="outer",delete r.value,delete r.update}return n}};function Pw(e,t){return`domain(${ee(e.scaleName(t))})`}function Iw(e){return e.parent&&Gc(e.parent)&&(!e.parent.parent||Iw(e.parent.parent))}const Tl="_brush",l9="_scale_trigger",bf="geo_interval_init_tick",c9="_init",y0e="_center",v0e={defined:e=>e.type==="interval",parse:(e,t,n)=>{if(e.hasProjection){const i={...ae(n.select)?n.select:{}};i.fields=[br],i.encodings||(i.encodings=n.value?Y(n.value):[Ar,$r]),n.select={type:"interval",...i}}if(t.translate&&!Xs.defined(t)){const i=`!event.item || event.item.mark.name !== ${ee(t.name+Tl)}`;for(const r of t.events){if(!r.between){Q(`${r} is not an ordered event stream for interval selections.`);continue}const s=le(r.between[0].filter??=[]);s.includes(i)||s.push(i)}}},signals:(e,t,n)=>{const i=t.name,r=i+ro,s=Ft(t.project.hasChannel).filter(a=>a.channel===mt||a.channel===Xt),o=t.init?t.init[0]:null;if(n.push(...s.reduce((a,u)=>a.concat(b0e(e,t,u,o?.[u.index])),[])),e.hasProjection){const a=ee(e.projectionName()),u=e.projectionName()+y0e,{x:l,y:c}=t.project.hasChannel,f=l?.signals.visual,d=c?.signals.visual,h=l?o?.[l.index]:`${u}[0]`,p=c?o?.[c.index]:`${u}[1]`,g=w=>e.getSizeSignalRef(w).signal,m=`[[${f?`${f}[0]`:"0"}, ${d?`${d}[0]`:"0"}],[${f?`${f}[1]`:g("width")}, ${d?`${d}[1]`:g("height")}]]`;o&&(n.unshift({name:i+c9,init:`[scale(${a}, [${l?h[0]:h}, ${c?p[0]:p}]), scale(${a}, [${l?h[1]:h}, ${c?p[1]:p}])]`}),(!l||!c)&&(n.find(E=>E.name===u)||n.unshift({name:u,update:`invert(${a}, [${g("width")}/2, ${g("height")}/2])`})));const y=`intersect(${m}, {markname: ${ee(e.getName("marks"))}}, unit.mark)`,v=`{unit: ${iu(e)}}`,b=`vlSelectionTuples(${y}, ${v})`,x=s.map(w=>w.signals.visual);return n.concat({name:r,on:[{events:[...x.length?[{signal:x.join(" || ")}]:[],...o?[{signal:bf}]:[]],update:b}]})}else{if(!Xs.defined(t)){const l=i+l9,c=s.map(f=>{const d=f.channel,{data:h,visual:p}=f.signals,g=ee(e.scaleName(d)),m=e.getScaleComponent(d).get("type"),y=mr(m)?"+":"";return`(!isArray(${h}) || (${y}invert(${g}, ${p})[0] === ${y}${h}[0] && ${y}invert(${g}, ${p})[1] === ${y}${h}[1]))`});c.length&&n.push({name:l,value:{},on:[{events:s.map(f=>({scale:e.scaleName(f.channel)})),update:`${c.join(" && ")} ? ${l} : {}`}]})}const a=s.map(l=>l.signals.data),u=`unit: ${iu(e)}, fields: ${i+Kh}, values`;return n.concat({name:r,...o?{init:`{${u}: ${Au(o)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${u}: [${a}]} : null`}]}:{}})}},topLevelSignals:(e,t,n)=>(vt(e)&&e.hasProjection&&t.init&&(n.filter(r=>r.name===bf).length||n.unshift({name:bf,value:null,on:[{events:"timer{1}",update:`${bf} === null ? {} : ${bf}`}]})),n),marks:(e,t,n)=>{const i=t.name,{x:r,y:s}=t.project.hasChannel,o=r?.signals.visual,a=s?.signals.visual,u=`data(${ee(t.name+Cu)})`;if(Xs.defined(t)||!r&&!s)return n;const l={x:r!==void 0?{signal:`${o}[0]`}:{value:0},y:s!==void 0?{signal:`${a}[0]`}:{value:0},x2:r!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:s!==void 0?{signal:`${a}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Y(l))l[m]=[{test:`${u}.length && ${u}[0].unit === ${iu(e)}`,...l[m]},{value:0}];const{fill:c,fillOpacity:f,cursor:d,...h}=t.mark,p=Y(h).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${o}[0] !== ${o}[1]`,s!==void 0&&`${a}[0] !== ${a}[1]`].filter(v=>v).join(" && "),value:h[y]},{value:null}],m),{}),g=d??(t.translate?"move":null);return[{name:`${i+Tl}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:f}},update:l}},...n,{name:i+Tl,type:"rect",clip:!0,encode:{enter:{...g?{cursor:{value:g}}:{},fill:{value:"transparent"}},update:{...l,...p}}}]}};function b0e(e,t,n,i){const r=!e.hasProjection,s=n.channel,o=n.signals.visual,a=ee(r?e.scaleName(s):e.projectionName()),u=d=>`scale(${a}, ${d})`,l=e.getSizeSignalRef(s===mt?"width":"height").signal,c=`${s}(unit)`,f=t.events.reduce((d,h)=>[...d,{events:h.between[0],update:`[${c}, ${c}]`},{events:h,update:`[${o}[0], clamp(${c}, 0, ${l})]`}],[]);if(r){const d=n.signals.data,h=Xs.defined(t),p=e.getScaleComponent(s),g=p?p.get("type"):void 0,m=i?{init:Au(i,!0,u)}:{value:[]};return f.push({events:{signal:t.name+l9},update:mr(g)?`[${u(`${d}[0]`)}, ${u(`${d}[1]`)}]`:"[0, 0]"}),h?[{name:d,on:[]}]:[{name:o,...m,on:f},{name:d,...i?{init:Au(i)}:{},on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${a}, ${o})`}]}]}else{const d=s===mt?0:1,h=t.name+c9,p=i?{init:`[${h}[0][${d}], ${h}[1][${d}]]`}:{value:[]};return[{name:o,...p,on:f}]}}function jc({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const s=Gh(t)&&t.condition;let o=[];s&&(o=le(s).map(l=>{const c=r(l);if(oge(l)){const{param:f,empty:d}=l;return{test:k9(e,{param:f,empty:d}),...c}}else return{test:e0(e,l.test),...c}})),i!==void 0&&o.push(i);const a=r(t);return a!==void 0&&o.push(a),o.length>1||o.length===1&&o[0].test?{[n]:o}:o.length===1?{[n]:o[0]}:{}}function vA(e,t="text"){const n=e.encoding[t];return jc({model:e,channelDef:n,vgChannel:t,mainRefFn:i=>ry(i,e.config),invalidValueRef:void 0})}function ry(e,t,n="datum"){if(e){if(yr(e))return ht(e.value);if(Me(e)){const{format:i,formatType:r}=Ym(e);return J$({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function f9(e,t={}){const{encoding:n,markDef:i,config:r,stack:s}=e,o=n.tooltip;if(G(o))return{tooltip:lR({tooltip:o},s,r,t)};{const a=t.reactiveGeom?"datum.datum":"datum";return jc({model:e,channelDef:o,vgChannel:"tooltip",mainRefFn:l=>{const c=ry(l,r,a);if(c)return c;if(l===null)return;let f=Je("tooltip",i,r);if(f===!0&&(f={content:"encoding"}),oe(f))return{value:f};if(ae(f))return ye(f)?f:f.content==="encoding"?lR(n,s,r,t):{signal:a}},invalidValueRef:void 0})}}function d9(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},s=new Set,o=i?"datum.datum":"datum",a=[];function u(c,f){const d=Bu(f),h=Un(c)?c:{...c,type:e[d].type},p=h.title||nA(h,r),g=le(p).join(", ").replaceAll(/"/g,'\\"');let m;if(kt(f)){const y=f==="x"?"x2":"y2",v=vr(e[y]);if(Kt(h.bin)&&v){const b=ne(h,{expr:o}),x=ne(v,{expr:o}),{format:w,formatType:E}=Ym(h);m=Wh(b,x,w,E,r),s.add(y)}}if((kt(f)||f===Hi||f===Sr)&&t&&t.fieldChannel===f&&t.offset==="normalize"){const{format:y,formatType:v}=Ym(h);m=J$({fieldOrDatumDef:h,format:y,formatType:v,expr:o,config:r,normalizeStack:!0}).signal}m??=ry(h,r,o).signal,a.push({channel:f,key:g,value:m})}rA(e,(c,f)=>{J(c)?u(c,f):Y1(c)&&u(c.condition,f)});const l={};for(const{channel:c,key:f,value:d}of a)!s.has(c)&&!l[f]&&(l[f]=d);return l}function lR(e,t,n,{reactiveGeom:i}={}){const r=d9(e,t,n,{reactiveGeom:i}),s=ia(r).map(([o,a])=>`"${o}": ${a}`);return s.length>0?{signal:`{${s.join(", ")}}`}:void 0}function x0e(e){const{markDef:t,config:n}=e,i=Je("aria",t,n);return i===!1?{}:{...i?{aria:i}:{},...w0e(e),..._0e(e)}}function w0e(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=Je("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:fe(qde,t)?{}:{ariaRoleDescription:{value:t}}}function _0e(e){const{encoding:t,markDef:n,config:i,stack:r}=e,s=t.description;if(s)return jc({model:e,channelDef:s,vgChannel:"description",mainRefFn:u=>ry(u,e.config),invalidValueRef:void 0});const o=Je("description",n,i);if(o!=null)return{description:ht(o)};if(i.aria===!1)return{};const a=d9(t,r,i);if(!at(a))return{description:{signal:ia(a).filter(([u])=>!u.startsWith("_")).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Zt(e,t,n={}){const{markDef:i,encoding:r,config:s}=t,{vgChannel:o}=n;let{defaultRef:a,defaultValue:u}=n;const l=r[e];a===void 0&&(u??=Je(e,i,s,{vgChannel:o,ignoreVgConfig:!Gh(l)}),u!==void 0&&(a=ht(u)));const c={markDef:i,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=Jz({...c,scaleChannel:e,channelDef:l});return jc({model:t,channelDef:l,vgChannel:o??e,invalidValueRef:f,mainRefFn:h=>Q$({...c,channel:e,channelDef:h,stack:null,defaultRef:a})})}function h9(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:s}=n,o=t.filled??Je("filled",n,r),a=Pe(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,u=Je(o===!0?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[o===!0&&"color"]??a,l=Je(o===!1?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[o===!1&&"color"],c=o?"fill":"stroke",f={...u?{fill:ht(u)}:{},...l?{stroke:ht(l)}:{}};return n.color&&(o?n.fill:n.stroke)&&Q(Ez("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...Zt("color",e,{vgChannel:c,defaultValue:o?u:l}),...Zt("fill",e,{defaultValue:i.fill?u:void 0}),...Zt("stroke",e,{defaultValue:i.stroke?l:void 0})}}function E0e(e){const{encoding:t,mark:n}=e,i=t.order;return!_a(n)&&yr(i)?jc({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:r=>ht(r.value),invalidValueRef:void 0}):{}}function hc({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const s=`${e}Offset`,o=t[s],a=n[s];if((s==="xOffset"||s==="yOffset")&&a)return{offsetType:"encoding",offset:Q$({channel:s,channelDef:a,markDef:t,config:i?.config,scaleName:i.scaleName(s),scale:i.getScaleComponent(s),stack:null,defaultRef:ht(o),bandPosition:r})};const u=t[s];return u?{offsetType:"visual",offset:u}:{}}function Pn(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:s,config:o,stack:a}=t,u=r[e],l=r[bs(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=hc({channel:e,markDef:s,encoding:r,model:t,bandPosition:.5}),p=bA({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),g=!u&&kt(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:S0e({channel:e,channelDef:u,channel2Def:l,markDef:s,config:o,scaleName:c,scale:f,stack:a,offset:d,defaultRef:p,bandPosition:h==="encoding"?0:void 0});return g?{[i||e]:g}:void 0}function S0e(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:s,markDef:o}=e;if(Me(n)&&r&&t===r.fieldChannel){if(J(n)){let a=n.bandPosition;if(a===void 0&&o.type==="text"&&(t==="radius"||t==="theta")&&(a=.5),a!==void 0)return Hm({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:a,offset:s})}return tu(n,i,{suffix:"end"},{offset:s})}return K$(e)}function bA({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:s,config:o}=e;return()=>{const a=Bu(n),u=ra(n),l=Je(n,s,o,{vgChannel:u});if(l!==void 0)return bd(n,l);switch(t){case"zeroOrMin":return cR({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:a,config:o});case"zeroOrMax":return cR({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:a,config:o});case"mid":return{...e[si(n)],mult:.5}}}}function cR({mainChannel:e,config:t,...n}){const i=Qz(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if(r==="zeroOrMin")return{value:0};const{widthSignal:s,heightSignal:o}=r.zeroOrMax;return{signal:`min(${s},${o})/2`}}case"theta":return r==="zeroOrMin"?{value:0}:{signal:"2*PI"};case"x":return r==="zeroOrMin"?{value:0}:{field:{group:"width"}};case"y":return r==="zeroOrMin"?{field:{group:"height"}}:{value:0}}}const $0e={left:"x",center:"xc",right:"x2"},A0e={top:"y",middle:"yc",bottom:"y2"};function p9(e,t,n,i="middle"){if(e==="radius"||e==="theta")return ra(e);const r=e==="x"?"align":"baseline",s=Je(r,t,n);let o;return ye(s)?(Q($he(r)),o=void 0):o=s,e==="x"?$0e[o||(i==="top"?"left":"center")]:A0e[o||i]}function Jm(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?g9(e,t,{defaultPos:n,defaultPos2:i}):Pn(e,t,{defaultPos:n})}function g9(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:s}=t,o=bs(e),a=si(e),u=C0e(t,i,o),l=u[a]?p9(e,r,s):ra(e);return{...Pn(e,t,{defaultPos:n,vgChannel:l}),...u}}function C0e(e,t,n){const{encoding:i,mark:r,markDef:s,stack:o,config:a}=e,u=Bu(n),l=si(n),c=ra(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:p}=n in i||n in s?hc({channel:n,markDef:s,encoding:i,model:e}):hc({channel:u,markDef:s,encoding:i,model:e});if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=si(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const g=k0e({channel:n,channelDef:f,channel2Def:i[n],markDef:s,config:a,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:Rp(n,s)||Rp(n,{[n]:Sw(n,s,a.style),[l]:Sw(l,s,a.style)})||Rp(n,a[r])||Rp(n,a.mark)||{[c]:bA({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function k0e({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:s,scale:o,stack:a,offset:u,defaultRef:l}){return Me(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?tu(t,s,{suffix:"start"},{offset:u}):K$({channel:e,channelDef:n,scaleName:s,scale:o,stack:a,markDef:i,config:r,offset:u,defaultRef:l})}function Rp(e,t){const n=si(e),i=ra(e);if(t[i]!==void 0)return{[i]:bd(e,t[i])};if(t[e]!==void 0)return{[i]:bd(e,t[e])};if(t[n]){const r=t[n];if(Su(r))Q(bhe(n));else return{[n]:bd(e,r)}}}function io(e,t){const{config:n,encoding:i,markDef:r}=e,s=r.type,o=bs(t),a=si(t),u=i[t],l=i[o],c=e.getScaleComponent(t),f=c?c.get("type"):void 0,d=r.orient,h=i[a]??i.size??Je("size",r,n,{vgChannel:a}),p=az(t),g=s==="bar"&&(t==="x"?d==="vertical":d==="horizontal")||s==="tick"&&(t==="y"?d==="vertical":d==="horizontal");return J(u)&&(ft(u.bin)||Kt(u.bin)||u.timeUnit&&!l)&&!(h&&!Su(h))&&!i[p]&&!Vt(f)?T0e({fieldDef:u,fieldDef2:l,channel:t,model:e}):(Me(u)&&Vt(f)||g)&&!l?F0e(u,t,e):g9(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function M0e(e,t,n,i,r,s,o){if(Su(r))if(n){const u=n.get("type");if(u==="band"){let l=`bandwidth('${t}')`;r.band!==1&&(l=`${r.band} * ${l}`);const c=os("minBandSize",{type:o},i);return{signal:c?`max(${or(c)}, ${l})`:l}}else r.band!==1&&(Q(Mhe(u)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(ye(r))return r;if(r)return{value:r}}if(n){const u=n.get("range");if(ju(u)&&We(u.step))return{value:u.step-2}}if(!s){const{bandPaddingInner:u,barBandPaddingInner:l,rectBandPaddingInner:c,tickBandPaddingInner:f}=i.scale,d=Ct(u,o==="tick"?f:o==="bar"?l:c);if(ye(d))return{signal:`(1 - (${d.signal})) * ${e}`};if(We(d))return{signal:`${1-d} * ${e}`}}return{value:Tw(i.view,e)-2}}function F0e(e,t,n){const{markDef:i,encoding:r,config:s,stack:o}=n,a=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=si(t),f=bs(t),d=az(t),h=n.scaleName(d),p=n.getScaleComponent(E$(t)),g=i.type==="tick"||a==="horizontal"&&t==="y"||a==="vertical"&&t==="x";let m;(r.size||i.size)&&(g?m=Zt("size",n,{vgChannel:c,defaultRef:ht(i.size)}):Q(Ohe(i.type)));const y=!!m,v=s8({channel:t,fieldDef:e,markDef:i,config:s,scaleType:(l||p)?.get("type"),useVlSizeChannel:g});m=m||{[c]:M0e(c,h||u,p||l,s,v,!!e,i.type)};const b=(l||p)?.get("type")==="band"&&Su(v)&&!y?"top":"middle",x=p9(t,i,s,b),w=x==="xc"||x==="yc",{offset:E,offsetType:_}=hc({channel:t,markDef:i,encoding:r,model:n,bandPosition:w?.5:0}),$=K$({channel:t,channelDef:e,markDef:i,config:s,scaleName:u,scale:l,stack:o,offset:E,defaultRef:bA({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:w?_==="encoding"?0:.5:ye(v)?{signal:`(1-${v})/2`}:Su(v)?(1-v.band)/2:0});if(c)return{[x]:$,...m};{const A=ra(f),F=m[c],M=E?{...F,offset:E}:F;return{[x]:$,[A]:G($)?[$[0],{...$[1],offset:M}]:{...$,offset:M}}}}function fR(e,t,n,i,r,s,o){if(tz(e))return 0;const a=e==="x"||e==="y2",u=a?-t/2:t/2;if(ye(n)||ye(r)||ye(i)||s){const l=or(n),c=or(r),f=or(i),d=or(s),p=s?`(${o} < ${d} ? ${a?"":"-"}0.5 * (${d} - (${o})) : ${u})`:u,g=f?`${f} + `:"",m=l?`(${l} ? -1 : 1) * `:"",y=c?`(${c} + ${p})`:p;return{signal:g+m+y}}else return r=r||0,i+(n?-r-u:+r+u)}function T0e({fieldDef:e,fieldDef2:t,channel:n,model:i}){const{config:r,markDef:s,encoding:o}=i,a=i.getScaleComponent(n),u=i.scaleName(n),l=a?a.get("type"):void 0,c=a.get("reverse"),f=s8({channel:n,fieldDef:e,markDef:s,config:r,scaleType:l}),h=i.component.axes[n]?.[0]?.get("translate")??.5,p=kt(n)?Je("binSpacing",s,r)??0:0,g=bs(n),m=ra(n),y=ra(g),v=os("minBandSize",s,r),{offset:b}=hc({channel:n,markDef:s,encoding:o,model:i,bandPosition:0}),{offset:x}=hc({channel:g,markDef:s,encoding:o,model:i,bandPosition:0}),w=tge({fieldDef:e,scaleName:u}),E=fR(n,p,c,h,b,v,w),_=fR(g,p,c,h,x??b,v,w),$=ye(f)?{signal:`(1-${f.signal})/2`}:Su(f)?(1-f.band)/2:.5,A=sa({fieldDef:e,fieldDef2:t,markDef:s,config:r});if(ft(e.bin)||e.timeUnit){const F=e.timeUnit&&A!==.5;return{[y]:dR({fieldDef:e,scaleName:u,bandPosition:$,offset:_,useRectOffsetField:F}),[m]:dR({fieldDef:e,scaleName:u,bandPosition:ye($)?{signal:`1-${$.signal}`}:1-$,offset:E,useRectOffsetField:F})}}else if(Kt(e.bin)){const F=tu(e,u,{},{offset:_});if(J(t))return{[y]:F,[m]:tu(t,u,{},{offset:E})};if(Uu(e.bin)&&e.bin.step)return{[y]:F,[m]:{signal:`scale("${u}", ${ne(e,{expr:"datum"})} + ${e.bin.step})`,offset:E}}}Q(Az(g))}function dR({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return Hm({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:ny,endSuffix:iy}:{}})}const R0e=new Set(["aria","width","height"]);function Gi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?h9(e):{};return{...O0e(e.markDef,t),...hR("fill",n),...hR("stroke",i),...Zt("opacity",e),...Zt("fillOpacity",e),...Zt("strokeOpacity",e),...Zt("strokeWidth",e),...Zt("strokeDash",e),...E0e(e),...f9(e),...vA(e,"href"),...x0e(e)}}function hR(e,t){return t?{[e]:t}:{}}function O0e(e,t){return jde.reduce((n,i)=>(!R0e.has(i)&&K(e,i)&&t[i]!=="ignore"&&(n[i]=ht(e[i])),n),{})}function xA(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,s)=>{let o;if(!xs(s)||!(o=e.getScaleType(s)))return;const a=I1(r.aggregate),u=X$({scaleChannel:s,markDef:n,config:t,scaleType:o,isCountAggregate:a});if(Jpe(u)){const l=e.vgField(s,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});l&&i.add(l)}}),i.size>0)return{defined:{signal:[...i].map(s=>U1(s,!0)).join(" && ")}}}function pR(e,t){if(t!==void 0)return{[e]:ht(t)}}const Qv="voronoi",m9={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Qv)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,s=e.mark;if(_a(s))return Q(Xde(s)),n;const o={name:e.getName(Qv),type:"path",interactive:!0,aria:!1,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...f9(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach((l,c)=>{const f=l.name??"";f===e.component.mark[0].name?a=c:f.includes(Qv)&&(u=!0)}),u||n.splice(a+1,0,o),n}},y9={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!cA(e.bind),parse:(e,t,n)=>$9(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,s=t.bind,o=t.init?.[0],a=m9.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{const c=gt(`${i}_${u.field}`);n.filter(d=>d.name===c).length||n.unshift({name:c,...o?{init:Au(o[l])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${ee(u.field)}] : null`}]:[],bind:s[u.field]??s[u.channel]??s})}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(l=>l.name===i+ro),o=i+Kh,a=r.items.map(l=>gt(`${i}_${l.field}`)),u=a.map(l=>`${l} !== null`).join(" && ");return a.length&&(s.update=`${u} ? {fields: ${o}, values: [${a.join(", ")}]} : null`),delete s.value,delete s.on,n}},Zm="_toggle",v9={defined:e=>e.type==="point"&&!Qr(e)&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Zm,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ro,i=t.name+Zm;return`${i} ? null : ${n}, ${t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${iu(e)}}, `}${i} ? ${n} : null`}},D0e={defined:e=>e.clear!==void 0&&e.clear!==!1&&!Qr(e),parse:(e,t)=>{t.clear&&(t.clear=oe(t.clear)?pa(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(y9.defined(t))for(const i of t.project.items){const r=n.findIndex(s=>s.name===gt(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,s){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:s})}if(t.type==="interval")for(const r of t.project.items){const s=n.findIndex(o=>o.name===r.signals.visual);if(i(s,"[0, 0]"),s===-1){const o=n.findIndex(a=>a.name===r.signals.data);i(o,"null")}}else{let r=n.findIndex(s=>s.name===t.name+ro);i(r,"null"),v9.defined(t)&&(r=n.findIndex(s=>s.name===t.name+Zm),i(r,"false"))}return n}},b9={defined:e=>{const t=e.resolve==="global"&&e.bind&&cA(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==br;return t&&!n&&Q(Zde),t&&n},parse:(e,t,n)=>{const i=Ce(n);if(i.select=oe(i.select)?{type:i.select,toggle:t.toggle}:{...i.select,toggle:t.toggle},$9(t,i),ae(n.select)&&(n.select.on||n.select.clear)){const o='event.item && indexof(event.item.mark.role, "legend") < 0';for(const a of t.events)a.filter=le(a.filter??[]),a.filter.includes(o)||a.filter.push(o)}const r=Hv(t.bind)?t.bind.legend:"click",s=oe(r)?pa(r,"view"):le(r);t.bind={legend:{merge:s}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=Hv(t.bind)&&t.bind.legend,s=o=>a=>{const u=Ce(a);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const a=`${gt(o.field)}_legend`,u=`${i}_${a}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(s(`${a}_symbols`)).concat(r.merge.map(s(`${a}_labels`))).concat(r.merge.map(s(`${a}_entries`)));n.unshift({name:u,...t.init?{}:{value:null},on:[{events:c,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]})}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,s=n.find(d=>d.name===i+ro),o=i+Kh,a=r.items.filter(d=>d.hasLegend).map(d=>gt(`${i}_${gt(d.field)}_legend`)),l=`${a.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${a.join(", ")}]} : null`;t.events&&a.length>0?s.on.push({events:a.map(d=>({signal:d})),update:l}):a.length>0&&(s.update=l,delete s.value,delete s.on);const c=n.find(d=>d.name===i+Zm),f=Hv(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push({...c.on[0],events:f}):c.on[0].events=f),n}};function N0e(e,t,n){const i=e.fieldDef(t)?.field;for(const r of Ft(e.component.selection??{})){const s=r.project.hasField[i]??r.project.hasChannel[t];if(s&&b9.defined(r)){const o=n.get("selections")??[];o.push(r.name),n.set("selections",o,!1),s.hasLegend=!0}}}const x9="_translate_anchor",w9="_translate_delta",P0e={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=Xs.defined(t),s=i+x9,{x:o,y:a}=t.project.hasChannel;let u=pa(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Tl,l))),n.push({name:s,value:{},on:[{events:u.map(l=>l.between[0]),update:`{x: x(unit), y: y(unit)${o!==void 0?`, extent_x: ${r?Pw(e,mt):`slice(${o.signals.visual})`}`:""}${a!==void 0?`, extent_y: ${r?Pw(e,Xt):`slice(${a.signals.visual})`}`:""}}`}]},{name:i+w9,value:{},on:[{events:u,update:`{x: ${s}.x - x(unit), y: ${s}.y - y(unit)}`}]}),o!==void 0&&gR(e,t,o,"width",n),a!==void 0&&gR(e,t,a,"height",n),n}};function gR(e,t,n,i,r){const s=t.name,o=s+x9,a=s+w9,u=n.channel,l=Xs.defined(t),c=r.find(w=>w.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d?.get("type"),p=d?.get("reverse"),g=l?u===mt?p?"":"-":p?"-":"":"",m=`${o}.extent_${u}`,y=`${g}${a}.${u} / ${l?`${f}`:`span(${m})`}`,v=!l||!d?"panLinear":h==="log"?"panLog":h==="symlog"?"panSymlog":h==="pow"?"panPow":"panLinear",b=l?h==="pow"?`, ${d.get("exponent")??1}`:h==="symlog"?`, ${d.get("constant")??1}`:"":"",x=`${v}(${m}, ${y}${b})`;c.on.push({events:{signal:a},update:l?x:`clampRange(${x}, 0, ${f})`})}const _9="_zoom_anchor",E9="_zoom_delta",I0e={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=Xs.defined(t),s=i+E9,{x:o,y:a}=t.project.hasChannel,u=ee(e.scaleName(mt)),l=ee(e.scaleName(Xt));let c=pa(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Tl,f))),n.push({name:i+_9,on:[{events:c,update:r?`{${[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>f).join(", ")}}`:"{x: x(unit), y: y(unit)}"}]},{name:s,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&mR(e,t,o,"width",n),a!==void 0&&mR(e,t,a,"height",n),n}};function mR(e,t,n,i,r){const s=t.name,o=n.channel,a=Xs.defined(t),u=r.find(v=>v.name===n.signals[a?"data":"visual"]),l=e.getSizeSignalRef(i).signal,c=e.getScaleComponent(o),f=c?.get("type"),d=a?Pw(e,o):u.name,h=s+E9,p=`${s}${_9}.${o}`,g=!a||!c?"zoomLinear":f==="log"?"zoomLog":f==="symlog"?"zoomSymlog":f==="pow"?"zoomPow":"zoomLinear",m=a?f==="pow"?`, ${c.get("exponent")??1}`:f==="symlog"?`, ${c.get("constant")??1}`:"":"",y=`${g}(${d}, ${p}, ${h}${m})`;u.on.push({events:{signal:h},update:a?y:`clampRange(${y}, 0, ${l})`})}const Cu="_store",ro="_tuple",L0e="_modify",S9="vlSelectionResolve",sy=[c0e,v0e,a0e,v9,y9,Xs,b9,D0e,P0e,I0e,m9];function z0e(e){let t=e.parent;for(;t&&!wi(t);)t=t.parent;return t}function iu(e,{escape:t}={escape:!0}){let n=t?ee(e.name):e.name;const i=z0e(e);if(i){const{facet:r}=i;for(const s of Oi)r[s]&&(n+=` + '__facet_${s}_' + (facet[${ee(i.vgField(s))}])`)}return n}function wA(e){return Ft(e.component.selection??{}).reduce((t,n)=>t||n.project.hasSelectionId,!1)}function $9(e,t){(oe(t.select)||!t.select.on)&&delete e.events,(oe(t.select)||!t.select.clear)&&delete e.clear,(oe(t.select)||!t.select.toggle)&&delete e.toggle}function Qr(e){return e.events?.find(t=>"type"in t&&t.type==="timer")}function Lw(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...Lw(e.object)),t.push(...Lw(e.property))),t)}function A9(e){return e.object.type==="MemberExpression"?A9(e.object):e.object.name==="datum"}function C9(e){const t=BS(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&A9(i)&&n.add(Lw(i).slice(1).join("."))}),n}class qc extends rt{model;filter;expr;_dependentFields;clone(){return new qc(null,this.model,Ce(this.filter))}constructor(t,n,i){super(t),this.model=n,this.filter=i,this.expr=e0(this.model,this.filter,this),this._dependentFields=C9(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function B0e(e,t){const n={},i=e.config.selection;if(!t||!t.length)return n;let r=0;for(const s of t){const o=gt(s.name),a=s.select,u=oe(a)?a:a.type,l=ae(a)?Ce(a):{type:u},c=i[u];for(const h in c)h==="fields"||h==="encodings"||(h==="mark"&&(l.mark={...c.mark,...l.mark}),(l[h]===void 0||l[h]===!0)&&(l[h]=Ce(c[h]??l[h])));const f=n[o]={...l,name:o,type:u,init:s.value,bind:s.bind,events:oe(l.on)?pa(l.on,"scope"):le(Ce(l.on))};if(Qr(f)&&(r++,r>1)){delete n[o];continue}const d=Ce(s);for(const h of sy)h.defined(f)&&h.parse&&h.parse(e,f,d)}return r>1&&Q(she),n}function k9(e,t,n,i="datum"){const r=oe(t)?t:t.param,s=gt(r),o=ee(s+Cu);let a;try{a=e.getSelectionComponent(s,r)}catch{return`!!${s}`}if(a.project.timeUnit){const d=n??e.component.data.raw,h=a.project.timeUnit.clone();d.parent?h.insertAsParentOf(d):d.parent=h}const u=a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest(",l=a.resolve==="global"?")":`, ${ee(a.resolve)})`,c=`${u}${o}, ${i}${l}`,f=`length(data(${o}))`;return t.empty===!1?`${f} && ${c}`:`!${f} || ${c}`}function M9(e,t,n){const i=gt(t),r=n.encoding;let s=n.field,o;try{o=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!s)s=o.project.items[0].field,o.project.items.length>1&&Q(ohe(s));else if(r&&!s){const a=o.project.items.filter(u=>u.channel===r);!a.length||a.length>1?(s=o.project.items[0].field,Q(ahe(a,r,n,s))):s=a[0].field}return`${o.name}[${ee(ji(s))}]`}function U0e(e,t){for(const[n,i]of ia(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Zn(new qc(t,e,{param:n}),r,xt.Lookup,e.component.data.outputNodeRefCounts)}}function e0(e,t,n){return vd(t,i=>oe(i)?i:mpe(i)?k9(e,i,n):Lz(i))}function j0e(e,t){if(e)return G(e)&&!ko(e)?e.map(n=>nA(n,t)).join(", "):e}function Jv(e,t,n,i){e.encode??={},e.encode[t]??={},e.encode[t].update??={},e.encode[t].update[n]=i}function Yf(e,t,n,i={header:!1}){const{disable:r,orient:s,scale:o,labelExpr:a,title:u,zindex:l,...c}=e.combine();if(!r){for(const f in c){const d=f,h=xge[d],p=c[d];if(h&&h!==t&&h!=="both")delete c[d];else if(Xh(p)){const{condition:g,...m}=p,y=le(g),v=WT[d];if(v){const{vgProp:b,part:x}=v,w=[...y.map(E=>{const{test:_,...$}=E;return{test:e0(null,_),...$}}),m];Jv(c,x,b,w),delete c[d]}else if(v===null){const b={signal:y.map(x=>{const{test:w,...E}=x;return`${e0(null,w)} ? ${kT(E)} : `}).join("")+kT(m)};c[d]=b}}else if(ye(p)){const g=WT[d];if(g){const{vgProp:m,part:y}=g;Jv(c,y,m,p),delete c[d]}}Pe(["labelAlign","labelBaseline"],d)&&c[d]===null&&delete c[d]}if(t==="grid"){if(!c.grid)return;if(c.encode){const{grid:f}=c.encode;c.encode={...f?{grid:f}:{}},at(c.encode)&&delete c.encode}return{scale:o,orient:s,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Ct(l,0)}}else{if(!i.header&&e.mainExtracted)return;if(a!==void 0){let d=a;c.encode?.labels?.update&&ye(c.encode.labels.update.text)&&(d=bu(a,"datum.label",c.encode.labels.update.text.signal)),Jv(c,"labels","text",{signal:d})}if(c.labelAlign===null&&delete c.labelAlign,c.encode){for(const d of g8)e.hasAxisPart(d)||delete c.encode[d];at(c.encode)&&delete c.encode}const f=j0e(u,n);return{scale:o,orient:s,grid:!1,...f?{title:f}:{},...c,...n.aria===!1?{aria:!1}:{},zindex:Ct(l,0)}}}}function F9(e){const{axes:t}=e.component,n=[];for(const i of ho)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const s=i==="x"?"height":"width",o=e.getSizeSignalRef(s).signal;s!==o&&n.push({name:s,update:o})}}return n}function q0e(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Yf(r,"grid",t)),...i.map(r=>Yf(r,"grid",t)),...n.map(r=>Yf(r,"main",t)),...i.map(r=>Yf(r,"main",t))].filter(r=>r)}function yR(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const s=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},a=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Y(o),...Y(a)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${s}" ? ${or(o[c])} : ${or(a[c])}`};return l}return t[r]})])}function W0e(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:jz(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],s=e==="x"?"axisX":"axisY",o=ye(n)?"axisOrient":`axis${Lh(n)}`,a=[...r,...r.map(l=>s+l.substr(4))],u=["axis",o,s];return{vlOnlyAxisConfig:yR(a,i,e,n),vgAxisConfig:yR(u,i,e,n),axisConfigStyle:H0e([...u,...a],i)}}function H0e(e,t){const n=[{}];for(const i of e){let r=t[i]?.style;if(r){r=le(r);for(const s of r)n.push(t.style[s])}}return Object.assign.apply(null,n)}function zw(e,t,n,i={}){const r=mz(e,n,t);if(r!==void 0)return{configFrom:"style",configValue:r};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(i[s]?.[e]!==void 0)return{configFrom:s,configValue:i[s][e]};return{}}const vR={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??G0e(n,e),gridScale:({model:e,channel:t})=>V0e(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||R9(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||T9(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??X0e(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??K0e(t.type,n,J(t)&&!!t.timeUnit,J(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const s=e==="x"?"width":e==="y"?"height":void 0,o=s?t.getSizeSignalRef(s):void 0;return n.tickCount??J0e({fieldOrDatumDef:i,scaleType:r,size:o,values:n.values})},tickMinStep:({axis:e,format:t,fieldOrDatumDef:n})=>e.tickMinStep??Z0e({format:t,fieldOrDatumDef:n}),title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=O9(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),s=n==="x"?"x2":"y2",o=t.fieldDef(s);return vz(r?[jT(r)]:[],J(o)?[jT(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>e1e(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??t1e(n,t)};function G0e(e,t){return!Vt(e)&&J(t)&&!ft(t?.bin)&&!Kt(t?.bin)}function V0e(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Y0e(e,t,n,i,r){const s=t?.labelAngle;if(s!==void 0)return ye(s)?s:Jd(s);{const{configValue:o}=zw("labelAngle",i,t?.style,r);return o!==void 0?Jd(o):n===mt&&Pe([W$,q$],e.type)&&!(J(e)&&e.timeUnit)?270:void 0}}function Bw(e){return`(((${e.signal} % 360) + 360) % 360)`}function T9(e,t,n,i){if(e!==void 0)if(n==="x"){if(ye(e)){const r=Bw(e),s=ye(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${s} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(ye(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(ye(e)){const r=Bw(e),s=ye(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${s} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(ye(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function R9(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,s=i?"bottom":"left";if(ye(e)){const o=Bw(e),a=ye(t)?`(${t.signal} === "${s}")`:t===s;return{signal:`(${r?`(${o} + 90)`:o} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${o} && ${o} < ${180+r}) === ${a} ? "left" : "right"`}}if((e+r)%180===0)return i?null:"center";if(ye(t)){const o=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${o} "${s}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===s)?"left":"right"}function X0e(e,t){if(t==="x"&&Pe(["quantitative","temporal"],e))return!0}function K0e(e,t,n,i){if(n&&!ae(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Q0e(e){return e==="x"?"bottom":"left"}function J0e({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){if(!i&&!Vt(t)&&t!=="log"){if(J(e)){if(ft(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Pe(["month","hours","day","quarter"],Ht(e.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function Z0e({format:e,fieldOrDatumDef:t}){if(e==="d")return 1;if(J(t)){const{timeUnit:n}=t;if(n){const i=Nz(n);if(i)return{signal:i}}}}function O9(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),s=i?i.title:void 0,o=r?r.title:void 0;if(s&&o)return bz(s,o);if(s)return s;if(o)return o;if(s!==void 0)return s;if(o!==void 0)return o}function e1e(e,t){const n=e.values;if(G(n))return p8(t,n);if(ye(n))return n}function t1e(e,t){return e==="rect"&&Vm(t)?1:0}class pc extends rt{transform;_dependentFields;clone(){return new pc(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this._dependentFields=C9(this.transform.calculate)}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(Hu(i)&&r8(i.sort)){const{field:s,timeUnit:o}=i,a=i.sort,u=a.map((l,c)=>`${Lz({field:s,timeUnit:o,equal:l})} ? ${c} : `).join("")+a.length;t=new pc(t,{calculate:u,as:gc(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ie(this.transform)}`}}function gc(e,t,n){return ne(e,{prefix:t,suffix:"sort_index",...n})}function oy(e,t){return Pe(["top","bottom"],t)?"column":Pe(["left","right"],t)||e==="row"?"row":"column"}function mc(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return Ct((t||{})[e],r[e],n.header[e])}function ay(e,t,n,i){const r={};for(const s of e){const o=mc(s,t||{},n,i);o!==void 0&&(r[s]=o)}return r}const _A=["row","column"],EA=["header","footer"];function n1e(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:s,titleAngle:o,titleOrient:a}=ay(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=oy(t,a),l=Jd(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:{text:n,...t==="row"?{orient:"left"}:{},style:"guide-title",...N9(l,u),...D9(u,l,s),...P9(i,r,t,jge,O8)}}}function D9(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=R9(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function N9(e,t){const n=T9(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function i1e(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of EA)if(n[r])for(const s of n[r]){const o=s1e(e,t,r,n,s);o!=null&&i.push(o)}return i}function r1e(e,t){const{sort:n}=e;return Ys(n)?{field:ne(n,{expr:"datum"}),order:n.order??"ascending"}:G(n)?{field:gc(e,t,{expr:"datum"}),order:"ascending"}:{field:ne(e,{expr:"datum"}),order:n??"ascending"}}function Uw(e,t,n){const{format:i,formatType:r,labelAngle:s,labelAnchor:o,labelOrient:a,labelExpr:u}=ay(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=J$({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=oy(t,a);return{text:{signal:u?bu(bu(u,"datum.label",l),"datum.value",ne(e,{expr:"parent"})):l},...t==="row"?{orient:"left"}:{},style:"guide-label",frame:"group",...N9(s,c),...D9(c,s,o),...P9(n,e,t,qge,D8)}}function s1e(e,t,n,i,r){if(r){let s=null;const{facetFieldDef:o}=i,a=e.config?e.config:void 0;if(o&&r.labels){const{labelOrient:f}=ay(["labelOrient"],o.header,a,t);(t==="row"&&!Pe(["top","bottom"],f)||t==="column"&&!Pe(["left","right"],f))&&(s=Uw(o,t,a))}const u=wi(e)&&!Hh(e.facet),l=r.axes,c=l?.length>0;if(s||c){const f=t==="row"?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:r1e(o,t)}:{},...c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...s?{title:s}:{},...r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{},...c?{axes:l}:{}}}}return null}const o1e={column:{start:0,end:1},row:{start:1,end:0}};function a1e(e,t){return o1e[t][e]}function u1e(e,t){const n={};for(const i of Oi){const r=e[i];if(r?.facetFieldDef){const{titleAnchor:s,titleOrient:o}=ay(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=oy(i,o),u=a1e(s,a);u!==void 0&&(n[a]=u)}}return at(n)?void 0:n}function P9(e,t,n,i,r){const s={};for(const o of i){if(!r[o])continue;const a=mc(o,t?.header,e,n);a!==void 0&&(s[r[o]]=a)}return s}function SA(e){return[...Op(e,"width"),...Op(e,"height"),...Op(e,"childWidth"),...Op(e,"childHeight")]}function Op(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const s=e.getScaleComponent(n);if(s){const o=s.get("type"),a=s.get("range");if(Vt(o)&&ju(a)){const u=e.scaleName(n);return wi(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[bR(u,a)]:[bR(u,a),{name:r,update:I9(u,s,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const s=r.endsWith("width"),o=s?"containerSize()[0]":"containerSize()[1]",a=Fw(e.config.view,s?"width":"height"),u=`isFinite(${o}) ? ${o} : ${a}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function bR(e,t){const n=`${e}_step`;return ye(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function I9(e,t,n){const i=t.get("type"),r=t.get("padding"),s=Ct(t.get("paddingOuter"),r);let o=t.get("paddingInner");return o=i==="band"?o!==void 0?o:r:1,`bandspace(${n}, ${or(o)}, ${or(s)}) * ${e}_step`}function L9(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function z9(e,t){return Y(e).reduce((n,i)=>({...n,...jc({model:t,channelDef:e[i],vgChannel:i,mainRefFn:r=>ht(r.value),invalidValueRef:void 0})}),{})}function B9(e,t){if(wi(t))return e==="theta"?"independent":"shared";if(Gc(t))return"shared";if(TA(t))return kt(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function $A(e,t){const n=e.scale[t],i=kt(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&Q(Lhe(t)),"independent"):e[i][t]||"shared"}const l1e={...Gge,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},U9=Y(l1e);class c1e extends go{}const xR={symbols:f1e,gradient:d1e,labels:h1e,entries:p1e};function f1e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:s}){if(s!=="symbol")return;const{markDef:o,encoding:a,config:u,mark:l}=n,c=o.filled&&l!=="trail";let f={...Gde({},n,jpe),...h9(n,{filled:c})};const d=r.get("symbolOpacity")??u.legend.symbolOpacity,h=r.get("symbolFillColor")??u.legend.symbolFillColor,p=r.get("symbolStrokeColor")??u.legend.symbolStrokeColor,g=d===void 0?j9(a.opacity)??o.opacity:void 0;if(f.fill){if(i==="fill"||c&&i===ii)delete f.fill;else if(K(f.fill,"field"))h?delete f.fill:(f.fill=ht(u.legend.symbolBaseFillColor??"black"),f.fillOpacity=ht(g??1));else if(G(f.fill)){const m=jw(a.fill??a.color)??o.fill??(c&&o.color);m&&(f.fill=ht(m))}}if(f.stroke){if(i==="stroke"||!c&&i===ii)delete f.stroke;else if(K(f.stroke,"field")||p)delete f.stroke;else if(G(f.stroke)){const m=Ct(jw(a.stroke||a.color),o.stroke,c?o.color:void 0);m&&(f.stroke={value:m})}}if(i!==fo){const m=J(t)&&W9(n,r,t);m?f.opacity=[{test:m,...ht(g??1)},ht(u.legend.unselectedOpacity)]:g&&(f.opacity=ht(g))}return f={...f,...e},at(f)?void 0:f}function d1e(e,{model:t,legendType:n,legendCmpt:i}){if(n!=="gradient")return;const{config:r,markDef:s,encoding:o}=t;let a={};const l=(i.get("gradientOpacity")??r.legend.gradientOpacity)===void 0?j9(o.opacity)||s.opacity:void 0;return l&&(a.opacity=ht(l)),a={...a,...e},at(a)?void 0:a}function h1e(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const s=n.legend(i)||{},o=n.config,a=J(t)?W9(n,r,t):void 0,u=a?[{test:a,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=s;let f;$u(c)?f=ar({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):l===void 0&&c===void 0&&o.customFormatTypes&&(t.type==="quantitative"&&o.numberFormatType?f=ar({fieldOrDatumDef:t,field:"datum.value",format:o.numberFormat,formatType:o.numberFormatType,config:o}):t.type==="temporal"&&o.timeFormatType&&J(t)&&t.timeUnit===void 0&&(f=ar({fieldOrDatumDef:t,field:"datum.value",format:o.timeFormat,formatType:o.timeFormatType,config:o})));const d={...u?{opacity:u}:{},...f?{text:f}:{},...e};return at(d)?void 0:d}function p1e(e,{legendCmpt:t}){return t.get("selections")?.length?{...e,fill:{value:"transparent"}}:e}function j9(e){return q9(e,(t,n)=>Math.max(t,n.value))}function jw(e){return q9(e,(t,n)=>Ct(t,n.value))}function q9(e,t){if(uge(e))return le(e.condition).reduce(t,e.value);if(yr(e))return e.value}function W9(e,t,n){const i=t.get("selections");if(!i?.length)return;const r=ee(n.field);return i.map(s=>`(!length(data(${ee(gt(s)+Cu)})) || (${s}[${r}] && indexof(${s}[${r}], datum.value) >= 0))`).join(" || ")}const wR={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return t8(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return n8(i,t,n)},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??w1e(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??_1e(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??m1e(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Fl(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(Ml(n)&&Hr(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>g1e(t,e)};function g1e(e,t){const n=e.values;if(G(n))return p8(t,n);if(ye(n))return n}function m1e(e,t,n,i){if(t!=="shape"){const r=jw(n)??i;if(r)return r}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function y1e(e){const{legend:t}=e;return Ct(t.type,v1e(e))}function v1e({channel:e,timeUnit:t,scaleType:n}){if(Ml(e)){if(Pe(["quarter","month","day"],t))return"symbol";if(Hr(n))return"gradient"}return"symbol"}function b1e({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??x1e(n,t)}function x1e(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function w1e({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:s,gradientHorizontalMinLength:o,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=e;if(Hr(r))return n==="horizontal"?i==="top"||i==="bottom"?_R(t,"width",o,s):o:_R(t,"height",u,a)}function _R(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function _1e(e){if(Pe(["quantile","threshold","log","symlog"],e))return"greedy"}function H9(e){const t=vt(e)?E1e(e):C1e(e);return e.component.legends=t,t}function E1e(e){const{encoding:t}=e,n={};for(const i of[ii,...P8]){const r=Nt(t[i]);!r||!e.getScaleComponent(i)||i===ri&&J(r)&&r.type===Uc||(n[i]=A1e(e,i))}return n}function S1e(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function $1e(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!n?.values;case"title":if(t==="title"&&e===i?.title)return!0}return e===(n||{})[t]}function A1e(e,t){let n=e.legend(t);const{markDef:i,encoding:r,config:s}=e,o=s.legend,a=new c1e({},S1e(e,t));N0e(e,t,a);const u=n!==void 0?!n:o.disable;if(a.set("disable",u,n!==void 0),u)return a;n=n||{};const l=e.getScaleComponent(t).get("type"),c=Nt(r[t]),f=J(c)?Ht(c.timeUnit)?.unit:void 0,d=n.orient||s.legend.orient||"right",h=y1e({legend:n,channel:t,timeUnit:f,scaleType:l}),p=b1e({legend:n,legendType:h,orient:d,legendConfig:o}),g={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:c,legendConfig:o,config:s,scaleType:l,orient:d,legendType:h,direction:p};for(const x of U9){if(h==="gradient"&&x.startsWith("symbol")||h==="symbol"&&x.startsWith("gradient"))continue;const w=x in wR?wR[x](g):n[x];if(w!==void 0){const E=$1e(w,x,n,e.fieldDef(t));(E||s.legend[x]===void 0)&&a.set(x,w,E)}}const m=n?.encoding??{},y=a.get("selections"),v={},b={fieldOrDatumDef:c,model:e,channel:t,legendCmpt:a,legendType:h};for(const x of["labels","legend","title","symbols","gradient","entries"]){const w=z9(m[x]??{},e),E=x in xR?xR[x](w,b):w;E!==void 0&&!at(E)&&(v[x]={...y?.length&&J(c)?{name:`${gt(c.field)}_legend_${x}`}:{},...y?.length?{interactive:!0}:{},update:y?.length?{...E,cursor:{value:"pointer"}}:E})}return at(v)||a.set("encode",v,!!n?.encoding),a}function C1e(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){H9(i);for(const r of Y(i.component.legends))n.legend[r]=$A(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=G9(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of Y(t))for(const r of e.children)r.component.legends[i]&&n.legend[i]==="shared"&&delete r.component.legends[i];return t}function G9(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const s of U9){const o=oa(e.getWithExplicit(s),t.getWithExplicit(s),s,"legend",(a,u)=>{switch(s){case"symbolType":return k1e(a,u);case"title":return xz(a,u);case"type":return r=!0,ci("symbol")}return ty(a,u,s,"legend")});e.setWithExplicit(s,o)}return r&&(e.implicit?.encode?.gradient&&jm(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&jm(e.explicit,["encode","gradient"])),e}function k1e(e,t){return t.value==="circle"?t:e}function M1e(e,t,n,i){e.encode??={},e.encode[t]??={},e.encode[t].update??={},e.encode[t].update[n]=i}function V9(e){const t=e.component.legends,n={};for(const r of Y(t)){const s=e.getScaleComponent(r),o=Ze(s.get("domains"));if(n[o])for(const a of n[o])G9(a,t[r])||n[o].push(t[r]);else n[o]=[t[r].clone()]}return Ft(n).flat().map(r=>F1e(r,e.config)).filter(r=>r!==void 0)}function F1e(e,t){const{disable:n,labelExpr:i,selections:r,...s}=e.combine();if(!n){if(t.aria===!1&&s.aria==null&&(s.aria=!1),s.encode?.symbols){const o=s.encode.symbols.update;o.fill&&o.fill.value!=="transparent"&&!o.stroke&&!s.stroke&&(o.stroke={value:"transparent"});for(const a of P8)s[a]&&delete o[a]}if(s.title||delete s.title,i!==void 0){let o=i;s.encode?.labels?.update&&ye(s.encode.labels.update.text)&&(o=bu(i,"datum.label",s.encode.labels.update.text.signal)),M1e(s,"labels","text",{signal:o})}return s}}function T1e(e){return Gc(e)||TA(e)?R1e(e):Y9(e)}function R1e(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),Y9(e))}function Y9(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},s=t.data.reduce((o,a)=>{const u=ye(a)?a.signal:`data('${e.lookupDataSource(a)}')`;return Pe(o,u)||o.push(u),o},[]);if(s.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:s.length>1?`[${s.join(", ")}]`:s[0]},...n}]}else return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}]}const O1e=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class X9 extends go{specifiedProjection;size;data;merged=!1;constructor(t,n,i,r){super({...n},{name:t}),this.specifiedProjection=n,this.size=i,this.data=r}get isFit(){return!!this.data}}function K9(e){e.component.projection=vt(e)?D1e(e):I1e(e)}function D1e(e){if(e.hasProjection){const t=Qt(e.specifiedProjection),n=!(t&&(t.scale!=null||t.translate!=null)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?N1e(e):void 0,s=new X9(e.projectionName(!0),{...Qt(e.config.projection),...t},i,r);return s.get("type")||s.set("type","equalEarth",!1),s}}function N1e(e){const t=[],{encoding:n}=e;for(const i of[[Ar,$r],[qi,Cr]])(Nt(n[i[0]])||Nt(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(ri)&&e.typedFieldDef(ri).type===Uc&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(xt.Main)),t}function P1e(e,t){const n=m$(O1e,r=>!!(!fe(e.explicit,r)&&!fe(t.explicit,r)||fe(e.explicit,r)&&fe(t.explicit,r)&&mi(e.get(r),t.get(r))));if(mi(e.size,t.size)){if(n)return e;if(mi(e.explicit,{}))return t;if(mi(t.explicit,{}))return e}return null}function I1e(e){if(e.children.length===0)return;let t;for(const i of e.children)K9(i);const n=m$(e.children,i=>{const r=i.component.projection;if(r)if(t){const s=P1e(t,r);return s&&(t=s),!!s}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new X9(i,t.specifiedProjection,t.size,Ce(t.data));for(const s of e.children){const o=s.component.projection;o&&(o.isFit&&r.data.push(...s.component.projection.data),s.renameProjection(o.get("name"),i),o.merged=!0)}return r}}function L1e(e,t,n,i){if(Yh(t,n)){const r=vt(e)?e.axis(n)??e.legend(n)??{}:{},s=ne(t,{expr:"datum"}),o=ne(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ne(t,{binSuffix:"range",forAs:!0}),formula:Wh(s,o,r.format,r.formatType,i)}}return{}}function Q9(e,t){return`${dz(e)}_${t}`}function z1e(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function AA(e,t,n){const i=X1(n,void 0)??{},r=Q9(i,t);return e.getName(`${r}_bins`)}function B1e(e){return"as"in e}function ER(e,t,n){let i,r;B1e(e)?i=oe(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[ne(e,{forAs:!0}),ne(e,{binSuffix:"end",forAs:!0})];const s={...X1(t,void 0)},o=Q9(s,e.field),{signal:a,extentSignal:u}=z1e(n,o);if(L1(s.extent)){const c=s.extent;r=M9(n,c.param,c),delete s.extent}const l={bin:s,field:e.field,as:[i],...a?{signal:a}:{},...u?{extentSignal:u}:{},...r?{span:r}:{}};return{key:o,binComponent:l}}class Jr extends rt{bins;clone(){return new Jr(null,Ce(this.bins))}constructor(t,n){super(t),this.bins=n}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,s,o)=>{if(Un(s)&&ft(s.bin)){const{key:a,binComponent:u}=ER(s,s.bin,n);r[a]={...u,...r[a],...L1e(n,s,o,n.config)}}return r},{});return at(i)?null:new Jr(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:s}=ER(n,n.bin,i);return new Jr(t,{[r]:s})}merge(t,n){for(const i of Y(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Wr([...this.bins[i].as,...t.bins[i].as],Ie)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(Ft(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Ft(this.bins).map(t=>t.field))}hash(){return`Bin ${Ie(this.bins)}`}assemble(){return Ft(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,{extent:s,...o}=t.bin,a={type:"bin",field:ji(t.field),as:i,signal:t.signal,...L1(s)?{extent:null}:{extent:s},...t.span?{span:{signal:`span(${t.span})`}}:{},...o};!s&&t.extentSignal&&(n.push({type:"extent",field:ji(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),n.push(a);for(const u of r)for(let l=0;l<2;l++)n.push({type:"formula",expr:ne({field:i[l]},{expr:"datum"}),as:u[l]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function U1e(e,t,n,i){const r=vt(i)?i.encoding[bs(t)]:void 0;if(Un(n)&&vt(i)&&o8(n,r,i.markDef,i.config)){e.add(ne(n,{})),e.add(ne(n,{suffix:"end"}));const{mark:s,markDef:o,config:a}=i,u=sa({fieldDef:n,markDef:o,config:a});Zd(s)&&u!==.5&&kt(t)&&(e.add(ne(n,{suffix:ny})),e.add(ne(n,{suffix:iy}))),n.bin&&Yh(n,t)&&e.add(ne(n,{binSuffix:"range"}))}else if(iz(t)){const s=nz(t);e.add(i.getName(s))}else e.add(ne(n));return Hu(n)&&Mpe(n.scale?.range)&&e.add(n.scale.range.field),e}function j1e(e,t){for(const n of Y(t)){const i=t[n];for(const r of Y(i))n in e?e[n][r]=new Set([...e[n][r]??[],...i[r]]):e[n]={[r]:i[r]}}}class fr extends rt{dimensions;measures;clone(){return new fr(null,new Set(this.dimensions),Ce(this.measures))}constructor(t,n,i){super(t),this.dimensions=n,this.measures=i}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(o=>{o.aggregate&&(i=!0)});const r={},s=new Set;return!i||(n.forEachFieldDef((o,a)=>{const{aggregate:u,field:l}=o;if(u)if(u==="count")r["*"]??={},r["*"].count=new Set([ne(o,{forAs:!0})]);else{if(no(u)||wa(u)){const c=no(u)?"argmin":"argmax",f=u[c];r[f]??={},r[f][c]=new Set([ne({op:c,field:f},{forAs:!0})])}else r[l]??={},r[l][u]=new Set([ne(o,{forAs:!0})]);xs(a)&&n.scaleDomain(a)==="unaggregated"&&(r[l]??={},r[l].min=new Set([ne({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([ne({field:l,aggregate:"max"},{forAs:!0})]))}else U1e(s,a,o,n)}),s.size+Y(r).length===0)?null:new fr(t,s,r)}static makeFromTransform(t,n){const i=new Set,r={};for(const s of n.aggregate){const{op:o,field:a,as:u}=s;o&&(o==="count"?(r["*"]??={},r["*"].count=new Set([u||ne(s,{forAs:!0})])):(r[a]??={},r[a][o]??=new Set,r[a][o].add(u||ne(s,{forAs:!0}))))}for(const s of n.groupby??[])i.add(s);return i.size+Y(r).length===0?null:new fr(t,i,r)}merge(t){return V4(this.dimensions,t.dimensions)?(j1e(this.measures,t.measures),!0):(epe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Y(this.measures)])}producedFields(){const t=new Set;for(const n of Y(this.measures))for(const i of Y(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ie({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const s of Y(this.measures))for(const o of Y(this.measures[s]))for(const a of this.measures[s][o])i.push(a),t.push(o),n.push(s==="*"?null:ji(s));return{type:"aggregate",groupby:[...this.dimensions].map(ji),ops:t,fields:n,as:i}}}class Wc extends rt{model;name;data;column;row;facet;childModel;constructor(t,n,i,r){super(t),this.model=n,this.name=i,this.data=r;for(const s of Oi){const o=n.facet[s];if(o){const{bin:a,sort:u}=o;this[s]={name:n.getName(`${s}_domain`),fields:[ne(o),...ft(a)?[ne(o,{binSuffix:"end"})]:[]],...Ys(u)?{sortField:u}:G(u)?{sortIndexField:gc(o,s)}:{}}}}this.childModel=n.child}hash(){let t="Facet";for(const n of Oi)this[n]&&(t+=` ${n.charAt(0)}:${Ie(this[n])}`);return t}get fields(){const t=[];for(const n of Oi)this[n]?.fields&&t.push(...this[n].fields);return t}dependentFields(){const t=new Set(this.fields);for(const n of Oi)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of ho){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),s=i.get("range");if(Vt(r)&&ju(s)){const o=uy(this.childModel,n),a=FA(o);a?t[n]=a:Q(F$(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],s=[],o=[],a=[];r&&i&&i[r]&&(n?(s.push(`distinct_${i[r]}`),o.push("max")):(s.push(i[r]),o.push("distinct")),a.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=G1,field:f}=u;s.push(f),o.push(c),a.push(ne(u,{forAs:!0}))}else l&&(s.push(l),o.push("max"),a.push(l));return{name:this[t].name,source:n??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...s.length?{fields:s,ops:o,as:a}:{}}]}}assembleFacetHeaderData(t){const{columns:n}=this.model.layout,{layoutHeaders:i}=this.model.component,r=[],s={};for(const u of _A){for(const l of EA){const c=i[u]?.[l]??[];for(const f of c)if(f.axes?.length>0){s[u]=!0;break}}if(s[u]){const l=`length(data("${this.facet.name}"))`,c=u==="row"?n?{signal:`ceil(${l} / ${n})`}:1:n?{signal:`min(${l}, ${n})`}:{signal:l};r.push({name:`${this.facet.name}_${u}`,transform:[{type:"sequence",start:0,stop:c}]})}}const{row:o,column:a}=s;return(o||a)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let n=null;const i=this.getChildIndependentFieldsWithStep(),{column:r,row:s,facet:o}=this;if(r&&s&&(i.x||i.y)){n=`cross_${this.column.name}_${this.row.name}`;const a=[].concat(i.x??[],i.y??[]),u=a.map(()=>"distinct");t.push({name:n,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:a,ops:u}]})}for(const a of[Vs,Gs])this[a]&&t.push(this.assembleRowColumnHeaderData(a,n,i));if(o){const a=this.assembleFacetHeaderData(i);a&&t.push(...a)}return t}}function SR(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function q1e(e,t){const n=b$(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=SR(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=SR(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return Q(lhe(t)),null}function W1e(e){const t={};return mg(e.filter,n=>{if(Iz(n)){let i=null;P$(n)?i=hi(n.equal):L$(n)?i=hi(n.lte):I$(n)?i=hi(n.lt):z$(n)?i=hi(n.gt):B$(n)?i=hi(n.gte):U$(n)?i=n.range[0]:j$(n)&&(i=(n.oneOf??n.in)[0]),i&&(qu(i)?t[n.field]="date":We(i)?t[n.field]="number":oe(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function H1e(e){const t={};function n(i){fc(i)?t[i.field]="date":i.type==="quantitative"&&Pde(i.aggregate)?t[i.field]="number":sc(i.field)>1?i.field in t||(t[i.field]="flatten"):Hu(i)&&Ys(i.sort)&&sc(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((vt(e)||wi(e))&&e.forEachFieldDef((i,r)=>{if(Un(i))n(i);else{const s=Bu(r),o=e.fieldDef(s);n({...i,type:o.type})}}),vt(e)){const{mark:i,markDef:r,encoding:s}=e;if(_a(i)&&!e.encoding.order){const o=r.orient==="horizontal"?"y":"x",a=s[o];J(a)&&a.type==="quantitative"&&!(a.field in t)&&(t[a.field]="number")}}return t}function G1e(e){const t={};if(vt(e)&&e.component.selection)for(const n of Y(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&sc(r.field)>1&&(t[r.field]="flatten")}return t}class gn extends rt{_parse;clone(){return new gn(null,Ce(this._parse))}constructor(t,n){super(t),this._parse=n}hash(){return`Parse ${Ie(this._parse)}`}static makeExplicit(t,n,i){let r={};const s=n.data;return!Go(s)&&s?.format?.parse&&(r=s.format.parse),this.makeWithAncestors(t,r,{},i)}static makeWithAncestors(t,n,i,r){for(const a of Y(i)){const u=r.getWithExplicit(a);u.value!==void 0&&(u.explicit||u.value===i[a]||u.value==="derived"||i[a]==="flatten"?delete i[a]:Q(DT(a,i[a],u.value)))}for(const a of Y(n)){const u=r.get(a);u!==void 0&&(u===n[a]?delete n[a]:Q(DT(a,n[a],u)))}const s=new go(n,i);r.copyAll(s);const o={};for(const a of Y(s.combine())){const u=s.get(a);u!==null&&(o[a]=u)}return Y(o).length===0||r.parseNothing?null:new gn(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const n of Y(this._parse)){const i=this._parse[n];sc(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(Y(this._parse))}dependentFields(){return new Set(Y(this._parse))}assembleTransforms(t=!1){return Y(this._parse).filter(n=>t?sc(n)>1:!0).map(n=>{const i=q1e(n,this._parse[n]);return i?{type:"formula",expr:i,as:zc(n)}:null}).filter(n=>n!==null)}}class aa extends rt{clone(){return new aa(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([br])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:br}}}class Qh extends rt{params;clone(){return new Qh(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ie(this.params)}`}assemble(){return{type:"graticule",...this.params===!0?{}:this.params}}}class Jh extends rt{params;clone(){return new Jh(null,this.params)}constructor(t,n){super(t),this.params=n}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${Ie(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class ku extends rt{_data;_name;_generator;constructor(t){super(null),t??={name:"source"};let n;if(Go(t)||(n=t.format?{...xi(t.format,["parse"])}:{}),eh(t))this._data={values:t.values};else if(dc(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Pe(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else t9(t)?this._data={values:[{type:"Sphere"}]}:(Z8(t)||Go(t))&&(this._data={});this._generator=Go(t),t.name&&(this._name=t.name),n&&!at(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}function CA(e){return e instanceof ku||e instanceof Qh||e instanceof Jh}class kA{#e;constructor(){this.#e=!1}setModified(){this.#e=!0}get modifiedFlag(){return this.#e}}class Gu extends kA{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,s)=>s[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class MA extends kA{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class V1e extends MA{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of Y(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class Y1e extends MA{requiresSelectionId;constructor(t){super(),this.requiresSelectionId=t&&wA(t)}run(t){t instanceof aa&&(this.requiresSelectionId&&(CA(t.parent)||t.parent instanceof fr||t.parent instanceof gn)||(this.setModified(),t.remove()))}}class X1e extends kA{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof Kr&&(i=t.producedFields(),y$(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class K1e extends MA{constructor(){super()}run(t){t instanceof Zn&&!t.isRequired()&&(this.setModified(),t.remove())}}class Q1e extends Gu{run(t){if(!CA(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof gn)if(t instanceof gn)this.setModified(),t.merge(n);else{if(v$(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class J1e extends Gu{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof gn);if(t.numChildren()>1&&i.length>=1){const r={},s=new Set;for(const o of i){const a=o.parse;for(const u of Y(a))u in r?r[u]!==a[u]&&s.add(u):r[u]=a[u]}for(const o of s)delete r[o];if(!at(r)){this.setModified();const o=new gn(t,r);for(const a of n){if(a instanceof gn)for(const u of Y(r))delete a.parse[u];t.removeChild(a),a.parent=o,a instanceof gn&&Y(a.parse).length===0&&a.remove()}}}}}class Z1e extends Gu{run(t){t instanceof Zn||t.numChildren()>0||t instanceof Wc||t instanceof ku||(this.setModified(),t.remove())}}class eye extends Gu{run(t){const n=t.children.filter(r=>r instanceof Kr),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class tye extends Gu{run(t){const n=t.children.filter(r=>r instanceof fr),i={};for(const r of n){const s=Ie(r.groupBy);s in i||(i[s]=[]),i[s].push(r)}for(const r of Y(i)){const s=i[r];if(s.length>1){const o=s.pop();for(const a of s)o.merge(a)&&(t.removeChild(a),a.parent=o,a.remove(),this.setModified())}}}}class nye extends Gu{model;constructor(t){super(),this.model=t}run(t){const n=!(CA(t)||t instanceof qc||t instanceof gn||t instanceof aa),i=[],r=[];for(const s of t.children)s instanceof Jr&&(n&&!v$(t.producedFields(),s.dependentFields())?i.push(s):r.push(s));if(i.length>0){const s=i.pop();for(const o of i)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof Jr?t.merge(s,this.model.renameSignal.bind(this.model)):s.swapWithParent()}if(r.length>1){const s=r.pop();for(const o of r)s.merge(o,this.model.renameSignal.bind(this.model));this.setModified()}}}class iye extends Gu{run(t){const n=[...t.children];if(!rc(n,o=>o instanceof Zn)||t.numChildren()<=1)return;const r=[];let s;for(const o of n)if(o instanceof Zn){let a=o;for(;a.numChildren()===1;){const[u]=a.children;if(u instanceof Zn)a=u;else break}r.push(...a.children),s?(t.removeChild(o),o.parent=s.parent,s.parent.removeChild(s),s.parent=a,this.setModified()):s=a}else r.push(o);if(r.length){this.setModified();for(const o of r)o.parent.removeChild(o),o.parent=s}}}class Vu extends rt{transform;clone(){return new Vu(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Wr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??ne(t)}hash(){return`JoinAggregateTransform ${Ie(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const s of this.transform.joinaggregate)n.push(s.op),i.push(this.getDefaultName(s)),t.push(s.field===void 0?null:s.field);const r=this.transform.groupby;return{type:"joinaggregate",as:i,ops:n,fields:t,...r!==void 0?{groupby:r}:{}}}}class yc extends rt{filter;clone(){return new yc(null,{...this.filter})}constructor(t,n){super(t),this.filter=n}static make(t,n,i){const{config:r,markDef:s}=n,{marks:o,scales:a}=i;if(o==="include-invalid-values"&&a==="include-invalid-values")return null;const u=n.reduceFieldDef((l,c,f)=>{const d=xs(f)&&n.getScaleComponent(f);if(d){const h=d.get("type"),{aggregate:p}=c,g=X$({scaleChannel:f,markDef:s,config:r,scaleType:h,isCountAggregate:I1(p)});g!=="show"&&g!=="always-valid"&&(l[c.field]=c)}return l},{});return Y(u).length?new yc(t,u):null}dependentFields(){return new Set(Y(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ie(this.filter)}`}assemble(){const t=Y(this.filter).reduce((n,i)=>{const r=this.filter[i],s=ne(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${s}) || (${qw(s)}))`):r.type==="quantitative"&&n.push(qw(s))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}function qw(e){return`isValid(${e}) && isFinite(+${e})`}function rye(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=ne(i);return r&&t.push(r),t},[])}function sye(e){return G(e)&&e.every(t=>oe(t))&&e.length>1}class Ks extends rt{_stack;clone(){return new Ks(null,Ce(this._stack))}constructor(t,n){super(t),this._stack=n}static makeFromTransform(t,n){const{stack:i,groupby:r,as:s,offset:o="zero"}=n,a=[],u=[];if(n.sort!==void 0)for(const f of n.sort)a.push(f.field),u.push(Ct(f.order,"ascending"));const l={field:a,order:u};let c;return sye(s)?c=s:oe(s)?c=[s,`${s}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new Ks(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:s,fieldChannel:o,offset:a,impute:u}=i,l=s.map(h=>{const p=r[h];return vr(p)}).filter(h=>!!h),c=rye(n),f=n.encoding.order;let d;if(G(f)||J(f))d=yz(f);else{const h=a8(f)?f.sort:o==="y"?"descending":"ascending";d=c.reduce((p,g)=>(p.field.includes(g)||(p.field.push(g),p.order.push(h)),p),{field:[],order:[]})}return new Ks(t,{dimensionFieldDefs:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:a,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ie(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[ne(r,{binSuffix:"mid"})]:[ne(r,{}),ne(r,{binSuffix:"end"})]:[ne(r)]).flat():i??[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:s,sort:o,offset:a,impute:u,as:l}=this._stack;if(u)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const h=ne(c,{expr:"datum"}),p=ne(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${qw(h)} ? ${f}*${h}+${1-f}*${p} : ${h}`,as:ne(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...s,...n],key:ne(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:o,as:l,offset:a}),t}}class Hc extends rt{transform;clone(){return new Hc(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Wr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach(n=>t.add(n.field)),this.transform.window.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??ne(t)}hash(){return`WindowTransform ${Ie(this.transform)}`}assemble(){const t=[],n=[],i=[],r=[];for(const f of this.transform.window)n.push(f.op),i.push(this.getDefaultName(f)),r.push(f.param===void 0?null:f.param),t.push(f.field===void 0?null:f.field);const s=this.transform.frame,o=this.transform.groupby;if(s&&s[0]===null&&s[1]===null&&n.every(f=>k$(f)))return{type:"joinaggregate",as:i,ops:n,fields:t,...o!==void 0?{groupby:o}:{}};const a=[],u=[];if(this.transform.sort!==void 0)for(const f of this.transform.sort)a.push(f.field),u.push(f.order??"ascending");const l={field:a,order:u},c=this.transform.ignorePeers;return{type:"window",params:r,as:i,ops:n,fields:t,sort:l,...c!==void 0?{ignorePeers:c}:{},...o!==void 0?{groupby:o}:{},...s!==void 0?{frame:s}:{}}}}function oye(e){function t(n){if(!(n instanceof Wc)){const i=n.clone();if(i instanceof Zn){const r=Hw+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof fr||i instanceof Ks||i instanceof Hc||i instanceof Vu)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function Ww(e){if(e instanceof Wc)if(e.numChildren()===1&&!(e.children[0]instanceof Zn)){const t=e.children[0];(t instanceof fr||t instanceof Ks||t instanceof Hc||t instanceof Vu)&&t.addDimensions(e.fields),t.swapWithParent(),Ww(e)}else{const t=e.model.component.data.main;J9(t);const n=oye(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(Ww)}function J9(e){if(e instanceof Zn&&e.type===xt.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Wc||(t.swapWithParent(),J9(e))}}const Hw="scale_",Dp=5;function Gw(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!Gw(t.children))return!1}return!0}function Vi(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function $R(e,t,n){let i=e.sources,r=!1;return r=Vi(new K1e,i)||r,r=Vi(new Y1e(t),i)||r,i=i.filter(s=>s.numChildren()>0),r=Vi(new Z1e,i)||r,i=i.filter(s=>s.numChildren()>0),n||(r=Vi(new Q1e,i)||r,r=Vi(new nye(t),i)||r,r=Vi(new X1e,i)||r,r=Vi(new J1e,i)||r,r=Vi(new tye,i)||r,r=Vi(new eye,i)||r,r=Vi(new V1e,i)||r,r=Vi(new iye,i)||r),e.sources=i,r}function aye(e,t){Gw(e.sources);let n=0,i=0;for(let r=0;r<Dp&&$R(e,t,!0);r++)n++;e.sources.map(Ww);for(let r=0;r<Dp&&$R(e,t,!1);r++)i++;Gw(e.sources),Math.max(n,i)===Dp&&Q(`Maximum optimization runs(${Dp}) reached.`)}class zt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}signal;static fromName(t,n){return new zt(()=>t(n))}}function Z9(e){vt(e)?uye(e):lye(e)}function uye(e){const t=e.component.scales;for(const n of Y(t)){const i=fye(e,n);if(t[n].setWithExplicit("domains",i),hye(e,n),e.component.data.isFaceted){let s=e;for(;!wi(s)&&s.parent;)s=s.parent;if(s.component.resolve.scale[n]==="shared")for(const a of i.value)Us(a)&&(a.data=Hw+a.data.replace(Hw,""))}}}function lye(e){for(const n of e.children)Z9(n);const t=e.component.scales;for(const n of Y(t)){let i,r=null;for(const s of e.children){const o=s.component.scales[n];if(o){i===void 0?i=o.getWithExplicit("domains"):i=oa(i,o.getWithExplicit("domains"),"domains","scale",Vw);const a=o.get("selectionExtent");r&&a&&r.param!==a.param&&Q(nhe),r=a}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function cye(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:s}=AR(t,n);if(!r){Q(s);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=AR(t,n);if(r)return"unaggregated"}return e}function fye(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=cye(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),t==="x"&&Nt(i.x2)?Nt(i.x)?oa(xo(n,r,e,"x"),xo(n,r,e,"x2"),"domain","scale",Vw):xo(n,r,e,"x2"):t==="y"&&Nt(i.y2)?Nt(i.y)?oa(xo(n,r,e,"y"),xo(n,r,e,"y2"),"domain","scale",Vw):xo(n,r,e,"y2"):xo(n,r,e,t)}function dye(e,t,n){return e.map(i=>({signal:`{data: ${K1(i,{timeUnit:n,type:t})}}`}))}function Zv(e,t,n){const i=Ht(n)?.unit;return t==="temporal"||i?dye(e,t,i):[e]}function xo(e,t,n,i){const{encoding:r,markDef:s,mark:o,config:a,stack:u}=n,l=Nt(r[i]),{type:c}=l,f=l.timeUnit,d=s0e({invalid:os("invalid",s,a),isPath:_a(o)});if(kpe(t)){const g=xo(e,void 0,n,i),m=Zv(t.unionWith,c,f);return Lr([...m,...g.value])}else{if(ye(t))return Lr([t]);if(t&&t!=="unaggregated"&&!Wz(t))return Lr(Zv(t,c,f))}if(u&&i===u.fieldChannel){if(u.offset==="normalize")return ci([[0,1]]);const g=n.requestDataName(d);return ci([{data:g,field:n.vgField(i,{suffix:"start"})},{data:g,field:n.vgField(i,{suffix:"end"})}])}const h=xs(i)&&J(l)?pye(n,i,e):void 0;if(ws(l)){const g=Zv([l.datum],c,f);return ci(g)}const p=l;if(t==="unaggregated"){const{field:g}=l;return ci([{data:n.requestDataName(d),field:ne({field:g,aggregate:"min"})},{data:n.requestDataName(d),field:ne({field:g,aggregate:"max"})}])}else if(ft(p.bin)){if(Vt(e))return ci(e==="bin-ordinal"?[]:[{data:Qd(h)?n.requestDataName(d):n.requestDataName(xt.Raw),field:n.vgField(i,Yh(p,i)?{binSuffix:"range"}:{}),sort:h===!0||!ae(h)?{field:n.vgField(i,{}),op:"min"}:h}]);{const{bin:g}=p;if(ft(g)){const m=AA(n,p.field,g);return ci([new zt(()=>{const y=n.getSignalName(m);return`[${y}.start, ${y}.stop]`})])}else return ci([{data:n.requestDataName(d),field:n.vgField(i,{})}])}}else if(p.timeUnit&&Pe(["time","utc"],e)){const g=r[bs(i)];if(o8(p,g,s,a)){const m=n.requestDataName(d),y=sa({fieldDef:p,fieldDef2:g,markDef:s,config:a}),v=Zd(o)&&y!==.5&&kt(i);return ci([{data:m,field:n.vgField(i,v?{suffix:ny}:{})},{data:m,field:n.vgField(i,{suffix:v?iy:"end"})}])}}return ci(h?[{data:Qd(h)?n.requestDataName(d):n.requestDataName(xt.Raw),field:n.vgField(i),sort:h}]:[{data:n.requestDataName(d),field:n.vgField(i)}])}function eb(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":G1),...i?{field:ji(i)}:{},...r?{order:r}:{}}}function hye(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t)?.bin,s=Wz(i)?i:void 0,o=Uu(r)&&L1(r.extent)?r.extent:void 0;(s||o)&&n.set("selectionExtent",s??o,!0)}function pye(e,t,n){if(!Vt(n))return;const i=e.fieldDef(t),r=i.sort;if(r8(r))return{op:"min",field:gc(i,t),order:"ascending"};const{stack:s}=e,o=s?new Set([...s.groupbyFields,...s.stackBy.map(a=>a.fieldDef.field)]):void 0;if(Ys(r)){const a=s&&!o.has(r.field);return eb(r,a)}else if(sge(r)){const{encoding:a,order:u}=r,l=e.fieldDef(a),{aggregate:c,field:f}=l,d=s&&!o.has(f);if(no(c)||wa(c))return eb({field:ne(l),order:u},d);if(k$(c)||!c)return eb({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Pe(["ascending",void 0],r))return!0}}function AR(e,t){const{aggregate:n,type:i}=e;return n?oe(n)&&!Lde.has(n)?{valid:!1,reason:The(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Rhe(e)}:{valid:!0}:{valid:!1,reason:Fhe(e)}}function Vw(e,t,n,i){return e.explicit&&t.explicit&&Q(Ihe(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function gye(e){const t=Wr(e.map(o=>{if(Us(o)){const{sort:a,...u}=o;return u}return o}),Ie),n=Wr(e.map(o=>{if(Us(o)){const a=o.sort;return a!==void 0&&!Qd(a)&&("op"in a&&a.op==="count"&&delete a.field,a.order==="ascending"&&delete a.order),a}}).filter(o=>o!==void 0),Ie);if(t.length===0)return;if(t.length===1){const o=e[0];if(Us(o)&&n.length>0){let a=n[0];if(n.length>1){Q(PT);const u=n.filter(l=>ae(l)&&"op"in l&&l.op!=="min");n.every(l=>ae(l)&&"op"in l)&&u.length===1?a=u[0]:a=!0}else if(ae(a)&&"field"in a){const u=a.field;o.field===u&&(a=a.order?{order:a.order}:!0)}return{...o,sort:a}}return o}const i=Wr(n.map(o=>Qd(o)||!("op"in o)||oe(o.op)&&fe(Dde,o.op)?o:(Q(zhe(o)),!0)),Ie);let r;i.length===1?r=i[0]:i.length>1&&(Q(PT),r=!0);const s=Wr(e.map(o=>Us(o)?o.data:null),o=>o);return s.length===1&&s[0]!==null?{data:s[0],fields:t.map(a=>a.field),...r?{sort:r}:{}}:{fields:t,...r?{sort:r}:{}}}function FA(e){if(Us(e)&&oe(e.field))return e.field;if(zde(e)){let t;for(const n of e.fields)if(Us(n)&&oe(n.field)){if(!t)t=n.field;else if(t!==n.field)return Q(Bhe),t}return Q(Uhe),t}else if(Bde(e)){Q(jhe);const t=e.fields[0];return oe(t)?t:void 0}}function uy(e,t){const i=e.component.scales[t].get("domains").map(r=>(Us(r)&&(r.data=e.lookupDataSource(r.data)),r));return gye(i)}function e7(e){return Gc(e)||TA(e)?e.children.reduce((t,n)=>t.concat(e7(n)),CR(e)):CR(e)}function CR(e){return Y(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:s,type:o,selectionExtent:a,domains:u,range:l,reverse:c,...f}=r,d=mye(r.range,s,n,e),h=uy(e,n),p=a?m0e(e,a,i,h):null;return t.push({name:s,type:o,...h?{domain:h}:{},...p?{domainRaw:p}:{},range:d,...c!==void 0?{reverse:c}:{},...f}),t},[])}function mye(e,t,n,i){if(kt(n)){if(ju(e))return{step:{signal:`${t}_step`}}}else if(ae(e)&&Us(e))return{...e,data:i.lookupDataSource(e.data)};return e}class t7 extends go{merged=!1;constructor(t,n){super({},{name:t}),this.setWithExplicit("type",n)}domainHasZero(){const t=this.get("type");if(Pe([Jt.LOG,Jt.TIME,Jt.UTC],t))return"definitely-not";const n=this.get("zero");if(n===!0||n===void 0&&Pe([Jt.LINEAR,Jt.SQRT,Jt.POW],t))return"definitely";const i=this.get("domains");if(i.length>0){let r=!1,s=!1,o=!1;for(const a of i){if(G(a)){const u=a[0],l=a[a.length-1];if(We(u)&&We(l))if(u<=0&&l>=0){r=!0;continue}else{s=!0;continue}}o=!0}if(r)return"definitely";if(s&&!o)return"definitely-not"}return"maybe"}}const yye=["range","scheme"];function vye(e){const t=e.component.scales;for(const n of C$){const i=t[n];if(!i)continue;const r=bye(n,e);i.setWithExplicit("range",r)}}function kR(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:i,field:r}=n,s=si(t),o=e.getName(s);if(ae(i)&&i.binned&&i.step!==void 0)return new zt(()=>{const a=e.scaleName(t),u=`(domain("${a}")[1] - domain("${a}")[0]) / ${i.step}`;return`${e.getSignalName(o)} / (${u})`});if(ft(i)){const a=AA(e,r,i);return new zt(()=>{const u=e.getSignalName(a),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(o)} / (${l})`})}}}function bye(e,t){const n=t.specifiedScales[e],{size:i}=t,s=t.getScaleComponent(e).get("type");for(const f of yye)if(n[f]!==void 0){const d=Cw(s,f),h=Hz(e,f);if(!d)Q(Sz(s,f,e));else if(h)Q(h);else switch(f){case"range":{const p=n.range;if(G(p)){if(kt(e))return Lr(p.map(g=>{if(g==="width"||g==="height"){const m=t.getName(g),y=t.getSignalName.bind(t);return zt.fromName(y,m)}return g}))}else if(ae(p))return Lr({data:t.requestDataName(xt.Main),field:p.field,sort:{op:"min",field:t.vgField(e)}});return Lr(p)}case"scheme":return Lr(xye(n[f]))}}const o=e===mt||e==="xOffset"?"width":"height",a=i[o];if(us(a)){if(kt(e))if(Vt(s)){const f=i7(a,t,e);if(f)return Lr({step:f})}else Q($z(o));else if(Uh(e)){const f=e===ga?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const p=r7(a,s);if(p)return Lr(p)}}}const{rangeMin:u,rangeMax:l}=n,c=wye(e,t);return(u!==void 0||l!==void 0)&&Cw(s,"rangeMin")&&G(c)&&c.length===2?Lr([u??c[0],l??c[1]]):ci(c)}function xye(e){return Cpe(e)?{scheme:e.name,...xi(e,["name"])}:{scheme:e}}function n7(e,t,n,{center:i}={}){const r=si(e),s=t.getName(r),o=t.getSignalName.bind(t);return e===Xt&&mr(n)?i?[zt.fromName(a=>`${o(a)}/2`,s),zt.fromName(a=>`-${o(a)}/2`,s)]:[zt.fromName(o,s),0]:i?[zt.fromName(a=>`-${o(a)}/2`,s),zt.fromName(a=>`${o(a)}/2`,s)]:[0,zt.fromName(o,s)]}function wye(e,t){const{size:n,config:i,mark:r,encoding:s}=t,{type:o}=Nt(s[e]),u=t.getScaleComponent(e).get("type"),{domain:l,domainMid:c}=t.specifiedScales[e];switch(e){case mt:case Xt:{if(Pe(["point","band"],u)){const f=s7(e,n,i.view);if(us(f))return{step:i7(f,t,e)}}return n7(e,t,u)}case ga:case Bc:return _ye(e,t,u);case co:{const f=$ye(r,i),d=Aye(r,n,t,i);return uc(u)?Sye(f,d,Eye(u,i,l,e)):[f,d]}case Hi:return[0,Math.PI*2];case zu:return[0,360];case Sr:return[0,new zt(()=>{const f=t.getSignalName(wi(t.parent)?"child_width":"width"),d=t.getSignalName(wi(t.parent)?"child_height":"height");return`min(${f},${d})/2`})];case ma:return{step:1e3/i.scale.framesPerSecond};case ba:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case xa:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case ri:return"symbol";case ii:case ys:case vs:return u==="ordinal"?o==="nominal"?"category":"ordinal":c!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case fo:case ya:case va:return[i.scale.minOpacity,i.scale.maxOpacity]}}function i7(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),s=E$(n),o=i[s];if(L8({step:e,offsetIsDiscrete:Me(o)&&zz(o.type)})==="offset"&&v8(i,s)){const u=t.getScaleComponent(s);let c=`domain('${t.scaleName(s)}').length`;if(u.get("type")==="band"){const d=u.get("paddingInner")??u.get("padding")??0,h=u.get("paddingOuter")??u.get("padding")??0;c=`bandspace(${c}, ${d}, ${h})`}const f=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${c} / (1-${Hde(f)})`}}else return e.step}function r7(e,t){if(L8({step:e,offsetIsDiscrete:Vt(t)})==="offset")return{step:e.step}}function _ye(e,t,n){const i=e===ga?"x":"y",r=t.getScaleComponent(i);if(!r)return n7(i,t,n,{center:!0});const s=r.get("type"),o=t.scaleName(i),{markDef:a,config:u}=t;if(s==="band"){const l=s7(i,t.size,t.config.view);if(us(l)){const c=r7(l,n);if(c)return c}return[0,{signal:`bandwidth('${o}')`}]}else{const l=t.encoding[i];if(J(l)&&l.timeUnit){const c=Nz(l.timeUnit,p=>`scale('${o}', ${p})`),f=t.config.scale.bandWithNestedOffsetPaddingInner,d=sa({fieldDef:l,markDef:a,config:u})-.5,h=d!==0?` + ${d}`:"";if(f){const p=ye(f)?`${f.signal}/2${h}`:`${f/2+d}`,g=ye(f)?`(1 - ${f.signal}/2)${h}`:`${1-f/2+d}`;return[{signal:`${p} * (${c})`},{signal:`${g} * (${c})`}]}return[0,{signal:c}]}return H4(`Cannot use ${e} scale if ${i} scale is not discrete.`)}}function s7(e,t,n){const i=e===mt?"width":"height",r=t[i];return r||Qm(n,i)}function Eye(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&G(n)?n.length+1:(Q(Qhe(i)),3)}}function Sye(e,t,n){const i=()=>{const r=or(t),s=or(e),o=`(${r} - ${s}) / (${n} - 1)`;return`sequence(${s}, ${r} + ${o}, ${o})`};return ye(t)?new zt(i):{signal:i()}}function $ye(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize}throw new Error(z1("size",e))}const MR=.95;function Aye(e,t,n,i){const r={x:kR(n,"x"),y:kR(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const s=FR(t,r,i.view);return We(s)?s-1:new zt(()=>`${s.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const s=FR(t,r,i.view);return We(s)?Math.pow(MR*s,2):new zt(()=>`pow(${MR} * ${s.signal}, 2)`)}}throw new Error(z1("size",e))}function FR(e,t,n){const i=us(e.width)?e.width.step:Tw(n,"width"),r=us(e.height)?e.height.step:Tw(n,"height");return t.x||t.y?new zt(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function o7(e,t){vt(e)?Cye(e,t):u7(e,t)}function Cye(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:s,specifiedScales:o}=e;for(const a of Y(n)){const u=o[a],l=n[a],c=e.getScaleComponent(a),f=Nt(r[a]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=Cw(h,t),y=Hz(a,t);if(d!==void 0&&(m?y&&Q(y):Q(Sz(h,t,a))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,b=f.type;switch(t){case"domainMax":case"domainMin":qu(u[t])||b==="temporal"||v?l.set(t,{signal:K1(u[t],{type:b,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=K(TR,t)?TR[t]({model:e,channel:a,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:s,config:i,hasNestedOffsetScale:b8(r,a),hasSecondaryRangeChannel:!!r[bs(a)]}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const TR={bins:({model:e,fieldOrDatumDef:t})=>J(t)?kye(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Mye(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:s})=>Fye(e,t,n,i,r,s),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>Tye(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:s})=>Rye(e,t,n.type,i,r.scale,s),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:s})=>Oye(e,t,n,i,r.scale,s),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=J(e)?e.sort:void 0;return Dye(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r,config:s,hasSecondaryRangeChannel:o})=>Nye(e,t,n,i,r,s.scale,o)};function a7(e){vt(e)?vye(e):u7(e,"range")}function u7(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?a7(i):o7(i,t);for(const i of Y(n)){let r;for(const s of e.children){const o=s.component.scales[i];if(o){const a=o.getWithExplicit(t);r=oa(r,a,t,"scale",J8((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function kye(e,t){const n=t.bin;if(ft(n)){const i=AA(e,t.field,n);return new zt(()=>e.getSignalName(i))}else if(Kt(n)&&Uu(n)&&n.step!==void 0)return{step:n.step}}function Mye(e,t){if(Pe([ii,ys,vs],e)&&t!=="nominal")return"hcl"}function Fye(e,t,n,i,r,s){if(!(vr(s)?.bin||G(n)||r!=null||i!=null||Pe([Jt.TIME,Jt.UTC],e)))return kt(t)?!0:void 0}function Tye(e,t,n,i,r,s){if(kt(e)){if(Hr(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:a}=r;if(o==="bar"&&!(J(i)&&(i.bin||i.timeUnit))&&(a==="vertical"&&e==="x"||a==="horizontal"&&e==="y"))return s.continuousBandSize}if(t===Jt.POINT)return n.pointPadding}}function Rye(e,t,n,i,r,s=!1){if(e===void 0){if(kt(t)){const{bandPaddingInner:o,barBandPaddingInner:a,rectBandPaddingInner:u,tickBandPaddingInner:l,bandWithNestedOffsetPaddingInner:c}=r;return s?c:Ct(o,n==="bar"?a:n==="tick"?l:u)}else if(Uh(t)&&i===Jt.BAND)return r.offsetBandPaddingInner}}function Oye(e,t,n,i,r,s=!1){if(e===void 0){if(kt(t)){const{bandPaddingOuter:o,bandWithNestedOffsetPaddingOuter:a}=r;if(s)return a;if(n===Jt.BAND)return Ct(o,ye(i)?{signal:`${i.signal}/2`}:i/2)}else if(Uh(t)){if(n===Jt.POINT)return .5;if(n===Jt.BAND)return r.offsetBandPaddingOuter}}}function Dye(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return mr(e)&&t==="descending"?ye(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(mr(e)&&t==="descending")return!0}function Nye(e,t,n,i,r,s,o){if(!!n&&n!=="unaggregated"&&mr(r)){if(G(n)){const u=n[0],l=n[n.length-1];if(We(u)&&u<=0&&We(l)&&l>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!uc(r))return!0;if(!(J(t)&&t.bin)&&Pe([...ho,...$de],e)){const{orient:u,type:l}=i;return Pe(["bar","area","line","trail"],l)&&(u==="horizontal"&&e==="y"||u==="vertical"&&e==="x")?!1:Pe(["bar","area"],l)&&!o?!0:s?.zero}return!1}function Pye(e,t,n,i,r=!1){const s=Iye(t,n,i,r),{type:o}=e;return xs(t)?o!==void 0?Dpe(t,o)?J(n)&&!Ope(o,n.type)?(Q(Nhe(o,s)),s):o:(Q(Dhe(t,o,s)),s):s:null}function Iye(e,t,n,i){switch(t.type){case"nominal":case"ordinal":{if(Ml(e)||jv(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Q(qv(e,"ordinal")),"ordinal";if(Uv(e))return"band";if(kt(e)||Uh(e)){if(Pe(["rect","bar","image","rule","tick"],n.type)||i)return"band"}else if(n.type==="arc"&&e in A$)return"band";const r=n[si(e)];return Su(r)||cc(t)&&t.axis?.tickBand?"band":"point"}case"temporal":return Ml(e)?"time":jv(e)==="discrete"?(Q(qv(e,"temporal")),"ordinal"):J(t)&&t.timeUnit&&Ht(t.timeUnit).utc?"utc":Uv(e)?"band":"time";case"quantitative":return Ml(e)?J(t)&&ft(t.bin)?"bin-ordinal":"linear":jv(e)==="discrete"?(Q(qv(e,"quantitative")),"ordinal"):Uv(e)?"band":"linear";case"geojson":return}throw new Error(_z(t.type))}function Lye(e,{ignoreRange:t}={}){l7(e),Z9(e);for(const n of Rpe)o7(e,n);t||a7(e)}function l7(e){vt(e)?e.component.scales=zye(e):e.component.scales=Uye(e)}function zye(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const s of C$){const o=Nt(t[s]);if(o&&n===Yz&&s===ri&&o.type===Uc)continue;let a=o&&o.scale;if(o&&a!==null&&a!==!1){a??={};const u=b8(t,s),l=Pye(a,s,o,i,u);r[s]=new t7(e.scaleName(`${s}`,!0),{value:l,explicit:a.type===l})}}return r}const Bye=J8((e,t)=>LT(e)-LT(t));function Uye(e){const t=e.component.scales={},n={},i=e.component.resolve;for(const r of e.children){l7(r);for(const s of Y(r.component.scales))if(i.scale[s]??=B9(s,e),i.scale[s]==="shared"){const o=n[s],a=r.component.scales[s].getWithExplicit("type");o?_pe(o.value,a.value)?n[s]=oa(o,a,"type","scale",Bye):(i.scale[s]="independent",delete n[s]):n[s]=a}}for(const r of Y(n)){const s=e.scaleName(r,!0),o=n[r];t[r]=new t7(s,o);for(const a of e.children){const u=a.component.scales[r];u&&(a.renameScale(u.get("name"),s),u.merged=!0)}}return t}class tb{nameMap;constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function vt(e){return e?.type==="unit"}function wi(e){return e?.type==="facet"}function TA(e){return e?.type==="concat"}function Gc(e){return e?.type==="layer"}class RA{type;parent;config;name;size;title;description;data;transforms;layout;scaleNameMap;projectionNameMap;signalNameMap;component;view;constructor(t,n,i,r,s,o,a){this.type=n,this.parent=i,this.config=s,this.parent=i,this.config=s,this.view=Qt(a),this.name=t.name??r,this.title=ko(t.title)?{text:t.title}:t.title?Qt(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new tb,this.projectionNameMap=i?i.projectionNameMap:new tb,this.signalNameMap=i?i.signalNameMap:new tb,this.data=t.data,this.description=t.description,this.transforms=Vme(t.transform??[]),this.layout=n==="layer"||n==="unit"?{}:Qge(t,n,s),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:V1(t)||i?.component.data.isFaceted&&t.data===void 0},layoutSize:new go,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?Ce(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Lye(this)}parseProjection(){K9(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){H9(this)}assembleEncodeFromView(t){const{style:n,...i}=t,r={};for(const s of Y(i)){const o=i[s];o!==void 0&&(r[s]=ht(o))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=ht(this.description)),this.type==="unit"||this.type==="layer")?{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...n}:at(n)?void 0:n}assembleLayout(){if(!this.layout)return;const{spacing:t,...n}=this.layout,{component:i,config:r}=this,s=u1e(i.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...n,...s?{titleBand:s}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Oi)t[i].title&&n.push(n1e(this,i));for(const i of _A)n=n.concat(i1e(this,i));return n}assembleAxes(){return q0e(this.component.axes,this.config)}assembleLegends(){return V9(this)}assembleProjections(){return T1e(this)}assembleTitle(){const{encoding:t,...n}=this.title??{},i={...hz(this.config.title).nonMarkTitleProperties,...n,...t?{encode:{update:t}}:{}};if(i.text)return Pe(["unit","layer"],this.type)?Pe(["middle",void 0],i.anchor)&&(i.frame??="group"):i.anchor??="start",at(i)?void 0:i}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||wi(this.parent)?e7(this):[];r.length>0&&(n.scales=r);const s=this.assembleAxes();s.length>0&&(n.axes=s);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return gt((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(xt[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(wi(this.parent)){const n=L9(t),i=P1(n),r=this.component.scales[i];if(r&&!r.merged){const s=r.get("type"),o=r.get("range");if(Vt(s)&&ju(o)){const a=r.get("name"),u=uy(this,i),l=FA(u);if(l){const c=ne({aggregate:"distinct",field:l},{expr:"datum"});return{signal:I9(a,r,c)}}else return Q(F$(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(sz(t)&&xs(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getScaleType(t){const n=this.getScaleComponent(t);return n?n.get("type"):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Kde(n));return i}hasAxisOrientSignalRef(){return this.component.axes.x?.some(t=>t.hasOrientSignalRef())||this.component.axes.y?.some(t=>t.hasOrientSignalRef())}}class c7 extends RA{vgField(t,n={}){const i=this.fieldDef(t);if(i)return ne(i,n)}reduceFieldDef(t,n){return Age(this.getMapping(),(i,r,s)=>{const o=vr(r);return o?t(i,o,s):i},n)}forEachFieldDef(t,n){rA(this.getMapping(),(i,r)=>{const s=vr(i);s&&t(s,r)},n)}}class ly extends rt{transform;clone(){return new ly(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"value",i[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ie(this.transform)}`}assemble(){const{density:t,...n}=this.transform,i={type:"kde",field:t,...n};return i.resolve=this.transform.resolve,i}}class cy extends rt{transform;clone(){return new cy(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${Ie(this.transform)}`}assemble(){const{extent:t,param:n}=this.transform;return{type:"extent",field:t,signal:n}}}class fy extends rt{transform;clone(){return new fy(this.parent,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((s,o)=>r[o]??s)}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ie(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class dy extends rt{transform;clone(){return new dy(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"key",i[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ie(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Rl extends rt{fields;geojson;signal;clone(){return new Rl(null,Ce(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[Ar,$r],[qi,Cr]]){const s=r.map(o=>{const a=Nt(n.encoding[o]);return J(a)?a.field:ws(a)?{expr:`${a.datum}`}:yr(a)?{expr:`${a.value}`}:void 0});(s[0]||s[1])&&(t=new Rl(t,s,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(ri)){const r=n.typedFieldDef(ri);r.type===Uc&&(t=new Rl(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}constructor(t,n,i,r){super(t),this.fields=n,this.geojson=i,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(oe);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ie(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class th extends rt{projection;fields;as;clone(){return new th(null,this.projection,Ce(this.fields),Ce(this.as))}constructor(t,n,i,r){super(t),this.projection=n,this.fields=i,this.as=r}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[Ar,$r],[qi,Cr]]){const r=i.map(o=>{const a=Nt(n.encoding[o]);return J(a)?a.field:ws(a)?{expr:`${a.datum}`}:yr(a)?{expr:`${a.value}`}:void 0}),s=i[0]===qi?"2":"";(r[0]||r[1])&&(t=new th(t,n.projectionName(),r,[n.getName(`x${s}`),n.getName(`y${s}`)]))}return t}dependentFields(){return new Set(this.fields.filter(oe))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ie(this.fields)} ${Ie(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class ru extends rt{transform;clone(){return new ru(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new ru(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,s=i.y;if(J(r)&&J(s)){const o=r.impute?r:s.impute?s:void 0;if(o===void 0)return;const a=r.impute?s:s.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=_8(n.mark,i);return new ru(t,{impute:o.field,key:a.field,...u?{method:u}:{},...l!==void 0?{value:l}:{},...c?{frame:c}:{},...f!==void 0?{keyvals:f}:{},...d.length?{groupby:d}:{}})}return null}hash(){return`Impute ${Ie(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:s,value:o,frame:a=[null,null]}=this.transform,u={type:"impute",field:t,key:n,...i?{keyvals:kme(i)?this.processSequence(i):i}:{},method:"value",...s?{groupby:s}:{},value:!r||r==="value"?o:null};if(r&&r!=="value"){const l={type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1,...s?{groupby:s}:{}},c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class hy extends rt{transform;clone(){return new hy(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ie(this.transform)}`}assemble(){const{loess:t,on:n,...i}=this.transform;return{type:"loess",x:n,y:t,...i}}}class nh extends rt{transform;secondary;clone(){return new nh(null,Ce(this.transform),this.secondary)}constructor(t,n,i){super(t),this.transform=n,this.secondary=i}static make(t,n,i,r){const s=n.component.data.sources,{from:o}=i;let a=null;if(Mme(o)){let u=h7(o.data,s);u||(u=new ku(o.data),s.push(u));const l=n.getName(`lookup_${r}`);a=new Zn(u,l,xt.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=a}else if(Fme(o)){const u=o.param;i={as:u,...i};let l;try{l=n.getSelectionComponent(gt(u),u)}catch{throw new Error(ehe(u))}if(a=l.materialized,!a)throw new Error(the(u))}return new nh(t,i,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?le(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ie({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:le(this.transform.as)}:{}};else{let n=this.transform.as;oe(n)||(Q(dhe),n="_lookup"),t={as:[n]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class py extends rt{transform;clone(){return new py(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??"prob",i[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ie(this.transform)}`}assemble(){const{quantile:t,...n}=this.transform;return{type:"quantile",field:t,...n}}}class gy extends rt{transform;clone(){return new gy(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n,this.transform=Ce(n);const i=this.transform.as??[void 0,void 0];this.transform.as=[i[0]??n.on,i[1]??n.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ie(this.transform)}`}assemble(){const{regression:t,on:n,...i}=this.transform;return{type:"regression",x:n,y:t,...i}}}class my extends rt{transform;clone(){return new my(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}addDimensions(t){this.transform.groupby=Wr((this.transform.groupby??[]).concat(t),n=>n)}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${Ie(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:s}=this.transform;return{type:"pivot",field:t,value:n,...r!==void 0?{limit:r}:{},...s!==void 0?{op:s}:{},...i!==void 0?{groupby:i}:{}}}}class yy extends rt{transform;clone(){return new yy(null,Ce(this.transform))}constructor(t,n){super(t),this.transform=n}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ie(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function f7(e){let t=0;function n(i,r){if(i instanceof ku&&!i.isGenerator&&!dc(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof gn&&(i.parent instanceof ku&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Wc){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Qh||i instanceof Jh||i instanceof yc||i instanceof qc||i instanceof pc||i instanceof th||i instanceof fr||i instanceof nh||i instanceof Hc||i instanceof Vu||i instanceof dy||i instanceof fy||i instanceof ly||i instanceof hy||i instanceof py||i instanceof gy||i instanceof aa||i instanceof yy||i instanceof my||i instanceof cy)&&r.transform.push(i.assemble()),(i instanceof Jr||i instanceof Kr||i instanceof ru||i instanceof Ks||i instanceof Rl)&&r.transform.push(...i.assemble()),i instanceof Zn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof Zn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof Zn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let s=r.name;!r.source||r.transform.length>0?e.push(r):s=r.source;for(const o of i.children)n(o,{name:null,source:s,transform:[]});break}}}return n}function jye(e){const t=[],n=f7(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function qye(e,t){const n=[],i=f7(n);let r=0;for(const o of e.sources){o.hasName()||(o.dataName=`source_${r++}`);const a=o.assemble();i(o,a)}for(const o of n)o.transform.length===0&&delete o.transform;let s=0;for(const[o,a]of n.entries())(a.transform??[]).length===0&&!a.source&&n.splice(s++,0,n.splice(o,1)[0]);for(const o of n)for(const a of o.transform??[])a.type==="lookup"&&(a.from=e.outputNodes[a.from].getSource());for(const o of n)o.name in t&&(o.values=t[o.name]);return n}function Wye(e){return e==="top"||e==="left"||ye(e)?"header":"footer"}function Hye(e){for(const t of Oi)Gye(e,t);RR(e,"x"),RR(e,"y")}function Gye(e,t){const{facet:n,config:i,child:r,component:s}=e;if(e.channelHasField(t)){const o=n[t],a=mc("title",null,i,t);let u=Fl(o,i,{allowDisabling:!0,includeDefault:a===void 0||!!a});r.component.layoutHeaders[t].title&&(u=G(u)?u.join(", "):u,u+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const l=mc("labelOrient",o.header,i,t),c=o.header!==null?Ct(o.header?.labels,i.header.labels,!0):!1,f=Pe(["bottom","right"],l)?"footer":"header";s.layoutHeaders[t]={title:o.header!==null?u:null,facetFieldDef:o,[f]:t==="facet"?[]:[d7(e,t,c)]}}}function d7(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function RR(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=$A(r,t),r.axis[t]==="shared"){const s=t==="x"?"column":"row",o=i[s];for(const a of n.component.axes[t]){const u=Wye(a.get("orient"));o[u]??=[d7(e,s,!1)];const l=Yf(a,"main",e.config,{header:!0});l&&o[u][0].axes.push(l),a.mainExtracted=!0}}}}function Vye(e){OA(e),t0(e,"width"),t0(e,"height")}function Yye(e){OA(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";t0(e,t),t0(e,n)}function OA(e){for(const t of e.children)t.parseLayoutSize()}function t0(e,t){const n=L9(t),i=P1(n),r=e.component.resolve,s=e.component.layoutSize;let o;for(const a of e.children){const u=a.component.layoutSize.getWithExplicit(n),l=r.scale[i]??B9(i,e);if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=oa(o,u,n,"")}else o=u}if(o){for(const a of e.children)e.renameSignal(a.getName(n),e.getName(t)),a.component.layoutSize.set(n,"merged",!1);s.setWithExplicit(t,o)}else s.setWithExplicit(t,{explicit:!1,value:void 0})}function Xye(e){const{size:t,component:n}=e;for(const i of ho){const r=si(i);if(t[r]){const s=t[r];n.layoutSize.set(r,us(s)?"step":s,!0)}else{const s=Kye(e,r);n.layoutSize.set(r,s,!1)}}}function Kye(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const s=r.get("type"),o=r.get("range");if(Vt(s)){const a=Qm(i.view,t);return ju(o)||us(a)?"step":a}else return Fw(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return Fw(i.view,t);{const s=Qm(i.view,t);return us(s)?s.step:s}}}function Yw(e,t,n){return ne(t,{suffix:`by_${ne(e)}`,...n})}class xd extends c7{facet;child;children;constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve),this.child=LA(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Hh(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=Y(t),i={};for(const r of n){if(![Gs,Vs].includes(r)){Q(z1(r,"facet"));break}const s=t[r];if(s.field===void 0){Q($w(s,r));break}i[r]=this.initFacetFieldDef(s,r)}return i}initFacetFieldDef(t,n){const i=iA(t,n);return i.header?i.header=Qt(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return K(this.facet,t)}fieldDef(t){return this.facet[t]}parseData(){this.component.data=vy(this),this.child.parseData()}parseLayoutSize(){OA(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection,Ft(this.component.selection).some(t=>Qr(t))&&R$(T$)}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Hye(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const n of Oi)for(const i of EA){const r=this.component.layoutHeaders[n],s=r[i],{facetFieldDef:o}=r;if(o){const a=mc("titleOrient",o.header,this.config,n);if(["right","bottom"].includes(a)){const u=oy(n,a);t.titleAnchor??={},t.titleAnchor[u]="end"}}if(s?.[0]){const a=n==="row"?"height":"width",u=i==="header"?"headerBand":"footerBand";n!=="facet"&&!this.child.component.layoutSize.get(a)&&(t[u]??={},t[u][n]=.5),r.title&&(t.offset??={},t.offset[n==="row"?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),{...this.getHeaderLayoutMixins(),...i?{columns:i}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof xd))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof xd?{...this.channelHasField("column")?{encode:{update:{columns:{field:ne(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof xd){if(this.child.channelHasField("column")){const r=ne(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of ho){const s=this.child.component.scales[r];if(s&&!s.merged){const o=s.get("type"),a=s.get("range");if(Vt(o)&&ju(a)){const u=uy(this.child,r),l=FA(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):Q(F$(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:s,ops:o,as:a}=this.getCardinalityAggregateForChild(),u=[];for(const c of Oi){const f=this.facet[c];if(f){u.push(ne(f));const{bin:d,sort:h}=f;if(ft(d)&&u.push(ne(f,{binSuffix:"end"})),Ys(h)){const{field:p,op:g=G1}=h,m=Yw(f,h);i&&r?(s.push(m),o.push("max"),a.push(m)):(s.push(p),o.push(g),a.push(m))}else if(G(h)){const p=gc(f,c);s.push(p),o.push("max"),a.push(p)}}}const l=!!i&&!!r;return{name:t,data:n,groupby:u,...l||s.length>0?{aggregate:{...l?{cross:l}:{},...s.length?{fields:s,ops:o,as:a}:{}}}:{}}}facetSortFields(t){const{facet:n}=this,i=n[t];return i?Ys(i.sort)?[Yw(i,i.sort,{expr:"datum"})]:G(i.sort)?[gc(i,t,{expr:"datum"})]:[ne(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(Ys(r)?r.order:!G(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return Uw(t.facet,"facet",n);const i={row:["top","bottom"],column:["left","right"]};for(const r of _A)if(t[r]){const s=mc("labelOrient",t[r]?.header,n,r);if(i[r].includes(s))return Uw(t[r],r,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=jye(n),r=t.assembleGroupEncodeEntry(!1),s=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...s?{title:s}:{},...o?{style:o}:{},from:{facet:this.assembleFacet()},sort:{field:Oi.map(u=>this.facetSortFields(u)).flat(),order:Oi.map(u=>this.facetSortOrder(u)).flat()},...i.length>0?{data:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup(d0e(this,[]))}]}getMapping(){return this.facet}}function Qye(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const s of[n,i])if(Ys(s.sort)){const{field:o,op:a=G1}=s.sort;e=r=new Vu(e,{joinaggregate:[{op:a,field:o,as:Yw(s,s.sort,{forAs:!0})}],groupby:[ne(s)]})}return r}return null}function h7(e,t){for(const n of t){const i=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const r=e.format?.mesh,s=i.format?.feature;if(r&&s)continue;const o=e.format?.feature;if((o||s)&&o!==s)continue;const a=i.format?.mesh;if(!((r||a)&&r!==a)){if(eh(e)&&eh(i)){if(mi(e.values,i.values))return n}else if(dc(e)&&dc(i)){if(e.url===i.url)return n}else if(Z8(e)&&e.name===n.dataName)return n}}return null}function Jye(e,t){if(e.data||!e.parent){if(e.data===null){const i=new ku({values:[]});return t.push(i),i}const n=h7(e.data,t);if(n)return Go(e.data)||(n.data.format=G4({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new ku(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Zye(e,t,n){let i=0;for(const r of t.transforms){let s,o;if(Bme(r))o=e=new pc(e,r),s="derived";else if(gA(r)){const a=W1e(r);o=e=gn.makeWithAncestors(e,{},a,n)??e,e=new qc(e,t,r.filter)}else if(Y8(r))o=e=Jr.makeFromTransform(e,r,t),s="number";else if(jme(r))s="date",n.getWithExplicit(r.field).value===void 0&&(e=new gn(e,{[r.field]:s}),n.set(r.field,s,!1)),o=e=Kr.makeFromTransform(e,r);else if(qme(r))o=e=fr.makeFromTransform(e,r),s="number",wA(t)&&(e=new aa(e));else if(V8(r))o=e=nh.make(e,t,r,i++),s="derived";else if(Ime(r))o=e=new Hc(e,r),s="number";else if(Lme(r))o=e=new Vu(e,r),s="number";else if(Wme(r))o=e=Ks.makeFromTransform(e,r),s="derived";else if(Hme(r))o=e=new dy(e,r),s="derived";else if(Gme(r))o=e=new cy(e,r),s="derived";else if(zme(r))o=e=new fy(e,r),s="derived";else if(Tme(r))o=e=new my(e,r),s="derived";else if(Pme(r))e=new yy(e,r);else if(Ume(r))o=e=ru.makeFromTransform(e,r),s="derived";else if(Rme(r))o=e=new ly(e,r),s="derived";else if(Ome(r))o=e=new py(e,r),s="derived";else if(Dme(r))o=e=new gy(e,r),s="derived";else if(Nme(r))o=e=new hy(e,r),s="derived";else{Q(fhe(r));continue}if(o&&s!==void 0)for(const a of o.producedFields()??[])n.set(a,s,!1)}return e}function vy(e){let t=Jye(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,o=!(r&&(Go(r)||dc(r)||eh(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new r0e;Go(r)?(e9(r)?t=new Jh(t,r.sequence):mA(r)&&(t=new Qh(t,r.graticule)),o.parseNothing=!0):r?.format?.parse===null&&(o.parseNothing=!0),t=gn.makeExplicit(t,e,o)??t,t=new aa(t);const a=e.parent&&Gc(e.parent);(vt(e)||wi(e))&&a&&(t=Jr.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=Zye(t,e,o));const u=G1e(e),l=H1e(e);t=gn.makeWithAncestors(t,{},{...u,...l},o)??t,vt(e)&&(t=Rl.parseAll(t,e),t=th.parseAll(t,e)),(vt(e)||wi(e))&&(a||(t=Jr.makeFromEncoding(t,e)??t),t=Kr.makeFromEncoding(t,e)??t,t=pc.parseAllForSortIndex(t,e));const c=t=Np(xt.Raw,e,t);if(vt(e)){const m=fr.makeFromEncoding(t,e);m&&(t=m,wA(e)&&(t=new aa(t))),t=ru.makeFromEncoding(t,e)??t,t=Ks.makeFromEncoding(t,e)??t}let f,d;if(vt(e)){const{markDef:m,mark:y,config:v}=e,b=Je("invalid",m,v),{marks:x,scales:w}=d=n9({invalid:b,isPath:_a(y)});x!==w&&w==="include-invalid-values"&&(f=t=Np(xt.PreFilterInvalid,e,t)),x==="exclude-invalid-values"&&(t=yc.make(t,e,d)??t)}const h=t=Np(xt.Main,e,t);let p;if(vt(e)&&d){const{marks:m,scales:y}=d;m==="include-invalid-values"&&y==="exclude-invalid-values"&&(t=yc.make(t,e,d)??t,p=t=Np(xt.PostFilterInvalid,e,t))}vt(e)&&U0e(e,h);let g=null;if(wi(e)){const m=e.getName("facet");t=Qye(t,e.facet)??t,g=new Wc(t,e,m,h.getSource()),n[m]=g}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:c,main:h,facetRoot:g,ancestorParse:o,preFilterInvalid:f,postFilterInvalid:p}}function Np(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,s=t.getDataName(e),o=new Zn(n,s,e,r);return i[s]=o,o}class eve extends RA{children;constructor(t,n,i,r){super(t,"concat",n,i,r,t.resolve),(t.resolve?.axis?.x==="shared"||t.resolve?.axis?.y==="shared")&&Q(uhe),this.children=this.getChildren(t).map((s,o)=>LA(s,this,this.getName(`concat_${o}`),void 0,r))}parseData(){this.component.data=vy(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Y(t.component.selection))this.component.selection[n]=t.component.selection[n]}Ft(this.component.selection).some(t=>Qr(t))&&R$(T$)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Z1(t)?t.vconcat:hA(t)?t.hconcat:t.concat}parseLayoutSize(){Yye(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=SA(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...n?{title:n}:{},...i?{style:i}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...t!=null?{columns:t}:{},bounds:"full",align:"each"}}}function tve(e){return e===!1||e===null}const nve={disable:1,gridScale:1,scale:1,...m8,labelExpr:1,encode:1},p7=Y(nve);class DA extends go{explicit;implicit;mainExtracted;constructor(t={},n={},i=!1){super(),this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new DA(Ce(this.explicit),Ce(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!tve(this.get(t))}hasOrientSignalRef(){return ye(this.explicit.orient)}}function ive(e,t,n){const{encoding:i,config:r}=e,s=Nt(i[t])??Nt(i[bs(t)]),o=e.axis(t)||{},{format:a,formatType:u}=o;if($u(u))return{text:ar({fieldOrDatumDef:s,field:"datum.value",format:a,formatType:u,config:r}),...n};if(a===void 0&&u===void 0&&r.customFormatTypes){if(lc(s)==="quantitative"){if(cc(s)&&s.stack==="normalize"&&r.normalizedNumberFormatType)return{text:ar({fieldOrDatumDef:s,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:ar({fieldOrDatumDef:s,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n}}if(lc(s)==="temporal"&&r.timeFormatType&&J(s)&&!s.timeUnit)return{text:ar({fieldOrDatumDef:s,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n}}return n}function rve(e){return ho.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[fve(n,e)]),t),{})}const sve={bottom:"top",top:"bottom",left:"right",right:"left"};function ove(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const r of e.children){r.parseAxesAndHeaders();for(const s of Y(r.component.axes))n.axis[s]=$A(e.component.resolve,s),n.axis[s]==="shared"&&(t[s]=ave(t[s],r.component.axes[s]),t[s]||(n.axis[s]="independent",delete t[s]))}for(const r of ho){for(const s of e.children)if(s.component.axes[r]){if(n.axis[r]==="independent"){t[r]=(t[r]??[]).concat(s.component.axes[r]);for(const o of s.component.axes[r]){const{value:a,explicit:u}=o.getWithExplicit("orient");if(!ye(a)){if(i[a]>0&&!u){const l=sve[a];i[a]>i[l]&&o.set("orient",l,!1)}i[a]++}}}delete s.component.axes[r]}if(n.axis[r]==="independent"&&t[r]&&t[r].length>1)for(const[s,o]of(t[r]||[]).entries())s>0&&o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function ave(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],s=t[i];if(!!r!=!!s)return;if(r&&s){const o=r.getWithExplicit("orient"),a=s.getWithExplicit("orient");if(o.explicit&&a.explicit&&o.value!==a.value)return;e[i]=uve(r,s)}}}else return t.map(n=>n.clone());return e}function uve(e,t){for(const n of p7){const i=oa(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,s)=>{switch(n){case"title":return xz(r,s);case"gridScale":return{explicit:r.explicit,value:Ct(r.value,s.value)}}return ty(r,s,n,"axis")});e.setWithExplicit(n,i)}return e}function lve(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(ye(n.labelAngle)?n.labelAngle:Jd(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===O9(i,r))return!0}return e===n[t]}const cve=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function fve(e,t){let n=t.axis(e);const i=new DA,r=Nt(t.encoding[e]),{mark:s,config:o}=t,a=n?.orient||o[e==="x"?"axisX":"axisY"]?.orient||o.axis?.orient||Q0e(e),u=t.getScaleComponent(e).get("type"),l=W0e(e,u,a,t.config),c=n!==void 0?!n:zw("disable",o.style,n?.style,l).configValue;if(i.set("disable",c,n!==void 0),c)return i;n=n||{};const f=Y0e(r,n,e,o.style,l),d=n8(n.formatType,r,u),h=t8(r,r.type,n.format,n.formatType,o,!0),p={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:u,orient:a,labelAngle:f,format:h,formatType:d,mark:s,config:o};for(const y of p7){const v=y in vR?vR[y](p):HT(y)?n[y]:void 0,b=v!==void 0,x=lve(v,y,n,t,e);if(b&&x)i.set(y,v,x);else{const{configValue:w=void 0,configFrom:E=void 0}=HT(y)&&y!=="values"?zw(y,o.style,n.style,l):{},_=w!==void 0;b&&!_?i.set(y,v,x):(E!=="vgAxisConfig"||cve.has(y)&&_||Xh(w)||ye(w))&&i.set(y,w,!1)}}const g=n.encoding??{},m=g8.reduce((y,v)=>{if(!i.hasAxisPart(v))return y;const b=z9(g[v]??{},t),x=v==="labels"?ive(t,e,b):b;return x!==void 0&&!at(x)&&(y[v]={update:x}),y},{});return at(m)||i.set("encode",m,!!n.encoding||n.labelAngle!==void 0),i}function dve({encoding:e,size:t}){for(const n of ho){const i=si(n);us(t[i])&&zo(e[n])&&(delete t[i],Q($z(i)))}return t}const hve={vgMark:"arc",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Pn("x",e,{defaultPos:"mid"}),...Pn("y",e,{defaultPos:"mid"}),...io(e,"radius"),...io(e,"theta")})},pve={vgMark:"area",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Jm("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"}),...Jm("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"}),...xA(e)})},gve={vgMark:"rect",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...io(e,"x"),...io(e,"y")})},mve={vgMark:"shape",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&J(n)&&n.type===Uc?{field:ne(n,{expr:"datum"})}:{}}]}},yve={vgMark:"image",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...io(e,"x"),...io(e,"y"),...vA(e,"url")})},vve={vgMark:"line",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Pn("x",e,{defaultPos:"mid"}),...Pn("y",e,{defaultPos:"mid"}),...Zt("size",e,{vgChannel:"strokeWidth"}),...xA(e)})},bve={vgMark:"trail",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Pn("x",e,{defaultPos:"mid"}),...Pn("y",e,{defaultPos:"mid"}),...Zt("size",e),...xA(e)})};function NA(e,t){const{config:n}=e;return{...Gi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Pn("x",e,{defaultPos:"mid"}),...Pn("y",e,{defaultPos:"mid"}),...Zt("size",e),...Zt("angle",e),...xve(e,n,t)}}function xve(e,t,n){return n?{shape:{value:n}}:Zt("shape",e)}const wve={vgMark:"symbol",encodeEntry:e=>NA(e)},_ve={vgMark:"symbol",encodeEntry:e=>NA(e,"circle")},Eve={vgMark:"symbol",encodeEntry:e=>NA(e,"square")},Sve={vgMark:"rect",encodeEntry:e=>({...Gi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...io(e,"x"),...io(e,"y")})},$ve={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:{...Gi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Jm("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"}),...Jm("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"}),...Zt("size",e,{vgChannel:"strokeWidth"})}}},Ave={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Gi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Pn("x",e,{defaultPos:"mid"}),...Pn("y",e,{defaultPos:"mid"}),...vA(e),...Zt("size",e,{vgChannel:"fontSize"}),...Zt("angle",e),...pR("align",Cve(e.markDef,n,t)),...pR("baseline",kve(e.markDef,n,t)),...Pn("radius",e,{defaultPos:null}),...Pn("theta",e,{defaultPos:null})}}};function Cve(e,t,n){if(Je("align",e,n)===void 0)return"center"}function kve(e,t,n){if(Je("baseline",e,n)===void 0)return"middle"}const Mve={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"x":"y",s=i==="horizontal"?"y":"x",o=i==="horizontal"?"height":"width";return{...Gi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...io(e,r),...Pn(s,e,{defaultPos:"mid",vgChannel:s==="y"?"yc":"xc"}),[o]:ht(Je("thickness",n,t))}}},Pp={arc:hve,area:pve,bar:gve,circle:_ve,geoshape:mve,image:yve,line:vve,point:wve,rect:Sve,rule:$ve,square:Eve,text:Ave,tick:Mve,trail:bve};function Fve(e){if(Pe([W1,j1,Lpe],e.mark)){const t=_8(e.mark,e.encoding);if(t.length>0)return Tve(e,t)}else if(e.mark===q1){const t=Ew.some(n=>Je(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return Rve(e)}return PA(e)}const OR="faceted_path_";function Tve(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:OR+e.requestDataName(xt.Main),data:e.requestDataName(xt.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:PA(e,{fromPrefix:OR})}]}const DR="stack_group_";function Rve(e){const[t]=PA(e,{fromPrefix:DR}),n=e.scaleName(e.stack.fieldChannel),i=(l={})=>e.vgField(e.stack.fieldChannel,l),r=(l,c)=>{const f=[i({prefix:"min",suffix:"start",expr:c}),i({prefix:"max",suffix:"start",expr:c}),i({prefix:"min",suffix:"end",expr:c}),i({prefix:"max",suffix:"end",expr:c})];return`${l}(${f.map(d=>`scale('${n}',${d})`).join(",")})`};let s,o;e.stack.fieldChannel==="x"?(s={...ic(t.encode.update,["y","yc","y2","height",...Ew]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...xi(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(s={...ic(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...xi(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const l of Ew){const c=os(l,e.markDef,e.config);t.encode.update[l]?(s[l]=t.encode.update[l],delete t.encode.update[l]):c&&(s[l]=ht(c)),c&&(t.encode.update[l]={value:0})}const a=[];if(e.stack.groupbyChannels?.length>0)for(const l of e.stack.groupbyChannels){const c=e.fieldDef(l),f=ne(c);f&&a.push(f),(c?.bin||c?.timeUnit)&&a.push(ne(c,{binSuffix:"end"}))}return s=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((l,c)=>{if(t.encode.update[c])return{...l,[c]:t.encode.update[c]};{const f=os(c,e.markDef,e.config);return f!==void 0?{...l,[c]:ht(f)}:l}},s),s.stroke&&(s.strokeForeground={value:!0},s.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(xt.Main),name:DR+e.requestDataName(xt.Main),groupby:a,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:s},marks:[{type:"group",encode:{update:o},marks:[t]}]}]}function Ove(e){const{encoding:t,stack:n,mark:i,markDef:r,config:s}=e,o=t.order;if(!(!G(o)&&yr(o)&&ww(o.value)||!o&&ww(Je("order",r,s)))){if((G(o)||J(o))&&!n)return yz(o,{expr:"datum"});if(_a(i)){const a=r.orient==="horizontal"?"y":"x",u=t[a];if(J(u))return{field:a}}}}function PA(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:s}=e,o=Ct(i.clip,Dve(e),Nve(e)),a=gz(i),u=r.key,l=Ove(e),c=Pve(e);c&&Object.values(e.component.selection).some(h=>h.type==="point"&&!h.bind&&h.on!=="pointerover")&&(e.markDef.cursor??="pointer");const f=Je("aria",i,s),d=Pp[n].postEncodingTransform?Pp[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Pp[n].vgMark,...o?{clip:o}:{},...a?{style:a}:{},...u?{key:u.field}:{},...l?{sort:l}:{},...c||{},...f===!1?{aria:f}:{},from:{data:t.fromPrefix+e.requestDataName(xt.Main)},encode:{update:Pp[n].encodeEntry(e)},...d?{transform:d}:{}}]}function Dve(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t?.get("selectionExtent")||n?.get("selectionExtent")?!0:void 0}function Nve(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Pve(e){if(!e.component.selection)return null;const t=Y(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=Y(i.component.selection).length,i=i.parent;return n?{interactive:t>0||e.mark==="geoshape"||!!e.encoding.tooltip||!!e.markDef.tooltip}:null}class g7 extends c7{markDef;encoding;specifiedScales={};stack;specifiedAxes={};specifiedLegends={};specifiedProjection={};selection=[];children=[];constructor(t,n,i,r={},s){super(t,"unit",n,i,s,void 0,VT(t)?t.view:void 0);const o=as(t.mark)?{...t.mark}:{type:t.mark},a=o.type;o.filled===void 0&&(o.filled=xme(o,s,{graticule:t.data&&mA(t.data)}));const u=this.encoding=Sge(t.encoding||{},a,o.filled,s);this.markDef=q8(o,u,s),this.size=dve({encoding:u,size:VT(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=j8(this.markDef,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter(l=>fA(l)),this.alignStackOrderWithColorDomain()}get hasProjection(){const{encoding:t}=this,n=this.mark===Yz,i=t&&mde.some(r=>Me(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return C$.reduce((i,r)=>{const s=Nt(n[r]);return s&&(i[r]=this.initScale(s.scale??{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=Qt(t);return G(n)&&(r.domain=n.map(hi)),G(i)&&(r.range=i.map(hi)),r}initAxes(t){return ho.reduce((n,i)=>{const r=t[i];if(Me(r)||i===mt&&Me(t.x2)||i===Xt&&Me(t.y2)){const s=Me(r)?r.axis:void 0;n[i]=s&&this.initAxis({...s})}return n},{})}initAxis(t){const n=Y(t),i={};for(const r of n){const s=t[r];i[r]=Xh(s)?pz(s):hi(s)}return i}initLegends(t){return Cde.reduce((n,i)=>{const r=Nt(t[i]);if(r&&Mde(i)){const s=r.legend;n[i]=s&&Qt(s)}return n},{})}alignStackOrderWithColorDomain(){const{color:t,fill:n,order:i,xOffset:r,yOffset:s}=this.encoding,o=n||t,a=J(o)?o:void 0,u=a?.field,l=a?.scale,c=a?.type,f=l?.domain,d=r||s,h=J(d)?d:void 0,p=`_${u}_sort_index`;if(!i&&Array.isArray(f)&&typeof u=="string"&&c==="nominal")if(h&&!h.sort)h.sort=f;else{const g=`indexof(${ee(f)}, datum['${u}'])`,m=this.markDef?.orient==="horizontal"?"ascending":"descending";this.transforms.push({calculate:g,as:p}),this.encoding.order={field:p,type:"quantitative",sort:m}}}parseData(){this.component.data=vy(this)}parseLayoutSize(){Xye(this)}parseSelections(){this.component.selection=B0e(this,this.selection)}parseMarkGroup(){this.component.mark=Fve(this)}parseAxesAndHeaders(){this.component.axes=rve(this)}assembleSelectionTopLevelSignals(t){return h0e(this,t)}assembleSignals(){return[...F9(this),...f0e(this,[])]}assembleSelectionData(t){return p0e(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return SA(this)}correctDataNames=t=>(t.from?.data&&(t.from.data=this.lookupDataSource(t.from.data),"time"in this.encoding&&(t.from.data=t.from.data+r9)),t.from?.facet?.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t);assembleMarks(){let t=this.component.mark??[];return(!this.parent||!Gc(this.parent))&&(t=u9(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return t!==void 0?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return nu(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return vr(n)}typedFieldDef(t){const n=this.fieldDef(t);return Un(n)?n:null}}class IA extends RA{children;constructor(t,n,i,r,s){super(t,"layer",n,i,s,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map((a,u)=>{if(ey(a))return new IA(a,this,this.getName(`layer_${u}`),o,s);if(po(a))return new g7(a,this,this.getName(`layer_${u}`),o,s);throw new Error(M$(a))})}parseData(){this.component.data=vy(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Vye(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Y(t.component.selection))this.component.selection[n]=t.component.selection[n]}Ft(this.component.selection).some(t=>Qr(t))&&R$(T$)}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){ove(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),F9(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),SA(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of le(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return g0e(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),V9(this))}}function LA(e,t,n,i,r){if(V1(e))return new xd(e,t,n,r);if(ey(e))return new IA(e,t,n,i,r);if(po(e))return new g7(e,t,n,i,r);if(Yge(e))return new eve(e,t,n,r);throw new Error(M$(e))}function Ive(e,t={}){t.logger&&Jhe(t.logger),t.fieldTitle&&d8(t.fieldTitle);try{const n=U8(_c(t.config,e.config)),i=Q8(e,n),r=LA(i,null,"",void 0,n);return r.parse(),aye(r.component.data,r),{spec:zve(r,Lve(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&Zhe(),t.fieldTitle&&gge()}}function Lve(e,t,n,i){const r=i.component.layoutSize.get("width"),s=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):oe(t)&&(t={type:t}),r&&s&&t0e(t.type)){if(r==="step"&&s==="step")Q(TT()),t.type="pad";else if(r==="step"||s==="step"){const o=r==="step"?"width":"height";Q(TT(P1(o)));const a=o==="width"?"height":"width";t.type=n0e(a)}}return{...Y(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t},...sR(n,!1),...sR(e,!0)}}function zve(e,t,n={},i){const r=e.config?ume(e.config):void 0,s=qye(e.component.data,n),o=e.assembleSelectionData(s),a=e.assembleProjections(),u=e.assembleTitle(),l=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0);let f=e.assembleLayoutSignals();f=f.filter(p=>(p.name==="width"||p.name==="height")&&p.value!==void 0?(t[p.name]=+p.value,!1):!0);const{params:d,...h}=t;return{$schema:"https://vega.github.io/schema/vega/v6.json",...e.description?{description:e.description}:{},...h,...u?{title:u}:{},...l?{style:l}:{},...c?{encode:{update:c}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...f,...e.assembleSelectionTopLevelSignals([]),...I8(d)]),...r?{config:r}:{},...i?{usermeta:i}:{}}}const Bve=cde.version,Uve=Object.freeze(Object.defineProperty({__proto__:null,accessPathDepth:sc,accessPathWithDatum:b$,accessWithDatumToUnescapedPath:nt,compile:Ive,contains:Pe,deepEqual:mi,deleteNestedProperty:jm,duplicate:Ce,entries:ia,every:m$,fieldIntersection:v$,flatAccessWithDatum:Y4,getFirstDefined:Ct,hasIntersection:y$,hasProperty:K,hash:Ie,internalField:J4,isBoolean:Qd,isEmpty:at,isEqual:dde,isInternalField:Z4,isNullOrFalse:ww,isNumeric:F1,keys:Y,logicalExpr:vd,mergeDeep:G4,never:H4,normalize:Q8,normalizeAngle:Jd,omit:xi,pick:ic,prefixGenerator:_w,removePathFromField:zc,replaceAll:bu,replacePathInField:ji,resetIdCounter:pde,setEqual:V4,some:rc,stringify:Ze,titleCase:Lh,unescapeSingleQuoteAndPathDot:X4,unique:Wr,uniqueId:Q4,vals:Ft,varName:gt,version:Bve},Symbol.toStringTag,{value:"Module"}));function m7(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var jve="3.0.0",qve={version:jve};const ol="#fff",NR="#888",Wve={background:"#333",view:{stroke:NR},title:{color:ol,subtitleColor:ol},style:{"guide-label":{fill:ol},"guide-title":{fill:ol}},axis:{domainColor:ol,gridColor:NR,tickColor:ol}},Ma="#4572a7",Hve={background:"#fff",arc:{fill:Ma},area:{fill:Ma},line:{stroke:Ma,strokeWidth:2},path:{stroke:Ma},rect:{fill:Ma},shape:{stroke:Ma},symbol:{fill:Ma,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Fa="#30a2da",nb="#cbcbcb",Gve="#999",Vve="#333",PR="#f0f0f0",IR="#333",Yve={arc:{fill:Fa},area:{fill:Fa},axis:{domainColor:nb,grid:!0,gridColor:nb,gridWidth:1,labelColor:Gve,labelFontSize:10,titleColor:Vve,tickColor:nb,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:PR,group:{fill:PR},legend:{labelColor:IR,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:IR,titleFontSize:14,titlePadding:10},line:{stroke:Fa,strokeWidth:2},path:{stroke:Fa,strokeWidth:.5},rect:{fill:Fa},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Fa},bar:{binSpacing:2,fill:Fa,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Ta="#000",Xve={group:{fill:"#e5e5e5"},arc:{fill:Ta},area:{fill:Ta},line:{stroke:Ta},path:{stroke:Ta},rect:{fill:Ta},shape:{stroke:Ta},symbol:{fill:Ta,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Kve=22,Qve="normal",LR="Benton Gothic, sans-serif",zR=11.5,Jve="normal",Ra="#82c6df",ib="Benton Gothic Bold, sans-serif",BR="normal",UR=13,xf={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},Zve={background:"#ffffff",title:{anchor:"start",color:"#000000",font:ib,fontSize:Kve,fontWeight:Qve},arc:{fill:Ra},area:{fill:Ra},line:{stroke:Ra,strokeWidth:2},path:{stroke:Ra},rect:{fill:Ra},shape:{stroke:Ra},symbol:{fill:Ra,size:30},axis:{labelFont:LR,labelFontSize:zR,labelFontWeight:Jve,titleFont:ib,titleFontSize:UR,titleFontWeight:BR},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:LR,labelFontSize:zR,symbolType:"square",titleFont:ib,titleFontSize:UR,titleFontWeight:BR},range:{category:xf["category-6"],diverging:xf["fireandice-6"],heatmap:xf["fire-7"],ordinal:xf["fire-7"],ramp:xf["fire-7"]}},Oa="#ab5787",Ip="#979797",ebe={background:"#f9f9f9",arc:{fill:Oa},area:{fill:Oa},line:{stroke:Oa},path:{stroke:Oa},rect:{fill:Oa},shape:{stroke:Oa},symbol:{fill:Oa,size:30},axis:{domainColor:Ip,domainWidth:.5,gridWidth:.2,labelColor:Ip,tickColor:Ip,tickWidth:.2,titleColor:Ip},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Da="#3e5c69",tbe={background:"#fff",arc:{fill:Da},area:{fill:Da},line:{stroke:Da},path:{stroke:Da},rect:{fill:Da},shape:{stroke:Da},symbol:{fill:Da},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Ci="#1696d2",jR="#000000",nbe="#FFFFFF",Lp="Lato",rb="Lato",ibe="Lato",rbe="#DEDDDD",sbe=18,wf={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},obe={background:nbe,title:{anchor:"start",fontSize:sbe,font:Lp},axisX:{domain:!0,domainColor:jR,domainWidth:1,grid:!1,labelFontSize:12,labelFont:rb,labelAngle:0,tickColor:jR,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Lp},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:rbe,gridWidth:1,labelFontSize:12,labelFont:rb,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Lp,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:rb,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Lp,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:wf["six-groups-cat-1"],diverging:wf["diverging-colors"],heatmap:wf["diverging-colors"],ordinal:wf["six-groups-seq"],ramp:wf["shades-blue"]},area:{fill:Ci},rect:{fill:Ci},line:{color:Ci,stroke:Ci,strokeWidth:5},trail:{color:Ci,stroke:Ci,strokeWidth:0,size:1},path:{stroke:Ci,strokeWidth:.5},point:{filled:!0},text:{font:ibe,color:Ci,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Ci,stroke:null}},arc:{fill:Ci},shape:{stroke:Ci},symbol:{fill:Ci,size:30}},Na="#3366CC",qR="#ccc",zp="Arial, sans-serif",abe={arc:{fill:Na},area:{fill:Na},path:{stroke:Na},rect:{fill:Na},shape:{stroke:Na},symbol:{stroke:Na},circle:{fill:Na},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:zp,fontSize:12},"guide-title":{font:zp,fontSize:12},"group-title":{font:zp,fontSize:12}},title:{font:zp,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:qR,tickColor:qR,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},zA=e=>e*(1/3+1),WR=zA(9),HR=zA(10),GR=zA(12),_f="Segoe UI",VR="wf_standard-font, helvetica, arial, sans-serif",YR="#252423",Ef="#605E5C",XR="transparent",ube="#C8C6C4",Xi="#118DFF",lbe="#12239E",cbe="#E66C37",fbe="#6B007B",dbe="#E044A7",hbe="#744EC2",pbe="#D9B300",gbe="#D64550",y7=Xi,v7="#DEEFFF",KR=[v7,y7],mbe=[v7,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",y7],ybe={view:{stroke:XR},background:XR,font:_f,header:{titleFont:VR,titleFontSize:GR,titleColor:YR,labelFont:_f,labelFontSize:HR,labelColor:Ef},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Ef,labelFontSize:WR,titleFont:VR,titleColor:YR,titleFontSize:GR,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:ube,gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Xi},line:{stroke:Xi,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:_f,fontSize:WR,fill:Ef},arc:{fill:Xi},area:{fill:Xi,line:!0,opacity:.6},path:{stroke:Xi},rect:{fill:Xi},point:{fill:Xi,filled:!0,size:75},shape:{stroke:Xi},symbol:{fill:Xi,strokeWidth:1.5,size:50},legend:{titleFont:_f,titleFontWeight:"bold",titleColor:Ef,labelFont:_f,labelFontSize:HR,labelColor:Ef,symbolType:"circle",symbolSize:75},range:{category:[Xi,lbe,cbe,fbe,dbe,hbe,pbe,gbe],diverging:KR,heatmap:KR,ordinal:mbe}},sb='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',vbe='IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',ob=400,Bp={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},bbe=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],xbe=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function by({theme:e,background:t}){const n=["white","g10"].includes(e)?"light":"dark",i=Bp.gridBg[e],r=Bp.textPrimary[e],s=Bp.textSecondary[e],o=n==="dark"?bbe:xbe,a=n==="dark"?"#d4bbff":"#6929c4";return{background:t,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:i,stroke:i},group:{fill:i},title:{color:r,anchor:"start",dy:-15,fontSize:16,font:sb,fontWeight:600},axis:{labelColor:s,labelFontSize:12,labelFont:vbe,labelFontWeight:ob,titleColor:r,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:Bp.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:sb,fill:s,fontWeight:ob},"guide-title":{font:sb,fill:s,fontWeight:ob}},range:{category:o,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const wbe=by({theme:"white",background:"#ffffff"}),_be=by({theme:"g10",background:"#f4f4f4"}),Ebe=by({theme:"g90",background:"#262626"}),Sbe=by({theme:"g100",background:"#161616"}),$be=qve.version,Abe=Object.freeze(Object.defineProperty({__proto__:null,carbong10:_be,carbong100:Sbe,carbong90:Ebe,carbonwhite:wbe,dark:Wve,excel:Hve,fivethirtyeight:Yve,ggplot2:Xve,googlecharts:abe,latimes:Zve,powerbi:ybe,quartz:ebe,urbaninstitute:obe,version:$be,vox:tbe},Symbol.toStringTag,{value:"Module"}));function Cbe(e,t,n,i){if(G(e))return`[${e.map(r=>t(oe(r)?r:QR(r,n))).join(", ")}]`;if(ae(e)){let r="";const{title:s,image:o,...a}=e;s&&(r+=`<h2>${t(s)}</h2>`),o&&(r+=`<img src="${new URL(t(o),i||location.href).href}">`);const u=Object.keys(a);if(u.length>0){r+="<table>";for(const l of u){let c=a[l];c!==void 0&&(ae(c)&&(c=QR(c,n)),r+=`<tr><td class="key">${t(l)}</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function kbe(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function QR(e,t){return JSON.stringify(e,kbe(t))}var Mbe=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black;
}
#vg-tooltip-element.visible {
  visibility: visible;
}
#vg-tooltip-element h2 {
  margin-top: 0;
  margin-bottom: 10px;
  font-size: 13px;
}
#vg-tooltip-element table {
  border-spacing: 0;
}
#vg-tooltip-element table tr {
  border: none;
}
#vg-tooltip-element table tr td {
  overflow: hidden;
  text-overflow: ellipsis;
  padding-top: 2px;
  padding-bottom: 2px;
}
#vg-tooltip-element table tr td.key {
  color: #808080;
  max-width: 150px;
  text-align: right;
  padding-right: 4px;
}
#vg-tooltip-element table tr td.value {
  display: block;
  max-width: 300px;
  max-height: 7em;
  text-align: left;
}
#vg-tooltip-element.dark-theme {
  background-color: rgba(32, 32, 32, 0.9);
  border: 1px solid #f5f5f5;
  color: white;
}
#vg-tooltip-element.dark-theme td.key {
  color: #bfbfbf;
}
`;const b7="vg-tooltip-element",Fbe={offsetX:10,offsetY:10,id:b7,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:Tbe,maxDepth:2,formatTooltip:Cbe,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function Tbe(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function Rbe(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return Mbe.toString().replaceAll(b7,e)}function x7(e,t,{offsetX:n,offsetY:i}){const r=w7({x1:e.clientX,x2:e.clientX,y1:e.clientY,y2:e.clientY},t,n,i),s=["bottom-right","bottom-left","top-right","top-left"];for(const o of s)if(_7(r[o],t))return r[o];return r["top-left"]}function Obe(e,t,n,i,r){const{position:s,offsetX:o,offsetY:a}=r,u=e._el.getBoundingClientRect(),l=e._origin,c=Dbe(u,l,n),f=w7(c,i,o,a),d=Array.isArray(s)?s:[s];for(const h of d)if(_7(f[h],i)&&!Nbe(t,f[h],i))return f[h];return x7(t,i,r)}function Dbe(e,t,n){const i=n.isVoronoi?n.datum.bounds:n.bounds;let r=e.left+t[0]+i.x1,s=e.top+t[1]+i.y1,o=n;for(;o.mark.group;)o=o.mark.group,r+=o.x??0,s+=o.y??0;const a=i.x2-i.x1,u=i.y2-i.y1;return{x1:r,x2:r+a,y1:s,y2:s+u}}function w7(e,t,n,i){const r=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2,o=e.x1-t.width-n,a=r-t.width/2,u=e.x2+n,l=e.y1-t.height-i,c=s-t.height/2,f=e.y2+i;return{top:{x:a,y:l},bottom:{x:a,y:f},left:{x:o,y:c},right:{x:u,y:c},"top-left":{x:o,y:l},"top-right":{x:u,y:l},"bottom-left":{x:o,y:f},"bottom-right":{x:u,y:f}}}function _7(e,t){return e.x>=0&&e.y>=0&&e.x+t.width<=window.innerWidth&&e.y+t.height<=window.innerHeight}function Nbe(e,t,n){return e.clientX>=t.x&&e.clientX<=t.x+n.width&&e.clientY>=t.y&&e.clientY<=t.y+n.height}class Pbe{call;options;el;constructor(t){this.options={...Fbe,...t};const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=Rbe(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:o}=this.options.anchor==="mark"?Obe(t,n,i,this.el.getBoundingClientRect(),this.options):x7(n,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${o}px`,this.el.style.left=`${s}px`}}var ab={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Ibe=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}})(),Lbe=Object.prototype.hasOwnProperty;function Xw(e,t){return Lbe.call(e,t)}function Kw(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var i=[];for(var r in e)Xw(e,r)&&i.push(r);return i}function yi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Qw(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function za(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function E7(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Jw(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Jw(e[t]))return!0}else if(typeof e=="object"){for(var i=Kw(e),r=i.length,s=0;s<r;s++)if(Jw(e[i[s]]))return!0}}return!1}function JR(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var S7=(function(e){Ibe(t,e);function t(n,i,r,s,o){var a=this.constructor,u=e.call(this,JR(n,{name:i,index:r,operation:s,tree:o}))||this;return u.name=i,u.index=r,u.operation=s,u.tree=o,Object.setPrototypeOf(u,a.prototype),u.message=JR(n,{name:i,index:r,operation:s,tree:o}),u}return t})(Error),_t=S7,zbe=yi,vl={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=n0(n,this.path);i&&(i=yi(i));var r=su(n,{op:"remove",path:this.from}).removed;return su(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=n0(n,this.from);return su(n,{op:"add",path:this.path,value:yi(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:ih(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Bbe={add:function(e,t,n){return Qw(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:vl.move,copy:vl.copy,test:vl.test,_get:vl._get};function n0(e,t){if(t=="")return e;var n={op:"_get",path:t};return su(e,n),n.value}function su(e,t,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(t,0,e,t.path):i0(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=n0(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=ih(e,t.value),o.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return o}}else{i||(e=yi(e));var a=t.path||"",u=a.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=i0;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=E7(h)),r&&(h=="__proto__"||h=="prototype"&&c>0&&u[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!Qw(h))throw new _t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);Qw(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new _t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);var o=Bbe[t.op].call(t,l,h,e);if(o.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}}else if(c>=f){var o=vl[t.op].call(t,l,h,e);if(o.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return o}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new _t("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,t,e)}}}function xy(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=yi(e));for(var s=new Array(t.length),o=0,a=t.length;o<a;o++)s[o]=su(e,t[o],n,!0,r,o),e=s[o].newDocument;return s.newDocument=e,s}function Ube(e,t,n){var i=su(e,t);if(i.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function i0(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new _t("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(vl[e.op]){if(typeof e.path!="string")throw new _t("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new _t('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new _t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Jw(e.value))throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new _t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new _t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},a=$7([o],n);if(a&&a.name==="OPERATION_PATH_UNRESOLVABLE")throw new _t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function $7(e,t,n){try{if(!Array.isArray(e))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)xy(yi(t),yi(e),n||!0);else{n=n||i0;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof _t)return r;throw r}}function ih(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,s,o;if(n&&i){if(s=e.length,s!=t.length)return!1;for(r=s;r--!==0;)if(!ih(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var a=Object.keys(e);if(s=a.length,s!==Object.keys(t).length)return!1;for(r=s;r--!==0;)if(!t.hasOwnProperty(a[r]))return!1;for(r=s;r--!==0;)if(o=a[r],!ih(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var jbe=Object.freeze({__proto__:null,JsonPatchError:_t,_areEquals:ih,applyOperation:su,applyPatch:xy,applyReducer:Ube,deepClone:zbe,getValueByPointer:n0,validate:$7,validator:i0});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var BA=new WeakMap,qbe=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),Wbe=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function Hbe(e){return BA.get(e)}function Gbe(e,t){return e.observers.get(t)}function Vbe(e,t){e.observers.delete(t.callback)}function Ybe(e,t){t.unobserve()}function Xbe(e,t){var n=[],i,r=Hbe(e);if(!r)r=new qbe(e),BA.set(e,r);else{var s=Gbe(r,t);i=s&&s.observer}if(i)return i;if(i={},r.value=yi(e),t){i.callback=t,i.next=null;var o=function(){Zw(i)},a=function(){clearTimeout(i.next),i.next=setTimeout(o)};typeof window<"u"&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return i.patches=n,i.object=e,i.unobserve=function(){Zw(i),clearTimeout(i.next),Vbe(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new Wbe(t,i)),i}function Zw(e,t){t===void 0&&(t=!1);var n=BA.get(e.object);UA(n.value,e.object,e.patches,"",t),e.patches.length&&xy(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function UA(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var s=Kw(t),o=Kw(e),a=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(Xw(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?UA(c,f,n,i+"/"+za(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+za(l),value:yi(c)}),n.push({op:"replace",path:i+"/"+za(l),value:yi(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+za(l),value:yi(c)}),n.push({op:"remove",path:i+"/"+za(l)}),a=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!a&&s.length==o.length))for(var u=0;u<s.length;u++){var l=s[u];!Xw(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+za(l),value:yi(t[l])})}}}function Kbe(e,t,n){n===void 0&&(n=!1);var i=[];return UA(e,t,i,"",n),i}var Qbe=Object.freeze({__proto__:null,compare:Kbe,generate:Zw,observe:Xbe,unobserve:Ybe});Object.assign({},jbe,Qbe,{JsonPatchError:S7,deepClone:yi,escapePathComponent:za,unescapePathComponent:E7});function Jbe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ub,ZR;function Zbe(){if(ZR)return ub;ZR=1;class e{constructor(){this.max=1e3,this.map=new Map}get(n){const i=this.map.get(n);if(i!==void 0)return this.map.delete(n),this.map.set(n,i),i}delete(n){return this.map.delete(n)}set(n,i){if(!this.delete(n)&&i!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(n,i)}return this}}return ub=e,ub}var lb,eO;function jA(){if(eO)return lb;eO=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return lb=i=>i?typeof i!="object"?e:i:t,lb}var Up={exports:{}},cb,tO;function qA(){if(tO)return cb;tO=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,i=16,r=t-6;return cb={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},cb}var fb,nO;function wy(){return nO||(nO=1,fb=typeof process=="object"&&ab&&ab.NODE_DEBUG&&/\bsemver\b/i.test(ab.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{}),fb}var iO;function WA(){return iO||(iO=1,(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=qA(),s=wy();t=e.exports={};const o=t.re=[],a=t.safeRe=[],u=t.src=[],l=t.safeSrc=[],c=t.t={};let f=0;const d="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",r],[d,i]],p=m=>{for(const[y,v]of h)m=m.split(`${y}*`).join(`${y}{0,${v}}`).split(`${y}+`).join(`${y}{1,${v}}`);return m},g=(m,y,v)=>{const b=p(y),x=f++;s(m,x,y),c[m]=x,u[x]=y,l[x]=b,o[x]=new RegExp(y,v?"g":void 0),a[x]=new RegExp(b,v?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),g("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${d}+`),g("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),g("FULL",`^${u[c.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),g("LOOSE",`^${u[c.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),g("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),g("COERCE",`${u[c.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",u[c.COERCEPLAIN]+`(?:${u[c.PRERELEASE]})?(?:${u[c.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",u[c.COERCE],!0),g("COERCERTLFULL",u[c.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Up,Up.exports)),Up.exports}var db,rO;function exe(){if(rO)return db;rO=1;const e=/^[0-9]+$/,t=(i,r)=>{const s=e.test(i),o=e.test(r);return s&&o&&(i=+i,r=+r),i===r?0:s&&!o?-1:o&&!s?1:i<r?-1:1};return db={compareIdentifiers:t,rcompareIdentifiers:(i,r)=>t(r,i)},db}var hb,sO;function HA(){if(sO)return hb;sO=1;const e=wy(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=qA(),{safeRe:i,safeSrc:r,t:s}=WA(),o=jA(),{compareIdentifiers:a}=exe();class u{constructor(c,f){if(f=o(f),c instanceof u){if(c.loose===!!f.loose&&c.includePrerelease===!!f.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",c,f),this.options=f,this.loose=!!f.loose,this.includePrerelease=!!f.includePrerelease;const d=c.trim().match(f.loose?i[s.LOOSE]:i[s.FULL]);if(!d)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+d[1],this.minor=+d[2],this.patch=+d[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");d[4]?this.prerelease=d[4].split(".").map(h=>{if(/^[0-9]+$/.test(h)){const p=+h;if(p>=0&&p<n)return p}return h}):this.prerelease=[],this.build=d[5]?d[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(e("SemVer.compare",this.version,this.options,c),!(c instanceof u)){if(typeof c=="string"&&c===this.version)return 0;c=new u(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof u||(c=new u(c,this.options)),a(this.major,c.major)||a(this.minor,c.minor)||a(this.patch,c.patch)}comparePre(c){if(c instanceof u||(c=new u(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let f=0;do{const d=this.prerelease[f],h=c.prerelease[f];if(e("prerelease compare",f,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return a(d,h)}while(++f)}compareBuild(c){c instanceof u||(c=new u(c,this.options));let f=0;do{const d=this.build[f],h=c.build[f];if(e("build compare",f,d,h),d===void 0&&h===void 0)return 0;if(h===void 0)return 1;if(d===void 0)return-1;if(d===h)continue;return a(d,h)}while(++f)}inc(c,f,d){if(c.startsWith("pre")){if(!f&&d===!1)throw new Error("invalid increment argument: identifier is empty");if(f){const h=new RegExp(`^${this.options.loose?r[s.PRERELEASELOOSE]:r[s.PRERELEASE]}$`),p=`-${f}`.match(h);if(!p||p[1]!==f)throw new Error(`invalid identifier: ${f}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",f,d);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",f,d);break;case"prepatch":this.prerelease.length=0,this.inc("patch",f,d),this.inc("pre",f,d);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",f,d),this.inc("pre",f,d);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const h=Number(d)?1:0;if(this.prerelease.length===0)this.prerelease=[h];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(f===this.prerelease.join(".")&&d===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(h)}}if(f){let p=[f,h];d===!1&&(p=[f]),a(this.prerelease[0],f)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return hb=u,hb}var pb,oO;function Vc(){if(oO)return pb;oO=1;const e=HA();return pb=(n,i,r)=>new e(n,r).compare(new e(i,r)),pb}var gb,aO;function txe(){if(aO)return gb;aO=1;const e=Vc();return gb=(n,i,r)=>e(n,i,r)===0,gb}var mb,uO;function nxe(){if(uO)return mb;uO=1;const e=Vc();return mb=(n,i,r)=>e(n,i,r)!==0,mb}var yb,lO;function ixe(){if(lO)return yb;lO=1;const e=Vc();return yb=(n,i,r)=>e(n,i,r)>0,yb}var vb,cO;function rxe(){if(cO)return vb;cO=1;const e=Vc();return vb=(n,i,r)=>e(n,i,r)>=0,vb}var bb,fO;function sxe(){if(fO)return bb;fO=1;const e=Vc();return bb=(n,i,r)=>e(n,i,r)<0,bb}var xb,dO;function oxe(){if(dO)return xb;dO=1;const e=Vc();return xb=(n,i,r)=>e(n,i,r)<=0,xb}var wb,hO;function axe(){if(hO)return wb;hO=1;const e=txe(),t=nxe(),n=ixe(),i=rxe(),r=sxe(),s=oxe();return wb=(a,u,l,c)=>{switch(u){case"===":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a===l;case"!==":return typeof a=="object"&&(a=a.version),typeof l=="object"&&(l=l.version),a!==l;case"":case"=":case"==":return e(a,l,c);case"!=":return t(a,l,c);case">":return n(a,l,c);case">=":return i(a,l,c);case"<":return r(a,l,c);case"<=":return s(a,l,c);default:throw new TypeError(`Invalid operator: ${u}`)}},wb}var _b,pO;function uxe(){if(pO)return _b;pO=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(c,f){if(f=n(f),c instanceof t){if(c.loose===!!f.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),o("comparator",c,f),this.options=f,this.loose=!!f.loose,this.parse(c),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(c){const f=this.options.loose?i[r.COMPARATORLOOSE]:i[r.COMPARATOR],d=c.match(f);if(!d)throw new TypeError(`Invalid comparator: ${c}`);this.operator=d[1]!==void 0?d[1]:"",this.operator==="="&&(this.operator=""),d[2]?this.semver=new a(d[2],this.options.loose):this.semver=e}toString(){return this.value}test(c){if(o("Comparator.test",c,this.options.loose),this.semver===e||c===e)return!0;if(typeof c=="string")try{c=new a(c,this.options)}catch{return!1}return s(c,this.operator,this.semver,this.options)}intersects(c,f){if(!(c instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,f).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,f).test(c.semver):(f=n(f),f.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||s(this.semver,"<",c.semver,f)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||s(this.semver,">",c.semver,f)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}_b=t;const n=jA(),{safeRe:i,t:r}=WA(),s=axe(),o=wy(),a=HA(),u=A7();return _b}var Eb,gO;function A7(){if(gO)return Eb;gO=1;const e=/\s+/g;class t{constructor(C,R){if(R=r(R),C instanceof t)return C.loose===!!R.loose&&C.includePrerelease===!!R.includePrerelease?C:new t(C.raw,R);if(C instanceof s)return this.raw=C.value,this.set=[[C]],this.formatted=void 0,this;if(this.options=R,this.loose=!!R.loose,this.includePrerelease=!!R.includePrerelease,this.raw=C.trim().replace(e," "),this.set=this.raw.split("||").map(N=>this.parseRange(N.trim())).filter(N=>N.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const N=this.set[0];if(this.set=this.set.filter(I=>!g(I[0])),this.set.length===0)this.set=[N];else if(this.set.length>1){for(const I of this.set)if(I.length===1&&m(I[0])){this.set=[I];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let C=0;C<this.set.length;C++){C>0&&(this.formatted+="||");const R=this.set[C];for(let N=0;N<R.length;N++)N>0&&(this.formatted+=" "),this.formatted+=R[N].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(C){const N=((this.options.includePrerelease&&h)|(this.options.loose&&p))+":"+C,I=i.get(N);if(I)return I;const U=this.options.loose,re=U?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];C=C.replace(re,P(this.options.includePrerelease)),o("hyphen replace",C),C=C.replace(u[l.COMPARATORTRIM],c),o("comparator trim",C),C=C.replace(u[l.TILDETRIM],f),o("tilde trim",C),C=C.replace(u[l.CARETTRIM],d),o("caret trim",C);let me=C.split(" ").map(Ae=>v(Ae,this.options)).join(" ").split(/\s+/).map(Ae=>M(Ae,this.options));U&&(me=me.filter(Ae=>(o("loose invalid filter",Ae,this.options),!!Ae.match(u[l.COMPARATORLOOSE])))),o("range list",me);const de=new Map,$e=me.map(Ae=>new s(Ae,this.options));for(const Ae of $e){if(g(Ae))return[Ae];de.set(Ae.value,Ae)}de.size>1&&de.has("")&&de.delete("");const Be=[...de.values()];return i.set(N,Be),Be}intersects(C,R){if(!(C instanceof t))throw new TypeError("a Range is required");return this.set.some(N=>y(N,R)&&C.set.some(I=>y(I,R)&&N.every(U=>I.every(re=>U.intersects(re,R)))))}test(C){if(!C)return!1;if(typeof C=="string")try{C=new a(C,this.options)}catch{return!1}for(let R=0;R<this.set.length;R++)if(D(this.set[R],C,this.options))return!0;return!1}}Eb=t;const n=Zbe(),i=new n,r=jA(),s=uxe(),o=wy(),a=HA(),{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:f,caretTrimReplace:d}=WA(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:p}=qA(),g=O=>O.value==="<0.0.0-0",m=O=>O.value==="",y=(O,C)=>{let R=!0;const N=O.slice();let I=N.pop();for(;R&&N.length;)R=N.every(U=>I.intersects(U,C)),I=N.pop();return R},v=(O,C)=>(o("comp",O,C),O=E(O,C),o("caret",O),O=x(O,C),o("tildes",O),O=$(O,C),o("xrange",O),O=F(O,C),o("stars",O),O),b=O=>!O||O.toLowerCase()==="x"||O==="*",x=(O,C)=>O.trim().split(/\s+/).map(R=>w(R,C)).join(" "),w=(O,C)=>{const R=C.loose?u[l.TILDELOOSE]:u[l.TILDE];return O.replace(R,(N,I,U,re,me)=>{o("tilde",O,N,I,U,re,me);let de;return b(I)?de="":b(U)?de=`>=${I}.0.0 <${+I+1}.0.0-0`:b(re)?de=`>=${I}.${U}.0 <${I}.${+U+1}.0-0`:me?(o("replaceTilde pr",me),de=`>=${I}.${U}.${re}-${me} <${I}.${+U+1}.0-0`):de=`>=${I}.${U}.${re} <${I}.${+U+1}.0-0`,o("tilde return",de),de})},E=(O,C)=>O.trim().split(/\s+/).map(R=>_(R,C)).join(" "),_=(O,C)=>{o("caret",O,C);const R=C.loose?u[l.CARETLOOSE]:u[l.CARET],N=C.includePrerelease?"-0":"";return O.replace(R,(I,U,re,me,de)=>{o("caret",O,I,U,re,me,de);let $e;return b(U)?$e="":b(re)?$e=`>=${U}.0.0${N} <${+U+1}.0.0-0`:b(me)?U==="0"?$e=`>=${U}.${re}.0${N} <${U}.${+re+1}.0-0`:$e=`>=${U}.${re}.0${N} <${+U+1}.0.0-0`:de?(o("replaceCaret pr",de),U==="0"?re==="0"?$e=`>=${U}.${re}.${me}-${de} <${U}.${re}.${+me+1}-0`:$e=`>=${U}.${re}.${me}-${de} <${U}.${+re+1}.0-0`:$e=`>=${U}.${re}.${me}-${de} <${+U+1}.0.0-0`):(o("no pr"),U==="0"?re==="0"?$e=`>=${U}.${re}.${me}${N} <${U}.${re}.${+me+1}-0`:$e=`>=${U}.${re}.${me}${N} <${U}.${+re+1}.0-0`:$e=`>=${U}.${re}.${me} <${+U+1}.0.0-0`),o("caret return",$e),$e})},$=(O,C)=>(o("replaceXRanges",O,C),O.split(/\s+/).map(R=>A(R,C)).join(" ")),A=(O,C)=>{O=O.trim();const R=C.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return O.replace(R,(N,I,U,re,me,de)=>{o("xRange",O,N,I,U,re,me,de);const $e=b(U),Be=$e||b(re),Ae=Be||b(me),et=Ae;return I==="="&&et&&(I=""),de=C.includePrerelease?"-0":"",$e?I===">"||I==="<"?N="<0.0.0-0":N="*":I&&et?(Be&&(re=0),me=0,I===">"?(I=">=",Be?(U=+U+1,re=0,me=0):(re=+re+1,me=0)):I==="<="&&(I="<",Be?U=+U+1:re=+re+1),I==="<"&&(de="-0"),N=`${I+U}.${re}.${me}${de}`):Be?N=`>=${U}.0.0${de} <${+U+1}.0.0-0`:Ae&&(N=`>=${U}.${re}.0${de} <${U}.${+re+1}.0-0`),o("xRange return",N),N})},F=(O,C)=>(o("replaceStars",O,C),O.trim().replace(u[l.STAR],"")),M=(O,C)=>(o("replaceGTE0",O,C),O.trim().replace(u[C.includePrerelease?l.GTE0PRE:l.GTE0],"")),P=O=>(C,R,N,I,U,re,me,de,$e,Be,Ae,et)=>(b(N)?R="":b(I)?R=`>=${N}.0.0${O?"-0":""}`:b(U)?R=`>=${N}.${I}.0${O?"-0":""}`:re?R=`>=${R}`:R=`>=${R}${O?"-0":""}`,b($e)?de="":b(Be)?de=`<${+$e+1}.0.0-0`:b(Ae)?de=`<${$e}.${+Be+1}.0-0`:et?de=`<=${$e}.${Be}.${Ae}-${et}`:O?de=`<${$e}.${Be}.${+Ae+1}-0`:de=`<=${de}`,`${R} ${de}`.trim()),D=(O,C,R)=>{for(let N=0;N<O.length;N++)if(!O[N].test(C))return!1;if(C.prerelease.length&&!R.includePrerelease){for(let N=0;N<O.length;N++)if(o(O[N].semver),O[N].semver!==s.ANY&&O[N].semver.prerelease.length>0){const I=O[N].semver;if(I.major===C.major&&I.minor===C.minor&&I.patch===C.patch)return!0}return!1}return!0};return Eb}var Sb,mO;function lxe(){if(mO)return Sb;mO=1;const e=A7();return Sb=(n,i,r)=>{try{i=new e(i,r)}catch{return!1}return i.test(n)},Sb}var cxe=lxe(),C7=Jbe(cxe);function fxe(e,t,n){const i=e.open(t),r=250,{origin:s}=new URL(t);let o=40;function a(l){l.source===i&&(o=0,e.removeEventListener("message",a,!1))}e.addEventListener("message",a,!1);function u(){o<=0||(i.postMessage(n,s),setTimeout(u,r),o-=1)}setTimeout(u,r)}var dxe=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus-within summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid rgba(0, 0, 0, 0);
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid rgba(0, 0, 0, 0);
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;function k7(e,...t){for(const n of t)hxe(e,n);return e}function hxe(e,t){for(const n of Object.keys(t))Ec(e,n,t[n],!0)}const Pr=Jfe;let rh=Uve;const yO=typeof window<"u"?window:void 0;rh===void 0&&yO?.vl?.compile&&(rh=yO.vl);const pxe={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},gxe={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Xf={vega:"Vega","vega-lite":"Vega-Lite"},r0={vega:Pr.version,"vega-lite":rh?rh.version:"not available"},mxe={vega:e=>e,"vega-lite":(e,t)=>rh.compile(e,{config:t}).spec},yxe=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,vxe="chart-wrapper";function bxe(e){return typeof e=="function"}function vO(e,t,n,i){const r=`<html><head>${t}</head><body><pre><code class="json">`,s=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(r+e+s),o.document.title=`${Xf[i]} JSON Source`}function xxe(e,t){if(e.$schema){const n=m7(e.$schema);t&&t!==n.library&&console.warn(`The given visualization spec is written in ${Xf[n.library]}, but mode argument sets ${Xf[t]??t}.`);const i=n.library;return C7(r0[i],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${Xf[i]} ${n.version}, but the current version of ${Xf[i]} is v${r0[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function M7(e){return!!(e&&"load"in e)}function bO(e){return M7(e)?e:Pr.loader(e)}function wxe(e){const t=e.usermeta?.embedOptions??{};return oe(t.defaultStyle)&&(t.defaultStyle=!1),t}async function _xe(e,t,n={}){let i,r;oe(t)?(r=bO(n.loader),i=JSON.parse(await r.load(t))):i=t;const s=wxe(i),o=s.loader;(!r||o)&&(r=bO(n.loader??o));const a=await xO(s,r),u=await xO(n,r),l={...k7(u,a),config:_c(u.config??{},a.config??{})};return await Sxe(e,i,l,r)}async function xO(e,t){const n=oe(e.config)?JSON.parse(await t.load(e.config)):e.config??{},i=oe(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...i?{patch:i}:{},...n?{config:n}:{}}}function Exe(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body}}async function Sxe(e,t,n={},i){const r=n.theme?_c(Abe[n.theme],n.config??{}):n.config,s=ua(n.actions)?n.actions:k7({},pxe,n.actions??{}),o={...gxe,...n.i18n},a=n.renderer??"svg",u=n.logLevel??Pr.Warn,l=n.downloadFileName??"visualization",c=document.querySelector(e);if(!c)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const w="vega-embed-style",{root:E,rootContainer:_}=Exe(c);if(!E.getElementById(w)){const $=document.createElement("style");$.id=w,$.innerHTML=n.defaultStyle===void 0||n.defaultStyle===!0?dxe.toString():n.defaultStyle,_.appendChild($)}}const f=xxe(t,n.mode);let d=mxe[f](t,r);if(f==="vega-lite"&&d.$schema){const w=m7(d.$schema);C7(r0.vega,`^${w.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${w.version}, but current version is v${r0.vega}.`)}c.classList.add("vega-embed"),s&&c.classList.add("has-actions"),c.innerHTML="";let h=c;if(s){const w=document.createElement("div");w.classList.add(vxe),c.appendChild(w),h=w}const p=n.patch;if(p&&(d=p instanceof Function?p(d):xy(d,p,!0,!1).newDocument),n.formatLocale&&Pr.formatLocale(n.formatLocale),n.timeFormatLocale&&Pr.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const w in n.expressionFunctions){const E=n.expressionFunctions[w];"fn"in E?Pr.expressionFunction(w,E.fn,E.visitor):E instanceof Function&&Pr.expressionFunction(w,E)}const{ast:g}=n,m=Pr.parse(d,f==="vega-lite"?{}:r,{ast:g}),y=new(n.viewClass||Pr.View)(m,{loader:i,logLevel:u,renderer:a,...g?{expr:Pr.expressionInterpreter??n.expr??ude}:{}});if(y.addSignalListener("autosize",(w,E)=>{const{type:_}=E;_=="fit-x"?(h.classList.add("fit-x"),h.classList.remove("fit-y")):_=="fit-y"?(h.classList.remove("fit-x"),h.classList.add("fit-y")):_=="fit"?h.classList.add("fit-x","fit-y"):h.classList.remove("fit-x","fit-y")}),n.tooltip!==!1){const{loader:w,tooltip:E}=n,_=w&&!M7(w)?w?.baseURL:void 0,$=bxe(E)?E:new Pbe({baseURL:_,...E===!0?{}:E}).call;y.tooltip($)}let{hover:v}=n;if(v===void 0&&(v=f==="vega"),v){const{hoverSet:w,updateSet:E}=typeof v=="boolean"?{}:v;y.hover(w,E)}n&&(n.width!=null&&y.width(n.width),n.height!=null&&y.height(n.height),n.padding!=null&&y.padding(n.padding)),await y.initialize(h,n.bind).runAsync();let b;if(s!==!1){let w=c;if(n.defaultStyle!==!1||n.forceActionsMenu){const _=document.createElement("details");_.title=o.CLICK_TO_VIEW_ACTIONS,c.append(_),w=_;const $=document.createElement("summary");$.innerHTML=yxe,_.append($),b=A=>{_.contains(A.target)||_.removeAttribute("open")},document.addEventListener("click",b)}const E=document.createElement("div");if(w.append(E),E.classList.add("vega-actions"),s===!0||s.export!==!1){for(const _ of["svg","png"])if(s===!0||s.export===!0||s.export[_]){const $=o[`${_.toUpperCase()}_ACTION`],A=document.createElement("a"),F=ae(n.scaleFactor)?n.scaleFactor[_]:n.scaleFactor;A.text=$,A.href="#",A.target="_blank",A.download=`${l}.${_}`,A.addEventListener("mousedown",async function(M){M.preventDefault();const P=await y.toImageURL(_,F);this.href=P}),E.append(A)}}if(s===!0||s.source!==!1){const _=document.createElement("a");_.text=o.SOURCE_ACTION,_.href="#",_.addEventListener("click",function($){vO(Ny(t),n.sourceHeader??"",n.sourceFooter??"",f),$.preventDefault()}),E.append(_)}if(f==="vega-lite"&&(s===!0||s.compiled!==!1)){const _=document.createElement("a");_.text=o.COMPILED_ACTION,_.href="#",_.addEventListener("click",function($){vO(Ny(d),n.sourceHeader??"",n.sourceFooter??"","vega"),$.preventDefault()}),E.append(_)}if(s===!0||s.editor!==!1){const _=n.editorUrl??"https://vega.github.io/editor/",$=document.createElement("a");$.text=o.EDITOR_ACTION,$.href="#",$.addEventListener("click",function(A){fxe(window,_,{config:r,mode:p?"vega":f,renderer:a,spec:Ny(p?d:t)}),A.preventDefault()}),E.append($)}}function x(){b&&document.removeEventListener("click",b),y.finalize()}return{view:y,spec:t,vgSpec:d,finalize:x,embedOptions:n}}const $xe={class:"p-10 flex-row"},Axe={__name:"Semester1",setup(e){const t={$schema:"https://vega.github.io/schema/vega-lite/v5.json",description:"Grouped bar chart of sentiment counts (positive, neutral, negative) by video ID.",width:800,height:400,data:{url:"json_file_spec_example.json",format:{type:"json"}},transform:[{fold:["positive","neutral","negative"],as:["sentiment","count"]}],mark:{type:"bar"},encoding:{x:{field:"videoId",type:"nominal",title:"Video ID"},xOffset:{field:"sentiment"},y:{field:"count",type:"quantitative",title:"Comment Count"},color:{field:"sentiment",type:"nominal",title:"Sentiment"},tooltip:[{field:"videoId",type:"nominal"},{field:"sentiment",type:"nominal"},{field:"count",type:"quantitative"}]}};return ZO(()=>{_xe("#vis",t)}),(n,i)=>(bc(),xc("div",$xe,[...i[0]||(i[0]=[bt("h2",{class:"text-4xl font-bold"},"Semester 1 Work",-1),bt("p",null," Due to unfortunate circumstances, the project was altered midway, on this page we are displaying progress from the previous half of the project ",-1),bt("p",null,"This is temporarily here.. for testing",-1),bt("h2",{class:"text-4xl font-bold"}," AI-Driven Sentiment Analysis for Public Perception of Emerging Technologies ",-1),bt("div",{id:"vis"},null,-1)])]))}},Cxe={};function kxe(e,t){return bc(),xc("p",null,"Dashboard")}const Mxe=_2(Cxe,[["render",kxe]]),Fxe=[{path:"/",component:Mxe},{path:"/about",component:pq},{path:"/contact",component:vq},{path:"/fit4701",component:Axe}],Txe=lq({history:Lj(),routes:Fxe});JU(aj).use(Txe).mount("#app");
